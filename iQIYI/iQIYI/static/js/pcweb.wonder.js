/*Built by pcw player group @2020-9-25 14:21:39 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.QiyiPlayerLoader=t()}(this,function(){"use strict";var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};function __extends(e,t){function a(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var PlayerVersion="5.1.201";function mixin(a,e,r,i){function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function t(e,t){var a;for(a in e)if(o(e,a)&&t(e[a],a))break}return e&&t(e,function(e,t){!r&&o(a,t)||(i&&"string"!=typeof e&&"boolean"!=typeof e?(a[t]||(a[t]={}),mixin(a[t],e,r,i)):a[t]=e)}),a}var licked={},cookie={get:function(e,t){var a="";if((t=mixin({memory:!1},t,!0)).memory&&licked.hasOwnProperty(e))a=licked[e];else{if(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)){var r,i=new RegExp("(^| )"+e+"=([^;]*)(;|$)").exec(document.cookie);i&&(a=i[2]||"")}"string"==typeof a&&(a=decodeURIComponent(a)),t.memory&&(licked[e]=a)}return a},set:function(e,t,a){a=a||{},t=encodeURIComponent(t);var r=a.expires;"number"==typeof a.expires&&(r=a.expires<=0?new Date(0):new Date).setTime(r.getTime()+a.expires),delete licked[e],document.cookie=e+"="+t+(a.path?"; path="+a.path:"")+(r?"; expires="+r.toUTCString():"")+(a.domain?"; domain="+a.domain:"")},remove:function(e,t){(t=t||{}).expires=-1,this.set(e,"",t)}},objectCreate=Object.create||objectCreatePolyfill,objectKeys=Object.keys||objectKeysPolyfill,bind=Function.prototype.bind||functionBindPolyfill,defaultMaxListeners=20,Dispatcher=(O.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},O.prototype.emit=function(e){var t,a,r,i,o,n,s="error"===e;if(n=this._events)s=s&&null==n.error;else if(!s)return!1;if(s){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(a=n[e]))return!1;var c="function"==typeof a;switch(r=arguments.length){case 1:emitNone(a,c,this);break;case 2:emitOne(a,c,this,arguments[1]);break;case 3:emitTwo(a,c,this,arguments[1],arguments[2]);break;case 4:emitThree(a,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];emitMany(a,c,this,i)}return!0},O.prototype.on=function(e,t,a){return void 0===a&&(a={highPriority:!1}),"object"!=typeof a&&(a={}),_addListener(this,e,t,a)},O.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,_onceWrap(this,e,t)),this},O.prototype.off=function(e,t){return _removeListener.call(this,e,t)},O.prototype.un=function(e,t){this.off(e,t)},O.prototype.removeAllListeners=function(e){var t,a,r;if(!(a=this._events))return this;if(!a.off)return 0===arguments.length?(this._events=objectCreate(null),this._eventsCount=0):a[e]&&(0==--this._eventsCount?this._events=objectCreate(null):delete a[e]),this;if(0===arguments.length){var i=objectKeys(a),o;for(r=0;r<i.length;++r)"off"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("off"),this._events=objectCreate(null),this._eventsCount=0,this}if("function"==typeof(t=a[e]))this.off(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.off(e,t[r]);return this},O.prototype.listeners=function(e){return _listeners(this,e,!0)},O.prototype.rawListeners=function(e){return _listeners(this,e,!1)},O.prototype.listenerCount=function(){return O.listenerCount.apply(this,arguments)},O),hasDefineProperty;function O(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=objectCreate(null),this._eventsCount=0),this._maxListeners=this._maxListeners||undefined}try{var o={};Object.defineProperty&&Object.defineProperty(o,"x",{value:0}),hasDefineProperty=0===o.x}catch(err){hasDefineProperty=!1}function $getMaxListeners(e){return e._maxListeners===undefined?Dispatcher.defaultMaxListeners:e._maxListeners}function emitNone(e,t,a){if(t)e.call(a);else for(var r=e.length,i=arrayClone(e,r),o=0;o<r;++o)try{i[o].call(a)}catch(n){}}function emitOne(e,t,a,r){if(t)e.call(a,r);else for(var i=e.length,o=arrayClone(e,i),n=0;n<i;++n)try{o[n].call(a,r)}catch(s){}}function emitTwo(e,t,a,r,i){if(t)e.call(a,r,i);else for(var o=e.length,n=arrayClone(e,o),s=0;s<o;++s)try{n[s].call(a,r,i)}catch(l){}}function emitThree(e,t,a,r,i,o){if(t)e.call(a,r,i,o);else for(var n=e.length,s=arrayClone(e,n),l=0;l<n;++l)try{s[l].call(a,r,i,o)}catch(c){}}function emitMany(e,t,a,r){if(t)e.apply(a,r);else for(var i=e.length,o=arrayClone(e,i),n=0;n<i;++n)try{o[n].apply(a,r)}catch(s){}}function _addListener(e,t,a,r){var i,o,n;void 0===r&&(r={});var s=!!r.highPriority;if("function"!=typeof a)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),o=e._events),n=o[t]):(o=e._events=objectCreate(null),e._eventsCount=0),n){if("function"==typeof n?n=o[t]=[n,a]:s?n.shift(a):n.push(a),!n.warned&&(i=$getMaxListeners(e))&&0<i&&n.length>i){n.warned=!0;var l=new Error("Possible Dispatcher memory leak detected. "+n.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=n.length}}else n=o[t]=a,++e._eventsCount;return e}function _removeListener(e,t){var a,r,i,o,n;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(a=r[e]))return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=objectCreate(null):(delete r[e],r.off&&this.emit("off",e,a.listener||t));else if("function"!=typeof a){for(i=-1,o=a.length-1;0<=o;o--)if(a[o]===t||a[o].listener===t){n=a[o].listener,i=o;break}if(i<0)return this;0===i?a.shift():spliceOne(a,i),1===a.length&&(r[e]=a[0]),r.off&&this.emit("off",e,n||t)}return this}function onceWrapper(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function _onceWrap(e,t,a){var r={fired:!1,wrapFn:undefined,target:e,type:t,listener:a},i=bind.call(onceWrapper,r);return i.listener=a,r.wrapFn=i}function _listeners(e,t,a){var r=e._events;if(!r)return[];var i=r[t];return i?"function"==typeof i?a?[i.listener||i]:[i]:a?unwrapListeners(i):arrayClone(i,i.length):[]}function listenerCount(e){var t=this._events;if(t){var a=t[e];if("function"==typeof a)return 1;if(a)return a.length}return 0}function spliceOne(e,t){for(var a=t,r=a+1,i=e.length;r<i;a+=1,r+=1)e[a]=e[r];e.pop()}function arrayClone(e,t){for(var a=new Array(t),r=0;r<t;++r)a[r]=e[r];return a}function unwrapListeners(e){for(var t=new Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}function objectCreatePolyfill(e){var t=function(){};return t.prototype=e,new t}function objectKeysPolyfill(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t);return t}function functionBindPolyfill(e){var t=this;return function(){return t.apply(e,arguments)}}hasDefineProperty?Object.defineProperty(Dispatcher,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=e}}):Dispatcher.defaultMaxListeners=defaultMaxListeners;var chrsz=8;function core_md5(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,r=-271733879,i=-1732584194,o=271733878,n=0;n<e.length;n+=16){var s=a,l=r,c=i,p=o;a=md5_ff(a,r,i,o,e[n+0],7,-680876936),o=md5_ff(o,a,r,i,e[n+1],12,-389564586),i=md5_ff(i,o,a,r,e[n+2],17,606105819),r=md5_ff(r,i,o,a,e[n+3],22,-1044525330),a=md5_ff(a,r,i,o,e[n+4],7,-176418897),o=md5_ff(o,a,r,i,e[n+5],12,1200080426),i=md5_ff(i,o,a,r,e[n+6],17,-1473231341),r=md5_ff(r,i,o,a,e[n+7],22,-45705983),a=md5_ff(a,r,i,o,e[n+8],7,1770035416),o=md5_ff(o,a,r,i,e[n+9],12,-1958414417),i=md5_ff(i,o,a,r,e[n+10],17,-42063),r=md5_ff(r,i,o,a,e[n+11],22,-1990404162),a=md5_ff(a,r,i,o,e[n+12],7,1804603682),o=md5_ff(o,a,r,i,e[n+13],12,-40341101),i=md5_ff(i,o,a,r,e[n+14],17,-1502002290),a=md5_gg(a,r=md5_ff(r,i,o,a,e[n+15],22,1236535329),i,o,e[n+1],5,-165796510),o=md5_gg(o,a,r,i,e[n+6],9,-1069501632),i=md5_gg(i,o,a,r,e[n+11],14,643717713),r=md5_gg(r,i,o,a,e[n+0],20,-373897302),a=md5_gg(a,r,i,o,e[n+5],5,-701558691),o=md5_gg(o,a,r,i,e[n+10],9,38016083),i=md5_gg(i,o,a,r,e[n+15],14,-660478335),r=md5_gg(r,i,o,a,e[n+4],20,-405537848),a=md5_gg(a,r,i,o,e[n+9],5,568446438),o=md5_gg(o,a,r,i,e[n+14],9,-1019803690),i=md5_gg(i,o,a,r,e[n+3],14,-187363961),r=md5_gg(r,i,o,a,e[n+8],20,1163531501),a=md5_gg(a,r,i,o,e[n+13],5,-1444681467),o=md5_gg(o,a,r,i,e[n+2],9,-51403784),i=md5_gg(i,o,a,r,e[n+7],14,1735328473),a=md5_hh(a,r=md5_gg(r,i,o,a,e[n+12],20,-1926607734),i,o,e[n+5],4,-378558),o=md5_hh(o,a,r,i,e[n+8],11,-2022574463),i=md5_hh(i,o,a,r,e[n+11],16,1839030562),r=md5_hh(r,i,o,a,e[n+14],23,-35309556),a=md5_hh(a,r,i,o,e[n+1],4,-1530992060),o=md5_hh(o,a,r,i,e[n+4],11,1272893353),i=md5_hh(i,o,a,r,e[n+7],16,-155497632),r=md5_hh(r,i,o,a,e[n+10],23,-1094730640),a=md5_hh(a,r,i,o,e[n+13],4,681279174),o=md5_hh(o,a,r,i,e[n+0],11,-358537222),i=md5_hh(i,o,a,r,e[n+3],16,-722521979),r=md5_hh(r,i,o,a,e[n+6],23,76029189),a=md5_hh(a,r,i,o,e[n+9],4,-640364487),o=md5_hh(o,a,r,i,e[n+12],11,-421815835),i=md5_hh(i,o,a,r,e[n+15],16,530742520),a=md5_ii(a,r=md5_hh(r,i,o,a,e[n+2],23,-995338651),i,o,e[n+0],6,-198630844),o=md5_ii(o,a,r,i,e[n+7],10,1126891415),i=md5_ii(i,o,a,r,e[n+14],15,-1416354905),r=md5_ii(r,i,o,a,e[n+5],21,-57434055),a=md5_ii(a,r,i,o,e[n+12],6,1700485571),o=md5_ii(o,a,r,i,e[n+3],10,-1894986606),i=md5_ii(i,o,a,r,e[n+10],15,-1051523),r=md5_ii(r,i,o,a,e[n+1],21,-2054922799),a=md5_ii(a,r,i,o,e[n+8],6,1873313359),o=md5_ii(o,a,r,i,e[n+15],10,-30611744),i=md5_ii(i,o,a,r,e[n+6],15,-1560198380),r=md5_ii(r,i,o,a,e[n+13],21,1309151649),a=md5_ii(a,r,i,o,e[n+4],6,-145523070),o=md5_ii(o,a,r,i,e[n+11],10,-1120210379),i=md5_ii(i,o,a,r,e[n+2],15,718787259),r=md5_ii(r,i,o,a,e[n+9],21,-343485551),a=safe_add(a,s),r=safe_add(r,l),i=safe_add(i,c),o=safe_add(o,p)}return Array(a,r,i,o)}function md5_cmn(e,t,a,r,i,o){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(r,o)),i),a)}function md5_ff(e,t,a,r,i,o,n){return md5_cmn(t&a|~t&r,e,t,i,o,n)}function md5_gg(e,t,a,r,i,o,n){return md5_cmn(t&r|a&~r,e,t,i,o,n)}function md5_hh(e,t,a,r,i,o,n){return md5_cmn(t^a^r,e,t,i,o,n)}function md5_ii(e,t,a,r,i,o,n){return md5_cmn(a^(t|~r),e,t,i,o,n)}function safe_add(e,t){var a=(65535&e)+(65535&t),r;return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function bit_rol(e,t){return e<<t|e>>>32-t}function str2binl(e){for(var t=Array(),a=(1<<chrsz)-1,r=0;r<e.length*chrsz;r+=chrsz)t[r>>5]|=(e.charCodeAt(r/chrsz)&a)<<r%32;return t}function binl2hex(e){for(var t="0123456789abcdef",a="",r=0;r<4*e.length;r++)a+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return a}function md5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}var isBool=function(e){return"boolean"==typeof e},isNum=function(e){return"number"==typeof e&&!isNaN(e)},isObject=function(e){return"[object object]"===Object.prototype.toString.call(e).toLowerCase()},isArray=function(e){var t;return t=Array.isArray?Array.isArray(e):"[object array]"===Object.prototype.toString.call(e).toLowerCase()},formatMilliseconds=function(e){if(isNaN(e))return"00:00:00";var t=3600<=(e=Math.round(e))?Math.floor(e/3600):0,a=60<=e%3600?Math.floor(e%3600/60):0;return a=10<=a?a:"0"+a,e=10<=(e=0<=parseInt(a,10)?e%3600%60:e)?e:"0"+e,0<t?(9<t?t:"0"+t)+":"+a+":"+e:a+":"+e},protocolRevise=function(e){void 0===e&&(e="");var t="";return t=(t=(t=e.replace("http://","//")).replace("https://","//")).replace(".qiyipic",".iqiyipic")},hex2rgba=function(e,t){void 0===t&&(t=1);for(var a=[],r=1;r<e.length;){var i=e.substring(r,r+2);a.push(parseInt(i,16)),r+=2}return a.push(t),"rgba("+a.join(",")+")"},util={isBool:isBool,isNumber:isNum,isArray:isArray,isObject:isObject,formatMilliseconds:formatMilliseconds,protocolRevise:protocolRevise,hex2rgba:hex2rgba},doc=document,noop=function(){},cacheMappingURL={},accepts={"*":"*/".concat("*"),text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},converters={"*":null,text:null,html:null,xml:null,json:function(e){var t={},a=window.JSON?JSON.parse:function(){return{}};try{t=a(e)}catch(r){}return t}},defaultOptions={method:"get",dataType:"*",timeout:1e4,charset:"utf-8",cache:!0,withCredentials:!0,jsonpCallback:"callback",complete:noop,success:noop,failure:noop},_paramFormat=function(e){var t=[];if("object"==typeof e)for(var a in e)t[t.length]=encodeURIComponent(a)+"="+encodeURIComponent(e[a]);return t.join("&").replace(/%20/g,"+")},ajax=function(p){mixin(p=p||{},defaultOptions);var d=p.url,f=p.dataType,_=p.params||{},u=p.success,y=p.failure,e;d&&function(){var r={},e=p.headers,t=p.data||null,a=_paramFormat(_);r.params=_,r.url=d+(0<a.length?(/\?/i.test(d)?"&":"?")+a:""),"function"==typeof p.beforeSend&&(r=p.beforeSend(r));var i=new XMLHttpRequest;if(i.withCredentials=p.withCredentials,i.onreadystatechange=l,i.ontimeout=c,i.open(p.method,r.url,!0),i.timeout=p.timeout,i.setRequestHeader("Accept",accepts[f]),util.isObject(e))for(var o in e)i.setRequestHeader(o,e[o]);i.send(t);var n="",s=!1;function l(){var e;if(n+=", readyState = "+i.readyState,4==i.readyState)if(e=converters[f]?converters[f](i.responseText):i.responseText,n+=", status = "+i.status+", statusText = "+i.statusText,200==i.status){if("json"===f&&"string"==typeof e)try{e=JSON.parse(e)}catch(a){}u(e)}else if(!s){s=!0;var t="";try{t=JSON.stringify(e)}catch(a){t=" json error"}n+=", data = "+t+"url = "+r.url,y("xhr error, time = "+p.timeout+n)}}function c(e){if(!s){s=!0;var t="xhr timeout, time = "+p.timeout+", readyState = "+i.readyState+", status = "+i.status+", data = "+JSON.stringify(e)+"url = "+r.url;y(t)}}}()},xhrJSON=function(e){mixin(e=e||{},defaultOptions),e.dataType="json",ajax(e)},jsonp=function(e){mixin(e=e||{},defaultOptions);var t=e.url,a=e.params||{},r=_paramFormat(a),i=t+(0<r.length?(/\?/i.test(t)?"&":"?")+r:""),o=e.complete,n=e.success,s=e.failure,l="Q"+md5(e.fixedCallback||i),c=!!e.memory,p=md5(i),d=cacheMappingURL[p];if(i){if(!(c&&d&&n)){var f=function(e,t,a){switch(_(),e){case"success":c&&(cacheMappingURL[p]=a),n(a);break;case"fail":s(a,t)}o(a)},_=function(){if(window[l]){window[l]=undefined;try{delete window[l]}catch(e){}}},u;window[l]=function(e){_(),setTimeout(function(){f("success","200",e)},0)};var y={},h=doc.createElement("script");h.async=!0,h.type="text/javascript",h.charset=e.charset;var E=function(){if(h)try{h.onload(null,!0)}catch(e){}};h.abort=E,h.onload=h.onreadystatechange=function(e,t){!t&&h.readyState&&!/loaded|complete/.test(h.readyState)||(h.onload=h.onreadystatechange=null,h.parentNode&&h.parentNode.removeChild(h),h=null,clearTimeout(u))},h.onerror=function(){f("fail",null),E()},u=setTimeout(function(){f("fail",408),E()},e.timeout);var m={};return m[e.jsonpCallback]=l,mixin(a,m,!0),y.url=i+(/\?/i.test(i)?"&":"?")+_paramFormat(m),y.params=a,"function"==typeof e.beforeSend&&(y=e.beforeSend(y)||y),h.src=y.url,doc.getElementsByTagName("head")[0].appendChild(h),h}n(d)}},beacon=function(e,t,a){if("string"==typeof t){var r=a===undefined||a;if(e){var i=[];for(var o in r&&(e._=+new Date),e)i.push(o+"="+encodeURIComponent(e[o]));var n=t+"?"+i.join("&"),s=new Image;s.onload=s.onerror=s.onabort=function(){s.onload=s.onerror=s.onabort=null,s=null},s.src=n}}},http={serializeParam:_paramFormat,ajax:ajax,json:xhrJSON,jsonp:jsonp,beacon:beacon},data={},changeData={},deleteData={},tMark=0,storage={getItem:function(e){return data[e]},setItem:function(e,t){data[e]=t},removeItem:function(e){delete data[e]}},ls=function(){try{return window.localStorage.setItem("_Q_test_",1),window.localStorage.removeItem("_Q_test_"),window.localStorage}catch(e){}return storage}(),updateStorage=function(){0===tMark&&(clearTimeout(tMark),tMark=setTimeout(function(){for(var e in tMark=0,changeData)ls.setItem(e,changeData[e]),delete changeData[e];for(var t in deleteData)ls.removeItem(t),delete deleteData[e]},1e3))},storage$1={PLAYER_VD_KEY:"QiyiPlayerVD",read:function(e){return data[e]||(data[e]=ls.getItem(e)),data[e]},write:function(e,t){data[e]=t,changeData[e]=t,updateStorage()},remove:function(e){delete data[e],deleteData[e]=0,updateStorage()}},loggerMessageChanged=!1,LOGGER_MESSAGE="",LOGGER_KEY="QiyiPlayerLogger",LOGGER_LEVEL_KEY="QiyiPlayerLoggerLevel",COLOR_BG_NORMAL="#FFA500",COLOR_BG_WARN="#ff6cb7",COLOR_BG_ERROR="#F30",COLOR_BG_DEBUG="#FFA500",Levels={OFF:{value:0,name:"OFF"},ERROR:{value:1,name:"ERROR"},WARN:{value:2,name:"WARN"},INFO:{value:3,name:"INFO"},DEBUG:{value:4,name:"DEBUG"}},filterLevelInStore=parseInt(storage$1.read(LOGGER_LEVEL_KEY),10),slice=Array.prototype.slice,prelogInfo="",repeatNum=0,prelog="",pad=function(e,t){var a="",r=e<0,i=String(Math.abs(e));return i.length<t&&(a=new Array(t-i.length+1).join("0")),(r?"-":"")+a+i},timeLabel=function(){var e=new Date;return e.getFullYear()+"-"+pad(e.getMonth()+1,2)+"-"+pad(e.getDate(),2)+" "+pad(e.getHours(),2)+":"+pad(e.getMinutes(),2)+":"+pad(e.getSeconds(),2)+(e.getMilliseconds?"."+pad(e.getMilliseconds(),3):"")},checkrepeat=function(e){var t=e.join("");prelog!==t?(prelog=t,repeatNum=0):(1<++repeatNum&&(LOGGER_MESSAGE=(LOGGER_MESSAGE=LOGGER_MESSAGE.replace(prelogInfo,"")).substring(0,LOGGER_MESSAGE.length-2)),e.push(">>repeat("+repeatNum+")<<"))},logHandler=function(e,t){var a,r=COLOR_BG_NORMAL;if(e=slice.call(e),checkrepeat(e),e.unshift("%c"),e.unshift("["+t.name+"]"),e.unshift("%c["+timeLabel()+" IQIYI_PLAYER_"+t.level.name+"]"),t.level!==Levels.DEBUG){prelogInfo=e.join("").replace(/(%c|IQIYI_PLAYER_)/gi,"");var i=LOGGER_MESSAGE||"";LOGGER_MESSAGE=(""!==i?i+"\n":"")+prelogInfo,loggerMessageChanged=!0}if("undefined"!=typeof console)try{a=console.log,t.level===Levels.WARN&&console.warn?(a=console.warn,r=COLOR_BG_WARN):t.level===Levels.ERROR&&console.error?(a=console.error,r=COLOR_BG_ERROR):t.level===Levels.INFO&&console.info?a=console.info:t.level===Levels.DEBUG&&console.debug&&(a=console.debug,r=COLOR_BG_DEBUG),t.print&&a.apply(console,[e.join(" ")+" ","background-color:#699f00;color:#fff;","background-color:"+r+";color:#fff;"])}catch(o){}},PlayerLogger=(sf.stringify=function(e){var t="";try{t=JSON.stringify(e)}catch(a){}return t},sf.setLevel=function(e){e&&"value"in e&&(sf._filterLevel=e,storage$1.write(LOGGER_LEVEL_KEY,e.value))},sf.getLevel=function(){if(!sf._filterLevel){var e=Levels.WARN;for(var t in Levels)Levels[t].value===filterLevelInStore&&(e=Levels[t]);sf._filterLevel=e}return sf._filterLevel},sf.getLog=function(){return LOGGER_MESSAGE},sf.saveImmediately=function(){writeLogInstantly()},sf.prototype.enabledFor=function(e){return e.value<=sf.getLevel().value},sf.prototype.invoke=function(e,t){logHandler(t,mixin({level:e,print:this.enabledFor(e)},this.context))},sf.prototype.debug=function(){this.invoke(Levels.DEBUG,arguments)},sf.prototype.log=function(){this.invoke(Levels.INFO,arguments)},sf.prototype.info=function(){this.invoke(Levels.INFO,arguments)},sf.prototype.warn=function(){this.invoke(Levels.WARN,arguments)},sf.prototype.error=function(){this.invoke(Levels.ERROR,arguments)},sf);function sf(e){this.context={name:e||"Unknown"}}PlayerLogger.Levels=Levels;var period=3e4,M=1048576,limitSize=.5*M;function truncateLog(e,t){var a="\n",r,i=LOGGER_MESSAGE.split(a).slice(0,6).join(a)+a+"~~~~~truncated log~~~~~"+a;LOGGER_MESSAGE=i+LOGGER_MESSAGE.slice(i.length<e?e:i.length,t)}function writeLogInstantly(){var e=LOGGER_MESSAGE.length;limitSize<e&&truncateLog(e-limitSize,e),storage$1.write(LOGGER_KEY,LOGGER_MESSAGE)}function cronLogIntoStore(){loggerMessageChanged&&(loggerMessageChanged=!1,writeLogInstantly()),setTimeout(cronLogIntoStore,period)}setTimeout(cronLogIntoStore,period);var _parse=function(e){var t="",a="",r="",i="",o=/(\w+):\/\/([^\/:]+):?(\d*)((?:\/|$)[^?#]*)/,n=e.match(o);return n&&(t=n[1],a=n[2],r=n[3],i=n[4]),{protocol:t,host:a,port:r,path:i}},_queryToJson=function(e){for(var t,a=e.substr(e.lastIndexOf("?")+1).split("&"),r=a.length,i={},o=0,n,s,l,c;o<r;o++)a[o]&&(n=(c=a[o].split("=")).shift(),s=c.join("="),void 0===(l=i[n])&&(i[n]=s));return i},_getQueryValue=function(e,t){1===arguments.length&&(t=e,e=window.location.href);var a=String(t).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1"),r=new RegExp("(^|&|\\?|#)"+a+"=([^&#]*)(&|$|#)",""),i=e.match(r);return i?i[2]:""},_filename=function(e){var t=_parse(e),a;return(t&&t.path||"").replace(/^.*[\\\/]/,"").split(".")[0]},urlkit={parse:_parse,query:_getQueryValue,query2Json:_queryToJson,filename:_filename},CON_TYPE={PlayerType_Html5VOD:"h5_VOD",PlayerType_FlashVOD:"flash_VOD",PlayerType_Null:"null",QYPLAYER_STATUS_LOAD_MOVIE:"loadmovie",QYPLAYER_STATUS_DATA_READY:"dataready",QYPLAYER_STATUS_AD_START_PLAY:"adstartplay",QYPLAYER_STATUS_AD_PLAYING:"adplaying",QYPLAYER_STATUS_AD_PAUSED:"adpaused",QYPLAYER_STATUS_AD_RESUMED:"adresumed",QYPLAYER_STATUS_READY:"ready",QYPLAYER_STATUS_START_PLAY:"startplay",QYPLAYER_STATUS_SEEKING:"seeking",QYPLAYER_STATUS_WAITING:"waiting",QYPLAYER_STATUS_PAUSED:"paused",QYPLAYER_STATUS_PLAYING:"playing",QYPLAYER_STATUS_STOPED:"stoped",QYPLAYER_STATUS_ERROR:"error",QYPLAYER_STATUS_END_PLAY:"endplay",QYPLAYER_LOAD_COMPLETE:"loadcomplete",QYPLAYER_LOAD_SUCCESS:"playerLoadSuccess",QYPLAYER_STATE_CHANGE:"playerStateChange",QYPLAYER_VIDEO_CHANGE:"videoChanged",QYPLAYER_VID_CHANGE:"vidChanged",QYPLAYER_NEXT_VIDEO:"playnextvideo",QYPLAYER_SET_LIGHT:"setLight",QYPLAYER_MOVETO_QITAN:"moveToQitan",QYPLAYER_SHOW_LOGIN_PANEL:"showLoginPanel",QYPLAYER_EXPAND:"expand",QYPLAYER_AUTHENTICATION_RESULE:"authenticationResult",QYPLAYER_RECHARGE:"recharge",QYPLAYER_SUBSCRIBE:"subscribe",QYPLAYER_REFRESH_PAGE:"refreshPage",QYPLAYER_DOWNLOAD:"download",QYPLAYER_REQUEST_VIDEOLIST:"requestVideoList",QYPLAYER_REQUEST_VIDEOLIST_BY_PAGE:"requestVideoListByPage",QYPLAYER_REQUEST_CHANGE_VIDEO:"requestChangeVideo",QYPLAYER_SWITCH_FULL_SCREEN:"switchFullScreen",QYPLAYER_ADD_TO_TABLE:"addToTable",QYPLAYER_FOCUS_TIPS:"focusTips",QYPLAYER_FOCUS_UPLOADER:"focusUploader",QYPLAYER_FIND_GOODS:"findGoods",QYPLAYER_PGC_FOLLOW:"pgcFollow",QYPLAYER_SHOW_DOWNLOAD_APPPOP:"showDownLoadAppPop",QYPLAYER_CHECK_CLIENT_INSTALL:"checkClientInstall",QYPLAYER_REQUEST_SEND_PINGBACK:"requestJSSendPB",QYPLAYER_DOSOMETHING:"setJsDoSomething",QYPLAYER_FOLLOW_UPNEXT_LOAD:"followUpNextLoad",QYPLAYER_USER_CLICK_SCORE:"userClickScore",QYPLAYER_BARRAGE_REPLAY:"barrageReply",QYPLAYER_BARRAGE_RECEIVE_DATA:"barrageReceiveData",QYPLAYER_SET_BARRAGE_INTERACT_INFO:"setBarrageInteractInfo",QYPLAYER_NOTIFY_BARRAGE_DATA:"notifyBarrageData",QYPLAYER_SET_BARRAGE_CONFIG_INFO:"setHasBarrageConfigInfo",QYPLAYER_SET_BARRAGE_CHANNEL_CONFIG_INFO:"setHasBarrageChannelConfigInfo",QYPLAYER_BARRAGE_STATE_CHANGE:"barrageStateChange",QYPLAYER_BARRAGE_ALLOWED:"barrageAllowed",QYPLAYER_REQUEST_REWARD:"requestReward",QYPLAYER_COMMENT_ALLOWED:"commentAllowed",QYPLAYER_GET_PLAYER_LOG:"getQiyiPlayerLog",QYPLAYER_WEBFULLSCREEN_BEFORE_CHANGE:"beforeWebFullScreenChange",QYPLAYER_WEBFULLSCREEN_AFTER_CHANGE:"afterWebFullScreenChange",QYPLAYER_FULLSCREEN_BEFORE_CHANGE:"beforeFullScreenChange",QYPLAYER_FULLSCREEN_AFTER_CHANGE:"afterFullScreenChange",QYPLAYER_NOTIFY_GIFT_INFO:"notifyGiftInfo",QYPLAYER_NOTIFY_WRITE_FLASH_LOG:"writeFlashLog",QYPLAYER_SWITCH_PLAYER:"switchPlayer",QYPLAYER_NOTIFY_AD_START:"ADStart",QYPLAYER_NOTIFY_AD_END:"ADEnd",QYPLAYER_NOTIFY_AD_NOTIFY_INFO:"adnotifyinfo",QYPLAYER_NOTIFY_AD_BLOCK:"adblock",QYPLAYER_NOTIFY_TIMEUPDATE:"timeUpdate",QYPLAYER_NOTIFY_SCORECHANGE:"scoreTaskChange",QYPLAYER_NOTIFY_FEEDBACK_SHOW:"feedbackShow",QYPLAYER_NOTIFY_FEEDBACK_HIDE:"feedbackHide",QYPLAYER_NOTIFY_USER_SEEK:"userSeek",QYPLAYER_BuyPlay:"buyPlay",QYPLAYER_NOTIFY_TO_DIVERSION:"todiversion",QYPLAYER_NOTIFY_AI_STAR_INFO:"aistarinfo",QYPLAYER_NOTIFY_AI_STAR_CLOSE:"aistarclose",QYPLAYER_NOTIFY_SHOW_VIDEOLIST:"showvideolist",QYPLAYER_NOTIFY_FOLLOW_CLICK:"followbtnclick",QYPLAYER_NOTIFY_INTERACTION_START:"interactionstart",QYPLAYER_NOTIFY_INTERACTION_END:"interactionend",QYPLAYER_H5_VIDEO_LOADSTART:"h5videoloadstart",QYPLAYER_H5_VIDEO_LOADEDMETADATA:"h5videoloadedmetadata",QYPLAYER_H5_DURATION_CHANGED:"h5durationchanged",QYPLAYER_H5_VOLUME_CHANGED:"h5volumechanged"};function platform(){var e="",l={},c={},t=navigator,a=t.platform,r=t.userAgent.toLowerCase(),i=r.match(/rtrident/),o=!i&&r.match(/(ipad).*os\s([\d_]+)/),n=!i&&!o&&r.match(/(iphone\sos)\s([\d_]+)/),s=r.match(/Android\s+([\d.]+)/i),p="",d="";if(d=navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:(d=r.match(/NetType\/\w+/)?r.match(/NetType\/\w+/)[0]:"").toLowerCase().replace("nettype/",""),c.userAgent=r,c.IE11=/rv\:11/.test(r),c.IE=/msie/.test(r)||c.IE11,c.IE6=/msie 6/.test(r),c.IE7=/msie 7/.test(r),c.IE8=/msie 8/.test(r),c.IE9=/msie 9/.test(r),c.IE10=/msie 10/.test(r),c.EDGE=/edge/.test(r),c.iPhone=/iphone os/.test(r)&&!i,c.iPhone4=/iphone os [45]_/.test(r)&&!i,c.iPad=/ipad/.test(r)&&!i,c.iPod=/iPod/i.test(r)&&!i,c.isTouch="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,c.CHROMEIOS=/crios/.test(r),c.CHROME=/chrome/.test(r)&&!c.EDGE,c.SAFARI=/safari/.test(r)&&!/chrome/.test(r),c.FIREFOX=/firefox/.test(r),c.mobile=/mobile/gi.test(r),c.mobileSafari=c.iPhone||c.iPhone||c.iPad,c.QQ=/QQBrowser/gi.test(r),c.WECHAT=/(wechat)|(micromessenger)/gi.test(r),c.CHROME){var f=/chrome\/([\d\.]+) /gi.exec(r);c.version=f?parseInt(f[1],10):0}if(c.EDGE){var _=/edge\/([\d\.]+)/gi.exec(r);c.version=_?parseInt(_[1],10):0}var u=/mac/i.test(a),y="X11"==a&&!u,h=/win/i.test(a)&&!y,E=/android/.test(r);l.unix=y,l.win=h,l.mac=u,l.android=E,l.androidMobile=E&&c.mobile,l.androidTablet=E&&(!c.mobile||/pad/i.test(r)),s&&(l.version=s[1]),l.ios=!1,n&&(l.ios=!0,l.version=n[2].replace(/_/g,".")),o&&(l.ios=!0,l.version=o[2].replace(/_/g,".")),c.iPod&&(l.ios=!0),e=c.iPad?"b85da1cf3ae44351":"b6c13e26323c537d";var m=function(e){var t="01";(c.iPhone||l.android)&&(t="02"),(c.iPad||l.androidTablet)&&(t="03");var a="01",r,i,o,n,s;return l.android&&(a="02"),l.mac&&(a="08"),l.ios&&(a="03"),t+a+"003"+"101"+"00"+(e?"10":"00")+"000000"},g=function(e){return p||m(e)},P=function(e){p=e},A=function(e){var t=1,a;switch(g(e).substr(0,4)){case"0108":t=276;break;case"0303":t=10;break;case"0302":t=11;break;case"0203":t=13;break;case"0202":t=12}return t},L=function(){var e="";return c.CHROME?e="CHROME":c.SAFARI?e="SAFARI":c.FIREFOX?e="FIREFOX":c.QQ?e="QQ":c.WECHAT?e="WECHAT":c.IE?e="IE":c.IE6?e="IE6":c.IE7?e="IE7":c.IE8?e="IE8":c.IE9?e="IE9":c.IE10?e="IE10":c.EDGE?e="EDGE":c.mobileSafari?e="mobileSafari":l.ios?e="ios":l.ios?e="ios":l.androidMobile?e="androidMobile":l.androidTablet&&(e="androidTablet"),e},v=r.match(/miuivideo\//i)||l.android&&4<parseInt(l.version)&&r.match(/MiuiBrowser/i),T=c.iPad||c.iPhone||l.android&&4<parseFloat(l.version)||v?"m3u8":"mp4";return/__pmode__=m3u8/.test(window.location.href)?T="m3u8":/__pmode__=mp4/.test(window.location.href)&&(T="mp4"),{browser:c,os:l,code:e,getPtid:g,setPtid:P,getAgentType:A,browserName:L,network:d,playerMode:T}}var platform$1=platform();function isSupported(){var e=!!window.Promise&&!!window.Uint8Array&&!!Array.prototype.forEach,t=window.MediaSource||window.WebKitMediaSource,a=window.URL,r=!1;if(t&&"function"==typeof t.isTypeSupported){var i=t.isTypeSupported('video/mp4;codecs="avc1.42E01E"'),o;r=t.isTypeSupported('audio/mp4;codecs="mp4a.40.2"')&&i}return e&&!!a&&(!!r||platform$1.browser.EDGE)}var mseFlag=isSupported(),_userAgent=navigator.userAgent,chromeVersion=/chrome\/([\d\.]+) /gi.exec(_userAgent.toLowerCase());chromeVersion=chromeVersion?parseInt(chromeVersion[1],10):0;var firxfoxVersion=/firefox\/([\d\.]+)/gi.exec(_userAgent.toLowerCase());firxfoxVersion=firxfoxVersion?parseInt(firxfoxVersion[1],10):0;var safariVersion=/Version\/([\d\.]+)/gi.exec(_userAgent.toLowerCase());function isSupportQVS(){var e=platform$1.browser.WECHAT,t=platform$1.browser.CHROME&&34<=chromeVersion&&!platform$1.browser.EDGE,a=platform$1.browser.SAFARI&&10<=safariVersion,r=platform$1.browser.FIREFOX&&42<=firxfoxVersion,i=platform$1.browser.EDGE,o;return mseFlag&&(e||t||a||r||i)}function isSupportHtml5(e){var t;return(isSupportQVS()||platform$1.os.ios||platform$1.os.android)&&!e}function getForcedType(){var e;return cookie.get("player_forcedType")||null}function getDefaultType(){var e=CON_TYPE.PlayerType_Html5VOD,t;return"flash"==urlkit.query("__playertype__")&&(e=CON_TYPE.PlayerType_FlashVOD),"1"===cookie.get("QP004")&&(e=CON_TYPE.PlayerType_FlashVOD),e}function getPlayerType(e,t){var a;return isSupportHtml5(t)?getForcedType()||e||getDefaultType():CON_TYPE.PlayerType_FlashVOD}safariVersion=safariVersion?parseFloat(safariVersion[1]):0;var domain="http://msg.qy.net";"https:"==window.location.protocol&&(domain="https://msg.qy.net");var Component=(mh.prototype.pv=function(e,t){(t=t||this.options).url=t.url||this.url,sendFunction({block:e,t:21},t)},mh.prototype.cl=function(e,t){(t=t||this.options).url=t.url||this.url;var a={t:20,rseat:e};mixin(a,t),!a.re&&window.document&&(a.re=[document.body.offsetWidth,document.body.offsetHeight].join("*")),sendFunction(a,t)},mh);function mh(e,t){this.url=e||domain+"/b",this.options=t||{}}var instance=new Component,sendFunction=function(e,t){var a=t.url,r={pf:1,p:10,p1:101,p2:"1_10_101",jsuid:cookie.get("QC005"),u:cookie.get("QC005"),pu:cookie.get("P00003")};mixin(r,e),t.param&&"object"==typeof t.param&&(t.cover?r=t.param:mixin(r,t.param)),/^(http:|https:)?\/\/([\w.]+\/?)\S*$/.test(t.url)?a=t.url:t.url&&(a=domain+t.url),http.beacon(r,a)},pingback={create:function(e){return new Component(e.url,e)},cl:function(e,t){instance.cl(e,t)},pv:function(e,t){instance.pv(e,t)}},browser=platform$1.browser,_swf,i18nLang,TEXT={zh:{error_maintitle:"Flash插件异常",error_fltitle:"下载官方Flash插件",error_h5title:"正在切换HTML5播放模式",error_fltip:"已安装仍无法观看"},tw:{error_maintitle:"Flash插件異常",error_fltitle:"下載官方Flash插件",error_h5title:"正在切換HTML5播放模式",error_fltip:"已安裝仍無法觀看"}},EmbedSwf=(Dh.prototype.embed=function(e,t){var a={};i18nLang=TEXT.zh,"tw_t"!=e.locale&&"cn_t"!=e.locale||(i18nLang=TEXT.tw),a.quality="high",a.allowScriptAccess="always",a.wmode=e.wmode?e.wmode:"opaque",a.align="middle",a.bgcolor="#000000",a.swLiveConnect="true",a.loop="true",a.play="true",a.DeviceFont="false",a.allowFullScreen="true",a.menu="true",a.flashVars="",(browser.IE6||browser.IE7||browser.IE8)&&(a.movie=e.playerUrl),e.origin=e.origin||"swf_"+e.parentId,e.P00001=cookie.get("P00001")||"",e.fluid=cookie.get("QC005")||"",e.jsuid=cookie.get("QC006")||"",e.profileID=cookie.get("P00PRU")||"",e.profileCookie=cookie.get("P00007")||"",e.passportID=cookie.get("P00003")||"",e.vipuser=cookie.get("CM0001")||"",e.vv=cookie.get("QC004")||"",e.yhls=1*new Date+parseInt(1e11*Math.random(),10),e.playerCTime=e.plyct,e.pageCTime=e.pgct,e.webEventID=window.webEventID||"",e.tmplt=e.pageTmpltType||0,e.isSupportHtml5=t?"1":"0",e.definitionID=e.vid,e.tvId=e.tvid;for(var r=["tvid","vid","wmode"],i=0;i<r.length;i++)e[r[i]]&&delete e[r[i]];for(var o in e)"undefined"==typeof e[o]||/^h5/gi.test(o)||(a.flashvars+=(/=/gi.test(a.flashvars)?"&":"")+o+"="+e[o]);var n=[];for(var s in n.push('<object id="'+e.origin+'" height="100%" width="100%" data-player-playerbody="flash" '+(browser.IE6||browser.IE7?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ':"")+'type="application/x-shockwave-flash" data="'+e.playerUrl+'">'),a)a[s]&&n.push('<param name="',s,'" value="',a[s],'" />');var l="",c=document.getElementById(e.parentId),p={maintitle:"font-size:22px;margin-bottom:24px;font-weight:normal",tiptitle:"font-size:14px;margin-bottom:18px",iconflash:"width:100px;height:100px;border-radius:50%;display:block;margin:-2px auto 0;background:url(//www.iqiyipic.com/common/fix/iq-player/fla-player-l.png) no-repeat center;cursor:pointer;background-color:#131313",iconlink:"font-size:13px;color:#00be06;text-decoration:none;display:inline-block;margin-top:12px"},d={maintitle:"font-size:26px;margin-bottom:32px;font-weight:normal",tiptitle:"font-size:18px;margin-bottom:32px",iconflash:"width:124px;height:124px;border-radius:50%;display:block;margin:-6px auto 0;background:url(//www.iqiyipic.com/common/fix/iq-player/fla-player.png) no-repeat center;cursor:pointer;background-color:#131313",iconlink:"font-size:16px;color:#00be06;text-decoration:none;display:inline-block;margin-top:15px"};if(/micromessenger/.test(navigator.userAgent.toLowerCase()))l='<div style="background-color:#232323;width:100%;height:100%;position:absolute;top:0;left:0;z-index:100;"><div style="position:absolute;left:50%;margin-left:-180px;top:50%;margin-top:-40px;"><p style="text-align:center;margin-bottom:40px;color:#fff;">为保证观影体验，请使用系统浏览器观看视频。</p><p style="text-align:center;margin-bottom:40px;color:#fff;">或在微信客户端--通用设置中勾选”使用系统默认浏览器打开网页“。</p></div></div>';else{var f=d;c.offsetWidth<=995&&(f=p),l+='<div style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:#000;z-index:100">  <div style="text-align:center;overflow:hidden;position:absolute;width:100%;top:50%;margin-top:-115px;text-align:center;color:#ddd">    <h3 id="j_qpmaintitle" style="'+f.maintitle+'">'+i18nLang.error_maintitle+'</h3>\t<p id="j_qptiptitle" style="'+f.tiptitle+'">'+i18nLang.error_fltitle+'</p><a id="j_qpflashdown" href="//www.adobe.com/go/getflashplayer" target="_blank" onmouseover="this.style.backgroundColor=\'#171717\'" onmouseout="this.style.backgroundColor=\'#131313\'"style="'+f.iconflash+'"</a><a id="j_qpflashhelp" target="_blank" href="//help.iqiyi.com/questionInfo/4048.html" style="'+f.iconlink+'">'+i18nLang.error_fltip+"></a>  </div></div>"}n.push(l),n.push("</object>");var _=n.join(""),u=document.createElement("div");u.innerHTML=_;try{c.appendChild(u.firstChild),this.addEvent(window,"resize",function(){var e=document.getElementById("j_qpflashdown");if(e){var t=document.getElementById("j_qpflashhelp"),a=document.getElementById("j_qpmaintitle"),r=document.getElementById("j_qptiptitle");c.offsetWidth<=995?(a.style.cssText=p.maintitle,r.style.cssText=p.tiptitle,e.style.cssText=p.iconflash,t.style.cssText=p.iconlink):(a.style.cssText=d.maintitle,r.style.cssText=d.tiptitle,e.style.cssText=d.iconflash,t.style.cssText=d.iconlink)}}),this.addEvent(c,"click",function(e){var t,a=((e=e||event).srcElement?e.srcElement:e.target).id;"j_qpflashdown"==a?pingback.cl("80720_errorpanel_flash"):"j_qpflashhelp"==a&&pingback.cl("80720_errorpanel_flash_explanation")}),pingback.pv("80720_errorpanel_flash"),(_swf=document.getElementById(e.origin)).loadSuccess=!1}catch(y){}return u=null,_swf},Dh.prototype.addEvent=function(e,t,a){window.attachEvent?e.attachEvent("on"+t,a):window.addEventListener&&e.addEventListener(t,a)},Dh);function Dh(){}var cbcache={},genCacheKey=function(e){return e},VideoInfo={get:function(e,o){var t=e.tvid,a=e.locale,r=genCacheKey(t);if(cbcache[r]=cbcache[r]||[],cbcache[r].push(o),t&&o){var i="//pcw-api.iqiyi.com/video/video/playervideoinfo?tvid="+t;i=a?i+"&locale="+a:i,http.jsonp({url:i,memory:!0,success:function(e){"A00000"===e.code&&e.data||o({}),e=e.data;var t=genCacheKey(e.tvid),a=genCacheKey(e.videoQipuId),r=[];cbcache[t]?(r=(cbcache[t]||[]).slice(0),delete cbcache[t]):cbcache[a]&&(r=(cbcache[a]||[]).slice(0),delete cbcache[a]);for(var i=0;i<r.length;i++)r[i]&&function(e,t){setTimeout(function(){e({tvid:t.videoQipuId,vid:t.vid,albumId:t.albumId,cid:t.cid,vi:t,sid:t.sid,cType:t.cType})},0)}(r[i],e);r=null},failure:function(e){o(e||{})}})}},isUGC:function(e){return!!((e+="")&&2<e.length&&"9"==e.charAt(e.length-1)&&"0"==e.charAt(e.length-2)&&0<(e=parseInt(e,10))&&9e7<e)}},xml2json=function(d){var e="1.2.0";function t(){d.escapeMode===undefined&&(d.escapeMode=!0),d.attributePrefix=d.attributePrefix||"_",d.arrayAccessForm=d.arrayAccessForm||"none",d.emptyNodeForm=d.emptyNodeForm||"text",d.enableToStringFunc===undefined&&(d.enableToStringFunc=!0),d.arrayAccessFormPaths=d.arrayAccessFormPaths||[],d.skipEmptyTextNodesForObj===undefined&&(d.skipEmptyTextNodesForObj=!0),d.stripWhitespaces===undefined&&(d.stripWhitespaces=!0),d.datetimeAccessFormPaths=d.datetimeAccessFormPaths||[],d.useDoubleQuotes===undefined&&(d.useDoubleQuotes=!1),d.xmlElementsFilter=d.xmlElementsFilter||[],d.jsonPropertiesFilter=d.jsonPropertiesFilter||[],d.keepCData===undefined&&(d.keepCData=!1)}d=d||{},t();var f={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function _(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function u(e){return e.prefix}function l(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,a,r){for(var i=0;i<e.length;i++){var o=e[i];if("string"==typeof o){if(o==r)break}else if(o instanceof RegExp){if(o.test(r))break}else if("function"==typeof o&&o(t,a,r))break}return i!=e.length}function y(e,t,a){switch(d.arrayAccessForm){case"property":e[t]instanceof Array?e[t+"_asArray"]=e[t]:e[t+"_asArray"]=[e[t]]}!(e[t]instanceof Array)&&0<d.arrayAccessFormPaths.length&&i(d.arrayAccessFormPaths,e,t,a)&&(e[t]=[e[t]])}function o(e){var t=e.split(/[-T:+Z]/g),a=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(a.setHours(t[3],t[4],r[0]),1<r.length&&a.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]),o;i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),a.setMinutes(a.getMinutes()-i-a.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())));return a}function h(e,t,a){if(0<d.datetimeAccessFormPaths.length){var r=a.split(".#")[0];return i(d.datetimeAccessFormPaths,e,t,r)?o(e):e}return e}function E(e,t,a,r){return!(t==f.ELEMENT_NODE&&0<d.xmlElementsFilter.length)||i(d.xmlElementsFilter,e,a,r)}function m(e,t){var a,r,i,o,n,s,l,c;if(e.nodeType==f.DOCUMENT_NODE){for(c=new Object,l=e.childNodes,s=0;s<l.length;s++)(a=l.item(s)).nodeType==f.ELEMENT_NODE&&(c[r=_(a)]=m(a,r));return c}if(e.nodeType==f.ELEMENT_NODE){for((c=new Object).__cnt=0,l=e.childNodes,s=0;s<l.length;s++)r=_(a=l.item(s)),a.nodeType!=f.COMMENT_NODE&&(i=t+"."+r,E(c,a.nodeType,r,i)&&(c.__cnt++,null==c[r]?(c[r]=m(a,i),y(c,r,i)):(null!=c[r]&&(c[r]instanceof Array||(c[r]=[c[r]],y(c,r,i))),c[r][c[r].length]=m(a,i))));for(n=0;n<e.attributes.length;n++)o=e.attributes.item(n),c.__cnt++,c[d.attributePrefix+o.name]=o.value;var p=u(e);return null!=p&&""!=p&&(c.__cnt++,c.__prefix=p),null!=c["#text"]&&(c.__text=c["#text"],c.__text instanceof Array&&(c.__text=c.__text.join("\n")),d.stripWhitespaces&&(c.__text=c.__text.trim()),delete c["#text"],"property"==d.arrayAccessForm&&delete c["#text_asArray"],c.__text=h(c.__text,r,t+"."+r)),null!=c["#cdata-section"]&&(c.__cdata=c["#cdata-section"],delete c["#cdata-section"],"property"==d.arrayAccessForm&&delete c["#cdata-section_asArray"]),0==c.__cnt&&"text"==d.emptyNodeForm?c="":1==c.__cnt&&null!=c.__text?c=c.__text:1!=c.__cnt||null==c.__cdata||d.keepCData?1<c.__cnt&&null!=c.__text&&d.skipEmptyTextNodesForObj&&(d.stripWhitespaces&&""==c.__text||""==c.__text.trim())&&delete c.__text:c=c.__cdata,delete c.__cnt,!d.enableToStringFunc||null==c.__text&&null==c.__cdata||(c.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),c}if(e.nodeType==f.TEXT_NODE||e.nodeType==f.CDATA_SECTION_NODE)return e.nodeValue}function c(e,t,a,r){var i="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=a)for(var o=0;o<a.length;o++){var n=a[o],s=e[n];d.escapeMode&&(s=l(s)),i+=" "+n.substr(d.attributePrefix.length)+"=",d.useDoubleQuotes?i+='"'+s+'"':i+="'"+s+"'"}return i+=r?"/>":">"}function p(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function a(e,t){return-1!==e.indexOf(t,e.length-t.length)}function g(e,t){return!!("property"==d.arrayAccessForm&&a(t.toString(),"_asArray")||0==t.toString().indexOf(d.attributePrefix)||0==t.toString().indexOf("__")||e[t]instanceof Function)}function P(e){var t=0;if(e instanceof Object)for(var a in e)g(e,a)||t++;return t}function A(e,t,a){return 0==d.jsonPropertiesFilter.length||""==a||i(d.jsonPropertiesFilter,e,t,a)}function L(e){var t=[];if(e instanceof Object)for(var a in e)-1==a.toString().indexOf("__")&&0==a.toString().indexOf(d.attributePrefix)&&t.push(a);return t}function r(e){var t="";return null!=e.__cdata&&(t+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(d.escapeMode?t+=l(e.__text):t+=e.__text),t}function v(e){var t="";return e instanceof Object?t+=r(e):null!=e&&(d.escapeMode?t+=l(e):t+=e),t}function T(e,t){return""===e?t:e+"."+t}function O(e,t,a,r){var i="";if(0==e.length)i+=c(e,t,a,!0);else for(var o=0;o<e.length;o++)i+=c(e[o],t,L(e[o]),!1),i+=Y(e[o],T(r,t)),i+=p(e[o],t);return i}function Y(e,t){var a="",r;if(0<P(e))for(var i in e)if(!g(e,i)&&(""==t||A(e,i,T(t,i)))){var o=e[i],n=L(o);if(null==o||o==undefined)a+=c(o,i,n,!0);else if(o instanceof Object)if(o instanceof Array)a+=O(o,i,n,t);else if(o instanceof Date)a+=c(o,i,n,!1),a+=o.toISOString(),a+=p(o,i);else{var s;0<P(o)||null!=o.__text||null!=o.__cdata?(a+=c(o,i,n,!1),a+=Y(o,T(t,i)),a+=p(o,i)):a+=c(o,i,n,!0)}else a+=c(o,i,n,!1),a+=v(o),a+=p(o,i)}return a+=v(e)}this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window,a;if(e===undefined)return null;if(window.DOMParser){var r=new window.DOMParser,i=null;if(!t)try{i=r.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(err){i=null}try{a=r.parseFromString(e,"text/xml"),null!=i&&0<a.getElementsByTagNameNS(i,"parsererror").length&&(a=null)}catch(err){a=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(a=new ActiveXObject("Microsoft.XMLDOM")).async="false",a.loadXML(e);return a},this.asArray=function(e){return e===undefined||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?o(e):e},this.xml2json=function(e){return m(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return Y(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return e}},logger=new PlayerLogger("FlashAdapter"),FlashAdapter=function(_super){function FlashAdapter(param,isSupportHtml5,manager){var _this_1=_super.call(this)||this;_this_1._player=_this_1,_this_1.__canRecordEvents=!0,_this_1.eventsRecorder={},_this_1.__evtRecorderTimer=setTimeout(function(){_this_1.stopRecordEvents()},3e5),_this_1.isSmallWindow=null,_this_1._videoid=param.vid,_this_1._tvid=param.tvid,_this_1.local=param.local||"cn_s",_this_1._isFirstWriteLog=!0;var _this=_this_1;return _this_1._embedSwf=new EmbedSwf,_this_1._swf=_this_1._embedSwf.embed(param,isSupportHtml5),_this_1._playerId=param.parentId||"",_this_1._param=param,_this_1._prevCalls=[],_this_1._firstTime=!0,_this_1.LOGGER_KEY="QiyiPlayerLogger",_this_1._swf&&(_this_1._swf.fire=function(data){try{var ev_1=window.JSON?window.JSON.parse(data):eval("("+data+")");if(ev_1.data.origin&&ev_1.data.origin!=_this._swf.id)return;setTimeout(function(){try{_this.handleEvent(ev_1.type,ev_1.data)}catch(e){}},0)}catch(e){return}},_this_1.destroy=function(){logger.log("js call func,params: type = player destroy(销毁播放器)"),_this_1._swf.parentNode.removeChild(_this_1._swf),_this_1._swf=null,_this_1._embedSwf=null,delete manager.players[_this_1._playerId],_this_1.fire({type:"destroy"}),_this_1.removeAllListeners()}),_this_1._embedSwf.addEvent(window,"beforeunload",function(){_this_1._flashcall("stopHeartBeat")}),_this_1}return __extends(FlashAdapter,_super),FlashAdapter.prototype.callSwf=function(e){var t=this._swf,a=e.functionName,r=e.parameter,i=e.callback||function(){};t&&a&&t[a]&&(r===undefined?i(t[a]()):"[object Object]"==Object.prototype.toString.apply(r)||"[object Array]"==Object.prototype.toString.apply(r)?i(t[a](JSON.stringify(r))):i(t[a](r)))},FlashAdapter.prototype.handleEvent=function(e,a){var r=this;if(a=a||{},e==CON_TYPE.QYPLAYER_STATE_CHANGE){var t=a.state||"";a.vid!=r._videoid&&(r._videoid=a.vid,r._tvid=a.tvid,t.toLocaleLowerCase()==CON_TYPE.QYPLAYER_STATUS_LOAD_MOVIE&&r.getVideoInfo(function(e){logger.info("call js, fire event,params: type = videoChanged(视频切换完成)"),r.fire({type:CON_TYPE.QYPLAYER_VIDEO_CHANGE,data:e})}),r.getPlayInfo(function(e){var t={};t.prePlayingDuration=e.prePlayingDuration,t.preTvid=e.preTvid,t.curPlayingDuration=e.curPlayingDuration,t.playerVersion=e.playerVersion,mixin(a,t),logger.info("call js, fire event,params: type = vidChanged(视频切换)"),r.fire({type:CON_TYPE.QYPLAYER_VID_CHANGE,data:a})})),t.toLocaleLowerCase()==CON_TYPE.QYPLAYER_STATUS_DATA_READY&&r.getVideoInfo(function(e){logger.info("call js, fire event,params: type = dataready(数据信息已经准备好)"),r.fire({type:CON_TYPE.QYPLAYER_STATUS_DATA_READY,data:e})}),t.toLocaleLowerCase()==CON_TYPE.QYPLAYER_STATUS_END_PLAY&&r.getPlayInfo(function(e){var t={};t.prePlayingDuration=e.prePlayingDuration,t.preTvid=e.preTvid,t.curPlayingDuration=e.curPlayingDuration,t.playerVersion=e.playerVersion,mixin(a,t)}),t.toLocaleLowerCase()==CON_TYPE.QYPLAYER_STATUS_START_PLAY&&r.getPlayInfo(function(e){r._timeMark=e.totaleDuration,mixin(a,e)}),t.toLocaleLowerCase()==CON_TYPE.QYPLAYER_STATUS_SEEKING&&r.fire({type:CON_TYPE.QYPLAYER_STATUS_SEEKING,data:{actionType:"controls",current:a.current,duration:a.duration}}),a.state&&(a.state=t.toLocaleLowerCase()),logger.info("call js, fire event,params: type = playerStateChange(状态改变), state = "+t.toLocaleLowerCase()),r.fire({type:CON_TYPE.QYPLAYER_STATE_CHANGE,data:a})}else if(e==CON_TYPE.QYPLAYER_NEXT_VIDEO)logger.info("call js, fire event,params: type = playnextvideo(点击下一集)"),r.fire({type:CON_TYPE.QYPLAYER_NEXT_VIDEO});else if(e==CON_TYPE.QYPLAYER_SWITCH_PLAYER)cookie.set("QP004",0,{expires:288e5,path:"/",domain:"iqiyi.com"}),window.location.reload();else if(e==CON_TYPE.QYPLAYER_LOAD_COMPLETE)logger.info("call js, fire event,params: type = loadcomplete(加载完成)"),r.fire({type:CON_TYPE.QYPLAYER_LOAD_COMPLETE,data:a});else if(e==CON_TYPE.QYPLAYER_SET_LIGHT){var i="false"==a.open;logger.info("call js, fire event,params: type = setLight(开关灯), open = "+i),r.fire({type:CON_TYPE.QYPLAYER_SET_LIGHT,data:i})}else if(e==CON_TYPE.QYPLAYER_MOVETO_QITAN)logger.info("call js, fire event,params: type = moveToQitan(移动到评论)"),r.fire({type:CON_TYPE.QYPLAYER_MOVETO_QITAN});else if(e==CON_TYPE.QYPLAYER_LOAD_SUCCESS)a.playerId=this._param.parentId,logger.info("call js, fire event,params: type = playerLoadSuccess(播放器初始化完毕)"),r.fire({type:CON_TYPE.QYPLAYER_LOAD_SUCCESS,data:a});else if(e==CON_TYPE.QYPLAYER_SHOW_LOGIN_PANEL)logger.info("call js, fire event,params: type = showLoginPanel(弹出登录框)"),r.fire({type:CON_TYPE.QYPLAYER_SHOW_LOGIN_PANEL,data:a});else if(e==CON_TYPE.QYPLAYER_EXPAND)logger.info("call js, fire event,params: type = expand(将播放器放大展开)"),r.fire({type:CON_TYPE.QYPLAYER_EXPAND,data:a});else if(e==CON_TYPE.QYPLAYER_AUTHENTICATION_RESULE)logger.info("call js, fire event,params: type = authenticationResult(鉴权结果), isTryWatch = "+a.isTryWatch),r.fire({type:CON_TYPE.QYPLAYER_AUTHENTICATION_RESULE,data:{isTryWatch:"true"==a.isTryWatch,tvid:a.tvid}});else if(e==CON_TYPE.QYPLAYER_RECHARGE)logger.info("call js, fire event,params: type = recharge(请求JS充值)"),r.fire({type:CON_TYPE.QYPLAYER_RECHARGE,data:a});else if(e==CON_TYPE.QYPLAYER_BuyPlay)logger.info("call js, fire event,params: type = buyPlay(会员购买超前点播特权)"),r.fire({type:CON_TYPE.QYPLAYER_BuyPlay,data:a});else if(e==CON_TYPE.QYPLAYER_REFRESH_PAGE)logger.info("call js, fire event,params: type = refreshPage(刷新页面)"),r.fire({type:CON_TYPE.QYPLAYER_REFRESH_PAGE});else if(e==CON_TYPE.QYPLAYER_DOWNLOAD)logger.info("call js, fire event,params: type = download(离线下载)"),r.fire({type:CON_TYPE.QYPLAYER_DOWNLOAD,data:a});else if(e==CON_TYPE.QYPLAYER_REQUEST_VIDEOLIST)logger.info("call js, fire event,params: type = requestVideoList(请求联播列表)"),r.fire({type:CON_TYPE.QYPLAYER_REQUEST_VIDEOLIST,data:a});else if(e==CON_TYPE.QYPLAYER_SWITCH_FULL_SCREEN)logger.info("call js, fire event,params: type = switchFullScreen(全屏|普屏切换)"),r.fire({type:CON_TYPE.QYPLAYER_SWITCH_FULL_SCREEN,data:a.value});else if(e==CON_TYPE.QYPLAYER_ADD_TO_TABLE)logger.info("call js, fire event,params: type = addToTable(追剧王--添加到桌面)"),r.fire({type:CON_TYPE.QYPLAYER_ADD_TO_TABLE});else if(e==CON_TYPE.QYPLAYER_ADD_TO_TABLE)logger.info("call js, fire event,params: type = addToTable(追剧王--添加到桌面)"),r.fire({type:CON_TYPE.QYPLAYER_ADD_TO_TABLE});else if(e==CON_TYPE.QYPLAYER_FOCUS_TIPS)logger.info("call js, fire event,params: type = focusTips(播放到看点)"),r.fire({type:CON_TYPE.QYPLAYER_FOCUS_TIPS,data:a});else if(e==CON_TYPE.QYPLAYER_FOCUS_UPLOADER)logger.info("call js, fire event,params: type = focusUploader(获取订阅信息)"),r.fire({type:CON_TYPE.QYPLAYER_FOCUS_UPLOADER,data:a});else if(e==CON_TYPE.QYPLAYER_FIND_GOODS)logger.info("call js, fire event,params: type = findGoods(定位到商品)"),r.fire({type:CON_TYPE.QYPLAYER_FIND_GOODS,data:a});else if(e==CON_TYPE.QYPLAYER_BARRAGE_REPLAY)logger.info("call js, fire event,params: type = barrageReply(回复弹幕)"),r.fire({type:CON_TYPE.QYPLAYER_BARRAGE_REPLAY,data:a});else if(e==CON_TYPE.QYPLAYER_BARRAGE_RECEIVE_DATA)logger.info("call js, fire event,params: type = barrageReceiveData(收到服务器最新socket弹幕信息)"),r.fire({type:CON_TYPE.QYPLAYER_BARRAGE_RECEIVE_DATA,data:a});else if(e==CON_TYPE.QYPLAYER_SET_BARRAGE_INTERACT_INFO)logger.info("call js, fire event,params: type = setBarrageInteractInfo(收到服务器官弹互动信息数据)"),r.fire({type:CON_TYPE.QYPLAYER_SET_BARRAGE_INTERACT_INFO,data:a});else if(e==CON_TYPE.QYPLAYER_SET_BARRAGE_CONFIG_INFO)logger.info("call js, fire event,params: type = setHasBarrageConfigInfo(弹幕的云控配置)"),r.fire({type:CON_TYPE.QYPLAYER_SET_BARRAGE_CONFIG_INFO,data:a});else if(e==CON_TYPE.QYPLAYER_SET_BARRAGE_CHANNEL_CONFIG_INFO)logger.info("call js, fire event,params: type = setHasBarrageChannelConfigInfo(弹幕的频道配置)"),r.fire({type:CON_TYPE.QYPLAYER_SET_BARRAGE_CHANNEL_CONFIG_INFO,data:a});else if(e==CON_TYPE.QYPLAYER_NOTIFY_GIFT_INFO)logger.info("call js, fire event,params: type = notifyGiftInfo(发现弹幕红包)"),r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_GIFT_INFO,data:{data:decodeURIComponent(a.data||"")}});else if(e==CON_TYPE.QYPLAYER_NOTIFY_BARRAGE_DATA){logger.info("call js, fire event,params: type = notifyBarrageData(发现弹幕数据)");var o={};a&&a.data&&(o=(new xml2json).xml_str2json(decodeURIComponent(a.data))),r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_BARRAGE_DATA,data:{data:o.danmu}})}else e==CON_TYPE.QYPLAYER_SHOW_DOWNLOAD_APPPOP?(logger.info("call js, fire event,params: type = showDownLoadAppPop(下载影音客户端)"),r.fire({type:CON_TYPE.QYPLAYER_SHOW_DOWNLOAD_APPPOP,data:a})):e==CON_TYPE.QYPLAYER_NOTIFY_SCORECHANGE?r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_SCORECHANGE}):e==CON_TYPE.QYPLAYER_CHECK_CLIENT_INSTALL?(logger.info("call js, fire event,params: type = checkClientInstall(检测客户端)"),r.fire({type:CON_TYPE.QYPLAYER_CHECK_CLIENT_INSTALL,data:a})):e==CON_TYPE.QYPLAYER_REQUEST_SEND_PINGBACK?(logger.info("call js, fire event,params: type = requestJSSendPB(请求JS发送pingback)"),r.fire({type:CON_TYPE.QYPLAYER_REQUEST_SEND_PINGBACK,data:a})):e==CON_TYPE.QYPLAYER_DOSOMETHING?(logger.info("call js, fire event,params: type = setJsDoSomething(请求JS做某些操作)"),r.fire({type:CON_TYPE.QYPLAYER_DOSOMETHING,data:a})):e==CON_TYPE.QYPLAYER_FOLLOW_UPNEXT_LOAD?(logger.info("call js, fire event,params: type = followUpNextLoad(继续加载后续结构)"),r.fire({type:CON_TYPE.QYPLAYER_FOLLOW_UPNEXT_LOAD,data:a})):e==CON_TYPE.QYPLAYER_USER_CLICK_SCORE?(logger.info("call js, fire event,params: type = userClickScore(评分)"),r.fire({type:CON_TYPE.QYPLAYER_USER_CLICK_SCORE,data:a})):e==CON_TYPE.QYPLAYER_BARRAGE_STATE_CHANGE?(logger.info("call js, fire event,params: type = barrageStateChange(弹幕状态发生改变)"),r.fire({type:CON_TYPE.QYPLAYER_BARRAGE_STATE_CHANGE,data:a})):e==CON_TYPE.QYPLAYER_REQUEST_REWARD?(logger.info("call js, fire event,params: type = requestReward(请求打赏)"),r.fire({type:CON_TYPE.QYPLAYER_REQUEST_REWARD,data:a})):e==CON_TYPE.QYPLAYER_COMMENT_ALLOWED?(logger.info("call js, fire event,params: type = commentAllowed(vrs的评论字段)"),r.fire({type:CON_TYPE.QYPLAYER_COMMENT_ALLOWED,data:a})):e==CON_TYPE.QYPLAYER_NOTIFY_WRITE_FLASH_LOG?r._isFirstWriteLog?(storage$1.write(r.LOGGER_KEY,a.logStr.join("\n")),r._isFirstWriteLog=!1):storage$1.write(r.LOGGER_KEY,storage$1.read(r.LOGGER_KEY)+"\n"+a.logStr.join("\n")):e==CON_TYPE.QYPLAYER_NOTIFY_AD_START?(logger.info("call js, fire event,params: type = ADStart(广告开播)"),r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_AD_START,data:a})):e==CON_TYPE.QYPLAYER_NOTIFY_AD_END?(logger.info("call js, fire event,params: type = ADEnd(广告播放完成)"),r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_AD_END,data:a})):e==CON_TYPE.QYPLAYER_NOTIFY_TIMEUPDATE?r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_TIMEUPDATE,data:a}):e==CON_TYPE.QYPLAYER_NOTIFY_AD_NOTIFY_INFO?(logger.info("call js, fire event,params: type = AD notify info(广告通知的信息-只是转发)"+a.type),r.fire({type:a.data.type,data:a.data.data})):e==CON_TYPE.QYPLAYER_NOTIFY_FEEDBACK_SHOW?r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_FEEDBACK_SHOW,data:a}):e==CON_TYPE.QYPLAYER_NOTIFY_FEEDBACK_HIDE?r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_FEEDBACK_HIDE,data:a}):e==CON_TYPE.QYPLAYER_NOTIFY_USER_SEEK?r.fire({type:CON_TYPE.QYPLAYER_NOTIFY_USER_SEEK}):e==CON_TYPE.QYPLAYER_BARRAGE_RECEIVE_DATA&&r.fire({type:CON_TYPE.QYPLAYER_BARRAGE_RECEIVE_DATA,data:a})},FlashAdapter.prototype.fire=function(e){var t=e.type,a=e.data,r={type:t};a!==undefined&&(r.data=a),this.emit(t,r),this.__canRecordEvents&&(this.eventsRecorder[t]||(this.eventsRecorder[t]=[]),"playerStateChange"===t?this.eventsRecorder[t].push(r):this.eventsRecorder[t]=[r])},FlashAdapter.prototype.un=function(e,t){return this.off(e,t),this},FlashAdapter.prototype._flashcall=function(e,t,a){var r={callback:a,functionName:e,parameter:t};this.callSwf(r)},FlashAdapter.prototype.load=function(e){logger.info("js call func,params: type = load(加载视频), data = "+e),this._flashcall("loadQiyiVideo",e)},FlashAdapter.prototype.stopRecordEvents=function(){var e=this;e.__canRecordEvents=!1,clearTimeout(e.__evtRecorderTimer),setTimeout(function(){e.eventsRecorder={}},1e4)},FlashAdapter.prototype.play=function(){logger.info("js call func,params: type = play(播放)"),this._flashcall("playQiyiVideo")},FlashAdapter.prototype.resume=function(){logger.info("js call func,params: type = resume"),this._flashcall("resumeQiyiVideo")},FlashAdapter.prototype.replay=function(){logger.info("js call func,params: type = replay"),this._flashcall("replayQiyiVideo")},FlashAdapter.prototype.pause=function(){logger.info("js call func,params: type = pause"),this._flashcall("pauseQiyiVideo")},FlashAdapter.prototype.seek=function(e){logger.info("js call func,params: type = seek, time = "+e),this._flashcall("seekQiyiVideo",e)},FlashAdapter.prototype.stop=function(){logger.info("js call func,params: type = stop(停止播放)"),this._flashcall("stopQiyiVideo")},FlashAdapter.prototype.getPlayInfo=function(r){this._flashcall("getQiyiPlayerInfo",undefined,function(e){var t=e||"",a=t?JSON.parse(t.replace(/\r/g,"").replace(/\n/g,"")):"";a&&(a.currentTime=a.currentTime?a.currentTime/1e3:0,r(a))})},FlashAdapter.prototype.getVideoInfo=function(e){var t=this.locale;t="tw_t"===t||"cn_t"===t?"zh_tw":"",VideoInfo.get({tvid:this._tvid,vid:this._videoid,locale:t},e)},FlashAdapter.prototype.getPlayerId=function(){return this._playerId},FlashAdapter.prototype.setQiyiUserLogin=function(e){logger.info("js call func,params: type = setQiyiUserLogin(修改登录状态), param = "+PlayerLogger.stringify(e)),this._flashcall("setQiyiUserLogin",e)},FlashAdapter.prototype.switchVideo=function(e){logger.info("js call func,params: type = switchVideo(影片切换), param = "+PlayerLogger.stringify(e)),this._flashcall("switchVideo",e)},FlashAdapter.prototype.switchNextVideo=function(){logger.info("js call func,params: type = switchNextVideo(下一集)"),this._flashcall("switchNextVideo")},FlashAdapter.prototype.switchPreVideo=function(){logger.info("js call func,params: type = switchPreVideo(上一集)"),this._flashcall("switchNextVideo")},FlashAdapter.prototype.addVideoList=function(e){logger.info("js call func,params: type = addVideoList(添加联播列表)"),this._flashcall("addVideoList",e)},FlashAdapter.prototype.removeVideoList=function(e){logger.info("js call func,params: type = removeVideoList(从联播列表删除), data = "+e),this._flashcall("removeVideoList",e)},FlashAdapter.prototype.setSmallWindowMode=function(e){this.isSmallWindow!==e&&(logger.info("js call func,params: type = setSmallWindowMode(设置小窗,1为小窗), data = "+e),this.isSmallWindow=e,this._flashcall("setSmallWindowMode",e))},FlashAdapter.prototype.jsNotifyAdManager=function(e){this._flashcall("jsNotifyAdManager",e)},FlashAdapter.prototype.getQiyiPlayerLog=function(e){this._flashcall("getQiyiPlayerLog",undefined,e)},FlashAdapter.prototype.clearBanWord=function(){this._flashcall("clearBanWord")},FlashAdapter.prototype.addBanWord=function(e){e!==undefined&&""!==e&&this._flashcall("addBanWord",e)},FlashAdapter.prototype.removeBanWord=function(e){e&&this._flashcall("removeBanWord",e)},FlashAdapter.prototype.requestBarrageData=function(e){this._flashcall("requestBarrageData")},FlashAdapter.prototype.notyfyADInfo=function(e){this._flashcall("notyfyADInfo",e)},FlashAdapter.prototype.getIsInMainVideo=function(e){this._flashcall("getIsInMainVideo",undefined,e)},FlashAdapter.prototype.setCyclePlay=function(e){logger.info("js call func,params: type = setCyclePlay(是否联播), param = "+e),this._flashcall("setCyclePlay")},FlashAdapter.prototype.getQiyiPlayerInfo=function(e){this.getPlayInfo(e)},FlashAdapter.prototype.getQiyiVideoInfo=function(e){this._flashcall("getQiyiVideoInfo",undefined,e)},FlashAdapter.prototype.setLight=function(e){logger.info("js call func,params: type = setLight(开关灯)"),this._flashcall("setLight",e)},FlashAdapter.prototype.expand=function(e){logger.info("js call func,params: type = expand"),this._flashcall("expand",e)},FlashAdapter.prototype.setBarrageStatus=function(e){logger.info("js call func,params: type = setBarrageStatus(设置弹幕开关)"),this._flashcall("setBarrageStatus",e)},FlashAdapter.prototype.setSelfSendBarrageInfo=function(e){this._flashcall("setSelfSendBarrageInfo",e)},FlashAdapter.prototype.setBarrageSetting=function(e){this._flashcall("setBarrageSetting",e)},FlashAdapter.prototype.setActivityNoticeInfo=function(e){this._flashcall("setActivityNoticeInfo",e)},FlashAdapter.prototype.zoomQiyiVideo=function(e){this._flashcall("zoomQiyiVideo",e)},FlashAdapter.prototype.setTimeListener=function(e){this._flashcall("setTimeListener",e)},FlashAdapter.prototype.getHasBarrageConfigInfo=function(){this._flashcall("getHasBarrageConfigInfo")},FlashAdapter.prototype.getHasBarrageChannelConfigInfo=function(){this._flashcall("getHasBarrageChannelConfigInfo")},FlashAdapter.prototype.getHasBarrageGiftInfo=function(){this._flashcall("getHasBarrageGiftInfo")},FlashAdapter.prototype.getCommentConfigInfo=function(){this._flashcall("getCommentConfigInfo")},FlashAdapter.prototype.setContinuePlayState=function(e){logger.info("js call func,params: type = setContinuePlayState"),this._flashcall("setContinuePlayState",e)},FlashAdapter.prototype.getSwitchVideoType=function(e){this._flashcall("getSwitchVideoType",undefined,e)},FlashAdapter.prototype.forceToSaveCurVideoInfo=function(e){this._flashcall("forceToSaveCurVideoInfo",e)},FlashAdapter.prototype.getContinueData=function(e){this._flashcall("getContinueData",e)},FlashAdapter.prototype.setQiyiVisits=function(e){this._flashcall("setQiyiVisits",e)},FlashAdapter.prototype.initQiyiVideo=function(e){logger.info("js call func,params: type = initQiyiVideo(初始化播放命令,用于账号封停,以非会员观看)"),this._flashcall("initQiyiVideo",e)},FlashAdapter.prototype.getQiyiPlayerType=function(e){var t="flash";return e&&"function"==typeof e&&e(t),t},FlashAdapter.prototype.setPlayerFullScreen=function(e){e&&this._flashcall("setPlayerFullScreen",e)},FlashAdapter.prototype.exitPicInPic=function(){},FlashAdapter.prototype.setQiyiSubscribe=function(){},FlashAdapter.prototype.setSubscribeInfo=function(){},FlashAdapter.prototype.setSubscribeStateChange=function(){},FlashAdapter.prototype.setPlayerWebFullScreen=function(){},FlashAdapter.prototype.setRightBarStatus=function(){},FlashAdapter.prototype.setExpandScreenStatus=function(){},FlashAdapter.prototype.showToast=function(){},FlashAdapter.prototype.refresh=function(){},FlashAdapter.prototype.backToStoryLine=function(){},FlashAdapter.prototype.backToIVMain=function(){},FlashAdapter}(Dispatcher),logger$1=new PlayerLogger("H5Adapter"),H5Adapter=(Wl=Dispatcher,__extends(Xl,Wl),Xl.prototype.fire=function(e){var t=e.type,a=e.data,r={type:t};a!==undefined&&(r.data=a),this.emit(t,r),this.__canRecordEvents&&(this.eventsRecorder[t]||(this.eventsRecorder[t]=[]),"playerStateChange"===t?this.eventsRecorder[t].push(r):this.eventsRecorder[t]=[r])},Xl.prototype.un=function(e,t){return this.off(e,t),this},Xl.prototype.loadSkin=function(e){QiyiPlayerLoader.loadSkin(e)},Xl.prototype.checkPack=function(e,t,a){var r=this;if(!this.disabled){var i=function(){if(a)a();else{if(r["package"][e])return r["package"][e](t);logger$1.info("checkPack error, method = "+e)}};if(this["package"])return i();this.once("createPack",i)}},Xl.prototype.addView=function(e){this.hasview||(this.hasview=!0,this.checkPack("addView",e))},Xl.prototype.load=function(e){this.checkPack("load",e)},Xl.prototype.stopRecordEvents=function(){var e=this;e.__canRecordEvents=!1,clearTimeout(e.__evtRecorderTimer),setTimeout(function(){e.eventsRecorder={}},1e4)},Xl.prototype.play=function(e){void 0===e&&(e={withUserGesture:!1}),this.checkPack("play",e)},Xl.prototype.resume=function(){this.checkPack("resume")},Xl.prototype.replay=function(){this.checkPack("replay")},Xl.prototype.pause=function(){this.checkPack("pause")},Xl.prototype.seek=function(e){this.checkPack("seek",e)},Xl.prototype.seekN=function(e){this.checkPack("seekN",e)},Xl.prototype.setPlayPingbackInfo=function(e){this.checkPack("setPlayPingbackInfo",e)},Xl.prototype.stop=function(){this.checkPack("stop")},Xl.prototype.isPaused=function(){return this.checkPack("isPaused")},Xl.prototype.getPlayInfo=function(e){this.checkPack("getPlayInfo",e)},Xl.prototype.getVideoInfo=function(e){this.checkPack("getVideoInfo",e)},Xl.prototype.getPlayerId=function(){return this._playerId},Xl.prototype.getMuted=function(){return this.checkPack("getMuted")},Xl.prototype.setMuted=function(e){this.checkPack("setMuted",e)},Xl.prototype.setQiyiUserLogin=function(e){this.checkPack("setQiyiUserLogin",e)},Xl.prototype.switchVideo=function(e){this.checkPack("switchVideo",e)},Xl.prototype.switchNextVideo=function(){this.checkPack("switchNextVideo")},Xl.prototype.switchPreVideo=function(){this.checkPack("switchPreVideo")},Xl.prototype.addVideoList=function(e){this.checkPack("addVideoList",e)},Xl.prototype.removeVideoList=function(e){this.checkPack("removeVideoList",e)},Xl.prototype.setSmallWindowMode=function(e){var t=this;this.isSmallWindow!==e&&(logger$1.info("js call func,params: type = setSmallWindowMode(设置小窗,1为小窗), data = "+e),this.isSmallWindow=e,this.checkPack("setSmallWindowMode",null,function(){t["package"].setSmallWindowMode&&t["package"].setSmallWindowMode(e)}))},Xl.prototype.jsNotifyAdManager=function(e){this.checkPack("jsNotifyAdManager",e)},Xl.prototype.getQiyiPlayerLog=function(e){try{e(PlayerLogger.getLog())}catch(t){}},Xl.prototype.clearBanWord=function(){this.checkPack("clearBanWord")},Xl.prototype.addBanWord=function(e){e!==undefined&&""!==e&&this.checkPack("addBanWord",e)},Xl.prototype.removeBanWord=function(e){this.checkPack("removeBanWord",e)},Xl.prototype.requestBarrageData=function(){},Xl.prototype.notyfyADInfo=function(e){this.checkPack("notyfyADInfo",e)},Xl.prototype.getQiyiPlayerInfo=function(e){this.checkPack("getQiyiPlayerInfo",e)},Xl.prototype.getQiyiPlayerType=function(e){var t="h5";return e&&"function"==typeof e&&e(t),t},Xl.prototype.setDelayPlayInfo=function(e){this.checkPack("setDelayPlayInfo",e)},Xl.prototype.clearDelayPlayInfo=function(e){this.checkPack("clearDelayPlayInfo",e)},Xl.prototype.setBarrageStatus=function(){},Xl.prototype.setSelfSendBarrageInfo=function(){},Xl.prototype.setBarrageSetting=function(){},Xl.prototype.setPlayerWebFullScreen=function(e){this.checkPack("setPlayerWebFullScreen",e)},Xl.prototype.setPlayerFullScreen=function(e){this.checkPack("setPlayerFullScreen",e)},Xl.prototype.getHasBarrageChannelConfigInfo=function(){},Xl.prototype.getHasBarrageConfigInfo=function(){},Xl.prototype.getHasBarrageGiftInfo=function(){},Xl.prototype.addPlayListView=function(e){this.checkPack("addPlayListView",e)},Xl.prototype.getSwitchVideoType=function(){return this.checkPack("getSwitchVideoType")},Xl.prototype.setRightBarStatus=function(e){this.checkPack("setRightBarStatus",e)},Xl.prototype.setExpandScreenStatus=function(e){this.checkPack("setExpandScreenStatus",e)},Xl.prototype.exitPicInPic=function(){this.checkPack("exitPicInPic")},Xl.prototype.showToast=function(e){this.checkPack("showToast",e)},Xl.prototype.refresh=function(e){this.checkPack("refresh",e)},Xl.prototype.backToStoryLine=function(e){this.checkPack("backToStoryLine",e)},Xl.prototype.backToIVMain=function(e){this.checkPack("backToIVMain",e)},Xl.prototype.setFollowData=function(e){this.checkPack("setFollowData",e)},Xl.prototype.changeFollowState=function(e){this.checkPack("changeFollowState",e)},Xl.prototype.changeAIBaikeState=function(e){this.checkPack("changeAIBaikeState",e)},Xl.prototype.setBarrageState=function(e){this.checkPack("setBarrageState",e)},Xl.prototype.getIsInMainVideo=function(){},Xl.prototype.setCyclePlay=function(){},Xl.prototype.getQiyiVideoInfo=function(){},Xl.prototype.setQiyiSubscribe=function(){},Xl.prototype.setLight=function(){},Xl.prototype.expand=function(){},Xl.prototype.setActivityNoticeInfo=function(){},Xl.prototype.zoomQiyiVideo=function(){},Xl.prototype.setTimeListener=function(){},Xl.prototype.getCommentConfigInfo=function(){},Xl.prototype.setSubscribeInfo=function(){},Xl.prototype.setSubscribeStateChange=function(){},Xl.prototype.setContinuePlayState=function(){},Xl.prototype.forceToSaveCurVideoInfo=function(){},Xl.prototype.getContinueData=function(){},Xl.prototype.setQiyiVisits=function(){},Xl.prototype.initQiyiVideo=function(){},Xl),Wl;function Xl(e,t){var a=Wl.call(this)||this;return(a._player=a)._playerId=e.parentId,a.disabled=!1,a.hasview=!1,a.type=CON_TYPE.PlayerType_Html5VOD,QiyiPlayerLoader.Package?a["package"]=new QiyiPlayerLoader.Package(e,a):(a["package"]=null,QiyiPlayerLoader.once("ready",function(){a["package"]=new QiyiPlayerLoader.Package(e,a),a.emit("createPack")})),a.__canRecordEvents=!0,a.eventsRecorder={},a.__evtRecorderTimer=setTimeout(function(){a.stopRecordEvents()},3e5),a.isSmallWindow=null,setTimeout(function(){logger$1.info("call js, fire event,params: type = playerLoadSuccess(播放器初始化完毕)"),a.fire({type:CON_TYPE.QYPLAYER_LOAD_SUCCESS,data:{playerId:e.parentId}}),logger$1.info("call js, fire event,params: type = barrageAllowed(H5暂时不支持弹幕), enable = false"),a.fire({type:CON_TYPE.QYPLAYER_BARRAGE_ALLOWED,data:{enable:!1}})},0),a.destroy=function(){a.checkPack("destroy",null,function(){logger$1.log("js call func,params: type = player destroy(销毁播放器)"),a["package"].destroy(),a.hasview=!1,a.disabled=!0,delete t.players[e.parentId],a.removeAllListeners(),a.fire({type:"destroy"})})},a}var onlineUrl={"wonder.data.pc":"//static.iqiyi.com/js/player_v2/wonder.data.pc.67fba959.js","wonder.http.mobile":"//static.iqiyi.com/js/player_v2/wonder.http.mobile.6959acff.js","skin.pc":"//static.iqiyi.com/js/player_v2/skin.pc.67fba959.js","skin.mobile":"//static.iqiyi.com/js/player_v2/skin.mobile.6959acff.js","p2p.abs":"//static.iqiyi.com/js/player_v2/565b19851417.js",FLASH_PLAYER_URL:"//www.iqiyi.com/player_v2/flashplayer/20200729/6af57dfc1027.swf",FLASH_PLAYER_ZURL:"//www.iqiyi.com/player_v2/flashplayer/20200729/906490701027.swf",FLASH_P2P_URL:"//www.iqiyi.com/common/flashplayer/20180620/14002a1b82aa.swf",FLASH_BARRAGE_URL:"//www.iqiyi.com/common/flashplayer/20180810/0949c72eeb6.swf",FLASH_PRELOADER_URL:"//www.iqiyi.com/common/flashplayer/20190719/23215aa9a57.swf",FLASH_PRELOADER_URL_TW:"//www.iqiyi.com/common/flashplayer/20180529/1508c9cdf8a4.swf",FLASH_PRELOADER_VIP:"//www.iqiyi.com/common/flashplayer/20190719/232184b0df09.swf",FLASH_PRELOADER_VIP_TW:"//www.iqiyi.com/common/flashplayer/20171129/1530df83b9a5.swf",FLASH_PRELOADER_PRODUCE:"//www.iqiyi.com/common/flashplayer/20190719/2321561520f8.swf",FLASH_PRELOADER_PRODUCE_TW:"//www.iqiyi.com/common/flashplayer/20180529/15085e1d0a85.swf",FLASH_PRELOADER_EXCLUSIVE:"//www.iqiyi.com/common/flashplayer/20190719/232121793893.swf",FLASH_PRELOADER_EXCLUSIVE_TW:"//www.iqiyi.com/common/flashplayer/20180529/1508dc809b19.swf",FLASH_PRELOADER_ICON:"//www.iqiyi.com/common/flashplayer/20171129/1530c314a0aa.swf",FLASH_PRELOADER_ICON_TW:"//www.iqiyi.com/common/flashplayer/20171129/15307da15813.swf",FLASH_PRELOADER_ICON_PRODUCE:"//www.iqiyi.com/common/flashplayer/20171129/1530925a82d4.swf",FLASH_PRELOADER_ICON_PRODUCE_TW:"//www.iqiyi.com/common/flashplayer/20171129/1530151837af.swf",FLASH_PRELOADER_ICON_EXCLUSIVE:"//www.iqiyi.com/common/flashplayer/20171129/153013651bd2.swf",FLASH_PRELOADER_ICON_EXCLUSIVE_TW:"//www.iqiyi.com/common/flashplayer/20171129/153077057f2.swf",FLASH_TIP_XML:"//static-s.iqiyi.com/ext/common/Tipdatavod_201809131013.xml","skin.pc.mini":"//static.iqiyi.com/js/player_v2/skin.pc.mini.67fba959.js"},CONST_adParamAttrName="data-widget-adparam",CONST_flashParamAttrName="data-widget-flashplayerparam",CONST_flashVarsAttrName="data-flashplayerparam-flashvars",CONST_h5Vars="data-h5playerparam-h5vars",CONST_PlayerParams,CONST_PlayerParamsKV,spans,ParamVars={},setInitVars=function(){spans=document.querySelectorAll?document.querySelectorAll("span"):document.getElementsByTagName("span"),CONST_PlayerParams=window.QiyiPlayerParam||[],CONST_PlayerParamsKV={};for(var e=0;e<CONST_PlayerParams.length;e++)CONST_PlayerParams[e].name&&(CONST_PlayerParamsKV[CONST_PlayerParams[e].name]=CONST_PlayerParams[e].attribute||{})},getVer=function(){var e="";try{e=navigator.plugins["Shockwave Flash"].description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(err){}}return"string"!=typeof e&&(e=""),(e||"0 r0").match(/\d+/g)},checkFlashLzma=function(){var e=getVer();return 2<e.length&&(12<=parseInt(e[0],10)||11===parseInt(e[0],10)&&4<=parseInt(e[1],10))},outsite=function(){var e=[],t;try{t=!window.parent.location.href}catch(a){for(0===e.length&&(t=!0);e.length;)if(-1===document.referrer.indexOf(e.pop())){t=!0;break}}return t+""}(),delItemInPlayerParams=function(e){(CONST_PlayerParamsKV[e]||CONST_PlayerParamsKV.hasOwnProperty(e))&&(CONST_PlayerParamsKV[e]=null,delete CONST_PlayerParamsKV[e]);for(var t=CONST_PlayerParams.length;t--;)CONST_PlayerParams[t].name===e&&CONST_PlayerParams.splice(t,1)},safely=function(e){return e.replace(/([<>])/g,"")},delParamEmptyProps=function(e){for(var t in e)e[t]||!1===e[t]||delete e[t];return e},getElemWrapperParams=function(t){var e,a,r,i=function(e){return t.getAttribute(e)},o={expandState:i("data-player-expandstate"),albumId:i("data-player-albumid"),tvid:i("data-player-tvid"),vid:i("data-player-videoid"),autoplay:i("data-player-autoplay"),isMember:i("data-player-ismember"),cyclePlay:i("data-player-cycleplay"),exclusive:i("data-player-exclusive"),qiyiProduced:i("data-player-qiyiProduced"),share_sTime:i("data-player-startTime"),share_eTime:i("data-player-endTime"),showBarStyle:i("data-player-barStyle"),isLoop:i("data-player-isloop")};for(e=0;e<spans.length;e++)if((a=(r=spans[e]).getAttribute(CONST_adParamAttrName))===CONST_adParamAttrName){var n=r.getAttribute("data-adparam-cupid"),s=r.getAttribute("data-adparam-playerid");n&&(o.adurl=n),s&&(o.cid=s)}return delParamEmptyProps(o)},getElemAdParams=function(){var e,t,a,r={};for(e=0;e<spans.length;e++)if((t=(a=spans[e]).getAttribute(CONST_adParamAttrName))===CONST_adParamAttrName){var i=a.getAttribute("data-adparam-cupid"),o=a.getAttribute("data-adparam-playerid");i&&(r.adurl=i),o&&(r.cid=o)}return delParamEmptyProps(r)},getElemPublicParams=function(){var e,t,a,r,i,o,n=!1,s={};for(i=0;i<CONST_PlayerParams.length;i++)"public"===CONST_PlayerParams[i].name&&(mixin(s,delParamEmptyProps(CONST_PlayerParams[i].attribute||{}),!0),delItemInPlayerParams("public"),n=!0);if(!n)for(e=0;e<spans.length;e++)t=(o=spans[e]).getAttribute(CONST_flashParamAttrName),a=o.getAttribute(CONST_flashVarsAttrName),r=o.getAttribute(CONST_h5Vars),"public"===t&&(a&&mixin(s,delParamEmptyProps(urlkit.query2Json(a)),!0),r&&mixin(s,delParamEmptyProps(urlkit.query2Json(r)),!0));return delParamEmptyProps(s)},getJSConfigParams=function(e){var t={playerUrl:checkFlashLzma()&&onlineUrl.FLASH_PLAYER_ZURL?onlineUrl.FLASH_PLAYER_ZURL:onlineUrl.FLASH_PLAYER_URL,flashP2PCoreUrl:onlineUrl.FLASH_P2P_URL,barrageurl:onlineUrl.FLASH_BARRAGE_URL,preloader:onlineUrl.FLASH_PRELOADER_URL,preloaderTw:onlineUrl.FLASH_PRELOADER_URL_TW,qiyiProducedPreloader:onlineUrl.FLASH_PRELOADER_PRODUCE,qiyiProducedPreloaderTw:onlineUrl.FLASH_PRELOADER_PRODUCE_TW,exclusivePreloader:onlineUrl.FLASH_PRELOADER_EXCLUSIVE,exclusivePreloaderTw:onlineUrl.FLASH_PRELOADER_EXCLUSIVE_TW,vipPreloader:onlineUrl.FLASH_PRELOADER_VIP,vipPreloaderTw:onlineUrl.FLASH_PRELOADER_VIP_TW,iconPreloader:onlineUrl.FLASH_PRELOADER_ICON,iconPreloaderTw:onlineUrl.FLASH_PRELOADER_ICON_TW,iconProducedPreloader:onlineUrl.FLASH_PRELOADER_ICON_PRODUCE,iconProducedPreloaderTw:onlineUrl.FLASH_PRELOADER_ICON_PRODUCE_TW,iconExclusivePreloader:onlineUrl.FLASH_PRELOADER_ICON_EXCLUSIVE,iconExclusivePreloaderTw:onlineUrl.FLASH_PRELOADER_ICON_EXCLUSIVE_TW,tipdataurl:onlineUrl.FLASH_TIP_XML};return delParamEmptyProps(t)},getElemCustomParams=function(){var e,t,a,r,i,o={};for(e=0;e<spans.length;e++)t=(i=spans[e]).getAttribute(CONST_flashParamAttrName),a=i.getAttribute(CONST_flashVarsAttrName),r=i.getAttribute(CONST_h5Vars),t&&"public"!==t&&(CONST_PlayerParamsKV[t]?(mixin(o,delParamEmptyProps(CONST_PlayerParamsKV[t]),!0),delItemInPlayerParams(t)):(a&&mixin(o,delParamEmptyProps(urlkit.query2Json(a)),!0),r&&mixin(o,delParamEmptyProps(urlkit.query2Json(r)),!0)));if(0<CONST_PlayerParams.length)for(e=0;e<CONST_PlayerParams.length;e++)CONST_PlayerParams[e]&&CONST_PlayerParams[e].name&&mixin(o,delParamEmptyProps(CONST_PlayerParams[e].attribute||{}),!0);return delParamEmptyProps(o)},getElemWrapperFlashVarsParams=function(t){var e={},a,r=function(e){return t.getAttribute(e)}("data-player-flashvars");return r=r?urlkit.query2Json(r):{},mixin(e,delParamEmptyProps(r),!0),delParamEmptyProps(e)},getURLParams=function(){var e={},t=function(e){var t=urlkit.query2Json(e),a=t.flashVars;a=a?urlkit.query2Json(safely(decodeURIComponent(a))):{};var r=t.share_sTime||t.s,i=t.share_eTime||t.e,o=r&&r.match(/(\d*)-.*?=(\d*)/);o&&(r=o[1],i=o[2]);var n={autoplay:t.autoplay,vid:t.videoid||t.vid,tvid:t.tvid||t.tvId,albumId:t.albumid,cyclePlay:t.cycleplay,isMember:t.ismember,exclusive:t.exclusive,qiyiProduced:t.qiyiProduced,share_sTime:r,share_eTime:i,outsite:t.outsite,cid:t.cid,ptid:t.ptid,isCid:t.isCid,vfrm:t.vfrm,isMute:t.isMute,showBarStyle:t.barStyle,local:t.local,components:t.components,isLoop:t.isLoop,masflag:t.masflag,isExpandScreen:t.isExpandScreen,isSupportedShot:t.isSupportedShot,isSmallWindowMode:t.isSmallWindowMode,isSupportedHotKey:t.isSupportedHotKey,ps3:t.ps3,abtest:t.abtest};return mixin(a,delParamEmptyProps(n),!0),a},a=t(safely(window.location.search.replace(/([<>])/g,""))),r=t(safely(window.location.hash.slice(1).replace(/([<>])/g,"")));for(var i in mixin(e,delParamEmptyProps(a),!0),mixin(e,delParamEmptyProps(r),!0),e)e[i]||!1===e[i]||delete e[i];return delParamEmptyProps(e)},playerParams={mix:function(e,t){setInitVars();var a=window.__qlt,r="";a&&a.brs&&(r=a.brs||"");var i=e.tmplt||0,o={outsite:outsite,site:"iqiyiw",components:"feffffe6e",local:"cn_s",ost:"0",browserType:r,pageTmpltType:i};mixin(o,getElemWrapperParams(t),!0),mixin(o,getElemAdParams(),!0),mixin(o,getElemPublicParams(),!0),mixin(o,getJSConfigParams(e),!0),mixin(o,getElemCustomParams(),!0),mixin(o,getElemWrapperFlashVarsParams(t),!0),mixin(o,e,!0),mixin(o,getURLParams(),!0);var n={abtest:storage$1.read("abtest")};for(var s in n.abtest&&storage$1.remove("abtest"),mixin(o,n,!0),(platform$1.os.ios||platform$1.os.android)&&(o.autoplay=!1),o)"string"==typeof o[s]&&(o[s]=o[s].replace(/^http:/gi,""));return ParamVars=o},getVars:function(){return ParamVars}},_uuidTick=0,_newuser=!1,_veid="",_webEventId=window.webEventID||"",_removeWeid=function(){_webEventId=window.webEventID||""},_genUuid=function(){return md5(window.navigator.userAgent+document.cookie+Math.random()+(new Date).getTime()*_uuidTick++)},saveCookie=function(e,t,a){cookie.set(e,t,{expires:a||31536e6,path:"/",domain:"iqiyi.com"})},_getJsuid=function(){var e="QC006",t=cookie.get(e);return t||(_newuser=!0,t=_genUuid(),saveCookie(e,t)),t},_getFluid=function(){return _checkJSUid()},_checkJSUid=function(){var e="QC005",t=cookie.get(e),a=storage$1.read(e),r=t||a;return r?a?t||saveCookie(e,r,283824e7):storage$1.write(e,r):(_newuser=!0,r=_genUuid(),saveCookie(e,r,283824e7),storage$1.write(e,r)),r},UUID={createUUID:function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1).toUpperCase()}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getQtsid:function(){var e,t=/^\d{10}\.\d{10}\.\d{10}\.\d+$/,a=function(){return parseInt(new Date/1e3,10).toString()};if(e=cookie.get("QC008"),cookie.get("QC010")&&e)return e;if(t.test(e))(e=e.split("."))[1]=e[2],e[2]=a(),e[3]=parseInt(e[3],10)+1;else{var r=a();e=[r,r,r,"1"]}return e.join("."),e},getJsuid:_getJsuid,getFluid:_getFluid,getWeid:function(){return _webEventId=_webEventId||(window.webEventID||md5(_getJsuid()+"weid"+ +new Date))},getEid:function(){var e="";return _veid||(e=_getJsuid(),_veid=md5(e+"veid"+1*new Date)),_veid},getIsNewUser:function(){return _newuser},init:function(){try{window.addEventListener("unload",_removeWeid),window.addEventListener("beforeunload",_removeWeid),window.addEventListener("pagehide",_removeWeid)}catch(e){}}},protocol=window.location.protocol,opendataURL=protocol+"//msg.qy.net/v5/bi/opendata",PF_CODE_PCW="1",PF_CODE_MOBILE="2",P_CODE_PCW="10",P_CODE_MOBILE="20",P1_CODE_PCW="101",P1_CODE_PHW="201",P1_CODE_TBW="202",pf=PF_CODE_PCW,p=P_CODE_PCW,p1=P1_CODE_PCW;platform$1.browser.iPad?(pf=PF_CODE_MOBILE,p=P_CODE_MOBILE,p1=P1_CODE_TBW):(platform$1.os.ios||platform$1.os.android)&&(pf=PF_CODE_MOBILE,p=P_CODE_MOBILE,p1=P1_CODE_PHW);var p_code=pf+"_"+p+"_"+p1,os_type="";platform$1.os.ios||platform$1.os.mac?os_type=2:platform$1.os.android&&(os_type=1);var _send=function(e){var t;mixin(t={p1:p_code,flashuid:UUID.getFluid()||"",v:e.playerVersion,pkg:"",sid:UUID.getWeid(),sttime:"",os_t:os_type,os_v:navigator.platform||"",ua_model:"",brand:"",lang:navigator.language||navigator.browserLanguage,resolution:window.screen.width+"*"+window.screen.height,network:"",cell_id:"",gps_lon:"",gps_lat:"",ipv4:"",tvid:e.tvid||"",aid:e.albumId||"",cid:e.cid||"",pid:UUID.getEid(),duration:e.duration||"",rn:+new Date,rfr:window.document.referrer,url:window.location.href,br:platform$1.browser.userAgent,ce:UUID.getWeid(),c2:""},e,!0),http.beacon(t,opendataURL)},ThreePingback=(Jo.prototype.sendStartPlayPingback=function(e){e.type=3,e.sttime=Math.round((new Date).getTime()/1e3),_send(e)},Jo.prototype.sendEndPlayPingback=function(e){e.type=4,e.sttime=Math.round((new Date).getTime()/1e3),_send(e)},Jo);function Jo(){}var ThreePingback$1=new ThreePingback,logger$2=new PlayerLogger("PlayerManager"),_playersReadyCalls={},PlayerManager=(Mo.prototype.createPlayer=function(e){var a=this,t=document.getElementById(e.parentId),r=(e=playerParams.mix(e,t)).tvid,i=e.vid,o=e.usevr;o=1==o||"true"==o,r=r||"",i=i||"fake123456";var n=this.players[e.parentId];if(!e.hasOwnProperty("parentId"))return null;if(null!=n)return null;e.width&&e.height&&(t.style.width=parseInt(e.width,10)+"px",t.style.height=parseInt(e.height,10)+"px");var s=getPlayerType(e.playerType,o);switch(e.plyct=+new Date,logger$2.log("<APP>播放器类型: 点播 - "+s+", v: "+PlayerVersion+", location: "+window.location.href+", env: "+navigator.userAgent.toLowerCase()),logger$2.log("initialize parameter, "+PlayerLogger.stringify(e)),e.cssRendered=this.cssRendered,this.cssRendered||(this.cssRendered=!0),s){case CON_TYPE.PlayerType_Html5VOD:n=new H5Adapter(e,this);break;case CON_TYPE.PlayerType_FlashVOD:n=new FlashAdapter(e,isSupportHtml5(o),this)}(this.players[e.parentId]=n).on(CON_TYPE.QYPLAYER_LOAD_SUCCESS,function(e){n.__loadsuccess=!0;var t=e.data.playerId;a.flushPlayerReadyCalls(t)});var l="";return n.on(CON_TYPE.QYPLAYER_STATE_CHANGE,function(e){var t=e.data.state.toLocaleLowerCase(),a={};switch(a.tvid=e.data.tvid||"",a.albumId=e.data.albumId||"",a.cid=e.data.cid||"",a.playerVersion=e.data.playerVersion||"",t){case CON_TYPE.QYPLAYER_STATUS_END_PLAY:var r=e.data.tvid,i=void 0;e.data.spend?(i=e.data.spend,a.duration=e.data.spend):i=e.data.prePlayingDuration,ThreePingback$1.sendEndPlayPingback(a);break;case CON_TYPE.QYPLAYER_STATUS_START_PLAY:case CON_TYPE.QYPLAYER_STATUS_AD_START_PLAY:var o=e.data.tvid;o!==l&&(ThreePingback$1.sendStartPlayPingback(a),l=o);break;case CON_TYPE.QYPLAYER_STATUS_ERROR:}}),n.on(CON_TYPE.QYPLAYER_STATUS_DATA_READY,function(e){}),n.on(CON_TYPE.QYPLAYER_VID_CHANGE,function(e){var t,a,r={};e.data.preMovieInfo?(t=e.data.preMovieInfo.tvid,a=e.data.preMovieInfo.spend,r.albumId=e.data.preMovieInfo.albumId||"",r.cid=e.data.preMovieInfo.cid||""):(t=e.data.preTvid,a=e.data.prePlayingDuration),r.playerVersion=e.data.playerVersion||"",r.tvid=t||"",r.duration=a||"",ThreePingback$1.sendEndPlayPingback(r)}),n},Mo.prototype.getPlayerById=function(e){return this.players[e]},Mo.prototype.destroyPlayer=function(e){this.players[e].destroy()},Mo.prototype.addView=function(e){if(this.subViewDef=this.subViewDef||e,this.subViewDef)for(var t in this.players)this.players[t].addView(this.subViewDef)},Mo.prototype.ready=function(e,t){var a=this.getPlayerById(e),r=_playersReadyCalls[e]||[];(_playersReadyCalls[e]=r).push(t),a&&a.__loadsuccess&&this.flushPlayerReadyCalls(e)},Mo.prototype.flushPlayerReadyCalls=function(e){var t=_playersReadyCalls[e]||[];_playersReadyCalls[e]=[];for(var a=0;a<t.length;a++)!function(e,t){setTimeout(function(){e[t].call()},0)}(t,a)},Mo);function Mo(){this.players={},this.cssRendered=!1,this.subViewDef=!1,this.constantType=CON_TYPE,this.version=PlayerVersion}var grayConfig={id:"",channelIds:[],index:"",eq:"",st:"",ed:"",url:{}};function seriesLoadScripts(t,a){"object"!=typeof t&&(t=[t]);var r=document.getElementsByTagName("head").item(0)||document.documentElement,i=[],o=t.length-1,n=function(e){i[e]=document.createElement("script"),i[e].setAttribute("type","text/javascript"),i[e].onload=i[e].onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),e!=o?n(e+1):"function"==typeof a&&a(!0))},i[e].onerror=i[e].onstalled=function(){"function"==typeof a&&a(!1)},i[e].setAttribute("src",t[e]),r.appendChild(i[e])};n(0)}var adurl="//static.iqiyi.com/js/common/ares-mobile-h5.min.js",PackLoader=(Bp.prototype.matchGray=function(e){var t=grayConfig||{};if(t.id){var a=cookie.get("QC005"),r=!1;return""!==t.index&&(a=parseInt(a.substr(t.index,1),16),""!==t.eq?r=a==t.eq:""!==t.st&&""!==t.ed&&(r=a>=t.st&&a<=t.ed)),-1<t.channelIds.indexOf(e)||r}return!1},Bp.prototype.loadPackage=function(){var e=this,t="data",a="pc";(platform$1.os.ios||platform$1.os.android)&&(t="http",a="mobile");var r="wonder."+t+"."+a,i=this.configUrl[r];this.globalEntry.packageName=r,setTimeout(function(){e.globalEntry.isSyncing=!1,e.globalEntry.Package||(e.logger.log("package loading: ("+r+")"),seriesLoadScripts(i,function(){e.logger.log("package loaded: ("+r+")")}))},0)},Bp.prototype.loadP2P=function(e){var r=this;"boolean"==typeof this.p2pcb.loaded?e():("function"==typeof e&&this.p2pcb.push(e),this.p2pcb.loading||(this.p2pcb.loading=!0,seriesLoadScripts(this.configUrl["p2p.abs"],function(e){for(r.p2pcb.loading=!1,r.p2pcb.loaded=e;0<r.p2pcb.length;)try{var t;r.p2pcb.shift()()}catch(a){}})))},Bp.prototype.loadSkin=function(e){var t="pc";(platform$1.os.ios||platform$1.os.android)&&(t="mobile");var a="";e&&e.isMini&&"pc"===t&&(a=".mini"),seriesLoadScripts(this.configUrl["skin."+t+a])},Bp.prototype.loadAD=function(e){var r=this;"boolean"==typeof this.adcb.loaded?e():("function"==typeof e&&this.adcb.push(e),this.adcb.loading||(this.adcb.loading=!0,seriesLoadScripts(adurl,function(e){for(r.adcb.loading=!1,r.adcb.loaded=e;0<r.adcb.length;)try{var t;r.adcb.shift()()}catch(a){}})))},Bp);function Bp(e,t){if(this.logger=new PlayerLogger("PackLoader"),this.globalEntry=e,this.configUrl=onlineUrl,this.usedGrayUrl={},this.p2pcb=[],this.adcb=[],this.matchGray(t)){var a=grayConfig.url;for(var r in a)this.configUrl[r]=a[r],this.usedGrayUrl[r]=!0}isSupportHtml5()&&this.loadPackage()}var logger$3=new PlayerLogger("QiyiLoader");Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length,a=+arguments[1]||0;if(0===t||isNaN(a)||t<=a)return-1;for(a<0&&(a=t+a)<0&&(a=0);a<t;++a)if(this[a]===e)return a;return-1});var PlayerLoader=(fq=Dispatcher,__extends(gq,fq),gq.prototype.ready=function(e){"function"==typeof e&&(this.isActived=!0,e(this.manager),this._checkEnv())},gq.prototype._checkEnv=function(){if(!this._testEnvChecked){this._testEnvChecked=!0;var e="production",t=cookie.get("setting")||"",a=window.location.protocol;logger$3.log("check env, "+e+"-"+t+"-"+a)}},gq.prototype.logger=function(){return PlayerLogger},gq.prototype.setPackage=function(e){this.Package=e,this.emit("ready")},gq.prototype.addView=function(e){this.manager.addView(e)},gq.prototype.loadSkin=function(e){this.skinLoad?this.manager.addView():(this.skinLoad=!0,this.packLoader.loadSkin(e))},gq.prototype.loadAd=function(e){this.packLoader.loadAD(e)},gq),fq;function gq(){var e=fq.call(this)||this,t=0;window.__qlt&&"number"==typeof window.__qlt.statisticsStart&&(t=window.__qlt.statisticsStart),logger$3.log("player v2 sdk init,player-"+PlayerVersion+", page benchmark@"+t+"!");var a,r=(window.uniqy||{}).curVideoInfo||{};return e.Package=null,e.packLoader=new PackLoader(e,r.channelId),e.renderd=!1,e.manager=new PlayerManager,e.isSyncing=!0,e}var QiyiPlayerLoader=new PlayerLoader;return QiyiPlayerLoader});
/*! Built by pcw player group @2020-9-25 14:21:39 */!function(e){function t(t){for(var i,n,r=t[0],s=t[1],o=0,u=[];o<r.length;o++)n=r[o],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(d&&d(t);u.length;)u.shift()()}var i={},a={7:0};function n(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(e){var t=[],i=a[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,n){i=a[e]=[t,n]}));t.push(i[2]=r);var s,o=document.createElement("script");o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.src=function(e){return n.p+""+({0:"jszip",1:"pako_deflate",2:"qvs.mat.stream",5:"vendors~crypto",6:"vendors~jszip"}[e]||e)+".67fba959.js"}(e);var d=new Error;s=function(t){o.onerror=o.onload=null,clearTimeout(u);var i=a[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",d.name="ChunkLoadError",d.type=n,d.request=r,i[1](d)}a[e]=undefined}};var u=setTimeout((function(){s({type:"timeout",target:o})}),12e4);o.onerror=o.onload=s,document.head.appendChild(o)}return Promise.all(t)},n.m=e,n.c=i,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="//static.iqiyi.com/js/player_v2/",n.oe=function(e){throw console.error(e),e};var r=window.iqiyiPlayerJSONPCallback=window.iqiyiPlayerJSONPCallback||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var o=0;o<r.length;o++)t(r[o]);var d=s;n(n.s=441)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),e}},function(e,t,i){"use strict";t.a={Status_Idle:"idle",Status_Ready:"ready",Status_Loadstart:"loadstart",Status_Loaddone:"loaddone",Status_LoadedMetaData:"loadedmetadata",Status_StartPlay:"startplay",Status_EveryStartPlay:"everystartplay",Status_Waiting:"waiting",Status_Paused:"paused",Status_Play:"play",Status_Playing:"playing",Status_Stoped:"stoped",Status_End_Play:"endplay",Status_PlayError:"error",Status_PatchStartplay:"patchstartplay",Status_MiddStoped:"middstoped",Status_AdLoaded:"adloaded",Status_AdInit:"adinit",Status_AdLoadstart:"adloadstart",Status_AdStartPlay:"adstartplay",Status_ADEveryStartPlay:"adeverystartplay",Status_AdPlaying:"adplaying",Status_AdPaused:"adpaused",Status_AdWillPlayEnded:"adwillended",Status_AdPlayEnded:"adended",Status_AdError:"aderror",Status_AdStalled:"adstalled",Status_AdWaiting:"adwaiting",Status_AresPlay:"aresplay",Status_AresEnded:"aresended",Status_AresNoticeInfo:"aresnoticeinfo",Status_ADLoadedMetaData:"adloadedmetadata",Status_Error:"ntferror",Status_Destroy:"ntfdestroy",NTF_StatusChanged:"statusChanged",NTF_Error:"engineError",NTF_VideoRefresh:"videorefresh",NTF_VideoChange:"videochange",NTF_VideoChanged:"videochanged",NTF_CanPlayThrough:"canplaythrough",NTF_VolumeChanged:"volumechanged",NTF_RateChanged:"ratechange",NTF_KeyVolumeChange:"keyvolumechange",NTF_DurationChanged:"durationchange",NTF_VRSStart:"vrsstart",NTF_VRSReady:"vrsready",NTF_VRSDone:"vrsdone",NTF_VRSPreloaded:"vrspreloaded",NTF_VDChangeFail:"ntfvdchangefail",NTF_AUDChanged:"ntfaudchange",NTF_AUDChangeFail:"ntfaudchangefail",NTF_ARES_Info:"ntfaresinfo",NTF_DefinitionSwitching:"definitionswitch",NTF_DefinitionSwitched:"definitionswitched",NTF_AudioSwitching:"aduioswitching",NTF_AudioSwitched:"aduioswitched",NTF_TimeUpdate:"timeupdate",NTF_Progress:"progress",NTF_Before_Seeking:"beforeSeeking",NTF_Seeking:"seeking",NTF_Seeked:"seeked",NTF_Recharge:"recharge",NTF_BuyPlay:"buyPlay",NTF_SkipHook:"skiphook",NTF_FollowUpNextLoad:"followUpNextLoad",NTF_NeedUserGesture4Playback:"needUserGesture4Playback",NTF_MutedStartPlay:"mutedStartPlay",NTF_PlayingFailByAutoPlay:"playingFailByAutoPlay",NTF_DelayToPlay:"delaytoplay",NTF_DelayToPlay_End:"delaytoplayend",NTF_Get_Record:"getrecord",NTF_AD_Showtips:"adshowtips",NTF_PLAY_MUTED:"playfailmuted",NTF_FPS_REPORT:"playFPSReport",NTF_IVPACKAGEPARSE_Failed:"IVPackageParse_Failed",NTF_IVPACKAGEPARSE_Finished:"IVPackageParse_Finished",NTF_AD_CanPlayThrough:"adcanplaythrough",NTF_AD_VolumeChanged:"advolumechanged",NTF_AD_DurationChanged:"addurationchange",NTF_AD_TimeUpdate:"adtimeupdate",NTF_AD_Progress:"adprogress",NTF_AD_Seeking:"adseeking",NTF_AD_Seeked:"adseeked",NTF_AD_NotifyManager:"jsNotifyAdManager",NTF_AD_Start:"jsNotifyAdStart",NTF_AD_End:"jsNotifyAdEnd",NTF_AD_CloudPlay:"adcloudplay",NTF_AD_CloudPlayEnd:"adcloudplayend",NTF_AD_BLOCK:"adblock",NTF_ARES_Load:"aresload",NTF_Show_VIPPay:"showVIPPay",Evt_StartFromHistory:"playStartFromHistory",Evt_SkipHeader:"playSkipHeader",Evt_SkipTailer:"playSkipTailer",Evt_StartShareTime:"playShareTime",Evt_PreloadAD:"playPreloadAD",ERROR_HttpFailed:"P00001",ERROR_AnalyzFailed:"P00002",Enjoy_Evt_PlayEnd:"enjoy_play_end",Enjoy_Evt_PanleShow:"enjoy_panle_show",HTTP_ENGINE:"HTTP",QVS_ENGINE:"QVS",CDN_LOADERMODE:"CDN",P2P_LOADERMODE:"P2P"}},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(t)}e.exports=i},function(e,t,i){var a=i(42),n=i(32);e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?n(e):t}},function(e,t,i){var a=i(225);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},function(e,t,i){"use strict";i(23),i(73),i(94);var a=i(153),n=i.n(a),r=i(0),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(1),h=i.n(l),_=i(5),f=i.n(_),p="undefined"==typeof window?self:window,g=i(80);i.d(t,"c",(function(){return k})),i.d(t,"b",(function(){return T}));var m=p.console,v="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof importScripts,b=">>>",y=new(function(e){function t(){var e;return s()(this,t),(e=d()(this,c()(t).call(this)))._enable=!1,e}return f()(t,e),h()(t,[{key:"enable",get:function(){return this._enable},set:function(e){this._enable=e,this.MSG_NAME="__log__"}}]),h()(t,[{key:"log",value:function(){var e;v?y.emit(this.MSG_NAME,"log",Array.prototype.slice.call(arguments).join("")):this._enable&&(e=m.log).call.apply(e,[m,b].concat(Array.prototype.slice.call(arguments)))}},{key:"debug",value:function(){var e;v?y.emit(this.MSG_NAME,"debug",Array.prototype.slice.call(arguments).join("")):this._enable&&m.debug&&(e=m.debug).call.apply(e,[m,b].concat(Array.prototype.slice.call(arguments)))}},{key:"assert",value:function(){if(this._enable&&m.assert){var e,t=arguments[0],i=Array.prototype.slice.call(arguments,1);i.unshift(b),(e=m.assert).call.apply(e,[m,t].concat(n()(i)))}}},{key:"warn",value:function(){var e;v?y.emit(this.MSG_NAME,"warn",Array.prototype.slice.call(arguments).join("")):this._enable&&(e=m.warn).call.apply(e,[m,b].concat(Array.prototype.slice.call(arguments)))}},{key:"error",value:function(){var e;v?y.emit(this.MSG_NAME,"error",Array.prototype.slice.call(arguments).join("")):this._enable&&(e=m.error).call.apply(e,[m,b].concat(Array.prototype.slice.call(arguments)))}}]),t}(g.a));function k(e){m=e}function T(){return y}t.a=y},function(e,t,i){"use strict";var a=0,n="ntf_";t.a={NTF_PLG_Enable:n+a++,NTF_PLG_Disable:n+a++,NTF_HOTKEY_ControlbarShow:n+a++,NTF_Play:n+a++,NTF_Pause:n+a++,NTF_Replay:n+a++,NTF_ChangeVolume:n+a++,NTF_PlayerSmallWindowStatus:n+a++,NTF_AllPluginsLoaded:n+a++,NTF_ControlbarShow:n+a++,NTF_ControlbarHide:n+a++,NTF_DefinitionBtnClick:n+a++,NTF_DefinitionBtnMouseEnter:n+a++,NTF_DefinitionBtnMouseLeave:n+a++,NTF_DefinitionListShow:n+a++,NTF_DefinitionListhide:n+a++,NTF_DefinitionADShow:n+a++,NTF_DefinitionADClick:n+a++,NTF_DefinitionUpdateText:n+a++,NTF_FullScreen:n+a++,NTF_WebFullScreen:n+a++,NTF_SetDownLoad:n+a++,NTF_BarrageSelfSend:n+a++,NTF_BarrageSettingChange:n+a++,NTF_HIDE_BOTTOM_TOP:n+a++,NTF_SHOW_BOTTOM_TOP:n+a++,NTF_BOTTOM_MUTUAL_EXCLUSION:n+a++,NTF_SHOW_VIDEOLIST:n+a++,NTF_HIDE_VIDEOLIST:n+a++,NTF_VIDEOLIST_CHANGED:n+a++,NTF_HIDE_TOPBAR:n+a++,NTF_SHOW_TOPBAR:n+a++,NTF_CLICK_PLAYLIST_BTN:n+a++,NTF_SHOW_PLAYLIST_BTN:n+a++,NTF_HIDE_PLAYLIST_BTN:n+a++,NTF_SHOW_CONTROLBAR_PINGBACK:n+a++,NTF_SEEKBAR_HOVER:n+a++,NTF_SHOW_HEATMAP:n+a++,NTF_HIDE_CONTROLBAR_VIDEOTIP:n+a++,NTF_SHOW_TOAST:n+a++,NTF_SHOW_SETTING_BOX:n+a++,NTF_SUBTITLES_REGISTER_DOM:n+a++,NTF_USERSET_SKIP_BTN:n+a++,NTF_PROGRESS_SKIP_BTN:n+a++,NTF_KeyVolumeChange:n+a++,NTF_SHOW_LOGIN_PANEL:n+a++,NTF_SHOW_RECOMMEND_PANEL:n+a++,NTF_HIDE_RECOMMEND_PANEL:n+a++,NTF_VideoListChanged:"videolistchanged",NTF_ADDVideoList:"addvideolist",NTF_REMOVEVideoList:"removevideolist",NTF_ClientInstallChecked:"clientinstallchecked",NTF_IV_SWITCH_FromStoryLine:"ivswitchfromstoryline",NTF_IV_REPLAY:"ivreplay",NTF_IV_PLAYEND:"ivplayend",NTF_IV_INTERACTIONSTART:"ivinteractionstart",NTF_IV_INTERACTIONEND:"ivinteractionend",NTF_IV_SHOWSTROYGUIDE:"ivshowstoryguide",NTF_IV_SHOWSTROYLIST:"ivshowstorylinelist",NTF_BACKTO_IVMAIN:"ivbacktomain",NTF_FOLLOW_SET_INFO:"followsetinfo",NTF_FOLLOW_CHANGE_STATE:"followchangestate",NTF_GESTURE_ASYNC_CONTROLS:n+a++,NTF_USER_SEEK:n+a++,NTF_BanTipHide:n+a++,NTF_WebFullScreen_BeforeChange:n+a++,NTF_WebFullScreen_AfterChange:n+a++,NTF_WebFullScreen_SetSwitch:n+a++,NTF_FullScreen_BeforeChange:n+a++,NTF_FullScreen_AfterChange:n+a++,NTF_ScoreTask_ScoreChange:n+a++,NTF_FullScreen_SetSwitch:n+a++,NTF_VideoPercent_Changed:n+a++,NTF_RIGHTBAR_STATUS_CHANGED:n+a++,NTF_EXPANDSCREEN_STATUS_CHANGED:n+a++,NTF_Barrage_SetConfigInfo:n+a++,NTF_Barrage_SetChannelConfigInfo:n+a++,NTF_Barrage_SetSwitch:n+a++,NTF_Barrage_ShowLike:n+a++,NTF_Barrage_ShowMoreLike:n+a++,NTF_Barrage_ShowReport:n+a++,NTF_Barrage_EnsureReport:n+a++,NTF_Barrage_ShowRulePage:n+a++,NTF_Barrage_NotifyBarrageData:n+a++,NTF_Barrage_ClearBanWord:n+a++,NTF_Barrage_AddBanWord:n+a++,NTF_Barrage_RemoveBanWord:n+a++,NTF_Barrage_CatchSystemBarrage:n+a++,NTF_Barrage_NotifyGiftInfo:n+a++,NTF_Barrage_ShowSystemBarrage:n+a++,NTF_Barrage_ClickSystemBarrage:n+a++,NTF_Barrage_ClickSystemBarrageButton:n+a++,NTF_Barrage_RequestBarrageData:n+a++,NTF_Subtitles_Changing:n+a++,NTF_Subtitles_Changed:n+a++,NTF_Subtitles_ChangeFailed:n+a++,NTF_FeedBack_Show:n+a++,NTF_FeedBack_Hide:n+a++,NTF_TO_DIVERSION:n+a++,NTF_AIView_ItemClick:n+a++,NTF_AIView_CLOSE:n+a++,NTF_AIView_BAIKE_CLOSE:n+a++,NTF_AIView_BAIKE_STATECHANGE:n+a++,NTF_IVOS_DATA_COMPLETE:n+a++,NTF_IVOS_REQUEST_IN:n+a++,NTF_IVOS_PREVIEW_CLOSE:n+a++,NTF_IVOS_PREVIEW_STARTPLAY:n+a++,NTF_IVOS_STATE_CHANGED:n+a++,NTF_SVP_POINTSREFRESH:n+a++,NTF_Voice_Change:n+a++,NTF_CTXMenu_Copied:n+a++,NTF_Hotkey_Percent_Seek:n+a++,NTF_Hotkey_Playback_Rate:n+a++,MINI_NTF_PLAY_END:n+a++,MINI_NTF_POSTER_SHOW:n+a++,MINI_NTF_POSTER_HIDE:n+a++,Type_Play:"play",Type_Pause:"pause",Type_Replay:"replay",Type_ExitPic:"exitpicinpic"}},function(e,t,i){"use strict";i(12),i(18);var a=null;function n(){var e=new Date;return(e.getHours()>=10?e.getHours():"0"+e.getHours())+":"+(e.getMinutes()>=10?e.getMinutes().toString():"0"+e.getMinutes())+":"+(e.getSeconds()>=10?e.getSeconds().toString():"0"+e.getSeconds())}t.a=Object.defineProperties({debug:function(e){a?a.debug("__PB__ "+e):console.log("__PB__"+n()+"__ "+e)},log:function(e){a?a.log("__PB__ "+e):console.log("__PB__"+n()+"__ "+e)},info:function(e){a?a.info("__PB__ "+e):console.log("__PB__"+n()+"__ "+e)},warn:function(e){a?a.warn("__PB__ "+e):console.log("__PB__"+n()+"__ "+e)},error:function(e){a?a.error("__PB__ "+e):console.log("__PB__"+n()+"__ "+e)}},{logTarget:{set:function(e){a=e},configurable:!0,enumerable:!0}})},function(e,t,i){"use strict";i(23),i(35),i(94),i(98),i(12),i(24),i(118),i(18),i(25),i(149),i(84);var a=i(42),n=i.n(a),r=i(0),s=i.n(r),o=i(1),d=i.n(o),u=i(26),c=document,l=window,h=/^-ms-/,_=/-([a-z])/g,f=Object.prototype.toString,p=Array.prototype.slice;function g(e){return e.replace(h,"ms-").replace(_,(function(e,t){return t.toUpperCase()}))}function m(e,t){return e.className&&e.className.baseVal!==undefined?new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.getAttribute("class")):(" "+e.className+" ").indexOf(" "+t+" ")>=0}function v(e,t){var i=e.className&&e.className.baseVal!==undefined;m(e,t)||(i?e.setAttribute("class",e.getAttribute("class")+" "+t):e.className+=(e.className?" ":"")+t)}function b(e,t){if(e.className&&e.className.baseVal!==undefined){var i=e.getAttribute("class").replace(new RegExp("(\\s|^)"+t+"(\\s|$)","g"),"$2");m(e,t)&&e.setAttribute("class",i)}else{for(var a=" "+e.className+" ";a.indexOf(" "+t+" ")>=0;)a=a.replace(" "+t+" "," ");e.className="function"==typeof a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}}var y=function(){function e(t){s()(this,e);var i=!1;try{addEventListener("test",null,Object.defineProperties({},{passive:{get:function(){i=!0},configurable:!0,enumerable:!0}}))}catch(a){}return this._supportOptions=i,this._query.call(this,t)}return d()(e,[{key:"find",value:function(t){return this._query(t,new e)}},{key:"_query",value:function(e,t){var i,a=[];if(!e)return this;if("[object nodelist]"===f.call(e).toLowerCase())a=e;else if(e.nodeType)a.push(e);else if(t)for(i=0;i<this.length;i++)a=a.concat(p.call(this[i].querySelectorAll(e)));else a=e.__$__&&"length"in e?p.call(e):c.querySelectorAll(e);for(t=t||this,i=0;i<a.length;i++)t[i]=a[i];return t.__$__=!0,t.length=a.length,t}},{key:"_each",value:function(e){for(var t=0;t<this.length&&!1!==e.call(this[t],t,this[t]);t++);return this}},{key:"addClass",value:function(e){return this._each((function(t,i){v(i,e)}))}},{key:"removeClass",value:function(e){return this._each((function(t,i){b(i,e)}))}},{key:"replaceClass",value:function(e){return this._each((function(t,i){!function(e,t){var i=t;e.className="function"==typeof i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}(i,e)}))}},{key:"toggleClass",value:function(e){return this._each((function(t,i){!function(e,t){m(e,t)?b(e,t):v(e,t)}(i,e)}))}},{key:"hasClass",value:function(e){return m(this[0],e)}},{key:"css",value:function(e,t){if("object"!==n()(e))return t!==undefined?this._each((function(i,a){a.style[g(e)]=t})):(this.length>0&&(t=getComputedStyle(this[0])[g(e)]),t);for(var i in e)this.css(i,e[i])}},{key:"show",value:function(){return this.css("display","")}},{key:"hide",value:function(){return this.css("display","none")}},{key:"attr",value:function(e,t){return t!==undefined?this._each((function(i,a){a.setAttribute(e,t)})):(this.length>0&&(t=this[0].getAttribute(e)),t)}},{key:"removeAttr",value:function(e){this._each((function(t,i){1===i.nodeType&&i.removeAttribute(e)}))}},{key:"children",value:function(){var e,t=[],i=this[0];if(i)for(e=i.firstChild;e;)1===e.nodeType&&t.push(e),e=e.nextSibling;return t}},{key:"html",value:function(e){if("string"==typeof e)this._each((function(t,i){i.innerHTML=e}));else if(this[0])return this[0].innerHTML}},{key:"append",value:function(e){var t,i,a=this[0];return a?("string"==typeof e&&(t=c.createDocumentFragment(),i=c.createElement("iqpdiv"),t.appendChild(i),i.innerHTML=e,e=i.firstChild),a.appendChild(e),i=null,this):this}},{key:"remove",value:function(){return this._each((function(e,t){t.parentNode&&t.parentNode.removeChild(t)}))}},{key:"offset",value:function(){var e,t=c.documentElement,i=this[0];return i?{top:(e=i.getBoundingClientRect()).top+(l.pageYOffset||t.scrollTop)-(t.clientTop||0),left:e.left+(l.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}:{top:0,left:0}}},{key:"width",value:function(e){var t=this[0];if(!t)return 0;if(e!==undefined)return this.css("width",isNaN(e)?e:e+"px");var i=this.css("width");if(i=parseInt("100%"===i?0:i),isNaN(i)){var a=t.offsetWidth;a<=0||null==a||(i=a)}return i}},{key:"height",value:function(e){return this[0]?e!==undefined?this.css("height",isNaN(e)?e:e+"px"):parseInt(this.css("height")):0}},{key:"contains",value:function(e){var t,i=this[0];return e&&(e.nodeType?t=e:e.__$__&&(t=e[0])),!(!i||!t)&&i.contains(t)}},{key:"on",value:function(e,t,i){var a=this,n=this._events=this._events||[],r=n[e];return i=Object(u.a)({capture:!1,passive:!1,once:!1},i||{},!0),r||(r=n[e]=[]),r.push(t),this._each((function(n,r){r.addEventListener(e,t,a._supportOptions?i:i.capture)}))}},{key:"un",value:function(e,t){var i=this._events||[],a=i[e];return a||(a=i[e]=[]),this._each((function(i,n){var r;if(t){for(;(r=a.indexOf(t))>-1;)a.splice(r,1);n.removeEventListener(e,t)}else a.length>0&&(a.forEach((function(t){n.removeEventListener(e,t)})),a.splice(0,a.length))}))}},{key:"fire",value:function(e,t){var i=this._events=this._events||[],a=i[e];a||(a=i[e]=[]),t.data=t.data||{},this._each((function(e,i){a.forEach((function(e){e.call(i,t)}))}))}}]),e}();t.a=function(e){return new y(e)}},function(e,t,i){"use strict";t.a={M4S:"m4s",TS:"ts",FTS:"fts",DASH:"dash"}},function(e,t,i){"use strict";i(94),i(12),i(18);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(152),d={IGNORABLE:0,RECOVERABLE:1,CRITICAL:2},u={NETWORK:1,MANIFEST:2,MEDIA:3,DATA_SOURCE:4,MUX:5,DRM:6},c={NET_UNSUPPORTED_SCHEME:1e3,NET_HTTPS_UNMATCHED_HTTP_SCHEME:1001,MFT_FAILED_TO_PARSE_MPD_XML:2301,MEDIA_VIDEO_ERROR:3e3,MEDIA_SOURCE_OPERATION_FAILED:3001,MEDIA_SOURCE_OPERATION_THREW:3002,MEDIA_QUOTA_EXCEEDED:3003,MEDIA_HIGH_BUFFER:3004,UNSUPPORTED_PLAY_RANGE:4e3,DATA_P2P_DISPATCH:4100,DATA_P2P_LOAD:4101,DATA_P2P_LOAD_ACCESS:4102,DATA_P2P_MEMORY_ALLOC:4103,DATA_P2P_DASH_BYTES_LENGTH:4104,DATA_P2P_AUTH:4105,DATA_P2P_RANGE_ERROR:4106,DATA_P2P_DATA_NULL:4107,DATA_HLS_DISPATCH_TIMEOUT:4200,DATA_HLS_DISPATCH_ERROR:4201,DATA_HLS_CDN_TIMEOUT:4202,DATA_HLS_CDN_ERROR:4203,DATA_AUTH_Error:4204,DATA_FLV_TIMEOUT:4301,DATA_FLV_ERROR:4302,DATA_FLV_DISPATCH_ERROR:4303,DATA_DASH_TIMEOUT:4401,DATA_DASH_ERROR:4402,DATA_DASH_DISPATCH_ERROR:4403,DATA_DASH_RANGE_ERROR:4404,DATA_AD_ERROR:4702,DATA_AUDIO_LOADED_ERROR:4601,DATA_AUDIO_LOADED_TIMEOUT:4602,DATA_AUDIO_DISPATHED_ERROR:4603,DATA_AUDIO_DISPATHED_TIMEOUT:4604,DATA_MP4_DISPATCH_ERROR:4701,DATA_MP4_CDN_TIMEOUT:4702,DATA_MP4_CDN_ERROR:4703,MUX_UNKNOWN_FAILED:5e3,MUX_WORKER_INTERNAL_EXCEPTION:5001,MUX_WORKER_MESSAGE_EXCEPTION:5002,MUX_TS_SYNC_BYTE:5003,DRM_NO_RECOGNIZED_KEY_SYSTEMS:6e3,DRM_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,DRM_FAILED_TO_CREATE_CDM:6002,DRM_FAILED_TO_ATTACH_TO_VIDEO:6003,DRM_INVALID_SERVER_CERTIFICATE:6004,DRM_FAILED_TO_CREATE_SESSION:6005,DRM_FAILED_TO_GENERATE_LICENSE_REQUEST:6006,DRM_LICENSE_REQUEST_ERROR:6007,DRM_LICENSE_REQUEST_TIMEOUT:6008,DRM_NO_LICENSE_SERVER_RESPONSE:6009,DRM_LICENSE_RESPONSE_REJECTED:6010,DRM_NO_LICENSE_SERVER_GIVEN:6012,DRM_NO_RECOGNIZED_ERROR:6013,DRM_SERVER_REJECT_BY_LICENSE_SDK:6015};i.d(t,"a",(function(){return l}));var l=function(){function e(t,i,a,r){if(n()(this,e),this.severity=t,this.category=i,this.code=a,this.data=Array.prototype.slice.call(arguments,3),this.handled=!1,o.a.DEBUG){var s="UNKNOWN",d="UNKNOWN";for(var l in u)u[l]===this.category&&(s=l);for(var h in c)c[h]===this.code&&(d=h);this.message="QVS Error "+s+"."+d+" ("+this.data.toString()+")";try{throw new Error(this.message)}catch(_){this.stack=_.stack}}}return s()(e,null,[{key:"severity",get:function(){return d}},{key:"category",get:function(){return u}},{key:"code",get:function(){return c}}]),e}()},function(e,t,i){var a=i(176),n=i(103),r=i(230);a||n(Object.prototype,"toString",r,{unsafe:!0})},function(e,t,i){"use strict";i(12),i(24),i(18);var a=0,n=0,r=32,s=0,o=32,d="",u="",c=!1,l=localStorage.getItem("absDoMain");localStorage.getItem("onP2PLog")&&(c=!0);var h=parseInt(localStorage.getItem("downTime"));h&&Date.now()-h<864e5&&(r=parseInt(localStorage.getItem("downMax")));var _=parseInt(localStorage.getItem("upTime"));_&&Date.now()-_<864e5&&(o=parseInt(localStorage.getItem("upMax")));var f=Object.defineProperties({aid:0,MixWaterMark:!1,trackerStatus:0,platform:0,p2pLog:"",onLog:c,uuid:"",bitrate:0,absOpen:!0,encryptFunc:null,getBufferFunc:null,dashUpdatedFunc:null,canSwitchVd:null,getReBufTimeFunc:null,isMediaUpdatingFunc:null,sendPingBack:null,updateDashRequireArgsFunc:null,getIsVipFunc:null,noticeDataArrived:null,checkIsMobius:null,dashUpdateVideoTime:0,playDuration:0,tvId:"",startPlayed:null,authorFailedStatus:0,trackerIP:"",absStatus:0,cdnLoadDoMain:"",lastReadSegIndex:0,lastReadTvID:0,fileType:"",pcwBuffer:0},{bid:{get:function(){return localStorage.getItem("bid")},configurable:!0,enumerable:!0},downMax:{get:function(){return r},configurable:!0,enumerable:!0},cdnSpeed:{get:function(){return a},set:function(e){!function(e){(a=e)+n>r&&(r=a+n,localStorage.setItem("downMax",r.toString()),localStorage.setItem("downTime",Date.now().toString()))}(e)},configurable:!0,enumerable:!0},downSpeed:{get:function(){return n},set:function(e){!function(e){a+(n=e)>r&&(r=a+n,localStorage.setItem("downMax",r.toString()),localStorage.setItem("downTime",Date.now().toString()))}(e)},configurable:!0,enumerable:!0},upMax:{get:function(){return o},configurable:!0,enumerable:!0},upSpeed:{get:function(){return s},set:function(e){!function(e){(s=e)>o&&(o=s,localStorage.setItem("upMax",o.toString()),localStorage.setItem("upTime",Date.now().toString()))}(e)},configurable:!0,enumerable:!0},bgpIP_1:{get:function(){return d},set:function(e){d=e},configurable:!0,enumerable:!0},bgpIP_2:{get:function(){return u},set:function(e){u=e},configurable:!0,enumerable:!0},bgpIP:{get:function(){return""===d?"access.if.iqiyi.com/3eb/":d+"/3eb/"},configurable:!0,enumerable:!0},bgpIP2:{get:function(){return""===u?"":u+"/3eb/"},configurable:!0,enumerable:!0},absDoMain:{get:function(){return l},configurable:!0,enumerable:!0}});t.a=f},function(e,t,i){"use strict";i.d(t,"i",(function(){return a})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return s})),i.d(t,"j",(function(){return o})),i.d(t,"g",(function(){return d})),i.d(t,"h",(function(){return u})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return h}));i(21),i(197),i(12),i(102),i(91);var a={mobile:!1,upLoad:!0,limitP2P:"",onP2P:!0,trackerVersion:3,tracker:[],stun:[],aidList:[],defaultTracker:[],getPeerIDStep:3e4,weedOutPeerStep:3e4,connectPeerStep:2e3,NATTimeoutStep:15e3,connectMax:8,passiveMax:10,RTCMax:1500,RTCPoolSize:50,coolDownTime:3e5,switchPage:!1,closeP2PVidList:[],closeP2PNetList:[],closeP2PFileTypeList:[]},n={dispatchCfg:[8e3,8e3,8e3,8e3],TTFBCfg:[8e3,8e3,8e3,8e3],rcvCfg:[8e3,8e3,8e3,8e3],reLoadCfg:[500,2e3,4e3,6e3],maxBuff:30},r={subPieceSize:1024,chunkSize:1048576,videoDataSize:0,videoMaxSize:134217728},s="https://cache.video.iqiyi.com/jp/dash",o=50,d=new Map,u=25,c=4,l=600,h=601;t.k={version:"1.0.0"}},function(e,t,i){"use strict";i(35),i(21),i(73),i(287),i(94),i(197),i(114),i(12),i(117),i(24),i(118),i(18),i(102),i(137),i(25),i(36),i(91);var a=i(13),n=i(14),r=i(83),s=new Map;function o(e){var t="";if(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)){var i=new RegExp("(^| )"+e+"=([^;]*)(;|$)").exec(document.cookie);i&&(t=i[2]||"")}return"string"==typeof t&&(t=decodeURIComponent(t)),t}function d(){var e=o("QP0022");if(!e)return{};var t=e.split("|");return{userInfo:t[0]+"|"+t[1],idc:t[2],userNetType:t[0],userArea:t[1].split("-")[0],userIP:t[1].split("-")[1]}}s.set("zhejiang","zj"),s.set("yunnan","yn"),s.set("xizang","xz"),s.set("xinjiang","xj"),s.set("tianjin","tj"),s.set("shan1xi","sx"),s.set("shan3xi","sn"),s.set("shanghai ","sh"),s.set("shandong","sd"),s.set("sichuan","sc"),s.set("qinghai","qh"),s.set("ningxia","nx"),s.set("neimeng","nm"),s.set("liaoning","ln"),s.set("jiangxi","jx"),s.set("jiangsu","js"),s.set("jilin","jl"),s.set("hainan","hi"),s.set("henan","ha"),s.set("hunan","hn"),s.set("heilongjiang","hl"),s.set("hebei","he"),s.set("hubei","hb"),s.set("guizhou","gz"),s.set("guangxi","gx"),s.set("gansu","gs"),s.set("guangdong","gd"),s.set("fujian","fj"),s.set("chongqing","cq"),s.set("beijing","bj"),s.set("anhui","ah"),t.a={fireUrl:function(e,t){if("string"==typeof t&&e){var i=new Image;i.onload=i.onerror=i.onabort=function(){i.onload=i.onerror=i.onabort=null,i=null};var a=[];for(var n in e.dur=+new Date,e)e.hasOwnProperty(n)&&a.push(n+"="+encodeURIComponent(e[n]));i.src=t+"?"+a.join("&")}},isUGC:function(e){return!!((e+="")&&e.length>2&&"9"===e.charAt(e.length-1)&&"0"===e.charAt(e.length-2)&&(e=parseInt(e,10))>0&&e>9e7)},accSub:function(e,t){var i,a,n,r;try{i=e.toString().split(".")[1].length}catch(s){i=0}try{a=t.toString().split(".")[1].length}catch(s){a=0}return n=Math.pow(10,Math.max(i,a)),r=i>=a?i:a,parseFloat((Math.round(e*n-t*n)/n).toFixed(r))},accAdd:function(e,t){var i,a,n;try{i=e.toString().split(".")[1].length}catch(r){i=0}try{a=t.toString().split(".")[1].length}catch(r){a=0}return n=Math.pow(10,Math.max(i,a)),Math.round(e*n+t*n)/n},trimNumber:function(e,t){t||(t=1e4);var i=t.toString().substr(1),a=Math.ceil(e);return a>0&&(i=(a+=t).toString().substr(1)),i},getCookie:o,setCookie:function(e,t){t=encodeURIComponent(t),document.cookie=e+"="+t},searchPosIndex:function(e,t){if(e<0)return!1;var i=0,a=t.length-1;if(e>=t[a])return a;for(;i<=a;){var n=Math.floor((i+a)/2);if(e>=t[n]&&(e<t[n+1]||n===t.length-1))return n;e<t[n]?a=n-1:i=n+1}return-1},searchTSPosIndex:function(e,t){if(e<0)return!1;var i=0,a=t.length-1;if(e>=t[a].ePos)return t.length;for(;i<=a;){var n=Math.floor((i+a)/2);if(e>=t[n].sPos&&e<t[n].ePos)return n;e<t[n].sPos?a=n-1:i=n+1}return-1},getUserInfoFromCookie:d,strToNumber:function(e){var t,i=0;t=e.length>8?e.slice(0,8):e;for(var a=0;a<t.length;a++)switch(a){case 0:i+=72057594037927940*("0x"+t[a]);break;case 1:i+=281474976710656*("0x"+t[a]);break;case 2:i+=1099511627776*("0x"+t[a]);break;case 3:i+=4294967296*("0x"+t[a]);break;case 4:i+=16777216*("0x"+t[a]);break;case 5:i+=65536*("0x"+t[a]);break;case 6:i+=256*("0x"+t[a]);break;case 7:i+=1*("0x"+t[a])}return i},getQueryString:function(e,t){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=e.split("?")[1].match(i);return null!=a?decodeURIComponent(a[2]):null},sliceStr:function(e,t){var i="";if(e.length<=t){for(i=e;i.length<t;)i+="0";return i}var a=Math.floor(e.length/t);(t-1)*(a+1)+1<=e.length&&(a+=1);for(var n=0;i.length<t;)i+=e[n],n+=a;return i},getPureIP:function(e){var t=e.match(/(\w+):\/\/([^/:]+):?(\d*)((?:\/|$)[^?#]*)/);return t?t[2]:""},parseURL:function(e){return e.match(/(\w+):\/\/([^\/:]+):?(\d*)((?:\/|$)[^?#]*)/)},isDomain:function(e){var t=e.match(/[a-z|A-Z]/g);return!!(t&&t.length>0)},shuffle:function(e){for(var t,i,a=e.length;a;)i=Math.floor(Math.random()*a--),t=e[a],e[a]=e[i],e[i]=t},ArrayBufferToStr:function(e,t,i){for(var a="",n=0;n<i;n++){var r=parseInt(e[t+n]);if(r===undefined)break;a+=(r<16?"0"+r.toString(16):r.toString(16))+"-"}return a},ArrayBufferTo10Str:function(e,t,i){for(var a="",n=0;n<i;n++){var r=parseInt(e[t+n]);if(r===undefined)break;a+=r.toString(10)+"-"}return a},setStringToData:function(e,t,i,a){for(var n=0;n<a;n++)n>=i.length?e[t+n]=0:e[t+n]=i.charCodeAt(n)},setNumberToData:function u(e,t,i,a){for(var n=i,r=t,s=a;s>4;)u(e,r,Math.floor(n/4294967296),s-4),n%=4294967296,r+=s-4,s-=s-4;for(var o=0;o<s;)e[r+o]=n/(1<<8*(s-o-1)),o++},getFileNameFromUrl:function(e){var t=e.indexOf(".ts");t<0&&(t=e.indexOf(".m4s")),t<0&&(t=e.indexOf(".webm")),t<0&&(t=e.indexOf(".mp4"));var i=e.lastIndexOf("/",t);return e.slice(i+1,t)},getTrackerIP:function(e,t,i,r){if(n.i.aidList.indexOf(a.a.aid)>=0&&n.i.defaultTracker.length>0)return n.i.defaultTracker[(i-1+1)%n.i.defaultTracker.length];for(var s="",o=0;o<t.length;o++)if(e===t[o].key||"*"===t[o].key){var d=t[o].value;d&&d.length>0&&(s=d[((i-1+1)%d.length+(r||0))%d.length]);break}return s},isHit:function(){var e=o("QC005"),t=d();return!!(parseInt(e.substring(0,1))<3||t&&t.userInfo.indexOf("OVERSEA")>=0)},getNewUrl:function(e,t,i){var a=function(e,t){var i=[];switch(e){case"ct":r.a.isHTTPS?t.indexOf("guangdong")>=0?i.push("bdcdnct-gd.inter.71edge.com"):i.push("bdcdnct.inter.71edge.com"):t.indexOf("guangdong")>=0?i.push("baiducdnct-gd.inter.iqiyi.com"):i.push("baiducdnct.inter.iqiyi.com");break;case"cnc":r.a.isHTTPS?i.push("bdcdncnc.inter.71edge.com"):i.push("baiducdncnc.inter.iqiyi.com");break;case"cmnet":var a=s.get(t);r.a.isHTTPS?a?i.push("bdcdncmn-"+a+".inter.71edge.com"):i.push("bdcdncmn1.inter.71edge.com"):(a?i.push("baiducdncmn-"+a+".inter.iqiyi.com"):i.push("bdcdncmn1.inter.71edge.com"),i.push("baiducdncmn-bj.inter.iqiyi.com"));break;default:r.a.isHTTPS?i.push("bdcdnct.inter.71edge.com"):i.push("baiducdnct.inter.iqiyi.com")}return i}(t.toLowerCase(),i.split("_")[0].toLowerCase());if(0===a.length)return e;var n=a[Date.now()%a.length],o=e.split("/");return o[2]?e.replace(o[2],n):e},isPoint80443:function(e){var t=e.split("/");if(t[2]){var i=t[2].split(":");if(i[1]&&("http:"===t[0]&&80!==parseInt(i[1])||"https:"===t[0]&&443!==parseInt(i[1])))return!1}return!0}}},function(e,t,i){"use strict";i(117),i(24),i(137),i(25);t.a=function(){var e="",t={},i={},a=navigator,n=a.platform,r=a.userAgent.toLowerCase(),s=r.match(/rtrident/),o=!s&&r.match(/(ipad).*os\s([\d_]+)/),d=!s&&!o&&r.match(/(iphone\sos)\s([\d_]+)/),u=r.match(/Android\s+([\d.]+)/i),c="",l="";if(l=navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:(l=r.match(/NetType\/\w+/)?r.match(/NetType\/\w+/)[0]:"").toLowerCase().replace("nettype/",""),i.userAgent=r,i.IE11=/rv\:11/.test(r),i.IE=/msie/.test(r)||i.IE11,i.IE6=/msie 6/.test(r),i.IE7=/msie 7/.test(r),i.IE8=/msie 8/.test(r),i.IE9=/msie 9/.test(r),i.IE10=/msie 10/.test(r),i.EDGE=/edge/.test(r),i.iPhone=/iphone os/.test(r)&&!s,i.iPhone4=/iphone os [45]_/.test(r)&&!s,i.iPad=/ipad/.test(r)&&!s,i.iPod=/iPod/i.test(r)&&!s,i.isTouch="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,i.CHROMEIOS=/crios/.test(r),i.CHROME=/chrome/.test(r)&&!i.EDGE,i.SAFARI=/safari/.test(r)&&!/chrome/.test(r),i.FIREFOX=/firefox/.test(r),i.mobile=/mobile/gi.test(r),i.mobileSafari=i.iPhone||i.iPhone||i.iPad,i.QQ=/QQBrowser/gi.test(r),i.WECHAT=/(wechat)|(micromessenger)/gi.test(r),i.CHROME){var h=/chrome\/([\d\.]+) /gi.exec(r);i.version=h?parseInt(h[1],10):0}if(i.EDGE){var _=/edge\/([\d\.]+)/gi.exec(r);i.version=_?parseInt(_[1],10):0}var f=/mac/i.test(n),p="X11"==n&&!f,g=/win/i.test(n)&&!p,m=/android/.test(r);t.unix=p,t.win=g,t.mac=f,t.android=m,t.androidMobile=m&&i.mobile,t.androidTablet=m&&(!i.mobile||/pad/i.test(r)),u&&(t.version=u[1]),t.ios=!1,d&&(t.ios=!0,t.version=d[2].replace(/_/g,".")),o&&(t.ios=!0,t.version=o[2].replace(/_/g,".")),i.iPod&&(t.ios=!0),e=i.iPad?"b85da1cf3ae44351":"b6c13e26323c537d";var v=function(e){return c||function(e){var a="01";(i.iPhone||t.android)&&(a="02"),(i.iPad||t.androidTablet)&&(a="03");var n="01";t.android&&(n="02"),t.mac&&(n="08"),t.ios&&(n="03");return a+n+"00310100"+(e?"10":"00")+"000000"}(e)},b=r.match(/miuivideo\//i)||t.android&&parseInt(t.version)>4&&r.match(/MiuiBrowser/i),y=i.iPad||i.iPhone||t.android&&parseFloat(t.version)>4||b?"m3u8":"mp4";return/__pmode__=m3u8/.test(window.location.href)?y="m3u8":/__pmode__=mp4/.test(window.location.href)&&(y="mp4"),{browser:i,os:t,code:e,getPtid:v,setPtid:function(e){c=e},getAgentType:function(e){var t=1;switch(v(e).substr(0,4)){case"0108":t=276;break;case"0303":t=10;break;case"0302":t=11;break;case"0203":t=13;break;case"0202":t=12}return t},browserName:function(){var e="";return i.CHROME?e="CHROME":i.SAFARI?e="SAFARI":i.FIREFOX?e="FIREFOX":i.QQ?e="QQ":i.WECHAT?e="WECHAT":i.IE?e="IE":i.IE6?e="IE6":i.IE7?e="IE7":i.IE8?e="IE8":i.IE9?e="IE9":i.IE10?e="IE10":i.EDGE?e="EDGE":i.mobileSafari?e="mobileSafari":t.ios||t.ios?e="ios":t.androidMobile?e="androidMobile":t.androidTablet&&(e="androidTablet"),e},network:l,playerMode:y}}()},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=function(){function e(t){return n()(this,e),new(0,e.PlayerLogger)(t)}return s()(e,null,[{key:"stringify",value:function(e){var t="";try{t=JSON.stringify(e)}catch(i){}return t}},{key:"setLevel",value:function(t){e.PlayerLogger.setLevel(t)}},{key:"getLevel",value:function(){return e.PlayerLogger.getLevel()}},{key:"getLog",value:function(){return e.PlayerLogger.getLog()}},{key:"saveImmediately",value:function(){e.PlayerLogger.saveImmediately()}},{key:"PlayerLogger",get:function(){return window.QiyiPlayerLoader.logger()}},{key:"levels",get:function(){return e.PlayerLogger.Levels}}]),e}();t.a=o},function(e,t,i){"use strict";var a=i(103),n=i(79),r=i(31),s=i(167),o=RegExp.prototype,d=o.toString,u=r((function(){return"/a/b"!=d.call({source:"a",flags:"b"})})),c="toString"!=d.name;(u||c)&&a(RegExp.prototype,"toString",(function(){var e=n(this),t=String(e.source),i=e.flags;return"/"+t+"/"+String(i===undefined&&e instanceof RegExp&&!("flags"in o)?s.call(e):i)}),{unsafe:!0})},function(e,t,i){"use strict";i(118),i(18);var a=i(26),n={},r={get:function(e,t){var i="";if((t=Object(a.a)({memory:!1},t,!0)).memory&&n.hasOwnProperty(e))i=n[e];else{if(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)){var r=new RegExp("(^| )"+e+"=([^;]*)(;|$)").exec(document.cookie);r&&(i=r[2]||"")}"string"==typeof i&&(i=decodeURIComponent(i)),t.memory&&(n[e]=i)}return i},set:function(e,t,i){i=i||{},t=encodeURIComponent(t);var a=i.expires;"number"==typeof i.expires&&(a=i.expires<=0?new Date(0):new Date).setTime(a.getTime()+i.expires),delete n[e],document.cookie=e+"="+t+(i.path?"; path="+i.path:"")+(a?"; expires="+a.toUTCString():"")+(i.domain?"; domain="+i.domain:"")},remove:function(e,t){(t=t||{}).expires=-1,this.set(e,"",t)}};t.a=r},function(e,t,i){"use strict";i(89);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(5),h=i.n(l),_=function(e){function t(e,i,a){var r;return n()(this,t),(r=d()(this,c()(t).call(this))).view=i,r.engine=i.engine,r.name=e,r.visable=!1,r.enabled=!0,a&&(r.parent=a,r.plugin=a.querySelector('[data-player-hook="'.concat(e,'"]')),r.cache="plgcontainer"===a.getAttribute("data-player-hook")),r.cacheFragment=document.createDocumentFragment(),r}return h()(t,e),s()(t,[{key:"_onBeforeEnableAction",value:function(){}},{key:"enable",value:function(){this.enabled||(this._onBeforeEnableAction(),this.enabled=!0,this.cache&&this.plugin&&this.parent.appendChild(this.plugin),this._onAfterEnableAction(),this.rollType=null,this.seekable=!1)}},{key:"_onAfterEnableAction",value:function(){}},{key:"_onBeforeDisableAction",value:function(){}},{key:"disable",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};e&&this.rollType&&this.rollType!==e.rollType&&(this.enabled=!0),this.enabled&&(this.rollType=e.rollType,this.seekable=e.seekable,this._onBeforeDisableAction(),this.enabled=!1,this.cache&&this.plugin&&this.cacheFragment.appendChild(this.plugin),this._onAfterDisableAction())}},{key:"_onAfterDisableAction",value:function(){}},{key:"show",value:function(){this.visable=!0,this.plugin.style.display=""}},{key:"hide",value:function(){this.visable=!1,this.plugin.style.display="none"}},{key:"toggle",value:function(){this.visable?this.hide():this.show()}},{key:"destroy",value:function(){this.plugin&&this.plugin.parentNode&&this.plugin.parentNode.removeChild(this.plugin)}},{key:"fire",value:function(e,t){this.view.emit(e,t)}}],[{key:"css",value:function(){return""}},{key:"html",value:function(){return""}},{key:"padCss",value:function(){return this.css()}},{key:"padHtml",value:function(){return this.html()}},{key:"mobileCss",value:function(){return this.css()}},{key:"mobileHtml",value:function(){return this.html()}}]),t}(i(77).a);t.a=_},function(e,t,i){"use strict";var a=i(116),n=i(189),r=i(178),s=i(119),o=i(216),d=s.set,u=s.getterFor("Array Iterator");e.exports=o(Array,"Array",(function(e,t){d(this,{type:"Array Iterator",target:a(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,i=e.kind,a=e.index++;return!t||a>=t.length?(e.target=undefined,{value:undefined,done:!0}):"keys"==i?{value:a,done:!1}:"values"==i?{value:t[a],done:!1}:{value:[a,t[a]],done:!1}}),"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},function(e,t,i){"use strict";t.a={ERROR:"qvsError",DESTROYING:"qvsDestroying",DESTROYED:"qvsDestroying",STATE_CHANGE:"qvsStateChange",STREAM_ENCRYPTED:"qvsStreamEncrypted",MSE_ATTACHING:"qvsMSEAttaching",MSE_ATTACHED:"qvsMSEAttached",MSE_DETACHING:"qvsMSEDetaching",MSE_DETACHED:"qvsMediaDetached",MEDIA_IDLE:"qvsMediaIdle",BUFFER_CREATED:"qvsBufferCreated",BUFFER_UPDATED:"qvsBufferUpdated",BUFFER_EXPECTING:"qvsBufferExpecting",BUFFER_APPENDING:"qvsBufferAppending",BUFFER_APPENDED:"qvsBufferAppended",BUFFER_FLUSHING:"qvsBufferFlushing",BUFFER_FLUSHED:"qvsBufferFlushed",MANIFEST_LOADED:"qvsManifestLoaded",DATA_EOD:"qvsDataEOD",DATA_STAGE_SWITCHING:"qvsDataStageSwitching",DATA_STAGE_SWITCHED:"qvsDataStageSwitched",DATA_BMFF_ARRIVED:"qvsDataBMFFArrived",AUDIO_TRACK_SWITCHED_FAILED:"qvsTrackSwitchedFailed",AUDIO_TRACK_SWITCHED_SUCCESSED:"qvsTrackSwitchedSuccessed",FPS_REPORT:"qvsFpsReport",FPS_STUCK:"qvsFpsStuck",DNS_PARSER_SUCCESS:"dns_parser_success"}},function(e,t,i){"use strict";var a=i(33),n=i(31),r=i(158),s=i(85),o=i(95),d=i(74),u=i(147),c=i(173),l=i(140),h=i(39),_=i(183),f=h("isConcatSpreadable"),p=_>=51||!n((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),g=l("concat"),m=function(e){if(!s(e))return!1;var t=e[f];return t!==undefined?!!t:r(e)};a({target:"Array",proto:!0,forced:!p||!g},{concat:function(e){var t,i,a,n,r,s=o(this),l=c(s,0),h=0;for(t=-1,a=arguments.length;t<a;t++)if(r=-1===t?s:arguments[t],m(r)){if(h+(n=d(r.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(i=0;i<n;i++,h++)i in r&&u(l,h,r[i])}else{if(h>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(l,h++,r)}return l.length=h,l}})},function(e,t,i){var a=i(33),n=i(224);a({global:!0,forced:parseInt!=n},{parseInt:n})},function(e,t,i){"use strict";var a=i(166),n=i(79),r=i(95),s=i(74),o=i(107),d=i(106),u=i(181),c=i(168),l=Math.max,h=Math.min,_=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,p=/\$([$&'`]|\d\d?)/g;a("replace",2,(function(e,t,i){return[function(i,a){var n=d(this),r=i==undefined?undefined:i[e];return r!==undefined?r.call(i,n,a):t.call(String(n),i,a)},function(e,r){var d=i(t,e,this,r);if(d.done)return d.value;var _=n(e),f=String(this),p="function"==typeof r;p||(r=String(r));var g=_.global;if(g){var m=_.unicode;_.lastIndex=0}for(var v=[];;){var b=c(_,f);if(null===b)break;if(v.push(b),!g)break;""===String(b[0])&&(_.lastIndex=u(f,s(_.lastIndex),m))}for(var y,k="",T=0,S=0;S<v.length;S++){b=v[S];for(var P=String(b[0]),x=l(h(o(b.index),f.length),0),I=[],E=1;E<b.length;E++)I.push((y=b[E])===undefined?y:String(y));var D=b.groups;if(p){var w=[P].concat(I,x,f);D!==undefined&&w.push(D);var A=String(r.apply(undefined,w))}else A=a(P,f,x,I,D,r);x>=T&&(k+=f.slice(T,x)+A,T=x+P.length)}return k+f.slice(T)}];function a(e,i,a,n,s,o){var d=a+e.length,u=n.length,c=p;return s!==undefined&&(s=r(s),c=f),t.call(o,c,(function(t,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return i.slice(0,a);case"'":return i.slice(d);case"<":o=s[r.slice(1,-1)];break;default:var c=+r;if(0===c)return t;if(c>u){var l=_(c/10);return 0===l?t:l<=u?n[l-1]===undefined?r.charAt(1):n[l-1]+r.charAt(1):t}o=n[c-1]}return o===undefined?"":o}))}}))},function(e,t,i){"use strict";t.a=function a(e,t,i,n){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return t&&function(e,t){var i;for(i in e)if(r(e,i)&&t(e[i],i))break}(t,(function(t,s){!i&&r(e,s)||(n&&"string"!=typeof t&&"boolean"!=typeof t?(e[s]||(e[s]={}),a(e[s],t,i,n)):e[s]=t)})),e}},function(e,t,i){"use strict";t.a={VIDEO:"video",AUDIO:"audio",TEXT:"text",APPLICATION:"application"}},function(e,t,i){"use strict";t.a={HLS:0,JDASH:1,F4V:2,FLV:2,MP4:3,AMP4:4,DASH_VP9:5,DASH_AV1:6}},function(e,t,i){"use strict";i(73),i(12),i(24),i(18),i(36);var a=i(19),n=i(99),r=i(90),s=0,o=!1,d="",u=window.webEventID||"",c=function(){u=window.webEventID||""},l=function(){return Object(n.a)(window.navigator.userAgent+document.cookie+Math.random()+(new Date).getTime()*s++)},h=function(e,t,i){a.a.set(e,t,{expires:i||31536e6,path:"/",domain:"iqiyi.com"})},_=function(){var e=a.a.get("QC006");return e||(o=!0,e=l(),h("QC006",e)),e},f=function(){var e=a.a.get("QC005"),t=r.a.read("QC005"),i=e||t;return i?t?e||h("QC005",i,283824e7):r.a.write("QC005",i):(o=!0,i=l(),h("QC005",i,283824e7),r.a.write("QC005",i)),i},p={createUUID:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1).toUpperCase()}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},getQtsid:function(){var e,t=function(){return parseInt(new Date/1e3,10).toString()};if(e=a.a.get("QC008"),a.a.get("QC010")&&e)return e;if(/^\d{10}\.\d{10}\.\d{10}\.\d+$/.test(e))(e=e.split("."))[1]=e[2],e[2]=t(),e[3]=parseInt(e[3],10)+1;else{var i=t();e=[i,i,i,"1"]}return e.join("."),e},getJsuid:_,getFluid:function(){return f()},getWeid:function(){return u||(u=window.webEventID||Object(n.a)(_()+"weid"+ +new Date)),u},getEid:function(){var e="";return d||(e=_(),d=Object(n.a)(e+"veid"+1*new Date)),d},getIsNewUser:function(){return o},init:function(){try{window.addEventListener("unload",c),window.addEventListener("beforeunload",c),window.addEventListener("pagehide",c)}catch(e){}}};t.a=p},function(e,t,i){(function(t){var i=function(e){return e&&e.Math==Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof t&&t)||Function("return this")()}).call(this,i(200))},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,i){var a=i(30),n=i(128).f,r=i(96),s=i(103),o=i(170),d=i(212),u=i(157);e.exports=function(e,t){var i,c,l,h,_,f=e.target,p=e.global,g=e.stat;if(i=p?a:g?a[f]||o(f,{}):(a[f]||{}).prototype)for(c in t){if(h=t[c],l=e.noTargetGet?(_=n(i,c))&&_.value:i[c],!u(p?c:f+(g?".":"#")+c,e.forced)&&l!==undefined){if(typeof h==typeof l)continue;d(h,l)}(e.sham||l&&l.sham)&&r(h,"sham",!0),s(i,c,h,e)}}},function(e,t,i){"use strict";i(117);var a=i(15);function n(e,t){var i=null,a=null;if(null!==e&&e.hasOwnProperty("m3u8")&&(i=e.m3u8),a=i.hasOwnProperty("payload")&&i.payload.hasOwnProperty("wm_a")?i.payload.wm_a:i,"video"===t){if(a.hasOwnProperty("video_track1")&&a.video_track1.hasOwnProperty("files"))return a.video_track1.files}else if("audio"===t&&a.hasOwnProperty("audio_track1")&&a.audio_track1.hasOwnProperty("files"))return a.audio_track1.files;return null}var r={getM4sDuration:function(e){var t=null,i=null;return null!==e&&e.hasOwnProperty("m3u8")&&(t=e.m3u8),t.hasOwnProperty("payload")&&t.payload.hasOwnProperty("wm_a")?(i=t.payload.wm_a).hasOwnProperty("video_track1")&&i.hasOwnProperty("audio_track1")?Math.min(parseFloat(i.video_track1.duration_second),parseFloat(i.audio_track1.duration_second)):void 0:e.duration},getGapPos:function(e,t,i,r){var s=n(e,i);if(null===s)return null;if(t>=e.duration){var o=s.length-1,d=s[o].seekable.time.length,u=s[o].seekable.pos.length;return"start"===r?{segmentIndex:o,chunkIndex:u-2,time:a.a.accAdd(s[o].start_second,s[o].seekable.time[d-2]),pos:s[o].seekable.pos[u-2]}:{segmentIndex:o,chunkIndex:u-1,time:a.a.accAdd(s[o].start_second,s[o].seekable.time[d-1]),pos:s[o].seekable.pos[u-1]}}for(var c=0;c<s.length;c++)if(t>=s[c].start_second&&t<a.a.accAdd(s[c].start_second,s[c].duration_second)){for(var l=s[c].start_second,h=s[c].seekable.time,_=0;_<h.length;_++)if(t>=a.a.accAdd(l,h[_])&&t<a.a.accAdd(l,h[_+1]))return"start"===r?{segmentIndex:c,chunkIndex:_,time:a.a.accAdd(l,h[_]),pos:s[c].seekable.pos[_]}:{segmentIndex:c,chunkIndex:_,time:a.a.accAdd(l,h[_+1]),pos:s[c].seekable.pos[_+1]}}else if("end"===r&&t===a.a.accAdd(s[c].start_second,s[c].duration_second)){var f=s[c].seekable.time.length-1;return{segmentIndex:c,chunkIndex:f-1,time:a.a.accAdd(s[c].start_second,s[c].duration_second),pos:s[c].seekable.pos[f]}}return null},getFilesInfo:n,getDuratioSecond:function(e,t,i){var n=r.getFilesInfo(e,t);return i<=n.length-1?a.a.accAdd(n[i].duration_second,n[i].start_second):0},getSegmentIdx:function(e,t){return e+t},getSegmentSize:function(e,t,i){var a=n(e,t);return i<a.length?a[i].size:-1},getChunkSEPos:function(e,t,i,a){var r=n(e,t);if(r[i]&&r[i].hasOwnProperty("seekable")){var s=r[i].seekable;if(s.hasOwnProperty("pos")&&s.pos[a+1])return{sPos:s.pos[a],ePos:s.pos[a+1]}}return null},getNextChunkInfo:function(e,t,i,r){var s=n(e,t);if(s[i]&&s[i].hasOwnProperty("seekable")){var o=s[i].seekable;return r+1<o.pos.length-1?{segmentIndex:i,chunkIndex:r+1,sTime:a.a.accAdd(s[i].start_second,o.time[r+1]),eTime:a.a.accAdd(s[i].start_second,o.time[r+2]),sPos:o.pos[r+1],ePos:o.pos[r+2]}:i<s.length-1?(o=s[i+1].seekable,{segmentIndex:i+1,chunkIndex:0,sTime:a.a.accAdd(s[i+1].start_second,o.time[0]),eTime:a.a.accAdd(s[i+1].start_second,o.time[1]),sPos:o.pos[0],ePos:o.pos[1]}):null}return null},getCurChunkInfo:function(e,t,i,r){var s=n(e,t);if(s[i]&&s[i].hasOwnProperty("seekable")){var o=s[i].seekable;return r<o.pos.length-1?{segmentIndex:i,chunkIndex:r,sTime:a.a.accAdd(s[i].start_second,o.time[r]),eTime:a.a.accAdd(s[i].start_second,o.time[r+1]),sPos:o.pos[r],ePos:o.pos[r+1]}:null}return null},getTSGapPos:function(e,t,i){if(!e.hasOwnProperty("m3u8")||0===e.m3u8.length)return null;var n=e.m3u8;if(t>=e.duration){var r=n.length-1,s=n[r].time.length,o=n[r].pos.length;return"start"===i?{segmentIndex:r,chunkIndex:o-1,time:a.a.accAdd(n[r].start_second,n[r].time[s-2]),pos:n[r].pos[o-1].sPos}:{segmentIndex:r,chunkIndex:o-1,time:a.a.accAdd(n[r].start_second,n[r].time[s-1]),pos:n[r].pos[o-1].ePos}}for(var d=0;d<n.length;d++)if(t>=n[d].start_second&&t<a.a.accAdd(n[d].start_second,n[d].duration_second)){for(var u=n[d].start_second,c=n[d].time,l=0;l<c.length;l++)if(l===c.length-1||t>=a.a.accAdd(u,c[l])&&t<a.a.accAdd(u,c[l+1]))return"start"===i?{segmentIndex:d,chunkIndex:l,time:a.a.accAdd(u,c[l]),pos:n[d].pos[l].sPos}:{segmentIndex:d,chunkIndex:l,time:a.a.accAdd(u,c[l+1]),pos:n[d].pos[l].ePos}}else if("end"===i&&t===a.a.accAdd(n[d].start_second,n[d].duration_second)){var h=n[d].pos.length-1;return{segmentIndex:d,chunkIndex:h,time:a.a.accAdd(n[d].start_second,n[d].duration_second),pos:n[d].pos[h].ePos}}return null},getTSChunkSEPos:function(e,t,i){if(!e.hasOwnProperty("m3u8")||0===e.m3u8.length)return null;var a=e.m3u8;if(a[t]){var n=a[t].pos;if(i<a[t].pos.length)return{sPos:n[i].sPos,ePos:n[i].ePos}}return null},getTSDuratioSecond:function(e,t){var i=e.m3u8;return a.a.accAdd(i[t].duration_second,i[t].start_second)},getTSNextChunkInfo:function(e,t,i){var n=e.m3u8;return t>=n.length?null:i<n[t].pos.length-1?{segmentIndex:t,chunkIndex:i+=1,sTime:a.a.accAdd(n[t].start_second,n[t].time[i]),eTime:a.a.accAdd(n[t].start_second,n[t].time[i+1]),sPos:n[t].pos[i].sPos,ePos:n[t].pos[i].ePos}:t<n.length-1&&i>=n[t].pos.length-1?(i=0,{segmentIndex:t+=1,chunkIndex:0,sTime:a.a.accAdd(n[t].start_second,n[t].time[i]),eTime:a.a.accAdd(n[t].start_second,n[t].time[i+1]),sPos:n[t].pos[i].sPos,ePos:n[t].pos[i].ePos}):t>=n.length-1&&i>=n[t].pos.length-1?null:void 0},getCurTSChunkInfo:function(e,t,i){var n=e.m3u8;return n&&n[t]&&i<n[t].time.length-1?{segmentIndex:t,chunkIndex:i,sTime:a.a.accAdd(n[t].start_second,n[t].time[i]),eTime:a.a.accAdd(n[t].start_second,n[t].time[i+1]),sPos:n[t].pos[i].sPos,ePos:n[t].pos[i].ePos}:null}};t.a=r},function(e,t,i){"use strict";var a=i(33),n=i(156).indexOf,r=i(141),s=[].indexOf,o=!!s&&1/[1].indexOf(1,-0)<0,d=r("indexOf");a({target:"Array",proto:!0,forced:o||d},{indexOf:function(e){return o?s.apply(this,arguments)||0:n(this,e,arguments.length>1?arguments[1]:undefined)}})},function(e,t,i){"use strict";var a=i(166),n=i(187),r=i(79),s=i(106),o=i(131),d=i(181),u=i(74),c=i(168),l=i(180),h=i(31),_=[].push,f=Math.min,p=!h((function(){return!RegExp(4294967295,"y")}));a("split",2,(function(e,t,i){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var a=String(s(this)),r=i===undefined?4294967295:i>>>0;if(0===r)return[];if(e===undefined)return[a];if(!n(e))return t.call(a,e,r);for(var o,d,u,c=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,p=new RegExp(e.source,h+"g");(o=l.call(p,a))&&!((d=p.lastIndex)>f&&(c.push(a.slice(f,o.index)),o.length>1&&o.index<a.length&&_.apply(c,o.slice(1)),u=o[0].length,f=d,c.length>=r));)p.lastIndex===o.index&&p.lastIndex++;return f===a.length?!u&&p.test("")||c.push(""):c.push(a.slice(f)),c.length>r?c.slice(0,r):c}:"0".split(undefined,0).length?function(e,i){return e===undefined&&0===i?[]:t.call(this,e,i)}:t,[function(t,i){var n=s(this),r=t==undefined?undefined:t[e];return r!==undefined?r.call(t,n,i):a.call(String(n),t,i)},function(e,n){var s=i(a,e,this,n,a!==t);if(s.done)return s.value;var l=r(e),h=String(this),_=o(l,RegExp),g=l.unicode,m=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(p?"y":"g"),v=new _(p?l:"^(?:"+l.source+")",m),b=n===undefined?4294967295:n>>>0;if(0===b)return[];if(0===h.length)return null===c(v,h)?[h]:[];for(var y=0,k=0,T=[];k<h.length;){v.lastIndex=p?k:0;var S,P=c(v,p?h:h.slice(k));if(null===P||(S=f(u(v.lastIndex+(p?0:k)),h.length))===y)k=d(h,k,g);else{if(T.push(h.slice(y,k)),T.length===b)return T;for(var x=1;x<=P.length-1;x++)if(T.push(P[x]),T.length===b)return T;k=y=S}}return T.push(h.slice(y)),T}]}),!p)},function(e,t,i){"use strict";i(73),i(25);var a=i(42),n=i.n(a),r=i(26),s=i(99),o=i(38),d=document,u=function(){},c={},l={"*":"*/".concat("*"),text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},h={"*":null,text:null,html:null,xml:null,json:function(e){var t={},i=window.JSON?JSON.parse:function(){return{}};try{t=i(e)}catch(a){}return t}},_={method:"get",dataType:"*",timeout:1e4,charset:"utf-8",cache:!0,withCredentials:!0,jsonpCallback:"callback",complete:u,success:u,failure:u},f=function(e){var t=[];if("object"==n()(e))for(var i in e)t[t.length]=encodeURIComponent(i)+"="+encodeURIComponent(e[i]);return t.join("&").replace(/%20/g,"+")},p=function(e){e=e||{},Object(r.a)(e,_);var t=e.url,i=e.dataType,a=e.params||{},n=e.success,s=e.failure;if(t){!function(){var r={},d=e.headers,u=e.data||null,c=f(a);r.params=a,r.url=t+(c.length>0?(/\?/i.test(t)?"&":"?")+c:""),"function"==typeof e.beforeSend&&(r=e.beforeSend(r));var _=new XMLHttpRequest;if(_.withCredentials=e.withCredentials,_.onreadystatechange=function(){var a;if(g+=", readyState = "+_.readyState,4==_.readyState)if(a=h[i]?h[i](_.responseText):_.responseText,g+=", status = "+_.status+", statusText = "+_.statusText,200==_.status){if("json"===i&&"string"==typeof a)try{a=JSON.parse(a)}catch(d){console.error("res is not comfortable, ".concat(t),d)}n(a)}else if(!m){m=!0;var o="";try{o=JSON.stringify(a)}catch(d){o=" json error"}g+=", data = "+o+"url = "+r.url,s("xhr error, time = "+e.timeout+g)}},_.ontimeout=function(t){if(!m){m=!0;var i="xhr timeout, time = "+e.timeout+", readyState = "+_.readyState+", status = "+_.status+", data = "+JSON.stringify(t)+"url = "+r.url;s(i)}},_.open(e.method,r.url,!0),_.timeout=e.timeout,_.setRequestHeader("Accept",l[i]),o.a.isObject(d))for(var p in d)_.setRequestHeader(p,d[p]);_.send(u);var g="",m=!1}()}};t.a={serializeParam:f,ajax:p,json:function(e){e=e||{},Object(r.a)(e,_),e.dataType="json",p(e)},jsonp:function(e){e=e||{},Object(r.a)(e,_);var t=e.url,i=e.params||{},a=f(i),n=t+(a.length>0?(/\?/i.test(t)?"&":"?")+a:""),o=e.complete,u=e.success,l=e.failure,h="Q"+Object(s.a)(e.fixedCallback||n),p=!!e.memory,g=Object(s.a)(n),m=c[g];if(n){if(!(p&&m&&u)){var v,b=function(e,t,i){switch(y(),e){case"success":p&&(c[g]=i),u(i);break;case"fail":l(i,t)}o(i)},y=function(){if(window[h]){window[h]=undefined;try{delete window[h]}catch(e){}}};window[h]=function(e){y(),setTimeout((function(){b("success","200",e)}),0)};var k={},T=d.createElement("script");T.async=!0,T.type="text/javascript",T.charset=e.charset;var S=function(){if(T)try{T.onload(null,!0)}catch(e){}};T.abort=S,T.onload=T.onreadystatechange=function(e,t){(t||!T.readyState||/loaded|complete/.test(T.readyState))&&(T.onload=T.onreadystatechange=null,T.parentNode&&T.parentNode.removeChild(T),T=null,clearTimeout(v))},T.onerror=function(){b("fail",null),S()},v=setTimeout((function(){b("fail",408),S()}),e.timeout);var P={};return P[e.jsonpCallback]=h,Object(r.a)(i,P,!0),k.url=n+(/\?/i.test(n)?"&":"?")+f(P),k.params=i,"function"==typeof e.beforeSend&&(k=e.beforeSend(k)||k),T.src=k.url,d.getElementsByTagName("head")[0].appendChild(T),T}u(m)}},beacon:function(e,t,i){if("string"==typeof t){var a=i===undefined||i;if(e){var n=[];for(var r in a&&(e._=+new Date),e)n.push(r+"="+encodeURIComponent(e[r]));var s=t+"?"+n.join("&"),o=new Image;o.onload=o.onerror=o.onabort=function(){o.onload=o.onerror=o.onabort=null,o=null},o.src=s}}}}},function(e,t,i){"use strict";i(73),i(12),i(24),i(18),i(25);t.a={isBool:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e&&!isNaN(e)},isArray:function(e){return Array.isArray?Array.isArray(e):"[object array]"===Object.prototype.toString.call(e).toLowerCase()},isObject:function(e){return"[object object]"===Object.prototype.toString.call(e).toLowerCase()},formatMilliseconds:function(e){if(isNaN(e))return"00:00:00";var t=(e=Math.round(e))>=3600?Math.floor(e/3600):0,i=e%3600>=60?Math.floor(e%3600/60):0;return i=i>=10?i:"0"+i,e=(e=parseInt(i,10)>=0?e%3600%60:e)>=10?e:"0"+e,t>0?(t>9?t:"0"+t)+":"+i+":"+e:i+":"+e},protocolRevise:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return e.replace("http://","//").replace("https://","//").replace(".qiyipic",".iqiyipic")},hex2rgba:function(e){for(var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,i=[],a=1;a<e.length;){var n=e.substring(a,a+2);i.push(parseInt(n,16)),a+=2}return i.push(t),"rgba(".concat(i.join(","),")")}}},function(e,t,i){var a=i(30),n=i(130),r=i(92),s=i(165),o=i(186),d=i(215),u=n("wks"),c=a.Symbol,l=d?c:s;e.exports=function(e){return r(u,e)||(o&&r(c,e)?u[e]=c[e]:u[e]=l("Symbol."+e)),u[e]}},function(e,t,i){"use strict";var a=i(33),n=i(31),r=i(217),s=i(79),o=i(124),d=i(74),u=i(131),c=r.ArrayBuffer,l=r.DataView,h=c.prototype.slice;a({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:n((function(){return!new c(2).slice(1,undefined).byteLength}))},{slice:function(e,t){if(h!==undefined&&t===undefined)return h.call(s(this),e);for(var i=s(this).byteLength,a=o(e,i),n=o(t===undefined?i:t,i),r=new(u(this,c))(d(n-a)),_=new l(this),f=new l(r),p=0;a<n;)f.setUint8(p++,_.getUint8(a++));return r}})},function(e,t,i){"use strict";t.a={LoaderState_ready:"LoaderState_ready",LoaderState_progress:"LoaderState_progress",LoaderState_done:"LoaderState_done",LoaderState_error:"LoaderState_error",LoaderState_error_dispatch:"LoaderState_error_dispatch",LoaderState_error_load:"LoaderState_error_load",LoaderState_dataRangeError:"loadDataRangeError",LoaderState_lowSpeed:"LoaderState_lowpeed",AuthorState_authorOK:0,AuthorState_authorFailed:1,AuthorState_Start:2,AuthorState_Done:3,AuthorState_reload:4}},function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?e.exports=a=function(e){return i(e)}:e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},a(t)}e.exports=a},function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(73),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_reverse__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(256),core_js_modules_es_array_reverse__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_reverse__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_sort__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(185),core_js_modules_es_array_sort__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_sort__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(12),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(24),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(18),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(137),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(25),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(36),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_8__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(0),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_9__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_10__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(4),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_11__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(3),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_12__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__),_kit_dispatcher__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(77),_kit_cookie__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(19),_kit_http__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(37),_kit_md5__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(99),_kit_logger__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(17),_kit_platform__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(16),_kit_uuid__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(29),_res_authkey__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(127),_res_authkey__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(_res_authkey__WEBPACK_IMPORTED_MODULE_21__),_i18n__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(82),logger=new _kit_logger__WEBPACK_IMPORTED_MODULE_18__.a("user"),NoticedLoginInfo,REQUEST_KEY="w0JD89dhtS7BdPLU2",RESPONSE_KEY="-0J1d9d^ESd)9jSsja",_isNewUser=!_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("QC006"),_isBANSync=!1,_banType="",_heartBeatTimer=0,_heartBeatTime=0,_userLevel=0,_isActivation=!1,_tvid="",_agentType=1,_qdv=7;_agentType=_kit_platform__WEBPACK_IMPORTED_MODULE_19__.a.browser.iPad?23:_kit_platform__WEBPACK_IMPORTED_MODULE_19__.a.os.androidTablet?24:1;var preIsVip=!1,_userIpInfo="",requestVipTypesRetryTimes=0;_i18n__WEBPACK_IMPORTED_MODULE_22__.a.isTWLocale()&&(_agentType=_kit_platform__WEBPACK_IMPORTED_MODULE_19__.a.getAgentType(!0));var getUserInfo=function getUserInfo(){var userInfo={},p00002=_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00002");return null!==p00002&&""!==p00002&&(p00002=window.JSON?window.JSON.parse(p00002):eval("("+p00002+")"),userInfo.uid=p00002.uid,userInfo.name=p00002.nickname,userInfo.email=p00002.email),userInfo},checkVipStack=[],flushCallback=function(e){for(var t=0;t<checkVipStack.length;t++)checkVipStack[t](e);checkVipStack=[]},onHeartBeatTimer=function(){var e={authcookie:_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001"),agenttype:_agentType,device_id:_kit_uuid__WEBPACK_IMPORTED_MODULE_20__.a.getFluid(),ptid:getPTID(),tv_id:_tvid,tn:Math.random().toString().replace(".","")};_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.jsonp({url:"https://cmonitor.iqiyi.com/apis/cmonitor/keepalive.action",params:e,beforeSend:function(e){var t=[];for(var i in e.params)t.push(i+"="+e.params[i]);return e.url+="&sign="+function(e){e&&e.sort();for(var t="",i=0;i<e.length;i++)t+=e[i]+"|";return t+="jfaljluixn39012$#",t=Object(_kit_md5__WEBPACK_IMPORTED_MODULE_17__.a)(t)}(t),e},success:function(e){},failure:function(e){}})},getPTID=function(){return _kit_platform__WEBPACK_IMPORTED_MODULE_19__.a.getPtid(_i18n__WEBPACK_IMPORTED_MODULE_22__.a.isTWLocale())},addEvent=function(e,t,i){e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i)},_getVipTypesStack=[],_getVipTypesCallback=function(e){for(var t=0;t<_getVipTypesStack.length;t++)_getVipTypesStack[t](e);_getVipTypesStack=[]},isRequestVipTypes=!1,__QP0013=null,UserInfo=function(e){function t(){return _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_9___default()(this,t),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_11___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_12___default()(t).call(this))}return _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13___default()(t,e),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_10___default()(t,[{key:"isLogin",value:function(){return NoticedLoginInfo?NoticedLoginInfo.login:""!==this.getUid()}},{key:"getUid",value:function(){return getUserInfo().uid||""}},{key:"isBanned",value:function(){return _isBANSync}},{key:"getBanType",value:function(){return _banType}},{key:"passportCookie",value:function(){return NoticedLoginInfo&&NoticedLoginInfo.P00001?NoticedLoginInfo.P00001:_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001")||""}},{key:"isNewUser",value:function(){return _isNewUser}},{key:"setInfo",value:function(e){preIsVip=""!==__QP0013&&"0"!==__QP0013,!0===(NoticedLoginInfo=e).login||"true"===NoticedLoginInfo.login?NoticedLoginInfo.login=!0:NoticedLoginInfo.login=!1,_isBANSync=!1,_banType="",this.clearVipTypes(),this.emit("infoset")}},{key:"tvid",value:function(e){_tvid=e}},{key:"openHeartBeat",value:function(){1===_userLevel&&(_isActivation=!0,0===_heartBeatTimer&&(onHeartBeatTimer(),_heartBeatTimer=setInterval(onHeartBeatTimer,_heartBeatTime)))}},{key:"stopHeartBeat",value:function(){_isActivation=!1,0!==_heartBeatTimer&&(clearInterval(_heartBeatTimer),_heartBeatTimer=0)}},{key:"closeHeartBeat",value:function(){var e=+new Date,t=getPTID(),i={authcookie:_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001"),agenttype:_agentType,device_id:_kit_uuid__WEBPACK_IMPORTED_MODULE_20__.a.getFluid()||_kit_uuid__WEBPACK_IMPORTED_MODULE_20__.a.getJsuid(),tv_id:_tvid,ptid:t,version:"4.1.1",qd_v:_qdv,ts:e};_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.jsonp({url:"https://cmonitor.iqiyi.com/apis/cmonitor/off.action",params:i,beforeSend:function(e){var t=[];for(var i in e.params)t.push(i+"="+e.params[i]);try{var a=function(e){e&&e.sort();for(var t="",i=0;i<e.length;i++)i===e.length-1?t+=e[i]:t+=e[i]+"&";return t}(t);e.url+="&qd_sc="+_res_authkey__WEBPACK_IMPORTED_MODULE_21___default.a.cmd5x(a)}catch(n){}return logger.log(e.url),e},success:function(e){},failure:function(e){}})}},{key:"beforeunloadListener",value:function(){var e=this;addEvent(window,"beforeunload",(function(){e.isVip((function(t){t&&e.closeHeartBeat()}))}))}},{key:"checkVip",value:function(e){var t=this,i=getPTID();_i18n__WEBPACK_IMPORTED_MODULE_22__.a.isTWLocale()&&(_agentType=_kit_platform__WEBPACK_IMPORTED_MODULE_19__.a.getAgentType(!0)),_isBANSync=!1,_banType="";var a=_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001");checkVipStack.push(e),a?_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.jsonp({url:"https://cmonitor.iqiyi.com/apis/user/check_vip.action",params:{agenttype:_agentType,sign:Object(_kit_md5__WEBPACK_IMPORTED_MODULE_17__.a)(a.substring(4,36)+"|"+_agentType+"|"+REQUEST_KEY),authcookie:a,ptid:i,version:3},timeout:2e3,memory:!0,beforeSend:function(){t.emit("httpStart")},complete:function(){t.emit("httpComplete")},success:function(e){var t=!1;if(_userLevel=0,e)if("A00000"==e.code){var i=Object(_kit_md5__WEBPACK_IMPORTED_MODULE_17__.a)(a.substring(5,39).split("").reverse().join("")+"<"+_agentType+"<"+RESPONSE_KEY);try{t=e.data.sign===i}catch(r){}if(e.data&&e.data.keepalive&&t){_userLevel=1;var n=1e3*parseInt(e.data.keepalive,10);n>0&&(n<1e4&&(n=1e4),(0===_heartBeatTimer||0!==_heartBeatTimer&&n!==_heartBeatTime)&&(_heartBeatTime=n,_isActivation&&(clearInterval(_heartBeatTimer),onHeartBeatTimer(),_heartBeatTimer=0,_heartBeatTimer=setInterval(onHeartBeatTimer,_heartBeatTime))))}}else switch(e.code){case"A10001":case"A10002":case"A10004":_isBANSync=!0,_banType=e.code}flushCallback(t)},failure:function(e,t){_userLevel=0,408===t&&logger.warn("passport: timeout, check user vip fail!"),flushCallback(!0)}}):flushCallback(!1)}},{key:"isVip",value:function(e){this.getVipTypes((function(t){var i=t.join(",");e("0"!==i&&""!==i)}))}},{key:"getVipTypes",value:function(e){if(this.isLogin()||this.clearVipTypes(),_getVipTypesStack.push(e),!__QP0013){var t=(__QP0013=_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("QP0013")).match(/[0-9]/g)||[];__QP0013&&t.length!=__QP0013.replace(/,/g,"").length&&(__QP0013="")}if(__QP0013){var i=__QP0013.split(",");_getVipTypesCallback(i)}else isRequestVipTypes||(isRequestVipTypes=!0,this.requestVipTypes())}},{key:"updateVipTypes",value:function(){isRequestVipTypes||(isRequestVipTypes=!0,this.requestVipTypes())}},{key:"clearVipTypes",value:function(){isRequestVipTypes=!1,requestVipTypesRetryTimes=0,_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.set("QP0013","",{expires:1296e6,path:"/",domain:"iqiyi.com"}),__QP0013=null}},{key:"__isChangeVipState",value:function(e){this.isVip((function(t){logger.log("isChangeVipState! preIsVip:"+preIsVip+",curIsVip: "+t),e(preIsVip!=t)}))}},{key:"requestVipTypes",value:function(){var e=this,t=_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001");if(!this.isLogin()||!t)return isRequestVipTypes=!1,void _getVipTypesCallback([0]);t&&_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.ajax({url:"//vinfo.vip.iqiyi.com/external/vip_users",params:{P00001:_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001"),platform:getPTID(),version:"3.0",appVersion:"1.0",bizSource:"vip_web_player",messageId:_kit_uuid__WEBPACK_IMPORTED_MODULE_20__.a.createUUID(),vipTypes:_i18n__WEBPACK_IMPORTED_MODULE_22__.a.isTWLocale()?"5,6,7,8,10,13,14,16,18":"1,3,4,5,7,8,10,13,14,16,18"},timeout:2e3,memory:!0,success:function(t){isRequestVipTypes=!1;try{t=JSON.parse(t||{})}catch(s){logger.error("vip_users: parse Error"),e.requestVipTypesFailed()}if("A00000"===t.code){var i=t.data||{},a=[];for(var n in i){var r=i[n];r&&"1"==r.status&&a.push(r.vipType),r=null}a.length||a.push(0),__QP0013=a.join(","),_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.set("QP0013",__QP0013,{expires:1296e6,path:"/",domain:"iqiyi.com"}),logger.log("requset vipTypes success! viptypes is "+__QP0013),_getVipTypesCallback(a)}else e.requestVipTypesFailed()},failure:function(t,i){isRequestVipTypes=!1,e.requestVipTypesFailed()}})}},{key:"requestVipTypesFailed",value:function(){requestVipTypesRetryTimes>0?(__QP0013="1",logger.log("requset vipTypes failed! viptypes is "+__QP0013),_getVipTypesCallback([1])):(this.requestVipTypes(),requestVipTypesRetryTimes++)}},{key:"getUserIPInfo",value:function(e){_userIpInfo?e(_userIpInfo):_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.json({url:"//data.video.iqiyi.com/v.f4v",withCredentials:!1,timeout:2e3,memory:!0,success:function(t){_userIpInfo=t,e(t)},failure:function(t){e(t)}})}},{key:"reqVipTypes",value:function(e){var t=_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001");this.isLogin()&&t?t&&_kit_http__WEBPACK_IMPORTED_MODULE_16__.a.ajax({url:"//vinfo.vip.iqiyi.com/external/vip_users",params:{P00001:_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.get("P00001"),platform:getPTID(),version:"3.0",appVersion:"1.0",bizSource:"vip_web_player",messageId:_kit_uuid__WEBPACK_IMPORTED_MODULE_20__.a.createUUID(),vipTypes:_i18n__WEBPACK_IMPORTED_MODULE_22__.a.isTWLocale()?"5,6,7,8,10,13,14,16,18":"1,3,4,5,7,8,10,13,14,16,18"},timeout:2e3,memory:!0,success:function(t){try{t=JSON.parse(t||{})}catch(o){e([1])}if("A00000"===t.code){var i=t.data||{},a=[];for(var n in i){var r=i[n];r&&"1"==r.status&&a.push(parseInt(r.vipType)),r=null}a.length||a.push(0);var s=a.join(",");_kit_cookie__WEBPACK_IMPORTED_MODULE_15__.a.set("QP0013",s,{expires:1296e6,path:"/",domain:"iqiyi.com"}),e(a)}else e([1])},failure:function(){e([1])}}):e([0])}}]),t}(_kit_dispatcher__WEBPACK_IMPORTED_MODULE_14__.a);__webpack_exports__.a=new UserInfo},function(e,t,i){i(221)("Uint8",1,(function(e){return function(t,i,a){return e(this,t,i,a)}}))},function(e,t,i){"use strict";var a=i(72),n=i(278),r=a.aTypedArray;a.exportProto("copyWithin",(function(e,t){return n.call(r(this),e,t,arguments.length>2?arguments[2]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(110).every,r=a.aTypedArray;a.exportProto("every",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(218),r=a.aTypedArray;a.exportProto("fill",(function(e){return n.apply(r(this),arguments)}))},function(e,t,i){"use strict";var a=i(72),n=i(110).filter,r=i(131),s=a.aTypedArray,o=a.aTypedArrayConstructor;a.exportProto("filter",(function(e){for(var t=n(s(this),e,arguments.length>1?arguments[1]:undefined),i=r(this,this.constructor),a=0,d=t.length,u=new(o(i))(d);d>a;)u[a]=t[a++];return u}))},function(e,t,i){"use strict";var a=i(72),n=i(110).find,r=a.aTypedArray;a.exportProto("find",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(110).findIndex,r=a.aTypedArray;a.exportProto("findIndex",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(110).forEach,r=a.aTypedArray;a.exportProto("forEach",(function(e){n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(156).includes,r=a.aTypedArray;a.exportProto("includes",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(156).indexOf,r=a.aTypedArray;a.exportProto("indexOf",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(30),n=i(72),r=i(21),s=i(39)("iterator"),o=a.Uint8Array,d=r.values,u=r.keys,c=r.entries,l=n.aTypedArray,h=n.exportProto,_=o&&o.prototype[s],f=!!_&&("values"==_.name||_.name==undefined),p=function(){return d.call(l(this))};h("entries",(function(){return c.call(l(this))})),h("keys",(function(){return u.call(l(this))})),h("values",p,!f),h(s,p,!f)},function(e,t,i){"use strict";var a=i(72),n=a.aTypedArray,r=[].join;a.exportProto("join",(function(e){return r.apply(n(this),arguments)}))},function(e,t,i){"use strict";var a=i(72),n=i(253),r=a.aTypedArray;a.exportProto("lastIndexOf",(function(e){return n.apply(r(this),arguments)}))},function(e,t,i){"use strict";var a=i(72),n=i(110).map,r=i(131),s=a.aTypedArray,o=a.aTypedArrayConstructor;a.exportProto("map",(function(e){return n(s(this),e,arguments.length>1?arguments[1]:undefined,(function(e,t){return new(o(r(e,e.constructor)))(t)}))}))},function(e,t,i){"use strict";var a=i(72),n=i(241).left,r=a.aTypedArray;a.exportProto("reduce",(function(e){return n(r(this),e,arguments.length,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=i(241).right,r=a.aTypedArray;a.exportProto("reduceRight",(function(e){return n(r(this),e,arguments.length,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=a.aTypedArray,r=Math.floor;a.exportProto("reverse",(function(){for(var e,t=n(this).length,i=r(t/2),a=0;a<i;)e=this[a],this[a++]=this[--t],this[t]=e;return this}))},function(e,t,i){"use strict";var a=i(72),n=i(74),r=i(240),s=i(95),o=i(31),d=a.aTypedArray,u=o((function(){new Int8Array(1).set({})}));a.exportProto("set",(function(e){d(this);var t=r(arguments.length>1?arguments[1]:undefined,1),i=this.length,a=s(e),o=n(a.length),u=0;if(o+t>i)throw RangeError("Wrong length");for(;u<o;)this[t+u]=a[u++]}),u)},function(e,t,i){"use strict";var a=i(72),n=i(131),r=i(31),s=a.aTypedArray,o=a.aTypedArrayConstructor,d=[].slice,u=r((function(){new Int8Array(1).slice()}));a.exportProto("slice",(function(e,t){for(var i=d.call(s(this),e,t),a=n(this,this.constructor),r=0,u=i.length,c=new(o(a))(u);u>r;)c[r]=i[r++];return c}),u)},function(e,t,i){"use strict";var a=i(72),n=i(110).some,r=a.aTypedArray;a.exportProto("some",(function(e){return n(r(this),e,arguments.length>1?arguments[1]:undefined)}))},function(e,t,i){"use strict";var a=i(72),n=a.aTypedArray,r=[].sort;a.exportProto("sort",(function(e){return r.call(n(this),e)}))},function(e,t,i){"use strict";var a=i(72),n=i(74),r=i(124),s=i(131),o=a.aTypedArray;a.exportProto("subarray",(function(e,t){var i=o(this),a=i.length,d=r(e,a);return new(s(i,i.constructor))(i.buffer,i.byteOffset+d*i.BYTES_PER_ELEMENT,n((t===undefined?a:r(t,a))-d))}))},function(e,t,i){"use strict";var a=i(30),n=i(72),r=i(31),s=a.Int8Array,o=n.aTypedArray,d=[].toLocaleString,u=[].slice,c=!!s&&r((function(){d.call(new s(1))})),l=r((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!r((function(){s.prototype.toLocaleString.call([1,2])}));n.exportProto("toLocaleString",(function(){return d.apply(c?u.call(o(this)):o(this),arguments)}),l)},function(e,t,i){"use strict";var a=i(30),n=i(72),r=i(31),s=a.Uint8Array,o=s&&s.prototype,d=[].toString,u=[].join;r((function(){d.call({})}))&&(d=function(){return u.call(this)}),n.exportProto("toString",d,(o||{}).toString!=d)},function(e,t,i){"use strict";i.d(t,"g",(function(){return s})),i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return c})),i.d(t,"f",(function(){return l})),i.d(t,"a",(function(){return h})),i.d(t,"h",(function(){return _}));i(12),i(18);var a=i(42),n=i.n(a),r=Object.prototype.toString;function s(e){return!!e&&"object"==n()(e)}function o(e){return"[object map]"===Object.prototype.toString.call(e).toLowerCase()}function d(e){var t=n()(e);return null!=e&&"string"!==t&&"function"!==t&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)}function u(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return"{}"===JSON.stringify(e)}function c(e){return/^https/gi.test(e||window.location.protocol)}function l(e){return"number"==typeof e&&!isNaN(e)}function h(e){return s(e)&&"[object arraybuffer]"===r.call(e).toLowerCase()}function _(e){return s(e)&&"[object uint8array]"===r.call(e).toLowerCase()}},function(e,t,i){"use strict";var a=i(33),n=i(110).find,r=i(189),s=!0;"find"in[]&&Array(1).find((function(){s=!1})),a({target:"Array",proto:!0,forced:s},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:undefined)}}),r("find")},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",a=e[3];if(!a)return i;if(t&&"function"==typeof btoa){var n=(s=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),r=a.sources.map((function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"}));return[i].concat(r).concat([n]).join("\n")}var s;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},n=0;n<this.length;n++){var r=this[n][0];null!=r&&(a[r]=!0)}for(n=0;n<e.length;n++){var s=e[n];null!=s[0]&&a[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}},function(e,t,i){"use strict";i(94),i(98),i(84);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(13),d=[],u=function(){function e(){n()(this,e),this._events={}}return s()(e,[{key:"on",value:function(e,t,i){var a=[];return this._events||(this._events={}),i&&this._events[e]&&(a=this._events[e]),a.push(t),this._events[e]=a,this}},{key:"off",value:function(e,t){var i=this._events[e];if(t)for(var a=i?i.length:0;a--;)i[a]===t&&i.splice(a,1);else delete this._events[e];return this}},{key:"emit",value:function(){for(var e=this,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var n=i[0],r=[].slice.call(i,1),s=this._events[n];return s&&s.forEach((function(t){return t.apply(e,r)})),this}},{key:"once",value:function(e,t){var i=this;return this.on(e,(function a(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];t.apply(i,r),i.off(e,a)})),this}},{key:"clear",value:function(){delete this._events}}]),e}();t.a={getEvent:function(){return d[o.a.tvId]},newEvent:function(){return d[o.a.tvId]=new u,d[o.a.tvId]},clearEvent:function(e){d[e]&&d[e].clear()}}},function(e,t,i){"use strict";var a,n=i(87),r=i(30),s=i(85),o=i(92),d=i(160),u=i(96),c=i(103),l=i(93).f,h=i(207),_=i(174),f=i(39),p=i(165),g=r.DataView,m=g&&g.prototype,v=r.Int8Array,b=v&&v.prototype,y=r.Uint8ClampedArray,k=y&&y.prototype,T=v&&h(v),S=b&&h(b),P=Object.prototype,x=P.isPrototypeOf,I=f("toStringTag"),E=p("TYPED_ARRAY_TAG"),D=!(!r.ArrayBuffer||!g),w=D&&!!_&&"Opera"!==d(r.opera),A=!1,q={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},O=function(e){return s(e)&&o(q,d(e))};for(a in q)r[a]||(w=!1);if((!w||"function"!=typeof T||T===Function.prototype)&&(T=function(){throw TypeError("Incorrect invocation")},w))for(a in q)r[a]&&_(r[a],T);if((!w||!S||S===P)&&(S=T.prototype,w))for(a in q)r[a]&&_(r[a].prototype,S);if(w&&h(k)!==S&&_(k,S),n&&!o(S,I))for(a in A=!0,l(S,I,{get:function(){return s(this)?this[E]:undefined}}),q)r[a]&&u(r[a],E,a);D&&_&&h(m)!==P&&_(m,P),e.exports={NATIVE_ARRAY_BUFFER:D,NATIVE_ARRAY_BUFFER_VIEWS:w,TYPED_ARRAY_TAG:A&&E,aTypedArray:function(e){if(O(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(_){if(x.call(T,e))return e}else for(var t in q)if(o(q,a)){var i=r[t];if(i&&(e===i||x.call(i,e)))return e}throw TypeError("Target is not a typed array constructor")},exportProto:function(e,t,i){if(n){if(i)for(var a in q){var s=r[a];s&&o(s.prototype,e)&&delete s.prototype[e]}S[e]&&!i||c(S,e,i?t:w&&b[e]||t)}},exportStatic:function(e,t,i){var a,s;if(n){if(_){if(i)for(a in q)(s=r[a])&&o(s,e)&&delete s[e];if(T[e]&&!i)return;try{return c(T,e,i?t:w&&v[e]||t)}catch(d){}}for(a in q)!(s=r[a])||s[e]&&!i||c(s,e,t)}},isView:function(e){var t=d(e);return"DataView"===t||o(q,t)},isTypedArray:O,TypedArray:T,TypedArrayPrototype:S}},function(e,t,i){"use strict";var a=i(33),n=i(139),r=i(116),s=i(141),o=[].join,d=n!=Object,u=s("join",",");a({target:"Array",proto:!0,forced:d||u},{join:function(e){return o.call(r(this),e===undefined?",":e)}})},function(e,t,i){var a=i(107),n=Math.min;e.exports=function(e){return e>0?n(a(e),9007199254740991):0}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return s}));var a="iqp-big-mode",n="iqp-btn-disable",r="volumeup",s="volumedown"},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(5),h=i.n(l),_=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return h()(t,e),s()(t,[{key:"pipe",value:function(e){return this.on("reset",(function(){e.reset()})),this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),e}},{key:"unpipe",value:function(){return this.removeAllListeners("reset"),this.removeAllListeners("data"),this.removeAllListeners("done"),this}},{key:"push",value:function(e){this.emit("data",e)}},{key:"flush",value:function(e){this.emit("done",e)}},{key:"reset",value:function(){this.emit("reset")}}]),t}(i(80).a);t.a=_},function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i(89),i(143);var a,n=i(42),r=i.n(n),s=i(0),o=i.n(s),d=i(1),u=i.n(d),c=Object.create||function(e){var t=function(){};return t.prototype=e,new t},l=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return i},h=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}},_=20,f=function(){function e(){o()(this,e),this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=c(null),this._eventsCount=0),this._maxListeners=this._maxListeners||undefined}return u()(e,null,[{key:"listenerCount",value:function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):I.call(e,t)}}]),u()(e,[{key:"emit",value:function(e){var t,i,a,n,r,s,o="error"===e;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var d=new Error('Unhandled "error" event. ('+t+")");throw d.context=t,d}if(!(i=s[e]))return!1;var u="function"==typeof i;switch(a=arguments.length){case 1:m(i,u,this);break;case 2:v(i,u,this,arguments[1]);break;case 3:b(i,u,this,arguments[1],arguments[2]);break;case 4:y(i,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(a-1),r=1;r<a;r++)n[r-1]=arguments[r];k(i,u,this,n)}return!0}},{key:"on",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{highPriority:!1};return"object"!=r()(i)&&(i={}),T(this,e,t,i)}},{key:"once",value:function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,function(e,t,i){var a={fired:!1,wrapFn:undefined,target:e,type:t,listener:i},n=h.call(P,a);return n.listener=i,a.wrapFn=n,n}(this,e,t)),this}},{key:"off",value:function(e,t){return S.call(this,e,t)}},{key:"un",value:function(e,t){this.off(e,t)}},{key:"removeAllListeners",value:function(e){var t,i,a;if(!(i=this._events))return this;if(!i.off)return 0===arguments.length?(this._events=c(null),this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=c(null):delete i[e]),this;if(0===arguments.length){var n,r=l(i);for(a=0;a<r.length;++a)"off"!==(n=r[a])&&this.removeAllListeners(n);return this.removeAllListeners("off"),this._events=c(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.off(e,t);else if(t)for(a=t.length-1;a>=0;a--)this.off(e,t[a]);return this}},{key:"listeners",value:function(e){return x(this,e,!0)}},{key:"rawListeners",value:function(e){return x(this,e,!1)}},{key:"listenerCount",value:function(){return e.listenerCount.apply(this,arguments)}}]),e}();try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),a=0===p.x}catch(D){a=!1}function g(e){return e._maxListeners===undefined?f.defaultMaxListeners:e._maxListeners}function m(e,t,i){if(t)e.call(i);else for(var a=e.length,n=E(e,a),r=0;r<a;++r)try{n[r].call(i)}catch(s){console.error(s)}}function v(e,t,i,a){if(t)e.call(i,a);else for(var n=e.length,r=E(e,n),s=0;s<n;++s)try{r[s].call(i,a)}catch(o){console.error(o)}}function b(e,t,i,a,n){if(t)e.call(i,a,n);else for(var r=e.length,s=E(e,r),o=0;o<r;++o)try{s[o].call(i,a,n)}catch(d){console.error(d)}}function y(e,t,i,a,n,r){if(t)e.call(i,a,n,r);else for(var s=e.length,o=E(e,s),d=0;d<s;++d)try{o[d].call(i,a,n,r)}catch(u){console.error(u)}}function k(e,t,i,a){if(t)e.apply(i,a);else for(var n=e.length,r=E(e,n),s=0;s<n;++s)try{r[s].apply(i,a)}catch(o){console.error(o)}}function T(e,t,i){var a,n,s,o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},d={highPriority:!!o.highPriority};if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((n=e._events)?(n.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),n=e._events),s=n[t]):(n=e._events=c(null),e._eventsCount=0),s){if("function"==typeof s?s=n[t]=[s,i]:d.highPriority?s.shift(i):s.push(i),!s.warned&&(a=g(e))&&a>0&&s.length>a){s.warned=!0;var u=new Error("Possible Dispatcher memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,"object"===("undefined"==typeof console?"undefined":r()(console))&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else s=n[t]=i,++e._eventsCount;return e}function S(e,t){var i,a,n,r,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(a=this._events))return this;if(!(i=a[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=c(null):(delete a[e],a.off&&this.emit("off",e,i.listener||t));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){s=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(e,t){for(var i=t,a=i+1,n=e.length;a<n;i+=1,a+=1)e[i]=e[a];e.pop()}(i,n),1===i.length&&(a[e]=i[0]),a.off&&this.emit("off",e,s||t)}return this}function P(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function x(e,t,i){var a=e._events;if(!a)return[];var n=a[t];return n?"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):E(n,n.length):[]}function I(e){var t=this._events;if(t){var i=t[e];if("function"==typeof i)return 1;if(i)return i.length}return 0}function E(e,t){for(var i=new Array(t),a=0;a<t;++a)i[a]=e[a];return i}a?Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');_=e}}):f.defaultMaxListeners=_},function(e,t,i){e.exports=i(190)},function(e,t,i){var a=i(85);e.exports=function(e){if(!a(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i(89),i(143);var a,n=i(42),r=i.n(n),s=i(0),o=i.n(s),d=i(1),u=i.n(d),c=Object.create||function(e){var t=function(){};return t.prototype=e,new t},l=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return i},h=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}},_=10,f=function(){function e(){o()(this,e),this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=c(null),this._eventsCount=0),this._maxListeners=this._maxListeners||undefined}return u()(e,null,[{key:"listenerCount",value:function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):P.call(e,t)}}]),u()(e,[{key:"emit",value:function(e){var t,i,a,n,r,s,o="error"===e;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var d=new Error('Unhandled "error" event. ('+t+")");throw d.context=t,d}if(!(i=s[e]))return!1;var u="function"==typeof i;switch(a=arguments.length){case 1:g(i,u,this);break;case 2:m(i,u,this,arguments[1]);break;case 3:v(i,u,this,arguments[1],arguments[2]);break;case 4:b(i,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(n=new Array(a-1),r=1;r<a;r++)n[r-1]=arguments[r];y(i,u,this,n)}return!0}},{key:"on",value:function(t,i){return function(t,i,a){var n,s,o;if("function"!=typeof a)throw new TypeError('"listener" argument must be a function');(s=t._events)?(s.newListener&&(t.emit("newListener",i,a.listener?a.listener:a),s=t._events),o=s[i]):(s=t._events=c(null),t._eventsCount=0);if(o){if("function"==typeof o?o=s[i]=[o,a]:o.push(a),!o.warned&&(n=function(t){return t._maxListeners===undefined?e.defaultMaxListeners:t._maxListeners}(t))&&n>0&&o.length>n){o.warned=!0;var d=new Error("Possible Dispatcher memory leak detected. "+o.length+' "'+String(i)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');d.name="MaxListenersExceededWarning",d.emitter=t,d.type=i,d.count=o.length,"object"===("undefined"==typeof console?"undefined":r()(console))&&console.warn&&console.warn("%s: %s",d.name,d.message)}}else o=s[i]=a,++t._eventsCount;return t}(this,t,i)}},{key:"once",value:function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,function(e,t,i){var a={fired:!1,wrapFn:undefined,target:e,type:t,listener:i},n=h.call(T,a);return n.listener=i,a.wrapFn=n,n}(this,e,t)),this}},{key:"off",value:function(e,t){return k.call(this,e,t)}},{key:"removeAllListeners",value:function(e){var t,i,a;if(!(i=this._events))return this;if(!i.off)return 0===arguments.length?(this._events=c(null),this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=c(null):delete i[e]),this;if(0===arguments.length){var n,r=l(i);for(a=0;a<r.length;++a)"off"!==(n=r[a])&&this.removeAllListeners(n);return this.removeAllListeners("off"),this._events=c(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.off(e,t);else if(t)for(a=t.length-1;a>=0;a--)this.off(e,t[a]);return this}},{key:"listeners",value:function(e){return S(this,e,!0)}},{key:"rawListeners",value:function(e){return S(this,e,!1)}},{key:"listenerCount",value:function(){return e.listenerCount.apply(this,arguments)}}]),e}();try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),a=0===p.x}catch(I){a=!1}function g(e,t,i){if(t)e.call(i);else for(var a=e.length,n=x(e,a),r=0;r<a;++r)try{n[r].call(i)}catch(s){console.error(s)}}function m(e,t,i,a){if(t)e.call(i,a);else for(var n=e.length,r=x(e,n),s=0;s<n;++s)try{r[s].call(i,a)}catch(o){console.error(o)}}function v(e,t,i,a,n){if(t)e.call(i,a,n);else for(var r=e.length,s=x(e,r),o=0;o<r;++o)try{s[o].call(i,a,n)}catch(d){console.error(d)}}function b(e,t,i,a,n,r){if(t)e.call(i,a,n,r);else for(var s=e.length,o=x(e,s),d=0;d<s;++d)try{o[d].call(i,a,n,r)}catch(u){console.error(u)}}function y(e,t,i,a){if(t)e.apply(i,a);else for(var n=e.length,r=x(e,n),s=0;s<n;++s)try{r[s].apply(i,a)}catch(o){console.error(o)}}function k(e,t){var i,a,n,r,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(a=this._events))return this;if(!(i=a[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=c(null):(delete a[e],a.off&&this.emit("off",e,i.listener||t));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===t||i[r].listener===t){s=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(e,t){for(var i=t,a=i+1,n=e.length;a<n;i+=1,a+=1)e[i]=e[a];e.pop()}(i,n),1===i.length&&(a[e]=i[0]),a.off&&this.emit("off",e,s||t)}return this}function T(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function S(e,t,i){var a=e._events;if(!a)return[];var n=a[t];return n?"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):x(n,n.length):[]}function P(e){var t=this._events;if(t){var i=t[e];if("function"==typeof i)return 1;if(i)return i.length}return 0}function x(e,t){for(var i=new Array(t),a=0;a<t;++a)i[a]=e[a];return i}a?Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return _},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');_=e}}):f.defaultMaxListeners=_},function(e,t,i){"use strict";t.a=function a(e,t,i,n){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t&&function(e,t){var i;for(i in e)if(r(e,i)&&t(e[i],i))break}(t,(function(t,s){!i&&r(e,s)||(n&&"string"!=typeof t&&"boolean"!=typeof t?(e[s]||(e[s]={}),a(e[s],t,i,n)):e[s]=t)}));return e}},function(e,t,i){"use strict";t.a={locale:"cn_s",isTraditionalChinese:function(){var e=!1,t=this.locale;return"tw_t"!==t&&"cn_t"!==t||(e=!0),e},isTWLocale:function(){var e=!1,t=this.locale;return"tw_t"!==t&&"tw_s"!==t||(e=!0),e},local:function(){return this.locale},setLocale:function(e){this.locale=e}}},function(e,t,i){"use strict";i(35),i(21),i(94),i(40),i(12),i(24),i(97),i(102),i(36),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(91),i(201);var a=self.navigator.userAgent.toLowerCase(),n=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(firefox)[\/]([\w.]+)/.exec(a)||/(iemobile)[\/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],r=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(windows phone)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(android)/.exec(a)||/(windows)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||[],s={browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",majorVersion:n[4]||n[2]||"0",platform:r[0]||""},o={};if(s.browser){o[s.browser]=!0;var d=s.majorVersion.split(".");o.version={major:parseInt(s.majorVersion,10),string:s.version},d.length>1&&(o.version.minor=parseInt(d[1],10)),d.length>2&&(o.version.build=parseInt(d[2],10))}if(s.platform&&(o[s.platform]=!0),(o.chrome||o.opr||o.safari)&&(o.webkit=!0),o.rv||o.iemobile){o.rv&&delete o.rv;s.browser="msie",o.msie=!0}if(o.edge){delete o.edge;s.browser="msedge",o.msedge=!0}if(o.opr){s.browser="opera",o.opera=!0}if(o.safari&&o.android){s.browser="android",o.android=!0}o.name=s.browser,o.platform=s.platform,o.chrome&&o.version&&o.version.major<=44&&(Uint8Array.prototype.slice=function(e,t){return new Uint8Array(this.subarray(e,t))}),window.WebSocket=window.webSocket||window.WebSocket,window.URL=window.URL||window.webkitURL,window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,window.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,window.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate,t.a=Object.defineProperties({},{browser:{get:function(){return o},configurable:!0,enumerable:!0},isHTTPS:{get:function(){return/^https/gi.test(window.location.protocol)},configurable:!0,enumerable:!0},supportFetch:{get:function(){return window.fetch&&!o.msedge},configurable:!0,enumerable:!0},webSocket:{get:function(){return window.WebSocket},configurable:!0,enumerable:!0},dataVideo:{get:function(){return window.MediaSource&&window.URL},configurable:!0,enumerable:!0},canP2P:{get:function(){return!0===o.chrome&&window.RTCSessionDescription!==undefined&&window.RTCPeerConnection!==undefined&&window.RTCIceCandidate!==undefined},configurable:!0,enumerable:!0}})},function(e,t,i){var a=i(30),n=i(208),r=i(238),s=i(96);for(var o in n){var d=a[o],u=d&&d.prototype;if(u&&u.forEach!==r)try{s(u,"forEach",r)}catch(c){u.forEach=r}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,i){"use strict";t.a={UpdateDash:"update.dash",DisPatchStatus:"disPatch.status",LoadStatus:"cdnTaskLoader.loadStatus",DisLoadStatus:"dispatchLoader.status",CdnNodeMgrStateChange:"cdnNodeMgr.stateChange"}},function(e,t,i){var a=i(31);e.exports=!a((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,i){"use strict";t.a={DASH:"DASH",CKNSP:"CKNSP",QVS:"QVS",QVSR:"QVSR",AD:"AD",IVG:"IVG",P00001:"P00001",P00002:"P00002",P00003:"P00003",P00004:"P00004",P00005:"P00005",P00006:"P00006",P00007:"P00007",P07001:"P07001",IV0001:"IV0001",dataKeyMap:{A00001:2,A00101:2,A00302:32,A00301:31,U00001:22,P00001:101,P00002:102,P00007:12,304:10,401:10,405:10,406:10,493:10,411:9,491:9,501:12,502:13,505:15,506:15,601:14,602:14,701:14,702:14,706:14,711:14,Q00312:22,Q00311:22,Q00501:22,P00005:21,P07001:7001},keyMap:{1:{title:"error_code_title1",desc:"error_code_desc1"},2:"error_code_desc2",6:"error_code_desc6",7:"error_code_desc7",9:{title:"error_code_title9",desc:"&nbsp;"},10:{title:"error_code_title10",desc:"&nbsp;"},11:"error_code_desc11",12:{title:"error_code_title12",desc:"error_code_desc12"},13:{title:"error_code_title13",desc:"error_code_desc12"},14:{title:"error_code_title14",desc:"error_code_desc14"},15:{title:"本视频仅限爱奇艺站点播放，请至爱奇艺网站观看",desc:"&nbsp;"},21:"error_code_desc21",22:{title:"error_code_desc22",desc:"&nbsp;"},31:{title:"error_private_selfsee",desc:"&nbsp;"},32:{title:"error_private_video",desc:"&nbsp;"},101:"error_code_desc_http",102:"error_code_desc_http",301:{title:"error_code_title301",desc:"&nbsp;"},7001:"error_code_desc_ad"}}},function(e,t,i){var a=i(87),n=i(93).f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/;!a||"name"in r||n(r,"name",{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(e){return""}}})},function(e,t,i){"use strict";var a={},n={},r={},s=0,o={getItem:function(e){return a[e]},setItem:function(e,t){a[e]=t},removeItem:function(e){delete a[e]}},d=function(){try{return window.localStorage.setItem("_Q_test_",1),window.localStorage.removeItem("_Q_test_"),window.localStorage}catch(e){}return o}(),u=function(){0===s&&(clearTimeout(s),s=setTimeout((function(){for(var e in s=0,n)d.setItem(e,n[e]),delete n[e];for(var t in r)d.removeItem(t),delete r[key]}),1e3))};t.a={PLAYER_VD_KEY:"QiyiPlayerVD",read:function(e){return a[e]||(a[e]=d.getItem(e)),a[e]},write:function(e,t){a[e]=t,n[e]=t,u()},remove:function(e){delete a[e],r[e]=0,u()}}},function(e,t,i){var a=i(30),n=i(208),r=i(21),s=i(96),o=i(39),d=o("iterator"),u=o("toStringTag"),c=r.values;for(var l in n){var h=a[l],_=h&&h.prototype;if(_){if(_[d]!==c)try{s(_,d,c)}catch(p){_[d]=c}if(_[u]||s(_,u,l),n[l])for(var f in r)if(_[f]!==r[f])try{s(_,f,r[f])}catch(p){_[f]=r[f]}}}},function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,i){var a=i(87),n=i(192),r=i(79),s=i(129),o=Object.defineProperty;t.f=a?o:function(e,t,i){if(r(e),t=s(t,!0),r(i),n)try{return o(e,t,i)}catch(a){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},function(e,t,i){"use strict";var a=i(33),n=i(85),r=i(158),s=i(124),o=i(74),d=i(116),u=i(147),c=i(140),l=i(39)("species"),h=[].slice,_=Math.max;a({target:"Array",proto:!0,forced:!c("slice")},{slice:function(e,t){var i,a,c,f=d(this),p=o(f.length),g=s(e,p),m=s(t===undefined?p:t,p);if(r(f)&&("function"!=typeof(i=f.constructor)||i!==Array&&!r(i.prototype)?n(i)&&null===(i=i[l])&&(i=undefined):i=undefined,i===Array||i===undefined))return h.call(f,g,m);for(a=new(i===undefined?Array:i)(_(m-g,0)),c=0;g<m;g++,c++)g in f&&u(a,c,f[g]);return a.length=c,a}})},function(e,t,i){var a=i(106);e.exports=function(e){return Object(a(e))}},function(e,t,i){var a=i(87),n=i(93),r=i(126);e.exports=a?function(e,t,i){return n.f(e,t,r(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){"use strict";var a,n,r,s,o=i(33),d=i(146),u=i(30),c=i(123),l=i(265),h=i(103),_=i(196),f=i(130),p=i(144),g=i(177),m=i(85),v=i(136),b=i(161),y=i(113),k=i(231),T=i(206),S=i(131),P=i(233).set,x=i(266),I=i(267),E=i(268),D=i(235),w=i(269),A=i(119),q=i(157),O=i(39),L=i(183),C=O("species"),M="Promise",R=A.get,B=A.set,N=A.getterFor(M),F=l,U=u.TypeError,V=u.document,H=u.process,W=f("inspectSource"),j=c("fetch"),G=D.f,z=G,K="process"==y(H),Y=!!(V&&V.createEvent&&u.dispatchEvent),Q=q(M,(function(){if(!(W(F)!==String(F))){if(66===L)return!0;if(!K&&"function"!=typeof PromiseRejectionEvent)return!0}if(d&&!F.prototype["finally"])return!0;if(L>=51&&/native code/.test(F))return!1;var e=F.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[C]=t,!(e.then((function(){}))instanceof t)})),J=Q||!T((function(e){F.all(e)["catch"]((function(){}))})),X=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Z=function(e,t,i){if(!t.notified){t.notified=!0;var a=t.reactions;x((function(){for(var n=t.value,r=1==t.state,s=0;a.length>s;){var o,d,u,c=a[s++],l=r?c.ok:c.fail,h=c.resolve,_=c.reject,f=c.domain;try{l?(r||(2===t.rejection&&ie(e,t),t.rejection=1),!0===l?o=n:(f&&f.enter(),o=l(n),f&&(f.exit(),u=!0)),o===c.promise?_(U("Promise-chain cycle")):(d=X(o))?d.call(o,h,_):h(o)):_(n)}catch(p){f&&!u&&f.exit(),_(p)}}t.reactions=[],t.notified=!1,i&&!t.rejection&&ee(e,t)}))}},$=function(e,t,i){var a,n;Y?((a=V.createEvent("Event")).promise=t,a.reason=i,a.initEvent(e,!1,!0),u.dispatchEvent(a)):a={promise:t,reason:i},(n=u["on"+e])?n(a):"unhandledrejection"===e&&E("Unhandled promise rejection",i)},ee=function(e,t){P.call(u,(function(){var i,a=t.value;if(te(t)&&(i=w((function(){K?H.emit("unhandledRejection",a,e):$("unhandledrejection",e,a)})),t.rejection=K||te(t)?2:1,i.error))throw i.value}))},te=function(e){return 1!==e.rejection&&!e.parent},ie=function(e,t){P.call(u,(function(){K?H.emit("rejectionHandled",e):$("rejectionhandled",e,t.value)}))},ae=function(e,t,i,a){return function(n){e(t,i,n,a)}},ne=function(e,t,i,a){t.done||(t.done=!0,a&&(t=a),t.value=i,t.state=2,Z(e,t,!0))},re=function(e,t,i,a){if(!t.done){t.done=!0,a&&(t=a);try{if(e===i)throw U("Promise can't be resolved itself");var n=X(i);n?x((function(){var a={done:!1};try{n.call(i,ae(re,e,a,t),ae(ne,e,a,t))}catch(r){ne(e,a,r,t)}})):(t.value=i,t.state=1,Z(e,t,!1))}catch(r){ne(e,{done:!1},r,t)}}};Q&&(F=function(e){b(this,F,M),v(e),a.call(this);var t=R(this);try{e(ae(re,this,t),ae(ne,this,t))}catch(i){ne(this,t,i)}},(a=function(e){B(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:undefined})}).prototype=_(F.prototype,{then:function(e,t){var i=N(this),a=G(S(this,F));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=K?H.domain:undefined,i.parent=!0,i.reactions.push(a),0!=i.state&&Z(this,i,!1),a.promise},"catch":function(e){return this.then(undefined,e)}}),n=function(){var e=new a,t=R(e);this.promise=e,this.resolve=ae(re,e,t),this.reject=ae(ne,e,t)},D.f=G=function(e){return e===F||e===r?new n(e):z(e)},d||"function"!=typeof l||(s=l.prototype.then,h(l.prototype,"then",(function(e,t){var i=this;return new F((function(e,t){s.call(i,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof j&&o({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return I(F,j.apply(u,arguments))}}))),o({global:!0,wrap:!0,forced:Q},{Promise:F}),p(F,M,!1,!0),g(M),r=c(M),o({target:M,stat:!0,forced:Q},{reject:function(e){var t=G(this);return t.reject.call(undefined,e),t.promise}}),o({target:M,stat:!0,forced:d||Q},{resolve:function(e){return I(d&&this===r?F:this,e)}}),o({target:M,stat:!0,forced:J},{all:function(e){var t=this,i=G(t),a=i.resolve,n=i.reject,r=w((function(){var i=v(t.resolve),r=[],s=0,o=1;k(e,(function(e){var d=s++,u=!1;r.push(undefined),o++,i.call(t,e).then((function(e){u||(u=!0,r[d]=e,--o||a(r))}),n)})),--o||a(r)}));return r.error&&n(r.value),i.promise},race:function(e){var t=this,i=G(t),a=i.reject,n=w((function(){var n=v(t.resolve);k(e,(function(e){n.call(t,e).then(i.resolve,a)}))}));return n.error&&a(n.value),i.promise}})},function(e,t,i){"use strict";var a=i(33),n=i(124),r=i(107),s=i(74),o=i(95),d=i(173),u=i(147),c=i(140),l=Math.max,h=Math.min;a({target:"Array",proto:!0,forced:!c("splice")},{splice:function(e,t){var i,a,c,_,f,p,g=o(this),m=s(g.length),v=n(e,m),b=arguments.length;if(0===b?i=a=0:1===b?(i=0,a=m-v):(i=b-2,a=h(l(r(t),0),m-v)),m+i-a>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(c=d(g,a),_=0;_<a;_++)(f=v+_)in g&&u(c,_,g[f]);if(c.length=a,i<a){for(_=v;_<m-a;_++)p=_+i,(f=_+a)in g?g[p]=g[f]:delete g[p];for(_=m;_>m-a+i;_--)delete g[_-1]}else if(i>a)for(_=m-a;_>v;_--)p=_+i-1,(f=_+a-1)in g?g[p]=g[f]:delete g[p];for(_=0;_<i;_++)g[_+v]=arguments[_+2];return g.length=m-a+i,c}})},function(e,t,i){"use strict";function a(e,t,i,a,n,r){return d(function(e,t){return e<<t|e>>>32-t}(d(d(t,e),d(a,r)),n),i)}function n(e,t,i,n,r,s,o){return a(t&i|~t&n,e,t,r,s,o)}function r(e,t,i,n,r,s,o){return a(t&n|i&~n,e,t,r,s,o)}function s(e,t,i,n,r,s,o){return a(t^i^n,e,t,r,s,o)}function o(e,t,i,n,r,s,o){return a(i^(t|~n),e,t,r,s,o)}function d(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}t.a=function(e){return function(e){for(var t="0123456789abcdef",i="",a=0;a<4*e.length;a++)i+=t.charAt(e[a>>2]>>a%4*8+4&15)+t.charAt(e[a>>2]>>a%4*8&15);return i}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,a=-271733879,u=-1732584194,c=271733878,l=0;l<e.length;l+=16){var h=i,_=a,f=u,p=c;i=n(i,a,u,c,e[l+0],7,-680876936),c=n(c,i,a,u,e[l+1],12,-389564586),u=n(u,c,i,a,e[l+2],17,606105819),a=n(a,u,c,i,e[l+3],22,-1044525330),i=n(i,a,u,c,e[l+4],7,-176418897),c=n(c,i,a,u,e[l+5],12,1200080426),u=n(u,c,i,a,e[l+6],17,-1473231341),a=n(a,u,c,i,e[l+7],22,-45705983),i=n(i,a,u,c,e[l+8],7,1770035416),c=n(c,i,a,u,e[l+9],12,-1958414417),u=n(u,c,i,a,e[l+10],17,-42063),a=n(a,u,c,i,e[l+11],22,-1990404162),i=n(i,a,u,c,e[l+12],7,1804603682),c=n(c,i,a,u,e[l+13],12,-40341101),u=n(u,c,i,a,e[l+14],17,-1502002290),i=r(i,a=n(a,u,c,i,e[l+15],22,1236535329),u,c,e[l+1],5,-165796510),c=r(c,i,a,u,e[l+6],9,-1069501632),u=r(u,c,i,a,e[l+11],14,643717713),a=r(a,u,c,i,e[l+0],20,-373897302),i=r(i,a,u,c,e[l+5],5,-701558691),c=r(c,i,a,u,e[l+10],9,38016083),u=r(u,c,i,a,e[l+15],14,-660478335),a=r(a,u,c,i,e[l+4],20,-405537848),i=r(i,a,u,c,e[l+9],5,568446438),c=r(c,i,a,u,e[l+14],9,-1019803690),u=r(u,c,i,a,e[l+3],14,-187363961),a=r(a,u,c,i,e[l+8],20,1163531501),i=r(i,a,u,c,e[l+13],5,-1444681467),c=r(c,i,a,u,e[l+2],9,-51403784),u=r(u,c,i,a,e[l+7],14,1735328473),i=s(i,a=r(a,u,c,i,e[l+12],20,-1926607734),u,c,e[l+5],4,-378558),c=s(c,i,a,u,e[l+8],11,-2022574463),u=s(u,c,i,a,e[l+11],16,1839030562),a=s(a,u,c,i,e[l+14],23,-35309556),i=s(i,a,u,c,e[l+1],4,-1530992060),c=s(c,i,a,u,e[l+4],11,1272893353),u=s(u,c,i,a,e[l+7],16,-155497632),a=s(a,u,c,i,e[l+10],23,-1094730640),i=s(i,a,u,c,e[l+13],4,681279174),c=s(c,i,a,u,e[l+0],11,-358537222),u=s(u,c,i,a,e[l+3],16,-722521979),a=s(a,u,c,i,e[l+6],23,76029189),i=s(i,a,u,c,e[l+9],4,-640364487),c=s(c,i,a,u,e[l+12],11,-421815835),u=s(u,c,i,a,e[l+15],16,530742520),i=o(i,a=s(a,u,c,i,e[l+2],23,-995338651),u,c,e[l+0],6,-198630844),c=o(c,i,a,u,e[l+7],10,1126891415),u=o(u,c,i,a,e[l+14],15,-1416354905),a=o(a,u,c,i,e[l+5],21,-57434055),i=o(i,a,u,c,e[l+12],6,1700485571),c=o(c,i,a,u,e[l+3],10,-1894986606),u=o(u,c,i,a,e[l+10],15,-1051523),a=o(a,u,c,i,e[l+1],21,-2054922799),i=o(i,a,u,c,e[l+8],6,1873313359),c=o(c,i,a,u,e[l+15],10,-30611744),u=o(u,c,i,a,e[l+6],15,-1560198380),a=o(a,u,c,i,e[l+13],21,1309151649),i=o(i,a,u,c,e[l+4],6,-145523070),c=o(c,i,a,u,e[l+11],10,-1120210379),u=o(u,c,i,a,e[l+2],15,718787259),a=o(a,u,c,i,e[l+9],21,-343485551),i=d(i,h),a=d(a,_),u=d(u,f),c=d(c,p)}return Array(i,a,u,c)}(function(e){for(var t=Array(),i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t}(e),8*e.length))}},function(e,t,i){"use strict";var a=i(33),n=i(110).map;a({target:"Array",proto:!0,forced:!i(140)("map")},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:undefined)}})},function(e,t,i){"use strict";t.a=Object.defineProperties({loader:{all:0,count:0,message:""},dispatcher:{all:0,count:0,message:""},errorFragment:null},{errorMessage:{get:function(){return"[ loader:"+this.loader.message+" , dispatcher:"+this.dispatcher.message+"]"},configurable:!0,enumerable:!0}})},function(e,t,i){"use strict";var a=i(188).charAt,n=i(119),r=i(216),s=n.set,o=n.getterFor("String Iterator");r(String,"String",(function(e){s(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=o(this),i=t.string,n=t.index;return n>=i.length?{value:undefined,done:!0}:(e=a(i,n),t.index+=e.length,{value:e,done:!1})}))},function(e,t,i){var a=i(30),n=i(130),r=i(96),s=i(92),o=i(170),d=i(193),u=i(119),c=u.get,l=u.enforce,h=String(d).split("toString");n("inspectSource",(function(e){return d.call(e)})),(e.exports=function(e,t,i,n){var d=!!n&&!!n.unsafe,u=!!n&&!!n.enumerable,c=!!n&&!!n.noTargetGet;"function"==typeof i&&("string"!=typeof t||s(i,"name")||r(i,"name",t),l(i).source=h.join("string"==typeof t?t:"")),e!==a?(d?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=i:r(e,t,i)):u?e[t]=i:o(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||d.call(this)}))},function(e,t,i){"use strict";t.a={MANIFEST:0,DISPATCH:1,SEGMENT:2,LICENSE:3,APP:4}},function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));i(23),i(35),i(73),i(109),i(12),i(118),i(18),i(137),i(25),i(36);var a=i(42),n=i.n(a),r=i(0),s=i.n(r),o=i(1),d=i.n(o),u=1,c=2,l=3,h=4,_=5,f=6,p=7,g=function(){function e(t){s()(this,e),this._encodedQuery=t||null,this.count_=null}return d()(e,[{key:"ensureKeyMapInitialized_",value:function(){if(!this.keyMap_&&(this.keyMap_={},this.count_=0,this._encodedQuery))for(var e=this._encodedQuery.split("&"),t=0;t<e.length;t++){var i=e[t].indexOf("="),a=null,n=null;i>=0?(a=e[t].substring(0,i),n=e[t].substring(i+1)):a=e[t],a=decodeURIComponent(a.replace(/\+/g," ")),n=n||"",this.add(a,decodeURIComponent(n.replace(/\+/g," ")))}}},{key:"getCount",value:function(){return this.ensureKeyMapInitialized_(),this.count_}},{key:"add",value:function(e,t){this.ensureKeyMapInitialized_(),this._encodedQuery=null;var i=this.keyMap_.hasOwnProperty(e)&&this.keyMap_[e];return i||(this.keyMap_[e]=i=[]),i.push(t),this.count_++,this}},{key:"update",value:function(e,t){return this.ensureKeyMapInitialized_(),this._encodedQuery=null,(this.keyMap_[e]=[]).push(t),this}},{key:"get",value:function(e){return this.ensureKeyMapInitialized_(),this.keyMap_[e]}},{key:"clone",value:function(){var t=new e;if(t._encodedQuery=this._encodedQuery,this.keyMap_){var i={};for(var a in this.keyMap_)i[a]=this.keyMap_[a].concat();t.keyMap_=i,t.count_=this.count_}return t}},{key:"toString",value:function(){if(this._encodedQuery)return this._encodedQuery;if(!this.keyMap_)return"";var e=[];for(var t in this.keyMap_)for(var i=encodeURIComponent(t),a=this.keyMap_[t],n=0;n<a.length;n++){var r=i;r+="="+encodeURIComponent(a[n]),e.push(r)}return this._encodedQuery=e.join("&")}},{key:"toDecodedString",value:function(){return m.decodeOrEmpty(this.toString())}}]),e}(),m=function(){function e(t){var i;s()(this,e),this._scheme="",this._domain="",this._port="",this._userInfo="",this._path="",this._query=new g,this._hash="",this._reDisallowedInQuery=/[\#\?@]/g,this._reDisallowedInSchemeOrUserInfo=/[#\/\?@]/g,this._reDisallowedInRelativePath=/[\#\?:]/g,this._reDisallowedInAbsolutePath=/[\#\?]/g,this._reDisallowedInFragment=/#/g,"object"===n()(t)&&t instanceof e?(this.setScheme(t.scheme),this.setUserInfo(t.userInfo),this.setDomain(t.domain),this.setPort(t.port),this.setPath(t.path),this.setQueryData(t.query.clone()),this.setHash(t.hash)):t&&(i=this.split(String(t)))?(this.setScheme(i[u]||"",!0),this.setUserInfo(i[c]||"",!0),this.setDomain(i[l]||"",!0),this.setPort(i[h]),this.setPath(i[_]||"",!0),this.setQueryData(i[f]||"",!0),this.setHash(i[p]||"",!0)):this._query=new g(null,null)}return d()(e,[{key:"scheme",get:function(){return this._scheme}},{key:"domain",get:function(){return this._domain}},{key:"port",get:function(){return this._port}},{key:"userInfo",get:function(){return this._userInfo}},{key:"path",get:function(){return this._path}},{key:"hash",get:function(){return this._hash}},{key:"query",get:function(){return this._query}}],[{key:"decodeOrEmpty",value:function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}}]),d()(e,[{key:"setScheme",value:function(t,i){return this._scheme=i?e.decodeOrEmpty(t,!0):t,this._scheme&&(this._scheme=this._scheme.replace(/:$/,"")),this}},{key:"toString",value:function(){var e=[],t=this.scheme;t&&e.push(this._encodeSpecialChars(t,this._reDisallowedInSchemeOrUserInfo,!0),":");var i=this.getDomain();if(i){e.push("//");var a=this.userInfo;a&&e.push(this._encodeSpecialChars(a,this._reDisallowedInSchemeOrUserInfo,!0),"@"),e.push(this._removeDoubleEncoding(encodeURIComponent(i)));var n=this.port;null!=n&&e.push(":",String(n))}var r=this.path;r&&(this.hasDomain()&&"/"!=r.charAt(0)&&e.push("/"),e.push(this._encodeSpecialChars(r,"/"==r.charAt(0)?this._reDisallowedInAbsolutePath:this._reDisallowedInRelativePath,!0)));var s=this.getEncodedQuery();s&&e.push("?",s);var o=this.hash;return o&&e.push("#",this._encodeSpecialChars(o,this._reDisallowedInFragment)),e.join("")}},{key:"split",value:function(e){var t=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");return e.match(t)}},{key:"setUserInfo",value:function(t,i){return this._userInfo=i?e.decodeOrEmpty(t):t,this}},{key:"hasDomain",value:function(){return!!this._domain}},{key:"setDomain",value:function(t,i){return this._domain=i?e.decodeOrEmpty(t,!0):t,this}},{key:"getDomain",value:function(){return this._domain}},{key:"setPort",value:function(e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);this._port=e}else this._port=null;return this}},{key:"setPath",value:function(t,i){return this._path=i?e.decodeOrEmpty(t,!0):t,this}},{key:"setQueryData",value:function(e,t){return"object"===n()(e)&&e instanceof g?this._query=e:(t||(e=this._encodeSpecialChars(e,this._reDisallowedInQuery)),this._query=new g(e,null)),this}},{key:"getEncodedQuery",value:function(){return this._query.toString()}},{key:"setHash",value:function(t,i){return this._hash=i?e.decodeOrEmpty(t):t,this}},{key:"_encodeSpecialChars",value:function(e,t,i){if("string"==typeof e){var a=encodeURI(e).replace(t,this._encodeChar);return i&&(a=this._removeDoubleEncoding(a)),a}return null}},{key:"_encodeChar",value:function(e){var t=e.charCodeAt(0);return"%"+(t>>4&15).toString(16)+(15&t).toString(16)}},{key:"_removeDoubleEncoding",value:function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")}}]),e}()},function(e,t){e.exports=function(e){if(e==undefined)throw TypeError("Can't call method on "+e);return e}},function(e,t){var i=Math.ceil,a=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?a:i)(e)}},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(4),s=i.n(r),o=i(3),d=i.n(o),u=i(1),c=i.n(u),l=i(5),h=i.n(l),_=i(28),f=i(259),p=function(e){function t(e){var i;return n()(this,t),(i=s()(this,d()(t).call(this,e)))._startTime=null,i._duration=0,i}return h()(t,e),c()(t,[{key:"startTime",get:function(){return this._startTime},set:function(e){this._startTime=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}}]),t}(i(260).a);p.TYPES=f.a,p.ORIGINS=_.a,t.a=p},function(e,t,i){"use strict";var a=i(87),n=i(30),r=i(157),s=i(103),o=i(92),d=i(113),u=i(184),c=i(129),l=i(31),h=i(142),_=i(134).f,f=i(128).f,p=i(93).f,g=i(159).trim,m=n.Number,v=m.prototype,b="Number"==d(h(v)),y=function(e){var t,i,a,n,r,s,o,d,u=c(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=g(u)).charCodeAt(0))||45===t){if(88===(i=u.charCodeAt(2))||120===i)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+u}for(s=(r=u.slice(2)).length,o=0;o<s;o++)if((d=r.charCodeAt(o))<48||d>n)return NaN;return parseInt(r,a)}return+u};if(r("Number",!m(" 0o1")||!m("0b1")||m("+0x1"))){for(var k,T=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof T&&(b?l((function(){v.valueOf.call(i)})):"Number"!=d(i))?u(new m(y(t)),i,T):y(t)},S=a?_(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),P=0;S.length>P;P++)o(m,k=S[P])&&!o(T,k)&&p(T,k,f(m,k));T.prototype=v,v.constructor=T,s(n,"Number",T)}},function(e,t,i){var a=i(135),n=i(139),r=i(95),s=i(74),o=i(173),d=[].push,u=function(e){var t=1==e,i=2==e,u=3==e,c=4==e,l=6==e,h=5==e||l;return function(_,f,p,g){for(var m,v,b=r(_),y=n(b),k=a(f,p,3),T=s(y.length),S=0,P=g||o,x=t?P(_,T):i?P(_,0):undefined;T>S;S++)if((h||S in y)&&(v=k(m=y[S],S,b),e))if(t)x[S]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return S;case 2:d.call(x,m)}else if(c)return!1;return l?-1:u||c?c:x}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(e,t,i){var a=i(252);function n(t,i,r){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=n=Reflect.get:e.exports=n=function(e,t,i){var n=a(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}},n(t,i,r||t)}e.exports=n},function(e,t,i){var a=i(282),n=i(283),r=i(284);e.exports=function(e,t){return a(e)||n(e,t)||r()}},function(e,t){var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,i){"use strict";var a=i(33),n=i(107),r=i(227),s=i(228),o=i(31),d=1..toFixed,u=Math.floor,c=function(e,t,i){return 0===t?i:t%2==1?c(e,t-1,i*e):c(e*e,t/2,i)};a({target:"Number",proto:!0,forced:d&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){d.call({})}))},{toFixed:function(e){var t,i,a,o,d=r(this),l=n(e),h=[0,0,0,0,0,0],_="",f="0",p=function(e,t){for(var i=-1,a=t;++i<6;)a+=e*h[i],h[i]=a%1e7,a=u(a/1e7)},g=function(e){for(var t=6,i=0;--t>=0;)i+=h[t],h[t]=u(i/e),i=i%e*1e7},m=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==h[e]){var i=String(h[e]);t=""===t?i:t+s.call("0",7-i.length)+i}return t};if(l<0||l>20)throw RangeError("Incorrect fraction digits");if(d!=d)return"NaN";if(d<=-1e21||d>=1e21)return String(d);if(d<0&&(_="-",d=-d),d>1e-21)if(i=(t=function(e){for(var t=0,i=e;i>=4096;)t+=12,i/=4096;for(;i>=2;)t+=1,i/=2;return t}(d*c(2,69,1))-69)<0?d*c(2,-t,1):d/c(2,t,1),i*=4503599627370496,(t=52-t)>0){for(p(0,i),a=l;a>=7;)p(1e7,0),a-=7;for(p(c(10,a,1),0),a=t-1;a>=23;)g(1<<23),a-=23;g(1<<a),p(1,1),g(2),f=m()}else p(0,i),p(1<<-t,0),f=m()+s.call("0",l);return f=l>0?_+((o=f.length)<=l?"0."+s.call("0",l-o)+f:f.slice(0,o-l)+"."+f.slice(o-l)):_+f}})},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=(i(94),i(98),function(){function e(){n()(this,e),this.map_={}}return s()(e,[{key:"push",value:function(e,t){this.map_.hasOwnProperty(e)?this.map_[e].push(t):this.map_[e]=[t]}},{key:"get",value:function(e){var t=this.map_[e];return t?t.slice():null}},{key:"getAll",value:function(){var e=[];for(var t in this.map_)e.push.apply(e,this.map_[t]);return e}},{key:"remove",value:function(e,t){var i=this.map_[e];if(i)for(var a=0;a<i.length;++a)i[a]==t&&(i.splice(a,1),--a)}},{key:"clear",value:function(){this.map_={}}},{key:"forEach",value:function(e){for(var t in this.map_)e(t,this.map_[t])}}]),e}());i.d(t,"a",(function(){return d}));var d=function(){function e(){n()(this,e),this._bindingMap=new o}return s()(e,[{key:"destroy",value:function(){this.removeAll(),this._bindingMap=null}},{key:"on",value:function(t,i,a){if(this._bindingMap){var n=new e._Binding(t,i,a);this._bindingMap.push(i,n)}}},{key:"once",value:function(e,t,i){this.on(e,t,function(a){this.off(e,t),i(a)}.bind(this))}},{key:"off",value:function(e,t){if(this._bindingMap)for(var i=this._bindingMap.get(t)||[],a=0;a<i.length;++a){var n=i[a];n.target==e&&(n.off(),this._bindingMap.remove(t,n))}}},{key:"removeAll",value:function(){if(this._bindingMap){for(var e=this._bindingMap.getAll(),t=0;t<e.length;++t)e[t].off();this._bindingMap.clear()}}}]),e}();d._Binding=function(e,t,i){this.target=e,this.type=t,this.listener=i,this.target.addEventListener?this.target.addEventListener(t,i,!1):this.target.on&&this.target.on(t,i,!1)},d._Binding.prototype.off=function(){this.target.removeEventListener?this.target.removeEventListener(this.type,this.listener,!1):this.target.off&&this.target.off(this.type,this.listener,!1),this.target=null,this.listener=null}},function(e,t,i){var a=i(139),n=i(106);e.exports=function(e){return a(n(e))}},function(e,t,i){var a=i(33),n=i(229);a({global:!0,forced:parseFloat!=n},{parseFloat:n})},function(e,t,i){var a=i(87),n=i(30),r=i(157),s=i(184),o=i(93).f,d=i(134).f,u=i(187),c=i(167),l=i(103),h=i(31),_=i(177),f=i(39)("match"),p=n.RegExp,g=p.prototype,m=/a/g,v=/a/g,b=new p(m)!==m;if(a&&r("RegExp",!b||h((function(){return v[f]=!1,p(m)!=m||p(v)==v||"/a/i"!=p(m,"i")})))){for(var y=function(e,t){var i=this instanceof y,a=u(e),n=t===undefined;return!i&&a&&e.constructor===y&&n?e:s(b?new p(a&&!n?e.source:e,t):p((a=e instanceof y)?e.source:e,a&&n?c.call(e):t),i?this:g,y)},k=function(e){e in y||o(y,e,{configurable:!0,get:function(){return p[e]},set:function(t){p[e]=t}})},T=d(p),S=0;T.length>S;)k(T[S++]);g.constructor=y,y.prototype=g,l(n,"RegExp",y)}_("RegExp")},function(e,t,i){var a,n,r,s=i(223),o=i(30),d=i(85),u=i(96),c=i(92),l=i(171),h=i(155),_=o.WeakMap;if(s){var f=new _,p=f.get,g=f.has,m=f.set;a=function(e,t){return m.call(f,e,t),t},n=function(e){return p.call(f,e)||{}},r=function(e){return g.call(f,e)}}else{var v=l("state");h[v]=!0,a=function(e,t){return u(e,v,t),t},n=function(e){return c(e,v)?e[v]:{}},r=function(e){return c(e,v)}}e.exports={set:a,get:n,has:r,enforce:function(e){return r(e)?n(e):a(e,{})},getterFor:function(e){return function(t){var i;if(!d(t)||(i=n(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return i}}}},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(4),s=i.n(r),o=i(3),d=i.n(o),u=i(1),c=i.n(u),l=i(5),h=i.n(l),_=i(28),f=i(259),p=function(e){function t(e){var i;return n()(this,t),(i=s()(this,d()(t).call(this,e)))._container="",i._codec="",i._trackId=null,i}return h()(t,e),c()(t,[{key:"container",get:function(){return this._container},set:function(e){this._container=e}},{key:"codec",get:function(){return this._codec},set:function(e){this._codec=e}},{key:"trackId",get:function(){return this._trackId},set:function(e){this._trackId=e}}]),t}(i(260).a);p.TYPES=f.a,p.ORIGINS=_.a,t.a=p},function(e,t,i){"use strict";i(109),i(36);var a,n=i(19),r="-1",s={get:function(){if(a)r=a.tryGetFingerPrint();else{if("-1"===r)try{r=n.a.get("__dfp")}catch(i){r=""}if(""!==r){var e=r.split("@"),t=(new Date).getTime();3==e.length&&Number(e[2])<=t&&t<=Number(e[1])&&(r=e[0])}}return r},setSDK:function(e){a=e}};t.a=s},function(e,t,i){"use strict";i(35),i(24),i(36);var a={},n={},r=navigator.userAgent.toLowerCase(),s=/(edge)\/([\w.]+)/.exec(r)||/(opr)[/]([\w.]+)/.exec(r)||/(chrome)[ /]([\w.]+)/.exec(r)||/(firefox)[ /]([\w.]+)/.exec(r)||/(iemobile)[/]([\w.]+)/.exec(r)||/(version)(applewebkit)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(r)||/(webkit)[ /]([\w.]+).*(version)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(r)||/(webkit)[ /]([\w.]+)/.exec(r)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(r)||/(msie) ([\w.]+)/.exec(r)||r.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(r)||r.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(r)||[],o=/(ipad)/.exec(r)||/(ipod)/.exec(r)||/(windows phone)/.exec(r)||/(iphone)/.exec(r)||/(kindle)/.exec(r)||/(silk)/.exec(r)||/(android)/.exec(r)||/(win)/.exec(r)||/(mac)/.exec(r)||/(linux)/.exec(r)||/(cros)/.exec(r)||/(playbook)/.exec(r)||/(bb)/.exec(r)||/(blackberry)/.exec(r)||[],d={},u={browser:s[5]||s[3]||s[1]||"",version:s[2]||s[4]||"0",versionNumber:s[4]||s[2]||"0",platform:o[0]||""};if(u.browser){d[u.browser]=!0;var c=u.versionNumber.split(".");d.version={major:parseInt(u.versionNumber,10),string:u.version},c.length>1&&(d.version.minor=parseInt(c[1],10)),c.length>2&&(d.version.build=parseInt(c[2],10))}n.version=d.version,n.CHROME=!!d.chrome,n.SAFARI=!!d.safari&&!n.CHROME,n.FIREFOX=!!d.firefox,n.IE11=/rv:11/.test(r),n.IE=!!d.msie||n.IE11,n.EDGE=!!d.edge,n.WECHAT=/(wechat)|(micromessenger)/.test(r),a.mac=!!u.platform.mac,a.iphone=!!u.platform.iphone,a.android=!!u.platform.android,t.a={browser:n,os:a}},function(e,t,i){var a=i(214),n=i(30),r=function(e){return"function"==typeof e?e:undefined};e.exports=function(e,t){return arguments.length<2?r(a[e])||r(n[e]):a[e]&&a[e][t]||n[e]&&n[e][t]}},function(e,t,i){var a=i(107),n=Math.max,r=Math.min;e.exports=function(e,t){var i=a(e);return i<0?n(i+t,0):r(i,t)}},function(e,t,i){"use strict";t.a="5.1.201"},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,i){var a;(a=function(e,t,a){var n=i(424);a.exports={cmd5xdash:n.cmd5xdash,cmd5x:n.cmd5x}}.call(t,i,t,e))===undefined||(e.exports=a)},function(e,t,i){var a=i(87),n=i(191),r=i(126),s=i(116),o=i(129),d=i(92),u=i(192),c=Object.getOwnPropertyDescriptor;t.f=a?c:function(e,t){if(e=s(e),t=o(t,!0),u)try{return c(e,t)}catch(i){}if(d(e,t))return r(!n.f.call(e,t),e[t])}},function(e,t,i){var a=i(85);e.exports=function(e,t){if(!a(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!a(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!a(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!a(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t,i){var a=i(146),n=i(222);(e.exports=function(e,t){return n[e]||(n[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.4.2",mode:a?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,i){var a=i(79),n=i(136),r=i(39)("species");e.exports=function(e,t){var i,s=a(e).constructor;return s===undefined||(i=a(s)[r])==undefined?t:n(i)}},function(e,t,i){"use strict";var a=i(33),n=i(110).filter;a({target:"Array",proto:!0,forced:!i(140)("filter")},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:undefined)}})},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=function(){function e(t){n()(this,e),this._id=null,this._frequency=Infinity,this._callback=function(){t()}.bind(this)}return s()(e,[{key:"cancel",value:function(){null!=this._id&&(clearTimeout(this._id),this._id=null)}},{key:"schedule",value:function(e){this.cancel(),this.adjustFrequency(e),this._id=setTimeout(this._callback,this._frequency)}},{key:"scheduleRepeated",value:function(e){this.cancel(),this.adjustFrequency(e);var t=function(){this._callback(),this.running&&(this._id=setTimeout(t,this._frequency))}.bind(this);this._id=setTimeout(t,this._frequency)}},{key:"adjustFrequency",value:function(e){this._frequency=1e3*e}},{key:"running",get:function(){return null!==this._id}}]),e}()},function(e,t,i){var a=i(194),n=i(172).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return a(e,n)}},function(e,t,i){var a=i(136);e.exports=function(e,t,i){if(a(e),t===undefined)return e;switch(i){case 0:return function(){return e.call(t)};case 1:return function(i){return e.call(t,i)};case 2:return function(i,a){return e.call(t,i,a)};case 3:return function(i,a,n){return e.call(t,i,a,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,i){"use strict";var a=i(166),n=i(79),r=i(74),s=i(106),o=i(181),d=i(168);a("match",1,(function(e,t,i){return[function(t){var i=s(this),a=t==undefined?undefined:t[e];return a!==undefined?a.call(t,i):new RegExp(t)[e](String(i))},function(e){var a=i(t,e,this);if(a.done)return a.value;var s=n(e),u=String(this);if(!s.global)return d(s,u);var c=s.unicode;s.lastIndex=0;for(var l,h=[],_=0;null!==(l=d(s,u));){var f=String(l[0]);h[_]=f,""===f&&(s.lastIndex=o(u,r(s.lastIndex),c)),_++}return 0===_?null:h}]}))},function(e,t,i){"use strict";i(23),i(94),i(12),i(18);var a,n,r=i(0),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(1),h=i.n(l),_=i(5),f=i.n(_),p=(i(21),i(40),i(114),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(104)),g=i(68),m=function(){function e(t,i,a,n){s()(this,e),this.netType=t,this.context=i,this.speedSampler=n}return h()(e,null,[{key:"isMozChunkedSupported",value:function(){if("boolean"!=typeof a)if(/firefox/gi.test(navigator.userAgent.toLowerCase())){var e=new XMLHttpRequest;try{e.responseType="moz-chunked-arraybuffer"}catch(t){}a="moz-chunked-arraybuffer"===e.responseType}else a=!1;return a}}]),h()(e,[{key:"destroy",value:function(){this.abort(),this.url=this.loader=this.stats=this.context=null}},{key:"_resetTimer",value:function(){clearTimeout(this._requestTimeout),clearTimeout(this._retryTimeout),this._requestTimeout=this._retryTimeout=null}},{key:"abort",value:function(){var e=this.stats,t=this.loader;this._resetTimer(),e&&(e.isTimeout?e.aborted=!1:e.aborted=!0),t&&4!==t.readyState?t.abort():this._onAbort(),e&&e.aborted&&this._onAbort()}},{key:"load",value:function(e){return this.url=e,this.stats={requestStartMark:null,retry:0,retryDelay:this.context.retryParameters.baseDelay,dump:!1},this._resetTimer(),this._doLoad()}},{key:"_doLoad",value:function(){var t=this.url,i=this.context,a=this.stats,n=this.netType,r=this.loader=new XMLHttpRequest;if(a.requestStartMark=performance.now(),r.open(i.method,t,!0),i.retryParameters.timeout>0&&(this._requestTimeout=setTimeout(this._onTimeout.bind(this),i.retryParameters.timeout)),r.withCredentials=!!i.allowCrossSiteCredentials,r.onload=this._onLoad.bind(this),r.onprogress=this._onProgress.bind(this),i.headers)for(var s in i.headers){var o=s.toLowerCase();r.setRequestHeader(o,i.headers[s])}return r.responseType=i.responseType||"arraybuffer",n===p.a.SEGMENT&&"arraybuffer"===r.responseType&&e.isMozChunkedSupported()&&(r.responseType="moz-chunked-arraybuffer"),r.send(i.body),this}},{key:"_retry",value:function(){var e=this.context,t=this.stats;t.isTimeout=!1,this._resetTimer(),this._retryTimeout=setTimeout(this._doLoad.bind(this),t.retryDelay),t.retryDelay=Math.min(2*t.retryDelay,e.retryParameters.maxRetryDelay),t.retry++}},{key:"_onLoad",value:function(e){var t=this.context,i=this.stats,a=this.url,n=e.currentTarget,r=n.status,s=t.callbacks;if(i.aborted)this._onAbort();else if(clearTimeout(this._requestTimeout),r>=200&&r<300){var o=n.response,d=(performance.now()-i.requestStartMark).toFixed(3),u=null;if("moz-chunked-arraybuffer"===n.responseType&&(o=t.totalBuffer),s.onSuccess){(Object(g.h)(o)||Object(g.a)(o))&&(u=o.byteLength/(d/1e3),this.speedSampler.sample(o.byteLength));var c={netCost:d,speed:u,status:r,data:o,url:a};s.onSuccess(c,i,t)}this._onComplete(),i.dump=!0}else i.retry>=t.retryParameters.maxRetry||r>=400&&r<499?(i.isTimeout?s.onTimeout&&s.onTimeout(i,t,{status:r,url:a}):s.onError&&s.onError({status:r,response:n.response,url:a},t),this._onComplete()):this._retry()}},{key:"_onTimeout",value:function(){this.stats.isTimeout=!0,this.abort()}},{key:"_onProgress",value:function(t){var i,a=this.context,n=this.stats,r=(this.loader,a.callbacks);t.lengthComputable&&(n.loaded?(i=t.loaded-n.loaded,this.speedSampler.sample(i)):i=t.loaded,this.speedSampler.sample(i||0),n.loaded=t.loaded,n.total=t.total);if(r.onProgress&&this.netType===p.a.SEGMENT&&e.isMozChunkedSupported()){var s=t.target?t.target.response:null;if(s){var o=new Uint8Array(s),d=new Uint8Array(a.totalBuffer||0),u=new Uint8Array(d.byteLength+o.byteLength);u.set(d,0),u.set(o,d.byteLength),a.totalBuffer=u.buffer}s&&((Object(g.h)(s)||Object(g.a)(s))&&this.speedSampler.sample(s.byteLength),r.onProgress(s,n),n.dump=!0)}}},{key:"_onAbort",value:function(){var e=this.context;if(e&&!e.completed){var t=e.callbacks;t.onAbort&&t.onAbort(),this._onComplete()}}},{key:"_onComplete",value:function(){var e=this.context;if(e&&!e.completed){var t=e.callbacks;e.completed=!0,e.totalBuffer=null,this.speedSampler.reset(),this._resetTimer(),t.onComplete&&t.onComplete()}}}]),e}(),v=(i(211),i(89),i(24),i(97),i(78)),b=i.n(v),y=(i(190),i(6)),k=function(){function e(t,i,a,n){s()(this,e),this.netType=t,this.context=i,this.speedSampler=n}return h()(e,null,[{key:"isSupported",value:function(){if("boolean"!=typeof n){var e=!!window.fetch,t=!!window.AbortController,i=!0;if(window.ReadableStream)try{new ReadableStream({})}catch(a){i=!1}else i=!1;n=e&&i&&t}return n}}]),h()(e,[{key:"destroy",value:function(){this.abort(),this.url=this.controller=this.loader=this.stats=this.context=null}},{key:"_resetTimer",value:function(){clearTimeout(this._requestTimeout),clearTimeout(this._retryTimeout),this._requestTimeout=this._retryTimeout=null}},{key:"abort",value:function(){var e=this.controller,t=this.stats;this._resetTimer(),t&&(t.isTimeout?t.aborted=!1:t.aborted=!0),e&&!e.signal.aborted&&e.abort(),t&&t.aborted&&this._onAbort()}},{key:"load",value:function(e){return this.url=e,this.stats={requestStartMark:null,retry:0,retryDelay:this.context.retryParameters.baseDelay,dump:!1},this._resetTimer(),this._doLoad()}},{key:"_parseRes",value:function(e,t){var i;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:a.t0=e,a.next="arraybuffer"===a.t0?3:"json"===a.t0?7:11;break;case 3:return a.next=5,b.a.awrap(t.arrayBuffer());case 5:return i=a.sent,a.abrupt("break",14);case 7:return a.next=9,b.a.awrap(t.json());case 9:return i=a.sent,a.abrupt("break",14);case 11:return a.next=13,b.a.awrap(t.text());case 13:i=a.sent;case 14:return a.abrupt("return",i);case 15:case"end":return a.stop()}}))}},{key:"_initReqTimeout",value:function(){var e=this.context;this.stats;e.retryParameters.timeout>0&&(clearTimeout(this._requestTimeout),this._requestTimeout=setTimeout(this._onTimeout.bind(this),e.retryParameters.timeout))}},{key:"_doLoad",value:function(){var e,t,i,a,n,r,s,o,d,u,c,l,h,_,f,g,m,v,k,T,S,P;return b.a.async((function(x){for(;;)switch(x.prev=x.next){case 0:return c=function(){return i.retry>=t.retryParameters.maxRetry||r>=400&&r<499},e=this,t=this.context,i=this.stats,a=this.speedSampler,n=this.url,o=0,d=t.callbacks,u=this.controller=new AbortController,i.requestStartMark=performance.now(),e._initReqTimeout(),x.prev=8,l=n,h={method:t.method,headers:t.headers||{},body:t.body||undefined,mode:"cors",credentials:t.allowCrossSiteCredentials?"include":"same-origin",signal:u.signal,cache:"no-store"},x.next=13,b.a.awrap(window.fetch(l,h));case 13:if(s=x.sent,!((r=s.status)>=200&&r<300)){x.next=34;break}if(!d.onProgress){x.next=23;break}return _=s.clone().body.getReader(),f=s.headers.get("Content-Length"),g=f?parseInt(f,10):0,m=function E(t){var i,a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(new Promise((function(e){_.read().then((function(t){var i=t.done,a=t.value;e({done:i,value:a})}),(function(t){y.a.error("ReadableStreamDefaultReader error, ".concat(g,", ").concat(t?t.message:"")),e({done:!0})}))})));case 2:if(i=n.sent,clearTimeout(e._requestTimeout),!i.done){n.next=8;break}t&&t.close(),n.next=14;break;case 8:return(a=ArrayBuffer.isView(i.value)?i.value.buffer:null)&&(o+=a.byteLength),e._onProgress(a),t&&t.enqueue(a),n.next=14,b.a.awrap(E());case 14:case"end":return n.stop()}}))},x.next=23,b.a.awrap(m());case 23:if(!d.onSuccess){x.next=32;break}return x.next=26,b.a.awrap(e._parseRes(t.responseType,s));case 26:v=x.sent,k=(performance.now()-i.requestStartMark).toFixed(3),T=null,this.netType===p.a.SEGMENT&&(T=v.byteLength/(k/1e3)),S={netCost:k,speed:T,url:n,data:v,status:r},i.aborted||(v&&a.sample(v.byteLength-o),d.onSuccess(S,i,t),this._onComplete(),i.dump=!0);case 32:x.next=48;break;case 34:if(!c()){x.next=47;break}if(!i.isTimeout){x.next=39;break}d.onTimeout&&d.onTimeout(i,t,{status:r,url:n}),x.next=44;break;case 39:if(!d.onError){x.next=44;break}return x.next=42,b.a.awrap(e._parseRes(t.responseType,s));case 42:P=x.sent,i.aborted||d.onError({status:r,url:n,response:P},t);case 44:this._onComplete(),x.next=48;break;case 47:this._retry();case 48:x.next=54;break;case 50:x.prev=50,x.t0=x["catch"](8),(x.t0 instanceof RangeError||x.t0 instanceof ReferenceError||x.t0 instanceof SyntaxError||x.t0 instanceof TypeError||x.t0 instanceof URIError)&&y.a.error("fetch ".concat(x.t0.constructor.name,": ").concat(x.t0.stack?x.t0.stack:x.t0.message?x.t0.message:x.t0));try{i.aborted||(c()?(i.isTimeout?d.onTimeout&&d.onTimeout(i,t,{status:r,url:n}):d.onError&&d.onError({code:r,response:null,error:x.t0},t),this._onComplete()):this._retry())}catch(I){y.a.error(I.stack?I.stack:I.message?I.message:I)}case 54:return x.abrupt("return",this);case 55:case"end":return x.stop()}}),null,this,[[8,50]])}},{key:"_retry",value:function(){var e=this.context,t=this.stats;t.isTimeout=!1,this._resetTimer(),this._retryTimeout=setTimeout(this._doLoad.bind(this),t.retryDelay),t.retryDelay=Math.min(2*t.retryDelay,e.retryParameters.maxRetryDelay),t.retry++}},{key:"_onTimeout",value:function(){this.context;this.stats.isTimeout=!0,this.abort()}},{key:"_onProgress",value:function(e){var t=this.context,i=this.stats,a=t.callbacks;(Object(g.h)(e)||Object(g.a)(e))&&this.speedSampler.sample(e.byteLength),a.onProgress(e,i),i.dump=!0}},{key:"_onAbort",value:function(){var e=this.context;if(!e.completed){var t=e.callbacks;t.onAbort&&t.onAbort(),this._onComplete()}}},{key:"_onComplete",value:function(){var e=this.context;if(e&&!e.completed){var t=e.callbacks;e.completed=!0,this.speedSampler.reset(),y.a.log("fetch onComplete"),this._resetTimer(),t.onComplete&&t.onComplete()}}}]),e}(),T=i(133),S=performance&&performance.now?performance.now.bind(performance):Date.now,P=function(){function e(t){var i=this;s()(this,e),this.runtime=t,this.tInit=null,this.tLastArrivedSecond=null,this.bytesInSecond=null,this.bytesAll=null,this._resetTimer=new T.a((function(){i.tInit=null,i.tLastArrivedSecond=null,i.bytesInSecond=null,i.bytesAll=null,i.runtime.downloadSpeed=0}))}return h()(e,[{key:"averageBps",get:function(){if(null===this.bytesAll||null===this.tInit)return 0;var e=(S()-this.tInit)/1e3;return this.bytesAll/e}}]),h()(e,[{key:"reset",value:function(){this._resetTimer.schedule(1)}},{key:"sample",value:function(e){var t=S();if(null===this.tInit)this.tInit=t,this.tLastArrivedSecond=t,this.bytesInSecond=e;else{var i=(t-this.tLastArrivedSecond)/1e3;i<1?this.bytesInSecond+=e:(this.bytesInSecond=e,this.tLastArrivedSecond=t),0==i&&(i=1),i>.5&&(this.runtime.downloadSpeed=this.bytesInSecond/i||0,this.runtime.bandwidth=Math.floor(Math.max(this.runtime.downloadSpeed,this.runtime.bandwidth||0))||null)}}}]),e}(),x=i(105),I=i(80),E=(i(35),i(42)),D=i.n(E);function w(e){var t=[];return function i(e){switch(D()(e)){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;case"object":default:if(!e)return e;if(t.indexOf(e)>=0)return null;var a=e.constructor==Array;if(e.constructor!=Object&&!a)return null;t.push(e);var n=a?[]:{};for(var r in e)n[r]=i(e[r]);return a&&(n.length=e.length),n}}(e)}var A=i(11),q=i(81),O=function(e){function t(){var e,i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return s()(this,t),e=d()(this,c()(t).call(this)),i.runtime||(i.runtime={}),e._ctx=i,e._runtime=i.runtime,e._schemes={},e._speedSampler=new P(i.runtime),k.isSupported()?(e._registerLoader("http",k),e._registerLoader("https",k)):(e._registerLoader("http",m),e._registerLoader("https",m)),e}return f()(t,e),h()(t,[{key:"defaultRetryParameters",get:function(){return{maxRetry:2,baseDelay:1e3,maxRetryDelay:8e3,timeout:0}}},{key:"isProgressSupported",get:function(){return k.isSupported()||m.isMozChunkedSupported()}}]),h()(t,[{key:"makeRequestContext",value:function(e,t){return{uris:e,method:"GET",headers:t.headers,body:null,responseType:"arraybuffer",allowCrossSiteCredentials:!1,retryParameters:t,callbacks:{onSuccess:function(e){},onError:function(){},onTimeout:function(e,t,i){},onAbort:function(){},onComplete:function(){}}}}},{key:"request",value:function(e,t){return t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=Object(q.a)(w(this.defaultRetryParameters),t.retryParameters,!0),t.uris=w(t.uris),this._makeRequestWithRetry(e,t)}},{key:"_makeRequestWithRetry",value:function(e,t){return this._send(e,t,0)}},{key:"_send",value:function(e,t,i){var a=this._ctx,n=this._schemes,r=this._runtime,s=this._speedSampler,o=new x.a(t.uris[i]),d=o.scheme,u=o.domain,c=this._getLocationProtocol();if(d||(d=c.slice(0,-1),o.setScheme(d),t.uris[i]=o.toString()),e===p.a.SEGMENT){if("http"===d&&/^https/gi.test(c))return y.a.warn("HTTP request in HTTPS Page: ".concat(o.toString())),a._emitError(new A.a(A.a.severity.CRITICAL,A.a.category.NETWORK,A.a.code.NET_HTTPS_UNMATCHED_HTTP_SCHEME,o));r.cdnHost=u,r.netProtocol=d}var l=n[d],h=l?l.loader:null;if(!h)return y.a.warn("Wrong with scheme ".concat(d,": ").concat(o.toString())),a._emitError(new A.a(A.a.severity.CRITICAL,A.a.category.NETWORK,A.a.code.NET_UNSUPPORTED_SCHEME,o));var _=new h(e,t,a,s);return _.load(t.uris[i]),_}},{key:"_getLocationProtocol",value:function(){return window.location.protocol}},{key:"_registerLoader",value:function(e,t,i){this._schemes[e]={loader:t,priority:i}}}]),t}(I.a);t.a=O},function(e,t,i){var a=i(31),n=i(113),r="".split;e.exports=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==n(e)?r.call(e,""):Object(e)}:Object},function(e,t,i){var a=i(31),n=i(39),r=i(183),s=n("species");e.exports=function(e){return r>=51||!a((function(){var t=[];return(t.constructor={})[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,i){"use strict";var a=i(31);e.exports=function(e,t){var i=[][e];return!i||!a((function(){i.call(null,t||function(){throw 1},1)}))}},function(e,t,i){var a=i(79),n=i(203),r=i(172),s=i(155),o=i(204),d=i(182),u=i(171)("IE_PROTO"),c=function(){},l=function(){var e,t=d("iframe"),i=r.length;for(t.style.display="none",o.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var i;return null!==e?(c.prototype=a(e),i=new c,c.prototype=null,i[u]=e):i=l(),t===undefined?i:n(i,t)},s[u]=!0},function(e,t,i){var a=i(33),n=i(95),r=i(175);a({target:"Object",stat:!0,forced:i(31)((function(){r(1)}))},{keys:function(e){return r(n(e))}})},function(e,t,i){var a=i(93).f,n=i(92),r=i(39)("toStringTag");e.exports=function(e,t,i){e&&!n(e=i?e:e.prototype,r)&&a(e,r,{configurable:!0,value:t})}},function(e,t,i){"use strict";i(12),i(18);t.a={create:function(){return Math.ceil(1e16*Math.random()+(new Date).getTime()).toString(32)}}},function(e,t){e.exports=!1},function(e,t,i){"use strict";var a=i(129),n=i(93),r=i(126);e.exports=function(e,t,i){var s=a(t);s in e?n.f(e,s,r(0,i)):e[s]=i}},function(e,t){e.exports="\t\n\x0B\f\r                　\u2028\u2029\ufeff"},function(e,t,i){"use strict";var a=i(33),n=i(159).trim;a({target:"String",proto:!0,forced:i(243)("trim")},{trim:function(){return n(this)}})},function(e,t,i){"use strict";var a=i(33),n=i(156).includes,r=i(189);a({target:"Array",proto:!0},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:undefined)}}),r("includes")},function(e,t,i){"use strict";var a=i(33),n=i(285),r=i(106);a({target:"String",proto:!0,forced:!i(286)("includes")},{includes:function(e){return!!~String(r(this)).indexOf(n(e),arguments.length>1?arguments[1]:undefined)}})},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(81),d=i(122),u=!1,c=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};n()(this,e);var i=d.a.browser.CHROME&&(d.a.browser.version.major<50||50===d.a.browser.version.major&&d.a.browser.version.build<2661);this.enableWorker=!0,this.alwaysSeekKeyframe=!!(i||d.a.browser.EDGE||d.a.browser.IE),this.switchVariantImmediate=!1,this.bufferExpectLength=5,this.mediaMaxDuration=86400,this.nudgeOffset=.1,this.nudgeMaxRetry=3,this.maxBufferHole=.5,this.maxBufferTimeLength=60,this.hlsRangeTSTolerance=5,this.hlsMaxSegmentSearchTolerance=.25,this.drm={retryParameters:{maxRetry:3,timeout:6e3},servers:{}},this.datasource={retryParameters:{maxRetry:2,timeout:2e4}},this.loaderWithBufferMaxRetry=3,this.loaderNoBufferMaxRetry=1,this.fpsStuckMonitoringPeriod=5,this.safariMinStartTime=.2,this.useP2P=!0,this.useVP9P2P=!0,this.useAV1P2P=!0,Object(o.a)(this,t,!0,!0)}return s()(e,null,[{key:"DEBUG",set:function(e){u=e},get:function(){return u}}]),e}();t.a=c},function(e,t,i){var a=i(271),n=i(272),r=i(273);e.exports=function(e){return a(e)||n(e)||r()}},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));i(98);var a=i(1),n=i.n(a),r=i(0),s=i.n(r),o=i(68),d=(i(6),function h(e,t){s()(this,h),this.start=e,this.end=t});function u(e){for(var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;t<this._ranges.length&&e>this._ranges[t].end;)++t;return{index:t,contained:t<this._ranges.length&&e>=this._ranges[t].start}}function c(e){return Object(o.f)(e)&&e>=0&&e<this._ranges.length}var l=function(){function e(){s()(this,e),this._ranges=[]}return n()(e,[{key:"length",get:function(){return this._ranges.length}}],[{key:"getGapIndex",value:function(e,t){if(!e||!e.length)return null;if(1==e.length&&e.end(0)-e.start(0)<1e-6)return null;var i=.1;/(Edge\/|Trident\/|Tizen)/.test(navigator.userAgent)&&(i=.5);for(var a=0;a<e.length;a++)if(e.start(a)>t&&(0==a||e.end(a-1)-t<=i)&&a>0)return a;return null}}]),n()(e,[{key:"start",value:function(e){if(!c.call(this,e))throw new Error("Invalid index");return this._ranges[e].start}},{key:"end",value:function(e){if(!c.call(this,e))throw new Error("Invalid index");return this._ranges[e].end}},{key:"add",value:function(e,t){if(!Object(o.f)(e)||!Object(o.f)(t)||t<e)throw new Error("Invalid range");var i=u.call(this,e),a=u.call(this,t,i.index);i.contained&&(e=Math.min(e,this._ranges[i.index].start)),a.contained&&(t=Math.max(t,this._ranges[a.index].end));var n=a.index-i.index+(a.contained?1:0);this._ranges.splice(i.index,n,new d(e,t))}},{key:"contain",value:function(e){return!!u.call(this,e).contained}},{key:"empty",value:function(){this._ranges.splice(0,this._ranges.length)}},{key:"toArray",value:function(){var e=[],t=this._ranges;if(Array.isArray(t))for(var i=0;i<t.length;i++){var a=t[i].start,n=t[i].end;e.push([a,n])}return e}}]),e}()},function(e,t){e.exports={}},function(e,t,i){var a=i(116),n=i(74),r=i(124),s=function(e){return function(t,i,s){var o,d=a(t),u=n(d.length),c=r(s,u);if(e&&i!=i){for(;u>c;)if((o=d[c++])!=o)return!0}else for(;u>c;c++)if((e||c in d)&&d[c]===i)return e||c||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,i){var a=i(31),n=/#|\.prototype\./,r=function(e,t){var i=o[s(e)];return i==u||i!=d&&("function"==typeof t?a(t):!!t)},s=r.normalize=function(e){return String(e).replace(n,".").toLowerCase()},o=r.data={},d=r.NATIVE="N",u=r.POLYFILL="P";e.exports=r},function(e,t,i){var a=i(113);e.exports=Array.isArray||function(e){return"Array"==a(e)}},function(e,t,i){var a=i(106),n="["+i(148)+"]",r=RegExp("^"+n+n+"*"),s=RegExp(n+n+"*$"),o=function(e){return function(t){var i=String(a(t));return 1&e&&(i=i.replace(r,"")),2&e&&(i=i.replace(s,"")),i}};e.exports={start:o(1),end:o(2),trim:o(3)}},function(e,t,i){var a=i(176),n=i(113),r=i(39)("toStringTag"),s="Arguments"==n(function(){return arguments}());e.exports=a?n:function(e){var t,i,a;return e===undefined?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(i){}}(t=Object(e),r))?i:s?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){e.exports=function(e,t,i){if(!(e instanceof t))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return e}},function(e,t,i){"use strict";var a=i(33),n=i(30),r=i(123),s=i(146),o=i(87),d=i(186),u=i(215),c=i(31),l=i(92),h=i(158),_=i(85),f=i(79),p=i(95),g=i(116),m=i(129),v=i(126),b=i(142),y=i(175),k=i(134),T=i(425),S=i(195),P=i(128),x=i(93),I=i(191),E=i(96),D=i(103),w=i(130),A=i(171),q=i(155),O=i(165),L=i(39),C=i(289),M=i(290),R=i(144),B=i(119),N=i(110).forEach,F=A("hidden"),U=L("toPrimitive"),V=B.set,H=B.getterFor("Symbol"),W=Object.prototype,j=n.Symbol,G=r("JSON","stringify"),z=P.f,K=x.f,Y=T.f,Q=I.f,J=w("symbols"),X=w("op-symbols"),Z=w("string-to-symbol-registry"),$=w("symbol-to-string-registry"),ee=w("wks"),te=n.QObject,ie=!te||!te.prototype||!te.prototype.findChild,ae=o&&c((function(){return 7!=b(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(e,t,i){var a=z(W,t);a&&delete W[t],K(e,t,i),a&&e!==W&&K(W,t,a)}:K,ne=function(e,t){var i=J[e]=b(j.prototype);return V(i,{type:"Symbol",tag:e,description:t}),o||(i.description=t),i},re=d&&"symbol"==typeof j.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof j},se=function(e,t,i){e===W&&se(X,t,i),f(e);var a=m(t,!0);return f(i),l(J,a)?(i.enumerable?(l(e,F)&&e[F][a]&&(e[F][a]=!1),i=b(i,{enumerable:v(0,!1)})):(l(e,F)||K(e,F,v(1,{})),e[F][a]=!0),ae(e,a,i)):K(e,a,i)},oe=function(e,t){f(e);var i=g(t),a=y(i).concat(le(i));return N(a,(function(t){o&&!de.call(i,t)||se(e,t,i[t])})),e},de=function(e){var t=m(e,!0),i=Q.call(this,t);return!(this===W&&l(J,t)&&!l(X,t))&&(!(i||!l(this,t)||!l(J,t)||l(this,F)&&this[F][t])||i)},ue=function(e,t){var i=g(e),a=m(t,!0);if(i!==W||!l(J,a)||l(X,a)){var n=z(i,a);return!n||!l(J,a)||l(i,F)&&i[F][a]||(n.enumerable=!0),n}},ce=function(e){var t=Y(g(e)),i=[];return N(t,(function(e){l(J,e)||l(q,e)||i.push(e)})),i},le=function(e){var t=e===W,i=Y(t?X:g(e)),a=[];return N(i,(function(e){!l(J,e)||t&&!l(W,e)||a.push(J[e])})),a};(d||(D((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==undefined?String(arguments[0]):undefined,t=O(e),i=function(e){this===W&&i.call(X,e),l(this,F)&&l(this[F],t)&&(this[F][t]=!1),ae(this,t,v(1,e))};return o&&ie&&ae(W,t,{configurable:!0,set:i}),ne(t,e)}).prototype,"toString",(function(){return H(this).tag})),I.f=de,x.f=se,P.f=ue,k.f=T.f=ce,S.f=le,o&&(K(j.prototype,"description",{configurable:!0,get:function(){return H(this).description}}),s||D(W,"propertyIsEnumerable",de,{unsafe:!0}))),u||(C.f=function(e){return ne(L(e),e)}),a({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:j}),N(y(ee),(function(e){M(e)})),a({target:"Symbol",stat:!0,forced:!d},{"for":function(e){var t=String(e);if(l(Z,t))return Z[t];var i=j(t);return Z[t]=i,$[i]=t,i},keyFor:function(e){if(!re(e))throw TypeError(e+" is not a symbol");if(l($,e))return $[e]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),a({target:"Object",stat:!0,forced:!d,sham:!o},{create:function(e,t){return t===undefined?b(e):oe(b(e),t)},defineProperty:se,defineProperties:oe,getOwnPropertyDescriptor:ue}),a({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:ce,getOwnPropertySymbols:le}),a({target:"Object",stat:!0,forced:c((function(){S.f(1)}))},{getOwnPropertySymbols:function(e){return S.f(p(e))}}),G)&&a({target:"JSON",stat:!0,forced:!d||c((function(){var e=j();return"[null]"!=G([e])||"{}"!=G({a:e})||"{}"!=G(Object(e))}))},{stringify:function(e,t,i){for(var a,n=[e],r=1;arguments.length>r;)n.push(arguments[r++]);if(a=t,(_(t)||e!==undefined)&&!re(e))return h(t)||(t=function(e,t){if("function"==typeof a&&(t=a.call(this,e,t)),!re(t))return t}),n[1]=t,G.apply(null,n)}});j.prototype[U]||E(j.prototype,U,j.prototype.valueOf),R(j,"Symbol"),q[F]=!0},function(e,t,i){"use strict";var a=i(33),n=i(87),r=i(30),s=i(92),o=i(85),d=i(93).f,u=i(212),c=r.Symbol;if(n&&"function"==typeof c&&(!("description"in c.prototype)||c().description!==undefined)){var l={},h=function(){var e=arguments.length<1||arguments[0]===undefined?undefined:String(arguments[0]),t=this instanceof h?new c(e):e===undefined?c():c(e);return""===e&&(l[t]=!0),t};u(h,c);var _=h.prototype=c.prototype;_.constructor=h;var f=_.toString,p="Symbol(test)"==String(c("test")),g=/^Symbol\((.*)\)[^)]+$/;d(_,"description",{configurable:!0,get:function(){var e=o(this)?this.valueOf():this,t=f.call(e);if(s(l,e))return"";var i=p?t.slice(7,-1):t.replace(g,"$1");return""===i?undefined:i}}),a({global:!0,forced:!0},{Symbol:h})}},function(e,t,i){i(290)("iterator")},function(e,t){var i=0,a=Math.random();e.exports=function(e){return"Symbol("+String(e===undefined?"":e)+")_"+(++i+a).toString(36)}},function(e,t,i){"use strict";var a=i(96),n=i(103),r=i(31),s=i(39),o=i(180),d=s("species"),u=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),c=!r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]}));e.exports=function(e,t,i,l){var h=s(e),_=!r((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),f=_&&!r((function(){var t=!1,i=/a/;return"split"===e&&((i={}).constructor={},i.constructor[d]=function(){return i},i.flags="",i[h]=/./[h]),i.exec=function(){return t=!0,null},i[h](""),!t}));if(!_||!f||"replace"===e&&!u||"split"===e&&!c){var p=/./[h],g=i(h,""[e],(function(e,t,i,a,n){return t.exec===o?_&&!n?{done:!0,value:p.call(t,i,a)}:{done:!0,value:e.call(i,t,a)}:{done:!1}})),m=g[0],v=g[1];n(String.prototype,e,m),n(RegExp.prototype,h,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)}),l&&a(RegExp.prototype[h],"sham",!0)}}},function(e,t,i){"use strict";var a=i(79);e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,i){var a=i(113),n=i(180);e.exports=function(e,t){var i=e.exec;if("function"==typeof i){var r=i.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},function(e,t,i){var a,n,r,s,o;a=i(431),n=i(299).utf8,r=i(432),s=i(299).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):n.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var i=a.bytesToWords(e),d=8*e.length,u=1732584193,c=-271733879,l=-1732584194,h=271733878,_=0;_<i.length;_++)i[_]=16711935&(i[_]<<8|i[_]>>>24)|4278255360&(i[_]<<24|i[_]>>>8);i[d>>>5]|=128<<d%32,i[14+(d+64>>>9<<4)]=d;var f=o._ff,p=o._gg,g=o._hh,m=o._ii;for(_=0;_<i.length;_+=16){var v=u,b=c,y=l,k=h;u=f(u,c,l,h,i[_+0],7,-680876936),h=f(h,u,c,l,i[_+1],12,-389564586),l=f(l,h,u,c,i[_+2],17,606105819),c=f(c,l,h,u,i[_+3],22,-1044525330),u=f(u,c,l,h,i[_+4],7,-176418897),h=f(h,u,c,l,i[_+5],12,1200080426),l=f(l,h,u,c,i[_+6],17,-1473231341),c=f(c,l,h,u,i[_+7],22,-45705983),u=f(u,c,l,h,i[_+8],7,1770035416),h=f(h,u,c,l,i[_+9],12,-1958414417),l=f(l,h,u,c,i[_+10],17,-42063),c=f(c,l,h,u,i[_+11],22,-1990404162),u=f(u,c,l,h,i[_+12],7,1804603682),h=f(h,u,c,l,i[_+13],12,-40341101),l=f(l,h,u,c,i[_+14],17,-1502002290),u=p(u,c=f(c,l,h,u,i[_+15],22,1236535329),l,h,i[_+1],5,-165796510),h=p(h,u,c,l,i[_+6],9,-1069501632),l=p(l,h,u,c,i[_+11],14,643717713),c=p(c,l,h,u,i[_+0],20,-373897302),u=p(u,c,l,h,i[_+5],5,-701558691),h=p(h,u,c,l,i[_+10],9,38016083),l=p(l,h,u,c,i[_+15],14,-660478335),c=p(c,l,h,u,i[_+4],20,-405537848),u=p(u,c,l,h,i[_+9],5,568446438),h=p(h,u,c,l,i[_+14],9,-1019803690),l=p(l,h,u,c,i[_+3],14,-187363961),c=p(c,l,h,u,i[_+8],20,1163531501),u=p(u,c,l,h,i[_+13],5,-1444681467),h=p(h,u,c,l,i[_+2],9,-51403784),l=p(l,h,u,c,i[_+7],14,1735328473),u=g(u,c=p(c,l,h,u,i[_+12],20,-1926607734),l,h,i[_+5],4,-378558),h=g(h,u,c,l,i[_+8],11,-2022574463),l=g(l,h,u,c,i[_+11],16,1839030562),c=g(c,l,h,u,i[_+14],23,-35309556),u=g(u,c,l,h,i[_+1],4,-1530992060),h=g(h,u,c,l,i[_+4],11,1272893353),l=g(l,h,u,c,i[_+7],16,-155497632),c=g(c,l,h,u,i[_+10],23,-1094730640),u=g(u,c,l,h,i[_+13],4,681279174),h=g(h,u,c,l,i[_+0],11,-358537222),l=g(l,h,u,c,i[_+3],16,-722521979),c=g(c,l,h,u,i[_+6],23,76029189),u=g(u,c,l,h,i[_+9],4,-640364487),h=g(h,u,c,l,i[_+12],11,-421815835),l=g(l,h,u,c,i[_+15],16,530742520),u=m(u,c=g(c,l,h,u,i[_+2],23,-995338651),l,h,i[_+0],6,-198630844),h=m(h,u,c,l,i[_+7],10,1126891415),l=m(l,h,u,c,i[_+14],15,-1416354905),c=m(c,l,h,u,i[_+5],21,-57434055),u=m(u,c,l,h,i[_+12],6,1700485571),h=m(h,u,c,l,i[_+3],10,-1894986606),l=m(l,h,u,c,i[_+10],15,-1051523),c=m(c,l,h,u,i[_+1],21,-2054922799),u=m(u,c,l,h,i[_+8],6,1873313359),h=m(h,u,c,l,i[_+15],10,-30611744),l=m(l,h,u,c,i[_+6],15,-1560198380),c=m(c,l,h,u,i[_+13],21,1309151649),u=m(u,c,l,h,i[_+4],6,-145523070),h=m(h,u,c,l,i[_+11],10,-1120210379),l=m(l,h,u,c,i[_+2],15,718787259),c=m(c,l,h,u,i[_+9],21,-343485551),u=u+v>>>0,c=c+b>>>0,l=l+y>>>0,h=h+k>>>0}return a.endian([u,c,l,h])})._ff=function(e,t,i,a,n,r,s){var o=e+(t&i|~t&a)+(n>>>0)+s;return(o<<r|o>>>32-r)+t},o._gg=function(e,t,i,a,n,r,s){var o=e+(t&a|i&~a)+(n>>>0)+s;return(o<<r|o>>>32-r)+t},o._hh=function(e,t,i,a,n,r,s){var o=e+(t^i^a)+(n>>>0)+s;return(o<<r|o>>>32-r)+t},o._ii=function(e,t,i,a,n,r,s){var o=e+(i^(t|~a))+(n>>>0)+s;return(o<<r|o>>>32-r)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(e===undefined||null===e)throw new Error("Illegal argument "+e);var i=a.wordsToBytes(o(e,t));return t&&t.asBytes?i:t&&t.asString?s.bytesToString(i):a.bytesToHex(i)}},function(e,t,i){var a=i(30),n=i(96);e.exports=function(e,t){try{n(a,e,t)}catch(i){a[e]=t}return t}},function(e,t,i){var a=i(130),n=i(165),r=a("keys");e.exports=function(e){return r[e]||(r[e]=n(e))}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,i){var a=i(85),n=i(158),r=i(39)("species");e.exports=function(e,t){var i;return n(e)&&("function"!=typeof(i=e.constructor)||i!==Array&&!n(i.prototype)?a(i)&&null===(i=i[r])&&(i=undefined):i=undefined),new(i===undefined?Array:i)(0===t?0:t)}},function(e,t,i){var a=i(79),n=i(226);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),t=i instanceof Array}catch(r){}return function(i,r){return a(i),n(r),t?e.call(i,r):i.__proto__=r,i}}():undefined)},function(e,t,i){var a=i(194),n=i(172);e.exports=Object.keys||function(e){return a(e,n)}},function(e,t,i){var a={};a[i(39)("toStringTag")]="z",e.exports="[object z]"===String(a)},function(e,t,i){"use strict";var a=i(123),n=i(93),r=i(39),s=i(87),o=r("species");e.exports=function(e){var t=a(e),i=n.f;s&&t&&!t[o]&&i(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports={}},function(e,t,i){var a=i(160),n=i(178),r=i(39)("iterator");e.exports=function(e){if(e!=undefined)return e[r]||e["@@iterator"]||n[a(e)]}},function(e,t,i){"use strict";var a,n,r=i(167),s=RegExp.prototype.exec,o=String.prototype.replace,d=s,u=(a=/a/,n=/b*/g,s.call(a,"a"),s.call(n,"a"),0!==a.lastIndex||0!==n.lastIndex),c=/()??/.exec("")[1]!==undefined;(u||c)&&(d=function(e){var t,i,a,n,d=this;return c&&(i=new RegExp("^"+d.source+"$(?!\\s)",r.call(d))),u&&(t=d.lastIndex),a=s.call(d,e),u&&a&&(d.lastIndex=d.global?a.index+a[0].length:t),c&&a&&a.length>1&&o.call(a[0],i,(function(){for(n=1;n<arguments.length-2;n++)arguments[n]===undefined&&(a[n]=undefined)})),a}),e.exports=d},function(e,t,i){"use strict";var a=i(188).charAt;e.exports=function(e,t,i){return t+(i?a(e,t).length:1)}},function(e,t,i){var a=i(30),n=i(85),r=a.document,s=n(r)&&n(r.createElement);e.exports=function(e){return s?r.createElement(e):{}}},function(e,t,i){var a,n,r=i(30),s=i(202),o=r.process,d=o&&o.versions,u=d&&d.v8;u?n=(a=u.split("."))[0]+a[1]:s&&(!(a=s.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=s.match(/Chrome\/(\d+)/))&&(n=a[1]),e.exports=n&&+n},function(e,t,i){var a=i(85),n=i(174);e.exports=function(e,t,i){var r,s;return n&&"function"==typeof(r=t.constructor)&&r!==i&&a(s=r.prototype)&&s!==i.prototype&&n(e,s),e}},function(e,t,i){"use strict";var a=i(33),n=i(136),r=i(95),s=i(31),o=i(141),d=[],u=d.sort,c=s((function(){d.sort(undefined)})),l=s((function(){d.sort(null)})),h=o("sort");a({target:"Array",proto:!0,forced:c||!l||h},{sort:function(e){return e===undefined?u.call(r(this)):u.call(r(this),n(e))}})},function(e,t,i){var a=i(31);e.exports=!!Object.getOwnPropertySymbols&&!a((function(){return!String(Symbol())}))},function(e,t,i){var a=i(85),n=i(113),r=i(39)("match");e.exports=function(e){var t;return a(e)&&((t=e[r])!==undefined?!!t:"RegExp"==n(e))}},function(e,t,i){var a=i(107),n=i(106),r=function(e){return function(t,i){var r,s,o=String(n(t)),d=a(i),u=o.length;return d<0||d>=u?e?"":undefined:(r=o.charCodeAt(d))<55296||r>56319||d+1===u||(s=o.charCodeAt(d+1))<56320||s>57343?e?o.charAt(d):r:e?o.slice(d,d+2):s-56320+(r-55296<<10)+65536}};e.exports={codeAt:r(!1),charAt:r(!0)}},function(e,t,i){var a=i(39),n=i(142),r=i(96),s=a("unscopables"),o=Array.prototype;o[s]==undefined&&r(o,s,n(null)),e.exports=function(e){o[s][e]=!0}},function(e,t,i){var a=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function o(e,t,i,a){var n=t&&t.prototype instanceof c?t:c,r=Object.create(n.prototype),s=new T(a||[]);return r._invoke=function(e,t,i){var a="suspendedStart";return function(n,r){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw r;return P()}for(i.method=n,i.arg=r;;){var s=i.delegate;if(s){var o=b(s,i);if(o){if(o===u)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===a)throw a="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);a="executing";var c=d(e,t,i);if("normal"===c.type){if(a=i.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(a="completed",i.method="throw",i.arg=c.arg)}}}(e,i,s),r}function d(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(a){return{type:"throw",arg:a}}}e.wrap=o;var u={};function c(){}function l(){}function h(){}var _={};_[n]=function(){return this};var f=Object.getPrototypeOf,p=f&&f(f(S([])));p&&p!==t&&i.call(p,n)&&(_=p);var g=h.prototype=c.prototype=Object.create(_);function m(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function v(e){var t;this._invoke=function(a,n){function r(){return new Promise((function(t,r){!function s(t,a,n,r){var o=d(e[t],e,a);if("throw"!==o.type){var u=o.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){s("next",e,n,r)}),(function(e){s("throw",e,n,r)})):Promise.resolve(c).then((function(e){u.value=e,n(u)}),(function(e){return s("throw",e,n,r)}))}r(o.arg)}(a,n,t,r)}))}return t=t?t.then(r,r):r()}}function b(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var a=d(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,u;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function y(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(y,this),this.reset(!0)}function S(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return l.prototype=g.constructor=h,h.constructor=l,h[s]=l.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),v.prototype[r]=function(){return this},e.AsyncIterator=v,e.async=function(t,i,a,n){var r=new v(o(t,i,a,n));return e.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},m(g),g[s]="Generator",g[n]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function a(){for(;t.length;){var i=t.pop();if(i in e)return a.value=i,a.done=!1,a}return a.done=!0,a}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(i,a){return s.type="throw",s.arg=e,t.next=i,a&&(t.method="next",t.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],s=r.completion;if("root"===r.tryLoc)return a("end");if(r.tryLoc<=this.prev){var o=i.call(r,"catchLoc"),d=i.call(r,"finallyLoc");if(o&&d){if(this.prev<r.catchLoc)return a(r.catchLoc,!0);if(this.prev<r.finallyLoc)return a(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return a(r.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return a(r.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),u}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var a=i.completion;if("throw"===a.type){var n=a.arg;k(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:S(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=a}catch(n){Function("r","regeneratorRuntime = r")(a)}},function(e,t,i){"use strict";var a={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,r=n&&!a.call({1:2},1);t.f=r?function(e){var t=n(this,e);return!!t&&t.enumerable}:a},function(e,t,i){var a=i(87),n=i(31),r=i(182);e.exports=!a&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},function(e,t,i){var a=i(130);e.exports=a("native-function-to-string",Function.toString)},function(e,t,i){var a=i(92),n=i(116),r=i(156).indexOf,s=i(155);e.exports=function(e,t){var i,o=n(e),d=0,u=[];for(i in o)!a(s,i)&&a(o,i)&&u.push(i);for(;t.length>d;)a(o,i=t[d++])&&(~r(u,i)||u.push(i));return u}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,i){var a=i(103);e.exports=function(e,t,i){for(var n in t)a(e,n,t[n],i);return e}},function(e,t,i){"use strict";var a=i(291),n=i(293);e.exports=a("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:undefined)}}),n,!0)},function(e,t,i){"use strict";i(23),i(21),i(40),i(12),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67);var a,n=i(0),r=i.n(n),s=i(1),o=i.n(s),d=i(4),u=i.n(d),c=i(3),l=i.n(c),h=i(5),_=i.n(h),f=(i(6),function se(e){r()(this,se);for(var t=8,i=arguments.length,a=new Array(i>1?i-1:0),n=1;n<i;n++)a[n-1]=arguments[n];for(var s,o=a.length,d=o;d--;)t+=a[d].byteLength;try{s=new Uint8Array(t)}catch(u){throw"mp4 box ".concat(e," alloc mem err: ").concat(u.message)}for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),d=0,t=8;d<o;d++)s.set(a[d],t),t+=a[d].byteLength;this.bytes=s}),p={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};for(a in p)p.hasOwnProperty(a)&&(p[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);var g=p,m=(new(function(e){function t(){r()(this,t);var e=new Uint8Array([105,115,111,109]),i=new Uint8Array([97,118,99,49]),a=new Uint8Array([0,0,0,1]);return u()(this,l()(t).call(this,g.ftyp,e,a,e,i))}return _()(t,e),t}(f))).bytes,v=function(e){function t(e,i){r()(this,t),i*=e;var a=Math.floor(i/(re.UINT32_MAX+1)),n=Math.floor(i%(re.UINT32_MAX+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return u()(this,l()(t).call(this,g.mvhd,s))}return _()(t,e),t}(f),b=function(e){function t(e){r()(this,t);var i=e.id,a=e.duration*e.timescale,n=e.width,s=e.height,o=Math.floor(a/(re.UINT32_MAX+1)),d=Math.floor(a%(re.UINT32_MAX+1));return u()(this,l()(t).call(this,g.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,d>>24,d>>16&255,d>>8&255,255&d,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,s>>8&255,255&s,0,0])))}return _()(t,e),t}(f),y=function(e){function t(e,i){r()(this,t),i*=e;var a=Math.floor(i/(re.UINT32_MAX+1)),n=Math.floor(i%(re.UINT32_MAX+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]);return u()(this,l()(t).call(this,g.mdhd,s))}return _()(t,e),t}(f),k=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),T=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),S=function(e){function t(e){var i;switch(r()(this,t),e){case"video":i=k;break;case"audio":i=T}return u()(this,l()(t).call(this,g.hdlr,i))}return _()(t,e),t}(f),P=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))}return _()(t,e),t}(f))).bytes,x=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.dinf,P))}return _()(t,e),t}(f))).bytes,I=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.smhd,new Uint8Array([0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,E=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,D=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.stco,new Uint8Array([0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,w=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,A=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.stsc,new Uint8Array([0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,q=(new(function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.stts,new Uint8Array([0,0,0,0,0,0,0,0])))}return _()(t,e),t}(f))).bytes,O=function(e){function t(e){r()(this,t);var i=e.sampleRate;return u()(this,l()(t).call(this,g[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0])))}return _()(t,e),t}(f),L=function(e){function t(e){r()(this,t);var i=e.config,a=i.length;return u()(this,l()(t).call(this,g.esds,new Uint8Array([0,0,0,0,3,23+a,0,1,0,4,15+a,64,21,0,0,0,0,0,0,0,0,0,0,0,5,a].concat(i).concat([6,1,2]))))}return _()(t,e),t}(f),C=function(e){function t(e){r()(this,t);var i=e.sampleRate,a=e.channelCount;return u()(this,l()(t).call(this,g.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,i>>8&255,255&i,0,0]),new L(e).bytes))}return _()(t,e),t}(f),M=(i(94),function(e){function t(e,i){return r()(this,t),u()(this,l()(t).call(this,g.pasp,new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i])))}return _()(t,e),t}(f)),R=function(e){function t(){return r()(this,t),u()(this,l()(t).call(this,g.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}return _()(t,e),t}(f),B=function(e){function t(e,i,a){return r()(this,t),u()(this,l()(t).call(this,g.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(a))))}return _()(t,e),t}(f),N=function(e){function t(e){r()(this,t);var i,a,n,s=[],o=[];for(i=0;i<e.sps.length;i++)n=(a=e.sps[i]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(a));for(i=0;i<e.pps.length;i++)n=(a=e.pps[i]).byteLength,o.push(n>>>8&255),o.push(255&n),o=o.concat(Array.prototype.slice.call(a));var d=new B(e,s,o).bytes,c=e.width,h=e.height,_=e.pixelRatio[0],f=e.pixelRatio[1];return u()(this,l()(t).call(this,g.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,h>>8&255,255&h,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,(new R).bytes,new M(_,f).bytes))}return _()(t,e),t}(f),F=function(e){function t(e){r()(this,t);var i,a=new Uint8Array([0,0,0,0,0,0,0,1]);return i="audio"===e.type?e.isAAC||"mp3"!==e.codec?function(e){return new C(e).bytes}(e):function(e){return new O(e).bytes}(e):function(e){return new N(e).bytes}(e),u()(this,l()(t).call(this,g.stsd,a,i))}return _()(t,e),t}(f),U=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.stbl,function(e){return new F(e).bytes}(e),q,A,w,D))}return _()(t,e),t}(f),V=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.minf,"audio"===e.type?I:E,x,function(e){return new U(e).bytes}(e)))}return _()(t,e),t}(f),H=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.mdia,(i=e.timescale,a=e.duration,new y(i,a).bytes),function(e){return new S(e).bytes}(e.type),function(e){return new V(e).bytes}(e)));var i,a}return _()(t,e),t}(f),W=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.trak,function(e){return new b(e).bytes}(e),function(e){return new H(e).bytes}(e)))}return _()(t,e),t}(f),j=i(153),G=i.n(j),z=function(e){function t(e){r()(this,t);var i=e.id;return u()(this,l()(t).call(this,g.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])))}return _()(t,e),t}(f),K=function(e){function t(e){var i;return r()(this,t),u()(this,(i=l()(t)).call.apply(i,[this,g.mvex].concat(G()(e))))}return _()(t,e),t}(f),Y=function(e){for(var t,i=e.length,a=[];i--;)a[i]=(t=e[i],new z(t).bytes);return new K(a).bytes},Q=function(e){function t(e){var i;r()(this,t);for(var a,n,s,o=e.length,d=[];o--;)d[o]=((a=e[o]).duration=a.duration||4294967295,new W(a).bytes);return u()(this,(i=l()(t)).call.apply(i,[this,g.moov,(n=e[0].timescale,s=e[0].duration,new v(n,s).bytes)].concat(d,[Y(e)])))}return _()(t,e),t}(f),J=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e])))}return _()(t,e),t}(f),X=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.tfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e])))}return _()(t,e),t}(f),Z=function(e){function t(e,i){return r()(this,t),u()(this,l()(t).call(this,g.tfdt,new Uint8Array([1,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i])))}return _()(t,e),t}(f),$=(i(264),function(e){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],i=arguments.length>1?arguments[1]:undefined;r()(this,t);var a,n,s,o,d,c=e.length,h=12+16*c,_=new Uint8Array(h);i+=8+h,_.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var f=0;f<c;f++)n=(a=e[f]).duration,s=a.size,o=a.flags,d=a.cts,_.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSyncSample,61440&o.degradationPriority,15&o.degradationPriority,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*f);return u()(this,l()(t).call(this,g.trun,_))}return _()(t,e),t}(f)),ee=function(e){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];r()(this,t);for(var i,a=new Uint8Array(4+e.length),n=0;n<e.length;n++)i=e[n].flags,a[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return u()(this,l()(t).call(this,g.sdtp,a))}return _()(t,e),t}(f),te=function(e){function t(e,i){r()(this,t);var a=e.id,n=e.samples,s=Math.floor(i/(re.UINT32_MAX+1)),o=Math.floor(i%(re.UINT32_MAX+1)),d=function(e){return new ee(e).bytes}(n);return u()(this,l()(t).call(this,g.traf,function(e){return new X(e).bytes}(a),function(e,t){return new Z(e,t).bytes}(s,o),function(e,t){return new $(e,t).bytes}(n,d.length+16+20+8+16+8+8),d))}return _()(t,e),t}(f),ie=function(e){function t(e,i,a){return r()(this,t),u()(this,l()(t).call(this,g.moof,new J(e).bytes,function(e,t){return new te(e,t).bytes}(a,i)))}return _()(t,e),t}(f),ae=function(e){function t(e){return r()(this,t),u()(this,l()(t).call(this,g.mdat,e))}return _()(t,e),t}(f),ne=function(){function e(){r()(this,e),this.UINT32_MAX=Math.pow(2,32)-1}return o()(e,[{key:"initSegment",value:function(e){var t,i=function(e){return new Q(e).bytes}(e);try{t=new Uint8Array(m.byteLength+i.byteLength)}catch(a){throw"mp4 initSegment alloc mem err ".concat(m.byteLength,"-").concat(i.byteLength)}return t.set(m),t.set(i,m.byteLength),t}},{key:"moof",value:function(e,t,i){return function(e,t,i){return new ie(e,t,i).bytes}(e,t,i)}},{key:"mdat",value:function(e){return function(e){return new ae(e).bytes}(e)}}]),e}(),re=t.a=new ne},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.duration_second=0,this.file_name=null,this.start_second=0,this.seekable={pos:[],time:[]},this.sourceID=null,this.loadInfo=[],this.size=0}}]),e}();t.a=o},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(a){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";i(102);var a,n=i(33),r=i(87),s=i(242),o=i(30),d=i(203),u=i(103),c=i(161),l=i(92),h=i(254),_=i(255),f=i(188).codeAt,p=i(279),g=i(144),m=i(280),v=i(119),b=o.URL,y=m.URLSearchParams,k=m.getState,T=v.set,S=v.getterFor("URL"),P=Math.floor,x=Math.pow,I=/[A-Za-z]/,E=/[\d+\-.A-Za-z]/,D=/\d/,w=/^(0x|0X)/,A=/^[0-7]+$/,q=/^\d+$/,O=/^[\dA-Fa-f]+$/,L=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,C=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,M=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,R=/[\u0009\u000A\u000D]/g,B=function(e,t){var i,a,n;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return"Invalid host";if(!(i=F(t.slice(1,-1))))return"Invalid host";e.host=i}else if(K(e)){if(t=p(t),L.test(t))return"Invalid host";if(null===(i=N(t)))return"Invalid host";e.host=i}else{if(C.test(t))return"Invalid host";for(i="",a=_(t),n=0;n<a.length;n++)i+=G(a[n],V);e.host=i}},N=function(e){var t,i,a,n,r,s,o,d=e.split(".");if(d.length&&""==d[d.length-1]&&d.pop(),(t=d.length)>4)return e;for(i=[],a=0;a<t;a++){if(""==(n=d[a]))return e;if(r=10,n.length>1&&"0"==n.charAt(0)&&(r=w.test(n)?16:8,n=n.slice(8==r?1:2)),""===n)s=0;else{if(!(10==r?q:8==r?A:O).test(n))return e;s=parseInt(n,r)}i.push(s)}for(a=0;a<t;a++)if(s=i[a],a==t-1){if(s>=x(256,5-t))return null}else if(s>255)return null;for(o=i.pop(),a=0;a<i.length;a++)o+=i[a]*x(256,3-a);return o},F=function(e){var t,i,a,n,r,s,o,d=[0,0,0,0,0,0,0,0],u=0,c=null,l=0,h=function(){return e.charAt(l)};if(":"==h()){if(":"!=e.charAt(1))return;l+=2,c=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=i=0;i<4&&O.test(h());)t=16*t+parseInt(h(),16),l++,i++;if("."==h()){if(0==i)return;if(l-=i,u>6)return;for(a=0;h();){if(n=null,a>0){if(!("."==h()&&a<4))return;l++}if(!D.test(h()))return;for(;D.test(h());){if(r=parseInt(h(),10),null===n)n=r;else{if(0==n)return;n=10*n+r}if(n>255)return;l++}d[u]=256*d[u]+n,2!=++a&&4!=a||u++}if(4!=a)return;break}if(":"==h()){if(l++,!h())return}else if(h())return;d[u++]=t}else{if(null!==c)return;l++,c=++u}}if(null!==c)for(s=u-c,u=7;0!=u&&s>0;)o=d[u],d[u--]=d[c+s-1],d[c+--s]=o;else if(8!=u)return;return d},U=function(e){var t,i,a,n;if("number"==typeof e){for(t=[],i=0;i<4;i++)t.unshift(e%256),e=P(e/256);return t.join(".")}if("object"==typeof e){for(t="",a=function(e){for(var t=null,i=1,a=null,n=0,r=0;r<8;r++)0!==e[r]?(n>i&&(t=a,i=n),a=null,n=0):(null===a&&(a=r),++n);return n>i&&(t=a,i=n),t}(e),i=0;i<8;i++)n&&0===e[i]||(n&&(n=!1),a===i?(t+=i?":":"::",n=!0):(t+=e[i].toString(16),i<7&&(t+=":")));return"["+t+"]"}return e},V={},H=h({},V,{" ":1,'"':1,"<":1,">":1,"`":1}),W=h({},H,{"#":1,"?":1,"{":1,"}":1}),j=h({},W,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),G=function(e,t){var i=f(e,0);return i>32&&i<127&&!l(t,e)?e:encodeURIComponent(e)},z={ftp:21,file:null,http:80,https:443,ws:80,wss:443},K=function(e){return l(z,e.scheme)},Y=function(e){return""!=e.username||""!=e.password},Q=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},J=function(e,t){var i;return 2==e.length&&I.test(e.charAt(0))&&(":"==(i=e.charAt(1))||!t&&"|"==i)},X=function(e){var t;return e.length>1&&J(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},Z=function(e){var t=e.path,i=t.length;!i||"file"==e.scheme&&1==i&&J(t[0],!0)||t.pop()},$=function(e){return"."===e||"%2e"===e.toLowerCase()},ee={},te={},ie={},ae={},ne={},re={},se={},oe={},de={},ue={},ce={},le={},he={},_e={},fe={},pe={},ge={},me={},ve={},be={},ye={},ke=function(e,t,i,n){var r,s,o,d,u,c=i||ee,h=0,f="",p=!1,g=!1,m=!1;for(i||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(M,"")),t=t.replace(R,""),r=_(t);h<=r.length;){switch(s=r[h],c){case ee:if(!s||!I.test(s)){if(i)return"Invalid scheme";c=ie;continue}f+=s.toLowerCase(),c=te;break;case te:if(s&&(E.test(s)||"+"==s||"-"==s||"."==s))f+=s.toLowerCase();else{if(":"!=s){if(i)return"Invalid scheme";f="",c=ie,h=0;continue}if(i&&(K(e)!=l(z,f)||"file"==f&&(Y(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,i)return void(K(e)&&z[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?c=_e:K(e)&&n&&n.scheme==e.scheme?c=ae:K(e)?c=oe:"/"==r[h+1]?(c=ne,h++):(e.cannotBeABaseURL=!0,e.path.push(""),c=ve)}break;case ie:if(!n||n.cannotBeABaseURL&&"#"!=s)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==s){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,c=ye;break}c="file"==n.scheme?_e:re;continue;case ae:if("/"!=s||"/"!=r[h+1]){c=re;continue}c=de,h++;break;case ne:if("/"==s){c=ue;break}c=me;continue;case re:if(e.scheme=n.scheme,s==a)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==s||"\\"==s&&K(e))c=se;else if("?"==s)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",c=be;else{if("#"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),c=me;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",c=ye}break;case se:if(!K(e)||"/"!=s&&"\\"!=s){if("/"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,c=me;continue}c=ue}else c=de;break;case oe:if(c=de,"/"!=s||"/"!=f.charAt(h+1))continue;h++;break;case de:if("/"!=s&&"\\"!=s){c=ue;continue}break;case ue:if("@"==s){p&&(f="%40"+f),p=!0,o=_(f);for(var v=0;v<o.length;v++){var b=o[v];if(":"!=b||m){var y=G(b,j);m?e.password+=y:e.username+=y}else m=!0}f=""}else if(s==a||"/"==s||"?"==s||"#"==s||"\\"==s&&K(e)){if(p&&""==f)return"Invalid authority";h-=_(f).length+1,f="",c=ce}else f+=s;break;case ce:case le:if(i&&"file"==e.scheme){c=pe;continue}if(":"!=s||g){if(s==a||"/"==s||"?"==s||"#"==s||"\\"==s&&K(e)){if(K(e)&&""==f)return"Invalid host";if(i&&""==f&&(Y(e)||null!==e.port))return;if(d=B(e,f))return d;if(f="",c=ge,i)return;continue}"["==s?g=!0:"]"==s&&(g=!1),f+=s}else{if(""==f)return"Invalid host";if(d=B(e,f))return d;if(f="",c=he,i==le)return}break;case he:if(!D.test(s)){if(s==a||"/"==s||"?"==s||"#"==s||"\\"==s&&K(e)||i){if(""!=f){var k=parseInt(f,10);if(k>65535)return"Invalid port";e.port=K(e)&&k===z[e.scheme]?null:k,f=""}if(i)return;c=ge;continue}return"Invalid port"}f+=s;break;case _e:if(e.scheme="file","/"==s||"\\"==s)c=fe;else{if(!n||"file"!=n.scheme){c=me;continue}if(s==a)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==s)e.host=n.host,e.path=n.path.slice(),e.query="",c=be;else{if("#"!=s){X(r.slice(h).join(""))||(e.host=n.host,e.path=n.path.slice(),Z(e)),c=me;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",c=ye}}break;case fe:if("/"==s||"\\"==s){c=pe;break}n&&"file"==n.scheme&&!X(r.slice(h).join(""))&&(J(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),c=me;continue;case pe:if(s==a||"/"==s||"\\"==s||"?"==s||"#"==s){if(!i&&J(f))c=me;else if(""==f){if(e.host="",i)return;c=ge}else{if(d=B(e,f))return d;if("localhost"==e.host&&(e.host=""),i)return;f="",c=ge}continue}f+=s;break;case ge:if(K(e)){if(c=me,"/"!=s&&"\\"!=s)continue}else if(i||"?"!=s)if(i||"#"!=s){if(s!=a&&(c=me,"/"!=s))continue}else e.fragment="",c=ye;else e.query="",c=be;break;case me:if(s==a||"/"==s||"\\"==s&&K(e)||!i&&("?"==s||"#"==s)){if(".."===(u=(u=f).toLowerCase())||"%2e."===u||".%2e"===u||"%2e%2e"===u?(Z(e),"/"==s||"\\"==s&&K(e)||e.path.push("")):$(f)?"/"==s||"\\"==s&&K(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&J(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(s==a||"?"==s||"#"==s))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==s?(e.query="",c=be):"#"==s&&(e.fragment="",c=ye)}else f+=G(s,W);break;case ve:"?"==s?(e.query="",c=be):"#"==s?(e.fragment="",c=ye):s!=a&&(e.path[0]+=G(s,V));break;case be:i||"#"!=s?s!=a&&("'"==s&&K(e)?e.query+="%27":e.query+="#"==s?"%23":G(s,V)):(e.fragment="",c=ye);break;case ye:s!=a&&(e.fragment+=G(s,H))}h++}},Te=function(e){var t,i,a=c(this,Te,"URL"),n=arguments.length>1?arguments[1]:undefined,s=String(e),o=T(a,{type:"URL"});if(n!==undefined)if(n instanceof Te)t=S(n);else if(i=ke(t={},String(n)))throw TypeError(i);if(i=ke(o,s,null,t))throw TypeError(i);var d=o.searchParams=new y,u=k(d);u.updateSearchParams(o.query),u.updateURL=function(){o.query=String(d)||null},r||(a.href=Pe.call(a),a.origin=xe.call(a),a.protocol=Ie.call(a),a.username=Ee.call(a),a.password=De.call(a),a.host=we.call(a),a.hostname=Ae.call(a),a.port=qe.call(a),a.pathname=Oe.call(a),a.search=Le.call(a),a.searchParams=Ce.call(a),a.hash=Me.call(a))},Se=Te.prototype,Pe=function(){var e=S(this),t=e.scheme,i=e.username,a=e.password,n=e.host,r=e.port,s=e.path,o=e.query,d=e.fragment,u=t+":";return null!==n?(u+="//",Y(e)&&(u+=i+(a?":"+a:"")+"@"),u+=U(n),null!==r&&(u+=":"+r)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==o&&(u+="?"+o),null!==d&&(u+="#"+d),u},xe=function(){var e=S(this),t=e.scheme,i=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(a){return"null"}return"file"!=t&&K(e)?t+"://"+U(e.host)+(null!==i?":"+i:""):"null"},Ie=function(){return S(this).scheme+":"},Ee=function(){return S(this).username},De=function(){return S(this).password},we=function(){var e=S(this),t=e.host,i=e.port;return null===t?"":null===i?U(t):U(t)+":"+i},Ae=function(){var e=S(this).host;return null===e?"":U(e)},qe=function(){var e=S(this).port;return null===e?"":String(e)},Oe=function(){var e=S(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Le=function(){var e=S(this).query;return e?"?"+e:""},Ce=function(){return S(this).searchParams},Me=function(){var e=S(this).fragment;return e?"#"+e:""},Re=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(r&&d(Se,{href:Re(Pe,(function(e){var t=S(this),i=String(e),a=ke(t,i);if(a)throw TypeError(a);k(t.searchParams).updateSearchParams(t.query)})),origin:Re(xe),protocol:Re(Ie,(function(e){var t=S(this);ke(t,String(e)+":",ee)})),username:Re(Ee,(function(e){var t=S(this),i=_(String(e));if(!Q(t)){t.username="";for(var a=0;a<i.length;a++)t.username+=G(i[a],j)}})),password:Re(De,(function(e){var t=S(this),i=_(String(e));if(!Q(t)){t.password="";for(var a=0;a<i.length;a++)t.password+=G(i[a],j)}})),host:Re(we,(function(e){var t=S(this);t.cannotBeABaseURL||ke(t,String(e),ce)})),hostname:Re(Ae,(function(e){var t=S(this);t.cannotBeABaseURL||ke(t,String(e),le)})),port:Re(qe,(function(e){var t=S(this);Q(t)||(""==(e=String(e))?t.port=null:ke(t,e,he))})),pathname:Re(Oe,(function(e){var t=S(this);t.cannotBeABaseURL||(t.path=[],ke(t,e+"",ge))})),search:Re(Le,(function(e){var t=S(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",ke(t,e,be)),k(t.searchParams).updateSearchParams(t.query)})),searchParams:Re(Ce),hash:Re(Me,(function(e){var t=S(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",ke(t,e,ye)):t.fragment=null}))}),u(Se,"toJSON",(function(){return Pe.call(this)}),{enumerable:!0}),u(Se,"toString",(function(){return Pe.call(this)}),{enumerable:!0}),b){var Be=b.createObjectURL,Ne=b.revokeObjectURL;Be&&u(Te,"createObjectURL",(function(e){return Be.apply(b,arguments)})),Ne&&u(Te,"revokeObjectURL",(function(e){return Ne.apply(b,arguments)}))}g(Te,"URL"),n({global:!0,forced:!s,sham:!r},{URL:Te})},function(e,t,i){var a=i(123);e.exports=a("navigator","userAgent")||""},function(e,t,i){var a=i(87),n=i(93),r=i(79),s=i(175);e.exports=a?Object.defineProperties:function(e,t){r(e);for(var i,a=s(t),o=a.length,d=0;o>d;)n.f(e,i=a[d++],t[i]);return e}},function(e,t,i){var a=i(123);e.exports=a("document","documentElement")},function(e,t,i){var a=i(39),n=i(178),r=a("iterator"),s=Array.prototype;e.exports=function(e){return e!==undefined&&(n.Array===e||s[r]===e)}},function(e,t,i){var a=i(39)("iterator"),n=!1;try{var r=0,s={next:function(){return{done:!!r++}},"return":function(){n=!0}};s[a]=function(){return this},Array.from(s,(function(){throw 2}))}catch(o){}e.exports=function(e,t){if(!t&&!n)return!1;var i=!1;try{var r={};r[a]=function(){return{next:function(){return{done:i=!0}}}},e(r)}catch(o){}return i}},function(e,t,i){var a=i(92),n=i(95),r=i(171),s=i(270),o=r("IE_PROTO"),d=Object.prototype;e.exports=s?Object.getPrototypeOf:function(e){return e=n(e),a(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?d:null}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},,function(e,t,i){"use strict";var a=0;t.a={WORKER_EXCEPTION:a++,WORKER_MSG_EXCEPTION:a++,TS_SYNC_BYTE:a++}},function(e,t,i){"use strict";var a=i(33),n=i(30),r=i(217),s=i(177),o=r.ArrayBuffer;a({global:!0,forced:n.ArrayBuffer!==o},{ArrayBuffer:o}),s("ArrayBuffer")},function(e,t,i){var a=i(92),n=i(213),r=i(128),s=i(93);e.exports=function(e,t){for(var i=n(t),o=s.f,d=r.f,u=0;u<i.length;u++){var c=i[u];a(e,c)||o(e,c,d(t,c))}}},function(e,t,i){var a=i(123),n=i(134),r=i(195),s=i(79);e.exports=a("Reflect","ownKeys")||function(e){var t=n.f(s(e)),i=r.f;return i?t.concat(i(e)):t}},function(e,t,i){e.exports=i(30)},function(e,t,i){var a=i(186);e.exports=a&&!Symbol.sham&&"symbol"==typeof Symbol()},function(e,t,i){"use strict";var a=i(33),n=i(236),r=i(207),s=i(174),o=i(144),d=i(96),u=i(103),c=i(39),l=i(146),h=i(178),_=i(237),f=_.IteratorPrototype,p=_.BUGGY_SAFARI_ITERATORS,g=c("iterator"),m=function(){return this};e.exports=function(e,t,i,c,_,v,b){n(i,t,c);var y,k,T,S=function(e){if(e===_&&D)return D;if(!p&&e in I)return I[e];switch(e){case"keys":case"values":case"entries":return function(){return new i(this,e)}}return function(){return new i(this)}},P=t+" Iterator",x=!1,I=e.prototype,E=I[g]||I["@@iterator"]||_&&I[_],D=!p&&E||S(_),w="Array"==t&&I.entries||E;if(w&&(y=r(w.call(new e)),f!==Object.prototype&&y.next&&(l||r(y)===f||(s?s(y,f):"function"!=typeof y[g]&&d(y,g,m)),o(y,P,!0,!0),l&&(h[P]=m))),"values"==_&&E&&"values"!==E.name&&(x=!0,D=function(){return E.call(this)}),l&&!b||I[g]===D||d(I,g,D),h[t]=D,_)if(k={values:S("values"),keys:v?D:S("keys"),entries:S("entries")},b)for(T in k)!p&&!x&&T in I||u(I,T,k[T]);else a({target:t,proto:!0,forced:p||x},k);return k}},function(e,t,i){"use strict";var a=i(30),n=i(87),r=i(72).NATIVE_ARRAY_BUFFER,s=i(96),o=i(196),d=i(31),u=i(161),c=i(107),l=i(74),h=i(239),_=i(274),f=i(134).f,p=i(93).f,g=i(218),m=i(144),v=i(119),b=v.get,y=v.set,k=a.ArrayBuffer,T=k,S=a.DataView,P=a.RangeError,x=_.pack,I=_.unpack,E=function(e){return[255&e]},D=function(e){return[255&e,e>>8&255]},w=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},A=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},q=function(e){return x(e,23,4)},O=function(e){return x(e,52,8)},L=function(e,t){p(e.prototype,t,{get:function(){return b(this)[t]}})},C=function(e,t,i,a){var n=h(i),r=b(e);if(n+t>r.byteLength)throw P("Wrong index");var s=b(r.buffer).bytes,o=n+r.byteOffset,d=s.slice(o,o+t);return a?d:d.reverse()},M=function(e,t,i,a,n,r){var s=h(i),o=b(e);if(s+t>o.byteLength)throw P("Wrong index");for(var d=b(o.buffer).bytes,u=s+o.byteOffset,c=a(+n),l=0;l<t;l++)d[u+l]=c[r?l:t-l-1]};if(r){if(!d((function(){k(1)}))||!d((function(){new k(-1)}))||d((function(){return new k,new k(1.5),new k(NaN),"ArrayBuffer"!=k.name}))){for(var R,B=(T=function(e){return u(this,T),new k(h(e))}).prototype=k.prototype,N=f(k),F=0;N.length>F;)(R=N[F++])in T||s(T,R,k[R]);B.constructor=T}var U=new S(new T(2)),V=S.prototype.setInt8;U.setInt8(0,2147483648),U.setInt8(1,2147483649),!U.getInt8(0)&&U.getInt8(1)||o(S.prototype,{setInt8:function(e,t){V.call(this,e,t<<24>>24)},setUint8:function(e,t){V.call(this,e,t<<24>>24)}},{unsafe:!0})}else T=function(e){u(this,T,"ArrayBuffer");var t=h(e);y(this,{bytes:g.call(new Array(t),0),byteLength:t}),n||(this.byteLength=t)},S=function(e,t,i){u(this,S,"DataView"),u(e,T,"DataView");var a=b(e).byteLength,r=c(t);if(r<0||r>a)throw P("Wrong offset");if(r+(i=i===undefined?a-r:l(i))>a)throw P("Wrong length");y(this,{buffer:e,byteLength:i,byteOffset:r}),n||(this.buffer=e,this.byteLength=i,this.byteOffset=r)},n&&(L(T,"byteLength"),L(S,"buffer"),L(S,"byteLength"),L(S,"byteOffset")),o(S.prototype,{getInt8:function(e){return C(this,1,e)[0]<<24>>24},getUint8:function(e){return C(this,1,e)[0]},getInt16:function(e){var t=C(this,2,e,arguments.length>1?arguments[1]:undefined);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=C(this,2,e,arguments.length>1?arguments[1]:undefined);return t[1]<<8|t[0]},getInt32:function(e){return A(C(this,4,e,arguments.length>1?arguments[1]:undefined))},getUint32:function(e){return A(C(this,4,e,arguments.length>1?arguments[1]:undefined))>>>0},getFloat32:function(e){return I(C(this,4,e,arguments.length>1?arguments[1]:undefined),23)},getFloat64:function(e){return I(C(this,8,e,arguments.length>1?arguments[1]:undefined),52)},setInt8:function(e,t){M(this,1,e,E,t)},setUint8:function(e,t){M(this,1,e,E,t)},setInt16:function(e,t){M(this,2,e,D,t,arguments.length>2?arguments[2]:undefined)},setUint16:function(e,t){M(this,2,e,D,t,arguments.length>2?arguments[2]:undefined)},setInt32:function(e,t){M(this,4,e,w,t,arguments.length>2?arguments[2]:undefined)},setUint32:function(e,t){M(this,4,e,w,t,arguments.length>2?arguments[2]:undefined)},setFloat32:function(e,t){M(this,4,e,q,t,arguments.length>2?arguments[2]:undefined)},setFloat64:function(e,t){M(this,8,e,O,t,arguments.length>2?arguments[2]:undefined)}});m(T,"ArrayBuffer"),m(S,"DataView"),e.exports={ArrayBuffer:T,DataView:S}},function(e,t,i){"use strict";var a=i(95),n=i(124),r=i(74);e.exports=function(e){for(var t=a(this),i=r(t.length),s=arguments.length,o=n(s>1?arguments[1]:undefined,i),d=s>2?arguments[2]:undefined,u=d===undefined?i:n(d,i);u>o;)t[o++]=e;return t}},function(e,t,i){"use strict";var a=i(122),n=i(6),r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];t.a=function(e,t,i){var s,o,d=e;if(!(t>r.length-1))return a.a.browser.FIREFOX?t>=6?(e=5,o=new Array(4),s=t-3):(e=2,o=new Array(2),s=t):a.a.os.android?(e=2,o=new Array(2),s=t):(e=5,o=new Array(4),t>=6?s=t-3:(1===i&&(e=2,o=new Array(2)),s=t)),o[0]=e<<3,o[0]|=(14&t)>>1,o[1]|=(1&t)<<7,o[1]|=i<<3,5===e&&(o[1]|=(14&s)>>1,o[2]=(1&s)<<7,o[2]|=8,o[3]=0),{config:o,sampleRate:r[t],channelCount:i,codec:"mp4a.40."+e,realCodec:"mp4a.40."+d};n.a.error("invalid sampling index:".concat(t))}},,function(e,t,i){"use strict";var a=i(33),n=i(30),r=i(87),s=i(275),o=i(72),d=i(217),u=i(161),c=i(126),l=i(96),h=i(74),_=i(239),f=i(240),p=i(129),g=i(92),m=i(160),v=i(85),b=i(142),y=i(174),k=i(134).f,T=i(277),S=i(110).forEach,P=i(177),x=i(93),I=i(128),E=i(119),D=i(184),w=E.get,A=E.set,q=x.f,O=I.f,L=Math.round,C=n.RangeError,M=d.ArrayBuffer,R=d.DataView,B=o.NATIVE_ARRAY_BUFFER_VIEWS,N=o.TYPED_ARRAY_TAG,F=o.TypedArray,U=o.TypedArrayPrototype,V=o.aTypedArrayConstructor,H=o.isTypedArray,W=function(e,t){for(var i=0,a=t.length,n=new(V(e))(a);a>i;)n[i]=t[i++];return n},j=function(e,t){q(e,t,{get:function(){return w(this)[t]}})},G=function(e){var t;return e instanceof M||"ArrayBuffer"==(t=m(e))||"SharedArrayBuffer"==t},z=function(e,t){return H(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},K=function(e,t){return z(e,t=p(t,!0))?c(2,e[t]):O(e,t)},Y=function(e,t,i){return!(z(e,t=p(t,!0))&&v(i)&&g(i,"value"))||g(i,"get")||g(i,"set")||i.configurable||g(i,"writable")&&!i.writable||g(i,"enumerable")&&!i.enumerable?q(e,t,i):(e[t]=i.value,e)};r?(B||(I.f=K,x.f=Y,j(U,"buffer"),j(U,"byteOffset"),j(U,"byteLength"),j(U,"length")),a({target:"Object",stat:!0,forced:!B},{getOwnPropertyDescriptor:K,defineProperty:Y}),e.exports=function(e,t,i,r){var o=e+(r?"Clamped":"")+"Array",d="get"+e,c="set"+e,p=n[o],g=p,m=g&&g.prototype,x={},I=function(e,i){q(e,i,{get:function(){return function(e,i){var a=w(e);return a.view[d](i*t+a.byteOffset,!0)}(this,i)},set:function(e){return function(e,i,a){var n=w(e);r&&(a=(a=L(a))<0?0:a>255?255:255&a),n.view[c](i*t+n.byteOffset,a,!0)}(this,i,e)},enumerable:!0})};B?s&&(g=i((function(e,i,a,n){return u(e,g,o),D(v(i)?G(i)?n!==undefined?new p(i,f(a,t),n):a!==undefined?new p(i,f(a,t)):new p(i):H(i)?W(g,i):T.call(g,i):new p(_(i)),e,g)})),y&&y(g,F),S(k(p),(function(e){e in g||l(g,e,p[e])})),g.prototype=m):(g=i((function(e,i,a,n){u(e,g,o);var r,s,d,c=0,l=0;if(v(i)){if(!G(i))return H(i)?W(g,i):T.call(g,i);r=i,l=f(a,t);var p=i.byteLength;if(n===undefined){if(p%t)throw C("Wrong length");if((s=p-l)<0)throw C("Wrong length")}else if((s=h(n)*t)+l>p)throw C("Wrong length");d=s/t}else d=_(i),r=new M(s=d*t);for(A(e,{buffer:r,byteOffset:l,byteLength:s,length:d,view:new R(r)});c<d;)I(e,c++)})),y&&y(g,F),m=g.prototype=b(U)),m.constructor!==g&&l(m,"constructor",g),N&&l(m,N,o),x[o]=g,a({global:!0,forced:g!=p,sham:!B},x),"BYTES_PER_ELEMENT"in g||l(g,"BYTES_PER_ELEMENT",t),"BYTES_PER_ELEMENT"in m||l(m,"BYTES_PER_ELEMENT",t),P(o)}):e.exports=function(){}},function(e,t,i){var a=i(30),n=i(170),r=a["__core-js_shared__"]||n("__core-js_shared__",{});e.exports=r},function(e,t,i){var a=i(30),n=i(193),r=a.WeakMap;e.exports="function"==typeof r&&/native code/.test(n.call(r))},function(e,t,i){var a=i(30),n=i(159).trim,r=i(148),s=a.parseInt,o=/^[+-]?0[Xx]/,d=8!==s(r+"08")||22!==s(r+"0x16");e.exports=d?function(e,t){var i=n(String(e));return s(i,t>>>0||(o.test(i)?16:10))}:s},function(e,t){function i(t,a){return e.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(t,a)}e.exports=i},function(e,t,i){var a=i(85);e.exports=function(e){if(!a(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,i){var a=i(113);e.exports=function(e){if("number"!=typeof e&&"Number"!=a(e))throw TypeError("Incorrect invocation");return+e}},function(e,t,i){"use strict";var a=i(107),n=i(106);e.exports="".repeat||function(e){var t=String(n(this)),i="",r=a(e);if(r<0||r==Infinity)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(i+=t);return i}},function(e,t,i){var a=i(30),n=i(159).trim,r=i(148),s=a.parseFloat,o=1/s(r+"-0")!=-Infinity;e.exports=o?function(e){var t=n(String(e)),i=s(t);return 0===i&&"-"==t.charAt(0)?-0:i}:s},function(e,t,i){"use strict";var a=i(176),n=i(160);e.exports=a?{}.toString:function(){return"[object "+n(this)+"]"}},function(e,t,i){var a=i(79),n=i(205),r=i(74),s=i(135),o=i(179),d=i(232),u=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,i,c,l){var h,_,f,p,g,m,v,b=s(t,i,c?2:1);if(l)h=e;else{if("function"!=typeof(_=o(e)))throw TypeError("Target is not iterable");if(n(_)){for(f=0,p=r(e.length);p>f;f++)if((g=c?b(a(v=e[f])[0],v[1]):b(e[f]))&&g instanceof u)return g;return new u(!1)}h=_.call(e)}for(m=h.next;!(v=m.call(h)).done;)if("object"==typeof(g=d(h,b,v.value,c))&&g&&g instanceof u)return g;return new u(!1)}).stop=function(e){return new u(!0,e)}},function(e,t,i){var a=i(79);e.exports=function(e,t,i,n){try{return n?t(a(i)[0],i[1]):t(i)}catch(s){var r=e["return"];throw r!==undefined&&a(r.call(e)),s}}},function(e,t,i){var a,n,r,s=i(30),o=i(31),d=i(113),u=i(135),c=i(204),l=i(182),h=i(234),_=s.location,f=s.setImmediate,p=s.clearImmediate,g=s.process,m=s.MessageChannel,v=s.Dispatch,b=0,y={},k=function(e){if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},T=function(e){return function(){k(e)}},S=function(e){k(e.data)},P=function(e){s.postMessage(e+"",_.protocol+"//"+_.host)};f&&p||(f=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return y[++b]=function(){("function"==typeof e?e:Function(e)).apply(undefined,t)},a(b),b},p=function(e){delete y[e]},"process"==d(g)?a=function(e){g.nextTick(T(e))}:v&&v.now?a=function(e){v.now(T(e))}:m&&!h?(r=(n=new m).port2,n.port1.onmessage=S,a=u(r.postMessage,r,1)):!s.addEventListener||"function"!=typeof postMessage||s.importScripts||o(P)?a="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),k(e)}}:function(e){setTimeout(T(e),0)}:(a=P,s.addEventListener("message",S,!1))),e.exports={set:f,clear:p}},function(e,t,i){var a=i(202);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(a)},function(e,t,i){"use strict";var a=i(136),n=function(e){var t,i;this.promise=new e((function(e,a){if(t!==undefined||i!==undefined)throw TypeError("Bad Promise constructor");t=e,i=a})),this.resolve=a(t),this.reject=a(i)};e.exports.f=function(e){return new n(e)}},function(e,t,i){"use strict";var a=i(237).IteratorPrototype,n=i(142),r=i(126),s=i(144),o=i(178),d=function(){return this};e.exports=function(e,t,i){var u=t+" Iterator";return e.prototype=n(a,{next:r(1,i)}),s(e,u,!1,!0),o[u]=d,e}},function(e,t,i){"use strict";var a,n,r,s=i(207),o=i(96),d=i(92),u=i(39),c=i(146),l=u("iterator"),h=!1;[].keys&&("next"in(r=[].keys())?(n=s(s(r)))!==Object.prototype&&(a=n):h=!0),a==undefined&&(a={}),c||d(a,l)||o(a,l,(function(){return this})),e.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:h}},function(e,t,i){"use strict";var a=i(110).forEach,n=i(141);e.exports=n("forEach")?function(e){return a(this,e,arguments.length>1?arguments[1]:undefined)}:[].forEach},function(e,t,i){var a=i(107),n=i(74);e.exports=function(e){if(e===undefined)return 0;var t=a(e),i=n(t);if(t!==i)throw RangeError("Wrong length or index");return i}},function(e,t,i){var a=i(276);e.exports=function(e,t){var i=a(e);if(i%t)throw RangeError("Wrong offset");return i}},function(e,t,i){var a=i(136),n=i(95),r=i(139),s=i(74),o=function(e){return function(t,i,o,d){a(i);var u=n(t),c=r(u),l=s(u.length),h=e?l-1:0,_=e?-1:1;if(o<2)for(;;){if(h in c){d=c[h],h+=_;break}if(h+=_,e?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;e?h>=0:l>h;h+=_)h in c&&(d=i(d,c[h],h,u));return d}};e.exports={left:o(!1),right:o(!0)}},function(e,t,i){var a=i(31),n=i(39),r=i(146),s=n("iterator");e.exports=!a((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,i="";return e.pathname="c%20d",t.forEach((function(e,a){t["delete"]("b"),i+=a+e})),r&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==i||"x"!==new URL("http://x",undefined).host}))},function(e,t,i){var a=i(31),n=i(148);e.exports=function(e){return a((function(){return!!n[e]()||"​᠎"!="​᠎"[e]()||n[e].name!==e}))}},function(e,t,i){"use strict";i(73),i(109),i(114),i(12),i(18),i(25);var a=/^(b|B)$/,n={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},r={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};t.a=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(isNaN(e))return"";var i=[],s=0,o=!0===t.bits,d=!0===t.unix,u=t.base||2,c=void 0!==t.round?t.round:d?1:2,l=void 0!==t.separator&&t.separator||"",h=void 0!==t.spacer?t.spacer:"",_=t.symbols||t.suffixes||{},f=2===u&&t.standard||"jedec",p=t.output||"string",g=!0===t.fullform,m=t.fullforms instanceof Array?t.fullforms:[],v=void 0!==t.exponent?t.exponent:-1,b=Number(e),y=b<0,k=u>2?1e3:1024;return y&&(b=-b),(-1===v||isNaN(v))&&(v=Math.floor(Math.log(b)/Math.log(k)))<0&&(v=0),v>8&&(v=8),0===b?(i[0]=0,i[1]=d?"":n[f][o?"bits":"bytes"][v]):(s=b/(2===u?Math.pow(2,10*v):Math.pow(1e3,v)),o&&(s*=8)>=k&&v<8&&(s/=k,v++),i[0]=Number(s.toFixed(v>0?c:0)),i[1]=10===u&&1===v?o?"kb":"kB":n[f][o?"bits":"bytes"][v],d&&(i[1]="jedec"===f?i[1].charAt(0):v>0?i[1].replace(/B$/,""):i[1],a.test(i[1])&&(i[0]=Math.floor(i[0]),i[1]=""))),y&&(i[0]=-i[0]),i[1]=_[i[1]]||i[1],"array"===p?i:"exponent"===p?v:"object"===p?{value:i[0],suffix:i[1],symbol:i[1]}:(g&&(i[1]=m[v]?m[v]:r[f][v]+(o?"bit":"byte")+(1===i[0]?"":"s")),l.length>0&&(i[0]=i[0].toString().replace(".",l)),i.join(h))}},function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-poster{position:absolute;width:100%;height:100%;top:0;background-size:contain;background-position:50%;background-repeat:no-repeat}",""])},,,function(e,t,i){"use strict";i(21),i(40),i(12),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(32),h=i.n(l),_=i(5),f=i.n(_),p=i(6),g=i(76),m=i(115),v=i(68),b={Demux:function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=t.meta||{};for(var a in i){var n=i[a];n&&(p.a.log("dash demux pushing buffer: ".concat(n.contentType)),this.emit("data",{type:"fragment",contentType:n.contentType,bytes:n.bytes,duration:n.segment.duration,startDTS:n.segment.startTime,startPTS:n.segment.startTime}))}}},{key:"endStream",get:function(){return this}}]),t}(g.a),Remux:function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){switch(e.type){case"initSegment":this.emit("data",{fragmentType:"initSegment",contentType:e.contentType,data:e.bytes});break;case"fragment":this.emit("data",{fragmentType:"fragment",contentType:e.contentType,data:e.bytes,startDTS:e.startDTS,startPTS:e.startPTS,duration:e.duration})}}},{key:"endStream",get:function(){return this}}]),t}(g.a)};i(109),i(23),i(211);function y(e){var t=0;return ArrayBuffer.isView(e)&&(t=e.byteOffset,e=e.buffer),new DataView(e,t)}var k=function(){function e(){n()(this,e)}return s()(e,[{key:"readUint8",value:function(e,t){return y(e).getUint8(t)}},{key:"readUint16",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2];return y(e).getUint16(t,i)}},{key:"readUint32",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2];return y(e).getUint32(t,i)}}]),e}(),T=function(){function e(t){n()(this,e)}return s()(e,null,[{key:"parseFlvHead",value:function(e){var t=e;if(e.length<13||70!==e[0]||76!==e[1]||86!==e[2])return null;var i={hasVideoTags:!1,hasAudioTags:!1},a=0,n=t[4];!0&n&&(i.hasVideoTags=!0,a++),(4&n)>>2==1&&(i.hasAudioTags=!0,a++);for(var r=0,s=0,o=0,d=t.length-1,u=13;u+15<=d;){var c=t[u];if(c!=this.TAG_TYPE_VIDEO&&c!=this.TAG_TYPE_AUDIO&&c!=this.TAG_TYPE_SCRIPTDATAOBJECT)break;if(0!=t[u+8]||0!=t[u+9])break;if(!(u+(s=(t[u+1]<<16)+(t[u+2]<<8)+t[u+3])+15<=d&&s>=0))break;if(s!=(o=(t[u+1+11+s]<<16)+(t[u+2+11+s]<<8)+t[u+3+11+s]-11))break;if(c==this.TAG_TYPE_SCRIPTDATAOBJECT){var l=t.subarray(u+11,s+u+11),h=this._AMFdeSerialize(l);i.info=h.onMetaData,l=null,a++}else i.hasVideoTags&&c==this.TAG_TYPE_VIDEO?(i.firstVideo=t.subarray(u,o+11+u),i.firstVideo=this._uint8arrayWrite32(i.firstVideo,o+11)):i.hasAudioTags&&c==this.TAG_TYPE_AUDIO&&(i.firstAudio=t.subarray(u,o+11+u),i.firstAudio=this._uint8arrayWrite32(i.firstAudio,o+11));if(++r>=a)return i;u+=o+4+11}return i}},{key:"_AMFdeSerialize",value:function(e){var t={},i=this._parseData(e);return t[i.key]=i.value,t}},{key:"_parseData",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=null,a=null,n=null;if(t){try{n=new Uint8Array(e.length+1)}catch(o){p.a.error("flv parseData failed: ".concat(o.message))}n[0]=2,n.set(e,1,e.length)}else n=e;i=this._deSerialize(n),t&&(i.valueLength-=1);var r=e.subarray(i.valueLength,e.byteLength);a=this._deSerialize(r);var s={};return s.key=i.value,s.value=a.value,s.valueLength=i.valueLength+a.valueLength,n=null,r=null,i=null,s}},{key:"_deSerialize",value:function(e){var t={},i=0,a=new k;switch(e[0]){case 0:i=8,t.value=this._uint8arrayToDouble(e.subarray(1,9)),t.valueLength=1+i;break;case 1:i=1,t.value=0!==e[1],t.valueLength=1+i;break;case 2:i=e[1]<<8|e[2],t.value=this._uint8arrayToString(e.subarray(3,3+i)),t.valueLength=3+i;break;case 3:for(i=1,t.value={};0!=e[i]||0!=e[i+1]||9!=e[i+2];){var n=e.subarray(i,e.byteLength),r=this._parseData(n,!0);t.value[r.key]=r.value,i+=r.valueLength,n=null}i+=3,t.valueLength=i;break;case 4:i=e[1]<<8|e[2],t.value=this._uint8arrayToString(e.subarray(3,3+i)),t.valueLength=3+i;break;case 5:t.value=null,i=1,t.valueLength=i;break;case 6:t.value=undefined,i=1,t.valueLength=i;break;case 7:t.value=a.readUint16(e,1),i=3,t.valueLength=i;break;case 8:var s=e[1]<<24|e[2]<<16|e[3]<<8|e[4];i=5,t.value={};for(var o=0;o<s;o++){var d=e.subarray(i,e.byteLength),u=this._parseData(d,!0);t.value[u.key]=u.value,i+=u.valueLength}i+=3,t.valueLength=i;break;case 9:break;case 10:for(var c=[],l=a.readUint32(e,1),h=0;h<l;h++){var _=e.subarray(9*h+4+1,e.byteLength);c.push(this._deSerialize(_).value)}t.value=c,i=9*c.length+4+1,t.valueLength=i;break;case 11:t.value=this._uint8arrayToDouble(e.subarray(0,8)),i=11,t.valueLength=i;break;case 12:i=e[1]<<24|e[2]<<16|e[3]<<8|e[4],t.value=this._uint8arrayToString(e.subarray(5,5+i)),t.valueLength=5+i;break;default:return null}return a=null,t}},{key:"parseAVCDecoderConfigurationRecord",value:function(e){var t=1+(3&e[4]),i=[],a=[],n=5,r=31&e[n];if(0===r)p.a.error("Flv: Invalid AVCDecoderConfigurationRecord: No SPS");else if(r>0){r>1&&p.a.warn("Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(r)),n++;for(var s=0;s<r;s++){var o=e[n]<<8|e[n+1];n+=2,a.push(e.subarray(n,n+o)),n+=o}}var d=e[n];if(0===d)p.a.error("Flv: Invalid AVCDecoderConfigurationRecord: No PPS");else if(d>0){d>1&&p.a.warn("Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(d)),n++;for(var u=0;u<d;u++){var c=e[n]<<8|e[n+1];n+=2,i.push(e.subarray(n,n+c)),n+=c}}return{naluSizeLength:t,spsNalus:a,ppsNalus:i}}},{key:"parseFLVTag",value:function(t){var i=null,a=t[0],n=t[1]<<16|t[2]<<8|t[3],r=null,s=null,o=t[7]<<24|t[4]<<16|t[5]<<8|t[6],d=t.subarray(11);if(a==this.TAG_TYPE_VIDEO){var u=1===(d[0]>>4&15),c=15&d[0];if(c===this.CODEC_ID_AVC){var l=d.subarray(1),h=l[0],_=l[1]<<16|l[2]<<8|l[3];if(s=(r=90*o)+90*_,8388608&_&&(_|=4278190080),h==this.AVC_PACKET_TYPE_SEQUENCE_HEADER){var f=e.parseAVCDecoderConfigurationRecord(l.subarray(4));i={type:"video",isKeyframe:u,PTS:s,DTS:r,sps:f.spsNalus[0],pps:f.ppsNalus[0],naluSizeLength:f.naluSizeLength}}else if(h==this.AVC_PACKET_TYPE_NALU){i={type:"video",isKeyframe:u,PTS:s,DTS:r,data_byte:t.subarray(this.TAG_HEADER_BYTE_COUNT+5,this.TAG_HEADER_BYTE_COUNT+5+n-5)}}else p.a.error("flv unknown avcPacketType ".concat(h))}else p.a.error("flv video data unhandled codecID ".concat(c))}else if(a==this.TAG_TYPE_AUDIO){var g=t[this.TAG_HEADER_BYTE_COUNT+0],m=g>>4&15,v=1==(1&g)?16:8;if(s=r=90*o,m==this.SOUND_FORMAT_AAC)if(0==t[this.TAG_HEADER_BYTE_COUNT+1]){var b=t[this.TAG_HEADER_BYTE_COUNT+2],y=t[this.TAG_HEADER_BYTE_COUNT+3],k=(7&b)<<1|y>>7;i={type:"audio",pts:s,dts:r,audioObjectType:(248&b)>>3,sampleCount:1024,channelCount:y>>3&15,sampleRate:this.ADTS_SAMPLING_FREQUENCIES[k],samplingFrequencyIndex:k,sampleSize:v}}else i={type:"audio",PTS:s,DTS:r,data_byte:t.subarray(this.TAG_HEADER_BYTE_COUNT+2,this.TAG_HEADER_BYTE_COUNT+2+n-2)};else p.a.error("flv unhandled soundFormat ".concat(m))}else p.a.warn("flv unhandled tag type ".concat(a));return i}},{key:"_uint8arrayToString",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"_uint8arrayToDouble",value:function(e){var t=new Uint8Array(e),i=new DataView(t.buffer),a=i.getFloat64(0);return i=null,t=null,a}},{key:"_uint8arrayWrite32",value:function(e,t){var i,a=new Uint8Array(4);new DataView(a.buffer).setInt32(0,t);try{i=new Uint8Array(e.byteLength+4)}catch(n){p.a.error("flv uint8arrayWrite32 ".concat(e.byteLength," failed: ").concat(n.message))}return i.set(e),i.set(a,e.byteLength),i}}]),e}();T.TAG_TYPE_VIDEO=9,T.TAG_TYPE_AUDIO=8,T.TAG_TYPE_SCRIPTDATAOBJECT=18,T.TAG_HEADER_BYTE_COUNT=11,T.AVC_PACKET_TYPE_SEQUENCE_HEADER=0,T.AVC_PACKET_TYPE_NALU=1,T.CODEC_ID_AVC=7,T.SOUND_FORMAT_AAC=10,T.ADTS_SAMPLING_FREQUENCIES=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];var S=i(81),P=i(80),x=1,I=2,E=3,D=4,w=5,A=6,q=7,O=8,L=9;i(24);function C(e){for(var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1,a=0,n="",r=t;r<t+i;r++)a=7-r%8,n+=e[Math.floor(r/8)]>>a&1;return parseInt(n,2)}function M(e){for(var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=[],a=8*e.byteLength,n=!1,r=0,s=0,o="",d=t;d<a;d++)if(r=7-d%8,s=e[Math.floor(d/8)]>>r&1,!n){if(0!==s){n=!0,t=d;break}i.push(0)}for(var u=i.length+1,c=t;c<t+u;c++)r=7-c%8,o+=s=e[Math.floor(c/8)]>>r&1;return o=parseInt(o,2)-1,{bitLength:i.length+u,value:o}}var R={readUEV:M,readSEV:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=M(e,t),a=i.value,n=Math.pow(-1,a+1)*Math.ceil(a/2);return{bitLength:i.bitLength,value:n}},readBit:C,readByte:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return C(e,t,8)}},B=0;function N(e,t){for(var i,a=8,n=8,r=0;r<t;r++)0!=n&&(i=R.readUEV(e,B),B+=i.bitLength,n=(a+i.value+256)%256),a=e[r]}i(427);var F=function(e){function t(e){var i;switch(n()(this,t),(i=d()(this,c()(t).call(this))).forbidden_zero_bit=e[0]>>7,i.ref_idc=e[0]>>5&3,i.unit_type=31&e[0],i.data=function(e){for(var t,i=e.byteLength,a=[],n=1,r=new Uint8Array(0);n<i-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(a.push(n+2),n+=2):n++;if(0===a.length)return e;t=i-a.length;try{r=new Uint8Array(t)}catch(o){throw"epsb alloc mem error ".concat(t)}var s=0;for(n=0;n<t;s++,n++)s===a[0]&&(s++,a.shift()),r[n]=e[s];return r}(e.subarray(1)),i.rawData=e,i.unit_type){case x:break;case I:case E:case D:case w:break;case q:i.sps=function(e){B=0;var t,i,a,n,r,s,o,d=e[0],u=e[1],c=e[2],l=e.subarray(3),h=0,_=[1,1],f=1,p=0,g=!0,m=R.readUEV(l,B);if(B+=m.bitLength,100==d||110==d||122==d||244==d||44==d||83==d||86==d||118==d||128==d){var v=R.readUEV(l,B);B+=v.bitLength,3==v.value&&(B+=1);var b=R.readUEV(l,B);B+=b.bitLength;var y=R.readUEV(l,B);if(B+=y.bitLength,B+=1,h=R.readBit(l,B),B+=1,h)for(var k=0;k<(3!=v.value?8:12);k++){var T=R.readBit(l,B);B+=1,T&&N(l,k<6?16:64)}}var S=R.readUEV(l,B);B+=S.bitLength;var P=R.readUEV(l,B),x=P.value;if(B+=P.bitLength,0===x)t=R.readUEV(l,B),B+=t.bitLength;else if(1===x){B+=1,i=R.readSEV(l,B),B+=i.bitLength,a=R.readSEV(l,B),B+=a.bitLength,n=R.readUEV(l,B),B+=n.bitLength;for(var I,E=0;E<n.value;E++)I=R.readSEV(l,B),B+=I.bitLength}var D=R.readUEV(l,B);B+=D.bitLength,B+=1;var w=R.readUEV(l,B);B+=w.bitLength;var A=R.readUEV(l,B);B+=A.bitLength;var q=R.readBit(l,B);B+=1,q||(B+=1),B+=1;var O=R.readBit(l,B);B+=1;var L=0,C=0,M=0,F=0;if(O){var U=R.readUEV(l,B);B+=U.bitLength,L=U.value;var V=R.readUEV(l,B);B+=V.bitLength,C=V.value;var H=R.readUEV(l,B);B+=H.bitLength,M=H.value;var W=R.readUEV(l,B);B+=W.bitLength,F=W.value}var j=R.readBit(l,B);if(B+=1,j){var G=R.readBit(l,B);if(B+=1,G){var z=R.readByte(l,B);switch(B+=8,z){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:var K=R.readByte(l,B);B+=8;var Y=R.readByte(l,B);B+=8;var Q=R.readByte(l,B);B+=8;var J=R.readByte(l,B);B+=8,_=[K<<8|Y,Q<<8|J]}_&&(f=_[0]/_[1]),255===z&&(B+=16,B+=16)}var X=R.readBit(l,B);B+=1,X&&(B+=1);var Z=R.readBit(l,B);if(B+=1,Z){r=R.readBit(l,B,3),B+=3,B+=1;var $=R.readBit(l,B);B+=1,$&&(B+=24)}var ee=R.readBit(l,B);if(B+=1,ee){var te=R.readUEV(l,B);B+=te.bitLength;var ie=R.readUEV(l,B);B+=ie.bitLength}var ae=R.readBit(l,B);B+=1,ae&&(s=R.readBit(l,B,32),B+=32,o=R.readBit(l,B,32),B+=32,g=R.readBit(l,B),B+=1,p=o/(2*s))}return{profile_idc:d,profile_compatibility:u,level_idc:c,sps_id:m.value,log2_max_frame_num_minus4:P.value,pic_order_cnt_type:x,log2_max_pic_order_cnt_lsb_minus4:t?t.value:0,width:Math.ceil((16*(w.value+1)-2*L-2*C)*f),height:(2-q)*(A.value+1)*16-2*M-2*F,pixelRatio:_,payload:l,video_format:r,fps:p,fixedFPS:g}}(i.data);break;case O:i.pps=function(e){var t,i=0,a=e,n=[],r=0;i+=R.readUEV(a,i).bitLength,i+=R.readUEV(a,i).bitLength;R.readBit(a,i);i+=1;R.readBit(a,i);i+=1;var s=R.readUEV(a,i);if(i+=s.bitLength,s.value>0){var o=R.readUEV(a,i);i+=o.bitLength;var d=0;switch(o.value){case 0:for(d=0;d<=o.value;d++)i+=R.readUEV(a,i).bitLength;break;case 2:for(d=0;d<=o.value;d++)i+=R.readUEV(a,i).bitLength,i+=R.readUEV(a,i).bitLength;break;case 3:case 4:case 5:R.readBit(a,i),i+=1,i+=R.readUEV(a,i).bitLength;break;case 6:i+=(t=R.readUEV(a,i)).bitLength;var u=Math.ceil(Math.log2(s.value+1));for(r=0;r<=t.value;r++)n.push(R.readBit(a,i,u)),i+=u}}i+=R.readUEV(a,i).bitLength,i+=R.readUEV(a,i).bitLength;R.readBit(a,i);i+=1;R.readBit(a,i,2);i+=1,i+=R.readSEV(a,i).bitLength,i+=R.readSEV(a,i).bitLength,i+=R.readSEV(a,i).bitLength;R.readBit(a,i);i+=1;R.readBit(a,i);i+=1;R.readBit(a,i);return i+=1,{sliceGroupNum:s.value+1}}(i.data);break;case A:i.sei=(i.data,{});break;case L:i.primary_pic_type=i.data[0]>>5}return i}return f()(t,e),t}(k),U=function(e){function t(){var e;return n()(this,t),(e=d()(this,c()(t).call(this))).cachedBytes=null,e}return f()(t,e),s()(t,[{key:"push",value:function(e){var t,i=0,a=0,n=0,r=e.pes,s=r.PTS,o=r.DTS,d=r.data_byte;if(this.cachedBytes){try{t=new Uint8Array(this.cachedBytes.byteLength+d.byteLength)}catch(E){throw"h264 alloc mem error ".concat(this.cachedBytes.byteLength,"/").concat(d.byteLength)}t.set(this.cachedBytes),t.set(d,this.cachedBytes.byteLength)}else t=d;if(r.hasOwnProperty("naluSizeLength")){var u=r.naluSizeLength,c=0,l=0,h=0;do{l=0;for(var _=0;_<u;_++)l|=t[c+_]<<8*(u-_-1);(h=(c+=u)+l)>t.length&&(h=t.length);var f=t.subarray(c,h),p=new F(f);p.pts=s,p.dts=o,this.emit("nalu",p),c=h}while(c<t.length)}else{var g=t.byteLength-1,m=0;do{if(0!==t[g])break;m++,g--}while(g>0);m>=3&&(t=t.subarray(0,g+1));do{var v=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],b=t.length-i>=4?v:-1,y=0,k=i===t.length-1;if(b>>8==1?y=3:1===b&&(y=4),3===y||4===y||k){var T=a+n,S=k&&m>=3;if(i>a&&(!k||S)){var P=t.subarray(T,S?i+1:i),x=new F(P);x.pts=s,x.dts=o,this.emit("nalu",x),a=i}k&&(m<3?(this.cachedBytes=t.subarray(a),this.cachedBytes.pts=s,this.cachedBytes.dts=o,this.cachedBytes.startCodeLength=n):this.cachedBytes=null),i===a&&(n=y),i+=y||1}else i++}while(i<t.length)}if(this.cachedBytes){var I=new F(this.cachedBytes.subarray(this.cachedBytes.startCodeLength));I.pts=this.cachedBytes.pts,I.dts=this.cachedBytes.dts,this.emit("nalu",I),this.cachedBytes=null}this.emit("done")}},{key:"reset",value:function(){this.cachedBytes=null}}]),t}(P.a),V=27,H=36,W=15,j=i(219),G=(i(18),function(e,t){for(var i="avc1.",a=[e.profile_idc,e.profile_compatibility,e.level_idc],n=0;n<a.length;n++){var r=a[n].toString(16);r.length<2&&(r="0"+r),i+=r}return{codec:i}}),z=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).ctx=e,i.options=a,i.videoTrack=null,i.audioTrack=null,i.captionTrack=null,i._initTagsInfo(),i._initHeaderInfo(),i}return f()(t,e),s()(t,[{key:"_initTagsInfo",value:function(){var e=this;this.faConfig=null,this.fvConfig=null,this.naluSizeLength=0,this._offsetTime=null,this.h264Codec=new U,this.h264Codec.on("nalu",(function(t){t.unit_type===A?(t=e._parseSEI(t))&&e._appendToFrame(t):t.unit_type===q?(e._updateSPSByNalu(t),e._appendToFrame(t)):t.unit_type===O?(e._updatePPSByNalu(t),e._appendToFrame(t)):t.unit_type!==w&&t.unit_type!==x||e._appendToFrame(t)})).on("done",(function(){e._pushFrameIntoGop()}))}},{key:"_appendToFrame",value:function(e){this.currentFrame=this.currentFrame||[];var t=this.currentFrame;0===t.length?(t.keyframe=!1,t.duration=0,t.byteLength=e.rawData.byteLength,t.naluCount=1):(t.naluCount++,t.byteLength+=e.rawData.byteLength),t.pts=e.pts,t.dts=e.dts,this.gop&&0===this.gop.length&&e.unit_type,e.unit_type===w&&(t.keyframe=!0),t.push(e)}},{key:"_initHeaderInfo",value:function(){var e=this;this.headerCodec=new U,this.headerObj={f:null,ac:null,vc:{},sps:!1,pps:!1,keyframeTimes:null,keyframePositions:null,naluSizeLength:0},this.headerCodec.on("nalu",(function(t){t.unit_type===q?e._updateSPSByNalu(t):t.unit_type===O&&e._updatePPSByNalu(t),e.headerObj.sps&&e.headerObj.pps&&e.emit("info",{type:"headerComplete",data:e.headerObj})}))}},{key:"_updateSPSByNalu",value:function(e){this.headerObj.sps=!0,this.headerObj.vc.width=e.sps.width,this.headerObj.vc.height=e.sps.height,this.headerObj.vc.profileIdc=e.sps.profile_idc,this.headerObj.vc.profileCompatibility=e.sps.profile_compatibility,this.headerObj.vc.levelIdc=e.sps.level_idc,this.headerObj.vc.pixelRatio=e.sps.pixelRatio,this.headerObj.vc.sps=[e.rawData],this.headerObj.vc.spsnalu=e}},{key:"_updatePPSByNalu",value:function(e){this.headerObj.pps=!0,this.headerObj.vc.pps=[e.rawData],this.headerObj.vc.ppsnalu=e}},{key:"push",value:function(e){var t=e.data,i=e.info,a=70==t[0]&&76==t[1]&&86==t[2];if(this._clear(),this.options.config=i,a)this._complexHead(t,i);else{var n=i.meta.vac;this.fvConfig=n.vc,this.faConfig=n.ac,this.naluSizeLength=n.naluSizeLength,"number"==typeof i.meta.offset&&i.meta.offset>=0?this._offsetTime=1e3*i.meta.offset:this._offsetTime=null,this._newGops(),this._complexFLVData(t)}this._lastPushDataIsFLVHead=a}},{key:"flush",value:function(){if(this.gop&&this.gop.length>0){var e=this.gop[0];this.videoTrack={id:256,type:"video",timescale:9e4,duration:Number.POSITIVE_INFINITY},this._pushGopIntoGroup(),this.videoTrack.gops=this.gops,this.videoTrack.firstDTS=e.dts,this.videoTrack.firstPTS=e.pts;var t=(this.videoTrack.firstDTS+this.gops.duration)/90;this.emit("info",{type:"endtimestamp",data:t/1e3});var i=G(this.fvConfig.spsnalu.sps);this.videoTrack.codec=i.codec,Object(S.a)(this.videoTrack,this.fvConfig),this.audioTrack&&this.audioTrack.frames.length>0&&(this.audioTrack.firstPTS=this.audioTrack.frames[0].pts,this.audioTrack.firstDTS=this.audioTrack.frames[0].dts),this.emit("data",{videoTrack:this.videoTrack,audioTrack:this.audioTrack,captionTrack:this.captionTrack}),this.emit("done")}else this.emit("done");this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}},{key:"_clear",value:function(){p.a.log("flvcomplex reset"),this.gop=null,this.gops=null,this._lastPushDataIsFLVHead||(this.currentFrame=null),this.videoTrack=null,this.audioTrack=null,this.captionTrack=null,this.headerObj.f=null,this.headerObj.ac=null,this.headerObj.vc={},this.headerObj.sps=!1,this.headerObj.pps=!1,this.headerObj.keyframeTimes=null,this.headerObj.keyframePositions=null,this.h264Codec.reset(),this.headerCodec.reset()}},{key:"_newGops",value:function(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this._newGop()}},{key:"_newGop",value:function(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}},{key:"_pushFrameIntoGop",value:function(){var e=this.currentFrame,t=this.gop.length;if(t>0){var i=this.gop[t-1],a=i.duration;i.duration=e.dts-i.dts,e.duration=i.duration,1===t&&0===a&&(this.gop.duration+=i.duration)}Array.isArray(e)&&e.length>0&&(this.gop.push(e),this.gop.duration+=e.duration,this.gop.byteLength+=e.byteLength,this.gop.naluCount+=e.naluCount),this.currentFrame=null}},{key:"_pushGopIntoGroup",value:function(){this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.push(this.gop)}},{key:"_complexFLVData",value:function(e){var t,i=new Uint8Array(e),a=0,n=0,r=null,s=null;for(t=i.byteLength;a<t;){if(n=i[a+1]<<16|i[a+2]<<8|i[a+3],r=i.subarray(a,11+n+4+a),s=T.parseFLVTag(r)){if(null!==this._offsetTime&&this._offsetTime>=0){var o=s.DTS/90,d=(s.PTS-s.DTS)/90;s.DTS=90*(this._offsetTime+o),s.PTS=s.DTS+90*d}"video"==s.type&&s.data_byte?this.h264Codec.push({isKeyframe:s.isKeyframe,pes:{naluSizeLength:this.naluSizeLength,PTS:s.PTS,DTS:s.DTS,data_byte:s.data_byte}}):"audio"==s.type&&s.data_byte&&this._adts(s)}a+=11+n+4}s=null,i=null,r=null}},{key:"_parseSEI",value:function(e){for(var t=null,i=e.data,a=(i[1],3+i[2]+1),n=i.length;a<n;){var r=i[a]<<24|i[a+1]<<16|i[a+2]<<8|i[a+3],s=31&i[a+4];s!=w&&s!=x||(i=i.subarray(a+4,a+4+r),t=new F(i)),a+=4+r}return t}},{key:"_adts",value:function(e){var t={};if(Object(S.a)(t,this.faConfig),t.data=e.data_byte,t.dts=e.DTS,t.pts=e.PTS,null==this.audioTrack&&(this.audioTrack={id:257,type:"audio",isAAC:!0,duration:Number.POSITIVE_INFINITY,stream_type:W},this.audioTrack.frames=[],this.audioTrack.frames.byteLength=0),null==this.audioTrack.config){var i=Object(j.a)(t.audioObjectType,t.samplingFrequencyIndex,t.channelCount);this.audioTrack.config=i.config,this.audioTrack.sampleRate=i.sampleRate,this.audioTrack.inputTimeScale=9e4,this.audioTrack.timescale=i.sampleRate,this.audioTrack.channelCount=i.channelCount,this.audioTrack.codec=i.codec,this.audioTrack.realCodec=i.realCodec}this.audioTrack.frames.push(t),this.audioTrack.frames.byteLength+=t.data.byteLength}},{key:"_complexHead",value:function(e,t){var i=T.parseFlvHead(e);if(this.headerObj.hasAudio=i.hasAudioTags,this.headerObj.hasVideo=i.hasVideoTags,this.headerObj.f=t.f,this.headerObj.keyframePositions=i.info.keyframes.filepositions,this.headerObj.keyframeTimes=i.info.keyframes.times,this.headerObj.filesize=i.info.filesize,this.headerObj.duration=i.info.duration,this.headerObj.width=i.info.width,this.headerObj.height=i.info.height,i.hasAudioTags&&(this.headerObj.ac=T.parseFLVTag(i.firstAudio)),i.hasVideoTags){var a=T.parseFLVTag(i.firstVideo),n=a.pps,r=a.sps;this.headerObj.naluSizeLength=a.naluSizeLength,this.headerCodec.push({pes:{PTS:a.PTS,DTS:a.DTS,data_byte:n}}),this.headerCodec.push({pes:{PTS:a.PTS,DTS:a.DTS,data_byte:r}})}}},{key:"_complexCaption",value:function(){}}]),t}(g.a),K={Demux:function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).context=e,i.options=a,i.complex=new z(e,a),i.pipe(i.complex),i}return f()(t,e),s()(t,[{key:"push",value:function(e,t){p.a.log("demux pushing flv"),this.options.config=t,this.emit("data",{data:e,info:t}),this.emit("done")}},{key:"endStream",get:function(){return this.complex}}]),t}(g.a),Remux:function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){this.emit("data",e)}},{key:"flush",value:function(){this.emit("done")}},{key:"endStream",get:function(){return this}}]),t}(g.a)},Y=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).context=e,a.PSI=i,a.videoTrack=null,a.audioTrack=null,a.captionTrack=null,a}return f()(t,e),s()(t,[{key:"push",value:function(e){for(var t,i=e,a=0;a<i.length;a++)switch((t=i[a]).type){case"video":this._complexVideo(t);break;case"audio":this._complexAudio(t);break;case"caption":this._complexCaption(t)}}},{key:"flush",value:function(){this.emit("done"),this._clearStream()}},{key:"reset",value:function(){this._clearStream()}},{key:"_clearStream",value:function(){this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}},{key:"_complexVideo",value:function(e){var t=this.PSI.findTrack(e.trackId);t&&(t.type="video",t.gops=e,t.firstDTS=e[0][0].dts,t.firstPTS=e[0][0].pts,t.duration=Number.POSITIVE_INFINITY,this.videoTrack=t,this.emit("data",{videoTrack:this.videoTrack}))}},{key:"_complexAudio",value:function(e){var t=this.PSI.findTrack(e.trackId);t&&(t.type="audio",t.frames=e,t.firstPTS=t.firstDTS=e[0].dts,t.duration=Number.POSITIVE_INFINITY,this.audioTrack=t,this.emit("data",{audioTrack:this.audioTrack}))}},{key:"_complexCaption",value:function(){}}]),t}(g.a),Q=(i(98),function(){function e(){n()(this,e),this._list=[],this._byteLength=null}return s()(e,[{key:"byteLength",get:function(){if(null===this._byteLength){for(var e=0,t=0;t<this._list.length;t++)e+=this._list[t].byteLength;this._byteLength=e}return this._byteLength}},{key:"empty",get:function(){return 0===this._list.length}},{key:"bufferList",get:function(){return this._list}}]),s()(e,[{key:"clear",value:function(){var e=this._list.length;e>0&&this._list.splice(0,e),this._byteLength=null}},{key:"toNewBytes",value:function(){for(var e=null,t=0;null===e;)try{t++,e=new Uint8Array(this.byteLength)}catch(r){if(t>50)throw r}for(var i=0,a=0;i<this._list.length;i++){var n=this._list[i];e.set(n,a),a+=n.byteLength}return e}},{key:"append",value:function(t){t instanceof e?this._list=this._list.concat(t.bufferList):this._list.push(t),this._byteLength=null}},{key:"cut",value:function(e){var t=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],i=null;if(e>0&&!this.empty){for(var a=this._list,n=0,r=0;a.length>0;){var s=a.shift();if(0!==r){var o=e-n;if(s.byteLength>=o){t&&i.set(s.subarray(0,o),n),(s=s.subarray(o)).byteLength>0&&a.unshift(s);break}t&&i.set(s,n),n+=s.byteLength;break}if(s.byteLength>=e){t&&(i=s.subarray(0,e)),s.byteLength>e&&(s=s.subarray(e),a.unshift(s));break}if(t){try{i=new Uint8Array(e)}catch(d){throw"alloc_memory_error@ cache buffer: ".concat(e," ").concat(d.message)}i.set(s,0)}n+=s.byteLength,r++}this._byteLength=null}return i}}]),e}()),J=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],X=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){var t,i,a,n,r,s,o=e.pes,d=o.PTS,u=o.DTS,c=0,l=0;for(t=o.data_byte;c+5<t.length;)if(255===t[c]&&240==(246&t[c+1])){if(a=2*(1&~t[c+1]),i=(3&t[c+3])<<11|t[c+4]<<3|(224&t[c+5])>>5,s=9e4*(r=1024*(1+(3&t[c+6])))/J[(60&t[c+2])>>>2],n=c+i,t.byteLength<n)return;if(this.emit("frame",{pts:d+l*s,dts:u+l*s,sampleCount:r,audioObjectType:1+(t[c+2]>>>6&3),channelCount:(1&t[c+2])<<2|(192&t[c+3])>>>6,sampleRate:J[(60&t[c+2])>>>2],samplingFrequencyIndex:(60&t[c+2])>>>2,sampleSize:16,data:t.subarray(c+7+a,n)}),t.byteLength===n)return t=undefined,void this.emit("done");l++,t=t.subarray(n)}else c++}}]),t}(P.a),Z=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).PSI=e,i.trackId=null,i.codec=new X,i.codec.on("frame",(function(e){i.frames.push(e),i.frames.byteLength+=e.data.byteLength,i.frames.trackId=i.trackId})),i._newFrames(),i}return f()(t,e),s()(t,[{key:"push",value:function(e){e.stream_type===W&&(this.trackId=e.pid,this.codec.push(e))}},{key:"flush",value:function(){if(this.frames.length>0){var e=this.frames.length,t=this.frames[0],i=this.frames[e-1],a=i.sampleRate*i.sampleCount/9e4;this.frames.firstDTS=t.dts,this.frames.firstPTS=t.pts,this.frames.duration=1===e?a:a+(i.pts-t.pts),this._updateTrackMeta(t),this.emit("data",this.frames),this.reset(),this.emit("done")}}},{key:"reset",value:function(){this.trackId=null,this._newFrames()}},{key:"_newFrames",value:function(){this.frames=[],this.frames.type="audio",this.frames.byteLength=0,this.frames.duration=0,this.frames.firstDTS=0,this.frames.firstPTS=0}},{key:"_updateTrackMeta",value:function(e){var t=this.PSI.findTrack(this.trackId),i=Object(j.a)(e.audioObjectType,e.samplingFrequencyIndex,e.channelCount);t.config=i.config,t.sampleRate=i.sampleRate,t.inputTimeScale=t.inputTimeScale||t.timescale,t.timescale=i.sampleRate,t.channelCount=i.channelCount,t.codec=i.codec,t.realCodec=i.realCodec,t.isAAC=!0}}]),t}(g.a),$=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).PSI=e,i.trackId=null,i.currentFrame=[],i.codec=new U,i._newGop(),i._newGops(),i.codec.on("nalu",(function(e){if(e.unit_type===q){var t=i.PSI.findTrack(i.trackId),a=G(e.sps);t.codec=a.codec,t.width=e.sps.width,t.height=e.sps.height,t.profileIdc=e.sps.profile_idc,t.profileCompatibility=e.sps.profile_compatibility,t.levelIdc=e.sps.level_idc,t.pixelRatio=e.sps.pixelRatio,t.sps=[e.rawData]}else if(e.unit_type===O){i.PSI.findTrack(i.trackId).pps=[e.rawData]}i._grouping(e)})),i}return f()(t,e),s()(t,[{key:"push",value:function(e){e.stream_type!==V&&e.stream_type!==H||(this.trackId=e.pid,this.codec.push(e))}},{key:"flush",value:function(){this.currentFrame.length>0&&((!this.currentFrame.duration||this.currentFrame.duration<=0)&&(this.currentFrame.duration=this.prevFrame.duration||0),this._pushFrameIntoGop(),this.currentFrame=[]),this.gop.length>0&&this._pushGopIntoGroup()}},{key:"reset",value:function(){this.codec.reset(),this.currentFrame=[],this._newGop(),this._newGops()}},{key:"_grouping",value:function(e){e.unit_type===L?(this.currentFrame.length>0&&(this.currentFrame.duration=e.dts-this.currentFrame.dts,this.gop.length>0&&this.currentFrame.keyframe&&(this.gop.trackId=this.trackId,this._pushGopIntoGroup()),this.currentFrame.keyframe||this.gop.length>0?this._pushFrameIntoGop():p.a.warn("h264 codec drop frame")),this.prevFrame=this.currentFrame,this.currentFrame=[],this.currentFrame.keyframe=!1,this.currentFrame.byteLength=0,this.currentFrame.naluCount=0,this.currentFrame.pts=e.pts,this.currentFrame.dts=e.dts):(e.unit_type===w&&(this.currentFrame.keyframe=!0),this.currentFrame.byteLength+=e.rawData.byteLength,this.currentFrame.naluCount++,this.currentFrame.push(e)),this.currentFrame.duration=e.dts-this.currentFrame.dts}},{key:"_newGop",value:function(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}},{key:"_pushFrameIntoGop",value:function(){this.gop.push(this.currentFrame),this.gop.duration+=this.currentFrame.duration,this.gop.byteLength+=this.currentFrame.byteLength,this.gop.naluCount+=this.currentFrame.naluCount}},{key:"_newGops",value:function(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this.gops.firstDTS=0}},{key:"_pushGopIntoGroup",value:function(){var e=this.gop[0];this.gops.trackId=this.trackId,this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.firstDTS=e.dts,this.gops.firstPTS=e.pts,this.gops.push(this.gop),this.emit("data",this.gops),this._newGop(),this._newGops(),this.emit("done")}}]),t}(g.a),ee=function(e){function t(e,i){var a,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return n()(this,t),(a=d()(this,c()(t).call(this))).context=e,a.PSI=i,a.options=r,a.tracks=[],a.adtsStream=new Z(i),a.avcStream=new $(i),a.streams=[a.adtsStream,a.avcStream],a.avcStream.on("data",(function(e){var t=r.config.stubTime;if(Object(v.f)(t)){var i=e.firstPTS/9e4,n=(e.firstPTS+e.duration)/9e4;if(n<t)return void p.a.warn("drop avc gop, start/end/stubTime(".concat(i,"/").concat(n,"/").concat(t,")"))}a.tracks.push(e),a.emit("data",a.tracks),a.tracks=[],a.adtsStream.flush()})),a.adtsStream.on("data",(function(e){var t=r.config.stubTime;if(Object(v.f)(t)){var i=(e.firstPTS+e.duration)/9e4;if(i<t)return void p.a.warn("drop adts, start/end/stubTime(".concat(e.firstPTS,"/").concat(i,"/").concat(t,")"))}a.tracks.push(e),a.emit("data",a.tracks),a.tracks=[]})),a}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=this.options,i=this.adtsStream,a=this.avcStream,n=e.stream_type;if(t.onlyDemuxElementary)this.emit("data",e);else switch(n){case V:case H:a.push(e);break;case W:i.push(e);break;default:p.a.warn("ts elementary encounter unknown stream type ".concat(n))}}},{key:"flush",value:function(){for(var e=0;e<this.streams.length;e++){this.streams[e].flush()}this.emit("data",this.tracks),this.emit("done"),this.tracks=[]}},{key:"reset",value:function(){this.tracks=[];for(var e=0;e<this.streams.length;e++){this.streams[e].reset()}this.emit("reset")}}]),t}(g.a),te=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).start_code_prefix=i.readUint16(e,0)<<8|e[2],i.stream_id=e[3],i.packet_length=i.readUint16(e,4),i.data_alignment_indicator=4&e[6],i.copyright=2&e[6],i.PTS_DTS_flags=e[7]>>6,i.ESCR_flag=32&e[7],i.ES_rate_flag=16&e[7],i.trick_mode_flag=8&e[7],i.additional_copy_info_flag=4&e[7],i.CRC_flag=2&e[7],i.extension_flag=1&e[7],i.header_data_length=e[8],i.PTS=0,2==(2&i.PTS_DTS_flags)&&(i.PTS=i._calcTimestamp(e,9)),i.DTS=i.PTS,1==(1&i.PTS_DTS_flags)&&(i.DTS=i._calcTimestamp(e,14)),i.data_byte=e.subarray(9+i.header_data_length),i}return f()(t,e),s()(t,[{key:"_calcTimestamp",value:function(e,t){return 536870912*(14&e[t])+(e[t+1]<<22)+(e[t+2]>>1<<15)+(e[t+3]<<7)+(e[t+4]>>1)}},{key:"valid",value:function(){var e=this.start_code_prefix;return 0===e[0]&&0===e[1]&&1===e[2]}}]),t}(k),ie=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).context=e,a.PSI=i,a.PID=null,a.cache_buffer=new Q,a}return f()(t,e),s()(t,[{key:"push",value:function(e){e.PID>255&&e.PID<8191&&(-1==this.PSI.currentProgramPID?this._pushPacket(e):this.PSI.currentProgramPID!==e.PID&&(1===e.payload_unit_start_indicator&&this._assembleOnePES(),this._pushPacket(e)))}},{key:"flush",value:function(){this._assembleOnePES(),this.emit("done")}},{key:"reset",value:function(){this._clearCached(),this.emit("reset")}},{key:"_clearCached",value:function(){this.PID=null,this.cache_buffer.clear()}},{key:"_pushPacket",value:function(e){var t=this.cache_buffer.empty;t&&0===e.payload_unit_start_indicator||(t&&(this.PID=e.PID),this.cache_buffer.append(e.payload))}},{key:"_assembleOnePES",value:function(){if(!this.cache_buffer.empty){var e;try{e=this.cache_buffer.toNewBytes()}catch(a){throw"pes alloc mem err ".concat(this.cache_buffer.byteLength)}var t=new te(e),i=this.PSI.findTrack(this.PID);i&&this.emit("data",{pid:i.id,stream_type:i.stream_type,pcr_pid:i.pcr_pid,pes:t}),this._clearCached()}}}]),t}(g.a),ae=(i(89),function(e){function t(e){var i;n()(this,t),(i=d()(this,c()(t).call(this))).table_id=e[0],i.section_syntax_indicator=e[1]>>7,i.section_length=(15&e[1])<<8|e[2],i.transport_stream_id=i.readUint16(e,3),i.version_number=e[5]>>1&31,i.current_next_indicator=e[5]&&1,i.section_number=e[6],i.last_section_number=e[7],i.network_PID=0;var a,r=0,s=i.section_length-4-5;for(i.pmtTable=[];r<s;r+=4)a=i.readUint16(e,8+r),e[10+r]>>5,0==a?(i.network_PID=(31&e[10+r])<<8|e[11+r],p.a.log("packet->network_PID %0x /n/n",i.network_PID)):i.pmtTable.push({programNum:a,program_map_PID:(31&e[10+r])<<8|e[11+r]});var o=i.section_length+3;return i.CRC_32=(255&e[o-4])<<24|(255&e[o-3])<<16|(255&e[o-2])<<8|255&e[o-1],i}return f()(t,e),s()(t,[{key:"valid",value:function(){var e=this.start_code_prefix;return 0===e[0]&&0===e[1]&&1===e[2]}}]),t}(k)),ne=function(e){function t(e){var i;if(n()(this,t),(i=d()(this,c()(t).call(this))).table_id=e[0],i.section_syntax_indicator=e[1]>>7,i.section_length=(15&e[1])<<8|e[2],i.program_number=i.readUint16(e,3),i.version_number=e[5]>>1&31,i.current_next_indicator=e[5]&&1,i.section_number=e[6],i.last_section_number=e[7],i.PCR_PID=(31&e[8])<<8|e[9],i.program_info_length=(15&e[10])<<8|e[11],i.program_info_length<0)return d()(i);if(i.program_info_length>2)for(var a=0;a<i.program_info_length;){a+=e[13+a]}var r=12+i.program_info_length,s=i.section_length-i.program_info_length-9-4,o=r+s;if(r>=o)return d()(i,p.a.warn("es_section_pos < es_section_end ".concat(r,", ").concat(o)));i.pes_table=[];for(var u=0;u<s;){var l=e[r+u],h=8191&i.readUint16(e,r+u+1),_=4095&i.readUint16(e,r+u+3);if(i.pes_table.push({streamType:l,PID:h}),_>2)for(var f=0,g=r+u+5;f<_;){f+=e[g+f]}u+=_+5}var m=i.section_length+3;return i.CRC_32=(255&e[m-4])<<24|(255&e[m-3])<<16|(255&e[m-2])<<8|255&e[m-1],i}return f()(t,e),s()(t,[{key:"parse",value:function(){}},{key:"valid",value:function(){var e=this.start_code_prefix;return 0===e[0]&&0===e[1]&&1===e[2]}}]),t}(k),re=(i(73),function(e){function t(e){var i;n()(this,t),(i=d()(this,c()(t).call(this))).table_id=e[0],i.section_syntax_indicator=e[1]>>7,i.section_length=(15&e[1])<<8|e[2],i.transport_stream_id=i.readUint16(e,3),i.version_number=e[5]>>1&31,i.current_next_indicator=1&e[5],i.section_number=e[6],i.last_section_number=e[7],i.original_network_id=i.readUint16(e,8);var a=i.section_length-8-4;i.service_table=[];for(var r=0;r<a;){var s=0,o={};for(o.service_id=i.readUint16(e,11),o.EIT_schedule_flag=2&e[13],o.EIT_present_following_flag=1&e[13],o.running_status=e[14]>>5,o.free_CA_mode=e[14]>>4&1,o.descriptors_loop_length=(15&e[14])<<8|e[15];s<o.descriptors_loop_length;){var u=16+s,l=e[u],h=e[u+1];switch(l){case 72:e[u+2];var _=[],f=e[u+3],g=0,m=0,v=u+4;for(g=0;g<f;g++)_.push(String.fromCharCode(e[v])),v+=1;o.provider_name=_.join("");var b=[],y=e[v];for(v+=1,m=0;m<y;m++)b.push(String.fromCharCode(e[v])),v+=1;o.name=b.join("");break;default:p.a.warn("sdt section unhandled descriptor_tag ".concat(l))}s+=2+h}i.service_table.push(o),r+=5+o.descriptors_loop_length}return i}return f()(t,e),t}(k)),se=function(){function e(t){n()(this,e),this.context=t,this.metadata={},this.pat_table=[],this.pes_streams=[]}return s()(e,[{key:"currentProgramPID",get:function(){for(var e=[],t=0;t<this.pat_table.length;t++)e.push(this.pat_table[t].pid);return e.length>0?e[0]:-1}}]),s()(e,[{key:"reset",value:function(){this.metadata={},this.pat_table.splice(0,this.pat_table.length),this.pes_streams.splice(0,this.pes_streams.length)}},{key:"parse",value:function(e){0===e.PID?this._parsePat(e):1===e.PID||2===e.PID||3<=e.PID&&e.PID<=15||(17===e.PID?this._parseSdt(e):e.PID===this.currentProgramPID&&this._parsePmt(e))}},{key:"findTrack",value:function(e){for(var t=null,i=this.pes_streams,a=0;a<i.length;a++)if(i[a].id===e){t=i[a];break}return t}},{key:"_parsePat",value:function(e){var t;if(e.payload_unit_start_indicator){var i=e.payload[0];t=e.payload.subarray(i+1)}else t=e.payload;for(var a=new ae(t),n=0;n<a.pmtTable.length;n++)this._add_pid_to_pmt(a.pmtTable[n].programNum,a.pmtTable[n].program_map_PID);return a}},{key:"_add_pid_to_pmt",value:function(e,t){var i=this.pat_table;(function(e){for(var t,a=0;a<i.length;a++)if((t=i[a]).id===e)return{idx:a,item:t};return null})(e)||i.push({id:e,pid:t})}},{key:"_parsePmt",value:function(e){var t;if(e.payload_unit_start_indicator){var i=e.payload[0];t=e.payload.subarray(i+1)}else t=e.payload;for(var a=new ne(t),n=0;n<a.pes_table.length;n++)this._add_pes_stream(a.pes_table[n],a);return a}},{key:"_add_pes_stream",value:function(e,t){var i=this.pes_streams;(function(e){for(var t,a=0;a<i.length;a++)if((t=i[a]).id===e)return{idx:a,item:t};return null})(e.id)||i.push({id:e.PID,stream_type:e.streamType,pcr_pid:t.PCR_PID,duration:0,sps:[],pps:[],pixelRatio:1,timescale:9e4,width:0,height:0})}},{key:"_parseSdt",value:function(e){var t;if(e.payload_unit_start_indicator){var i=e.payload[0];t=e.payload.subarray(i+1)}else t=e.payload;var a=new re(t);return a.service_table.length>0&&(this.metadata.service_name=a.service_table[0].name,this.metadata.service_provider=a.service_table[0].provider_name),a}}]),e}(),oe=function(e){function t(e){var i;if(n()(this,t),(i=d()(this,c()(t).call(this))).sync_byte=e[0],i.transport_error_indicator=e[1]>>7,i.payload_unit_start_indicator=e[1]>>6&1,i.transport_priority=e[1]>>>5&1,i.PID=8191&i.readUint16(e,1),i.tsc=e[3]>>6,i.afc=e[3]>>4&3,i.continuity_counter=15&e[3],i.has_payload=1&i.afc,i.has_adaptation=2&i.afc,i.is_discontinuity=i.has_adaptation&&0!=e[4]&&128&e[5],i.has_payload)if(i.has_adaptation){var a=e[4];i.payload=e.subarray(5+a)}else i.payload=e.subarray(4);return i}return f()(t,e),s()(t,[{key:"valid",value:function(){return 71===this.sync_byte&&this.has_payload}}]),t}(k),de=i(210),ue={Demux:function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).context=e,i.options=a,i.cache_buffer=new Q,i.psi=new se(e),i.pesStream=new ie(e,i.psi),i.elementaryStream=new ee(e,i.psi,a),i.complexStream=new Y(e,i.psi),i.pipe(i.pesStream),i.pesStream.pipe(i.elementaryStream),i.elementaryStream.pipe(i.complexStream),i}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=t.done,a=t.meta,n=this.cache_buffer.byteLength,r=null;for(a&&Object(v.f)(a.byteOffset)&&(r=a.byteOffset-n),this.options.config=t,p.a.log("hls demux received ".concat(e.byteLength," bytes, cache ").concat(n," bytes. ").concat(i?"chunk done":"")),this.cache_buffer.append(e);this.cache_buffer.byteLength>=188;){var s=this.cache_buffer.cut(188);if(s){var o=new oe(s);if(!o.valid()){var d="Encounter invalid ts packet, packet_length(".concat(s.length,"), cache_length(").concat(this.cache_buffer.byteLength,"), has_payload(").concat(o.has_payload,"), data(").concat(s,")");p.a.error(d),this.reset(),this.context.emit("error",de.a.TS_SYNC_BYTE,d,{level:a.level,fragIdx:a.fragIdx,startByte:r,endByte:r+s.byteLength});break}this.psi.parse(o),this.emit("data",o),r+=s.byteLength}}this.cache_buffer.empty&&i&&this.emit("done")}},{key:"reset",value:function(){this.cache_buffer.clear(),this.emit("reset")}},{key:"endStream",get:function(){var e=this.complexStream;return this.options.onlyDemuxElementary&&(e=this.elementaryStream),e}}]),t}(g.a),Remux:function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){this.emit("data",e)}}]),t}(g.a)},ce=(i(263),i(91),i(295)),le=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).options=a,i.videoTrack=null,i.audioTrack=null,i.captionTrack=null,i.videoSampleList=[],i.audioSampleList=[],i.videoChunkList=[],i.audioChunkList=[],i._initTagsInfo(),i._initHeaderInfo(),i}return f()(t,e),s()(t,[{key:"_initTagsInfo",value:function(){var e=this;this.faConfig={},this.fvConfig={},this.naluSizeLength=0,this._offsetTime=null,this.h264Codec=new U,this.h264Codec.on("nalu",(function(t){t.unit_type===A?(t=e._parseSEI(t))&&e._appendToFrame(t):t.unit_type===q||t.unit_type===O?e._appendToFrame(t):t.unit_type!==w&&t.unit_type!==x||e._appendToFrame(t)})).on("done",(function(){e._pushFrameIntoGop()}))}},{key:"_appendToFrame",value:function(e){this.currentFrame=this.currentFrame||[];var t=this.currentFrame;0===t.length?(t.keyframe=!1,t.duration=0,t.byteLength=e.rawData.byteLength,t.naluCount=1):(t.naluCount++,t.byteLength+=e.rawData.byteLength),t.pts=e.pts,t.dts=e.dts,e.unit_type===w&&(t.keyframe=!0),t.push(e)}},{key:"_parseSEI",value:function(e){for(var t=null,i=e.data,a=(i[1],3+i[2]+1),n=i.length;a<n;){var r=i[a]<<24|i[a+1]<<16|i[a+2]<<8|i[a+3],s=31&i[a+4];s!=w&&s!=x||(i=i.subarray(a+4,a+4+r),t=new F(i)),a+=4+r}return t}},{key:"_initHeaderInfo",value:function(){var e=this;this.headerCodec=new U,this.headerObj={f:null,ac:null,vc:{},sps:!1,pps:!1,keyframeTimes:[],keyframePositions:[],naluSizeLength:0},this.headerCodec.on("nalu",(function(t){t.unit_type===q?e._updateSPSByNalu(t):t.unit_type===O&&e._updatePPSByNalu(t),e.headerObj.sps&&e.headerObj.pps&&e.emit("info",{type:"headerComplete",data:e.headerObj})}))}},{key:"_updateSPSByNalu",value:function(e){this.headerObj.sps=!0,this.fvConfig.width=e.sps.width,this.fvConfig.height=e.sps.height,this.fvConfig.profileIdc=e.sps.profile_idc,this.fvConfig.profileCompatibility=e.sps.profile_compatibility,this.fvConfig.levelIdc=e.sps.level_idc,this.fvConfig.pixelRatio=e.sps.pixelRatio,this.fvConfig.sps=[e.rawData],this.fvConfig.spsnalu=e}},{key:"_updatePPSByNalu",value:function(e){this.headerObj.pps=!0,this.fvConfig.pps=[e.rawData],this.fvConfig.ppsnalu=e}},{key:"push",value:function(e){this._clear(),this.options.config.meta.isHeader?(this.videoSampleList=[],this.audioSampleList=[],this.videoChunkList=[],this.audioChunkList=[],this._analyzeHeader(e)):(this._newGops(),this._complexMP4Data(e))}},{key:"_complexMP4Data",value:function(e){var t,i=new Uint8Array(e),a=0,n=0,r=0,s=this.options.config.meta.byteOffset,o=null;for(t=i.byteLength;a<t;)(o=this._getSampleByPosition(s+a))?(r=(n=o.sample.startPosition-s)+o.sample.size,"video"==o.type?this.h264Codec.push({pes:{naluSizeLength:this.naluSizeLength,PTS:o.sample.pts,DTS:o.sample.dts,data_byte:i.subarray(n,r)}}):"audio"==o.type&&this._adts({PTS:o.sample.pts,DTS:o.sample.dts,data_byte:i.subarray(n,r)}),a+=o.sample.size):a=t;o=null,i=null}},{key:"_newGops",value:function(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this._newGop()}},{key:"_newGop",value:function(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}},{key:"_pushFrameIntoGop",value:function(){var e=this.currentFrame,t=this.gop.length;if(t>0){var i=this.gop[t-1],a=i.duration;i.duration=e.dts-i.dts,e.duration=i.duration,1===t&&0===a&&(this.gop.duration+=i.duration)}Array.isArray(e)&&e.length>0&&(this.gop.push(e),this.gop.duration+=e.duration,this.gop.byteLength+=e.byteLength,this.gop.naluCount+=e.naluCount),this.currentFrame=null}},{key:"_pushGopIntoGroup",value:function(){this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.push(this.gop)}},{key:"_getSampleByPosition",value:function(e){for(var t=0;t<this.videoSampleList.length;t++)if(e==this.videoSampleList[t].startPosition)return{type:"video",sample:this.videoSampleList[t]};for(var i=0;i<this.audioSampleList.length;i++)if(e==this.audioSampleList[i].startPosition)return{type:"audio",sample:this.audioSampleList[i]};return null}},{key:"_adts",value:function(e){var t={};if(Object(S.a)(t,this.faConfig),t.data=e.data_byte,t.dts=e.DTS,t.pts=e.PTS,null==this.audioTrack&&(this.audioTrack={id:257,type:"audio",isAAC:!0,duration:Number.POSITIVE_INFINITY,stream_type:W},this.audioTrack.frames=[],this.audioTrack.frames.byteLength=0),null==this.audioTrack.config){var i=Object(j.a)(t.audioObjectType,t.samplingFrequencyIndex,t.channelCount);this.audioTrack.config=i.config,this.audioTrack.sampleRate=i.sampleRate,this.audioTrack.inputTimeScale=9e4,this.audioTrack.timescale=i.sampleRate,this.audioTrack.channelCount=i.channelCount,this.audioTrack.codec=i.codec,this.audioTrack.realCodec=i.realCodec}this.audioTrack.frames.push(t),this.audioTrack.frames.byteLength+=t.data.byteLength}},{key:"_analyzeHeader",value:function(e){var t=new Uint8Array(e),i=ce.a.mp4toJSON(t),a=this._flattenMp4Box(i);this._makeVideoTrack(a.videTrack),this._makeAudioTrack(a.sounTrack);for(var n={},r=a.videTrack.avc1.config,s=0;s<r.length;s++)if("avcC"===r[s].type)switch(n.sps=r[s].sps[0],n.pps=r[s].pps[0],r[s].lengthSizeMinusOne){case 0:this.naluSizeLength=1;break;case 1:this.naluSizeLength=2;break;case 2:this.naluSizeLength=3;break;case 3:this.naluSizeLength=4}this.videoSampleList.length>0&&(this.headerCodec.push({pes:{PTS:0,DTS:0,data_byte:n.pps}}),this.headerCodec.push({pes:{PTS:0,DTS:0,data_byte:n.sps}}))}},{key:"_flattenMp4Box",value:function(e){var t={};if(Array.isArray(e))for(var i=0;i<e.length;i++){var a=e[i],n=a.type,r=t,s=this._flattenMp4Box(a.boxes,"boxes");switch(a.type){case"trak":r=t[s.handlerType+"Track"]={};break;case"hdlr":t.handlerType=a.handlerType}a.hasOwnProperty("boxes")&&Object.assign(r,s),"trak"===a.type&&"tkhd"===a.type||(t[n]=a)}return t}},{key:"_makeVideoTrack",value:function(e){e||p.a.error("mat can't discovery video box");var t=e.stsz.entries,i=e.stco.chunkOffsets,a=e.stsc.sampleToChunks,n=e.stts.timeToSamples,r=e.ctts?e.ctts.frameIndex:[],s=e.stss.frameIndex,o=0,d=0,u=0,c=0,l=0,h=0,_=0,f=0,g=0,m=0,v=0,b=0,y=0,k=i[0];for(d=0;d<t.length;d++){var T={};if(l<=d){for(var S=0;S<a.length;S++)u===a[S].firstChunk-1&&(c=S);l+=a[c].samplesPerChunk,k=i[u],u++}_<=d&&r.length>0&&(_+=r[h].sample_count,y=r[h].sample_offset,h++),m<=d&&(m+=n[g].sampleCount,o=n[g].sampleDelta/e.mdhd.timescale,v=n[g].sampleDelta,g++),T.index=d,T.startTime=o*d,T.size=t[d],T.startPosition=k,T.endPosition=k+t[d],T.dts=9e4*b/e.mdhd.timescale,T.pts=9e4*(b+y)/e.mdhd.timescale,this.videoSampleList.push(T),k+=t[d],b+=v}for(l=a[0].samplesPerChunk,d=0,u=0;u<i.length;u++){var P={};for(c=0;c<a.length;c++)if(u===a[c].firstChunk-1){l=a[c].samplesPerChunk;break}P.samplesLength=l,P.startSamples=d,P.endSamples=d+l,P.startPosition=i[u];for(var x=0,I=P.startSamples;I<P.endSamples;I++)x+=this.videoSampleList[I].size;P.size=x,d+=l,this.videoChunkList.push(P)}for(f=0;f<s.length;f++){var E=parseInt(s[f].index,10);this.headerObj.keyframeTimes.push(this.videoSampleList[E-1].startTime),this.headerObj.keyframePositions.push(this.videoSampleList[E-1].startPosition)}this.fvConfig.id=e.tkhd.trackId,this.fvConfig.width=e.avc1.width,this.fvConfig.height=e.avc1.height,this.fvConfig.duration=e.mdhd.duration/e.mdhd.timescale,this.headerObj.hasVideo=!0,this.headerObj.vc=this.fvConfig}},{key:"_makeAudioTrack",value:function(e){e||p.a.error("mat can't discovery soun box");var t=e.stsz.entries,i=e.stco.chunkOffsets,a=e.stsc.sampleToChunks,n=e.stts.timeToSamples,r=0,s=0,o=0,d=0,u=0,c=0,l=0,h=0,_=0,f=i[0];for(s=0;s<t.length;s++){var g={};if(u<=s){for(var m=0;m<a.length;m++)o===a[m].firstChunk-1&&(d=m);u+=a[d].samplesPerChunk,f=i[o],o++}l<=s&&(l+=n[c].sampleCount,r=n[c].sampleDelta/e.mp4a.samplerate,h=n[c].sampleDelta,c++),g.index=s,g.startTime=r*s,g.size=t[s],g.startPosition=f,g.endPosition=f+t[s],g.pts=9e4*_/e.mp4a.samplerate,g.dts=9e4*_/e.mp4a.samplerate,this.audioSampleList.push(g),f+=t[s],_+=h}for(u=a[0].samplesPerChunk,s=0,o=0;o<i.length;o++){var v={};for(d=0;d<a.length;d++)if(o===a[d].firstChunk-1){u=a[d].samplesPerChunk;break}v.samplesLength=u,v.startSamples=s,v.endSamples=s+u,v.startPosition=i[o];for(var b=0,y=v.startSamples;y<v.endSamples;y++)b+=this.audioSampleList[y].size;v.size=b,s+=u,this.audioChunkList.push(v)}var k=e.mp4a.streamDescriptor.decoderConfig.decoderConfigDescriptor;this.faConfig.audioObjectType=k.audioObjectType,this.faConfig.channelCount=k.channelConfiguration,this.faConfig.samplingFrequencyIndex=k.samplingFrequencyIndex,this.faConfig.sampleSize=e.mp4a.samplesize,this.faConfig.sampleRate=e.mp4a.samplerate,this.faConfig.sampleCount=n[0].sampleDelta,this.headerObj.hasAudio=!0,this.headerObj.ac=this.faConfig}},{key:"flush",value:function(){if(this.gop&&this.gop.length>0){var e=this.gop[0];this.videoTrack={id:256,type:"video",timescale:9e4,duration:Number.POSITIVE_INFINITY},this._pushGopIntoGroup(),this.videoTrack.gops=this.gops,this.videoTrack.firstDTS=e.dts,this.videoTrack.firstPTS=e.pts;var t=G(this.fvConfig.spsnalu.sps);this.videoTrack.codec=t.codec,Object(S.a)(this.videoTrack,this.fvConfig),this.audioTrack&&this.audioTrack.frames.length>0&&(this.audioTrack.firstPTS=this.audioTrack.frames[0].pts,this.audioTrack.firstDTS=this.audioTrack.frames[0].dts),this.emit("data",{videoTrack:this.videoTrack,audioTrack:this.audioTrack,captionTrack:this.captionTrack}),this.emit("done")}else this.emit("done");this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}},{key:"_clear",value:function(){p.a.log("MP4complex reset"),this.gop=null,this.gops=null,this.videoTrack=null,this.audioTrack=null,this.captionTrack=null,this.headerObj.f=null,this.headerObj.ac=null,this.headerObj.vc={},this.headerObj.sps=!1,this.headerObj.pps=!1,this.headerObj.keyframeTimes=[],this.headerObj.keyframePositions=[],this.h264Codec.reset(),this.headerCodec.reset()}}]),t}(g.a),he=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).options=a,i.complex=new le(e,a),i.pipe(i.complex),i}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};p.a.log("demux pushing buffer: ".concat(e.type)),this.options.config=t,this.emit("data",e),this.emit("done")}},{key:"endStream",get:function(){return this.complex}}]),t}(g.a),_e=i(198),fe=function(){function e(t){n()(this,e),this.context=t,this._hasVideoIS=!1,this._hasAudioIS=!1}return s()(e,[{key:"needParseIS",get:function(){return!(this._hasVideoIS&&this._hasAudioIS)}}]),s()(e,[{key:"parse",value:function(e){for(var t=[],i=e.tracks||[],a=0;a<i.length;a++){var n=i[a];switch(n.type){case"video":this._hasVideoIS||(this._hasVideoIS=!0,n.container="video/mp4",t.push(this._initSegment(n)));break;case"audio":this._hasAudioIS||(this._hasAudioIS=!0,n.container="audio/mp4",t.push(this._initSegment(n)))}}return t}},{key:"reset",value:function(){this._hasVideoIS=!1,this._hasAudioIS=!1}},{key:"_initSegment",value:function(e){var t=_e.a.initSegment([e]);return{type:"initSegment",contentType:e.type,container:e.container,codec:e.codec,trackId:e.id,arrayBufferList:[t.buffer]}}}]),e}(),pe=(i(114),function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}),ge=function(){function e(t){n()(this,e),this.context=t,this.audioSequenceNumber=1,this.nextSegmentPts=undefined,this.cacheBuffer=new Q}return s()(e,[{key:"parse",value:function(e){var t=null,i=e.tracks.audioTrack;i&&(this._loopAACFrames(i,e.audioTimeOffset),i.samples.length>0&&(t={type:"fragment",contentType:"audio",arrayBufferList:this._remuxAudio(i),duration:(this.nextSegmentPts-this.curSegmentPts)/i.inputTimeScale,startDTS:this.curSegmentPts/i.inputTimeScale,startPTS:this.curSegmentPts/i.inputTimeScale,nextSegmentPTS:this.nextSegmentPts}));return t}},{key:"reset",value:function(){this.audioSequenceNumber=1,this.nextSegmentPts=undefined,this.cacheBuffer.clear()}},{key:"_remuxAudio",value:function(e){var t=_e.a.moof(this.audioSequenceNumber,e.baseMediaDecodeTime,e),i=_e.a.mdat(this.mdat);this.audioSequenceNumber++,this.cacheBuffer.append(t),this.cacheBuffer.append(i);var a=this.cacheBuffer.toNewBytes();return this.cacheBuffer.clear(),[a.buffer]}},{key:"_loopAACFrames",value:function(e,t){var i=e.frames,a=e.codec,n=e.realCodec,r=e.channelCount,s=e.timescale,o=e.inputTimeScale,d=e.isAAC,u=this.nextSegmentPts,c=o/s,l=(d?1024:1152)*c;if(e.samples=[],0!==i.length){var h="number"==typeof u&&!isNaN(u)&&u>0&&(Math.abs(t-u)<.1*o||Math.abs(i[0].pts-u)<20*l);h||(p.a.log("audio track consecutive fragments as being contiguous: ".concat(h)),u=t);for(var _,f=0;f<i.length;){var g=(_=i[f]).pts-u,m=Math.abs(1e3*g/o);if(g<=-1*l)p.a.warn("Dropping 1 audio sample @ ".concat((u/e.inputTimeScale).toFixed(3),"s due to ").concat(Math.round(m)," ms overlap.")),i.byteLength-=_.data.byteLength,i.splice(f,1);else if(g>=1*l&&m<1e4&&u){var v=Math.round(g/l);p.a.warn("Injecting ".concat(v," audio frame (").concat(a,"/").concat(n,"/").concat(r,") @ ").concat((u/o).toFixed(3),"s due to ").concat(Math.round(1e3*g/o)," ms gap."));for(var b=0;b<v;b++){var y=Math.max(u,0),k=pe(n,r);k||(p.a.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),k=_.data.subarray()),i.byteLength+=k.byteLength,i.splice(f,0,{data:k,pts:y,dts:y}),u+=l,f++}_.pts=_.dts=u,u+=l,f++}else _.pts=_.dts=u,u+=l,f++}if(0!==i.length){var T=i[0],S=Math.max(T.pts,0);e.baseMediaDecodeTime=S/c;for(var P,x,I=new Uint8Array(i.byteLength),E=0,D=0;E<i.length;E++)P=i[E],x=i[E+1],e.samples.push({size:P.data.byteLength,duration:x?Math.round((x.pts-P.pts)/c):0,cts:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:0}}),I.set(P.data,D),D+=P.data.byteLength;e.samples.length>=2&&(e.samples[e.samples.length-1].duration=e.samples[e.samples.length-2].duration),this.nextSegmentPts=u,this.curSegmentPts=S,this.mdat=I}}}}]),e}(),me=i(122),ve=me.a.browser.SAFARI,be=function(){function e(t){n()(this,e),this.context=t,this.videoSequenceNumber=1,this.mdat=null,this.nextSegmentDts=null,this.nextSegmentPts=null,this.cacheBuffer=new Q}return s()(e,[{key:"parse",value:function(e){var t=null,i=e.tracks.videoTrack;i&&(this._loopGOPs(i),t={type:"fragment",contentType:"video",arrayBufferList:this._remuxVideo(i),duration:(this.nextSegmentDts-i.firstDTS)/i.timescale,startDTS:i.firstDTS/i.timescale,startPTS:i.firstPTS/i.timescale});return t}},{key:"reset",value:function(){this.videoSequenceNumber=1,this.mdat=null,this.nextSegmentDts=null,this.nextSegmentPts=null,this.cacheBuffer.clear()}},{key:"_remuxVideo",value:function(e){var t=_e.a.moof(this.videoSequenceNumber,e.baseMediaDecodeTime,e),i=_e.a.mdat(this.mdat);this.videoSequenceNumber++,this.cacheBuffer.append(t),this.cacheBuffer.append(i);var a=this.cacheBuffer.toNewBytes();return this.cacheBuffer.clear(),[a.buffer]}},{key:"_loopGOPs",value:function(e){var t,i,a,n,r,s,o,d,u,c,l,h=0,_=e.gops,f=-1,g=0;e.samples=[];var m=_[0],v=m[0],b=_[_.length-1],y=b[b.length-1];r=Math.max(v.dts,0),s=Math.max(v.pts,0),o=Math.max(y.dts,0),d=s,me.a.browser.SAFARI&&(h=Math.round((o-r)/(_.frameLength-1)));var k=_.length&&this.nextSegmentDts&&(Math.abs((r-this.nextSegmentDts)/e.timescale)<.1||Math.abs(s-this.nextSegmentPts)<e.timescale/5);"boolean"==typeof k&&(k=!0);var T=Math.round((r-this.nextSegmentDts)/90);if(k&&T)if(T>1){var P=v.duration/90,x=T%P*90,I=Math.ceil(T/P)||0;for(p.a.warn("AVC:".concat(T," ms hole between fragments detected, filling it ").concat(I," I-frame")),n=0;n<I;n++){var E=Math.max(this.nextSegmentDts,0),D=Math.max(this.nextSegmentPts,0),w=Object(S.a)([],v,!0);w.dts=E,w.pts=D,0===n&&(r=E,s=D),n===I-1&&x>0&&(w.duration=x),this.nextSegmentDts+=w.duration,this.nextSegmentPts+=w.duration,_.byteLength+=w.byteLength,_.naluCount+=w.naluCount,m.splice(n,0,w)}}else T<-1&&p.a.log("AVC:".concat(-T," ms overlapping between fragments detected"));var A=_.byteLength+4*_.naluCount,q=new Uint8Array(A),O=new DataView(q.buffer);for(t=0;t<_.length;t++)for(u=_[t],i=0;i<u.length;i++){c=u[i],f+=1,me.a.browser.SAFARI?c.dts=r+f*h:c.dts=Math.max(c.dts,r),c.pts=Math.max(c.pts,c.dts);var L={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};for(L.cts=ve?Math.max(0,h*Math.round((c.pts-c.dts)/h)):c.pts-c.dts,L.duration=c.duration,L.size=4*c.length,L.size+=c.byteLength,(c.keyframe||me.a.browser.CHROME&&0===e.samples.length)&&(L.flags.dependsOn=2,L.flags.isDependedOn=1,L.flags.isNonSyncSample=0),e.samples.push(L),a=0;a<c.length;a++)l=c[a],O.setUint32(g,l.rawData.byteLength),g+=4,q.set(l.rawData,g),g+=l.rawData.byteLength;d=Math.max(d,c.pts)}e.firstDTS=r,e.firstPTS=s,e.baseMediaDecodeTime=r;var C=e.samples[e.samples.length-1].duration;this.nextSegmentPts=d+C,this.nextSegmentDts=o+C,this.mdat=q}}]),e}(),ye=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).context=e,a.options=i,a._initComplexer=new fe(e),a._audioComplexer=new ge(e),a._videoComplexer=new be(e),a}return f()(t,e),s()(t,[{key:"audioAlignPTS",set:function(e){this._audioComplexer.nextSegmentPts=e}}]),s()(t,[{key:"push",value:function(e){if(this._initComplexer.needParseIS){var t=this._initComplexer.parse(e),i=t.length;if(i>0)for(var a=0;a<i;a++){var n=t[a];this.emit("data",{fragmentType:"initSegment",contentType:n.contentType,container:n.container,codec:n.codec,trackId:n.trackId,data:n.arrayBufferList,meta:this.options.config.meta})}}if(this._audioComplexer){var r=this._audioComplexer.parse(e);r&&this.emit("data",{fragmentType:"fragment",contentType:r.contentType,data:r.arrayBufferList,startDTS:r.startDTS,startPTS:r.startPTS,duration:r.duration,nextSegmentPTS:r.nextSegmentPTS,meta:this.options.config.meta})}if(this._videoComplexer){var s=this._videoComplexer.parse(e);s&&this.emit("data",{fragmentType:"fragment",contentType:s.contentType,data:s.arrayBufferList,startDTS:s.startDTS,startPTS:s.startPTS,duration:s.duration,meta:this.options.config.meta})}}},{key:"rebuildInitSegment",value:function(){this._initComplexer.reset()}},{key:"reset",value:function(){this._initComplexer.reset(),this._audioComplexer.reset(),this._videoComplexer.reset()}}]),t}(g.a),ke={dash:b,m2ts:ue,flv:K,mp4:{Demux:he,Remux:function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).context=e,i.options=a,i.tracks=[],i._syncDTS=0,i._syncPTS=0,i._complexStream=new ye(e,a),i.pipe(i._complexStream),i}return f()(t,e),s()(t,[{key:"audioAlignPTS",set:function(e){this._complexStream.audioAlignPTS=e}}]),s()(t,[{key:"push",value:function(e){var t=this.tracks,i=e.videoTrack,a=e.audioTrack,n=e.captionTrack;i&&!t.videoTrack&&(t.push(i),t.videoTrack=i),a&&!t.audioTrack&&(t.push(a),t.audioTrack=a),n&&!t.captionTrack&&(t.push(n),t.captionTrack=n),this._doComplex()}},{key:"rebuildInitSegment",value:function(){this._complexStream.rebuildInitSegment()}},{key:"reset",value:function(){this.tracks=[],this._syncDTS=0,this._syncPTS=0,this.emit("reset")}},{key:"_doComplex",value:function(){var e=this.tracks.videoTrack,t=this.tracks.audioTrack,i=e?e.firstDTS:0,a=t?t.firstDTS:0;if(t&&t.frames&&e&&e.gops){var n=t.firstDTS-e.firstDTS;a=i+Math.max(0,n)}this.emit("data",{audioTimeOffset:a,videoTimeOffset:i,tracks:this.tracks}),this.tracks.splice(0,this.tracks.length),this.tracks.videoTrack=null,this.tracks.audioTrack=null,this.tracks.captionTrack=null}},{key:"endStream",get:function(){return this._complexStream}}]),t}(g.a)}},Te=function(e){function t(e,i){var a,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return n()(this,t),a=d()(this,c()(t).call(this)),r.debug&&(p.a.enable=!0),a._demuxer=new ke[e].Demux(h()(a),r),a._remuxer=new ke[i].Remux(h()(a),r),a._eventManager=new m.a,a._demuxer.endStream.pipe(a._remuxer),a._eventManager.on(a._demuxer.endStream,"info",(function(e){return a.emit("info",e)})),a._eventManager.on(a._demuxer.endStream,"data",(function(e){return a.emit("demux_data",e)})),a._eventManager.on(a._remuxer.endStream,"data",(function(e){return a.emit("remux_data",e)})),a._eventManager.on(a._remuxer.endStream,"done",(function(){return a.emit("done")})),a}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=t.resetInitSegment,a=t.audioSegmentAlignPTS;(Object(v.a)(e)||Object(v.h)(e))&&(Object(v.a)(e)&&(e=new Uint8Array(e)),"number"!=typeof a||isNaN(a)||(this._remuxer.audioAlignPTS=a),"boolean"==typeof i&&i&&this._remuxer.rebuildInitSegment(),this._demuxer.push(e,t),this._noticeIdle())}},{key:"reset",value:function(){this._demuxer.reset(),this._remuxer.reset()}},{key:"destroy",value:function(){this._demuxer.unpipe(),this._demuxer.endStream.unpipe(),this._remuxer.endStream.removeAllListeners("data"),this._remuxer.endStream.removeAllListeners("done"),this._eventManager.removeAll()}},{key:"_noticeIdle",value:function(){this.emit("__idle__")}}]),t}(g.a);t.a=Te},function(e,t,i){"use strict";var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.duration_second=0,this.file_name=null,this.start_second=0,this.pos=[],this.time=[0],this.sourceID=null,this.loadInfo=[]}}]),e}();t.a=o},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,(function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(err){buffer=undefined}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},i=0,a=e.length;i<a;i++)t[e.charAt(i)]=i;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],i=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(i>>>18),b64chars.charAt(i>>>12&63),t>=2?"=":b64chars.charAt(i>>>6&63),t>=1?"=":b64chars.charAt(63&i)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return fromCharCode(55296+(t>>>10))+fromCharCode(56320+(1023&t));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,i=t%4,a=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),n=[fromCharCode(a>>>16),fromCharCode(a>>>8&255),fromCharCode(255&a)];return n.length-=[0,0,2,1][i],n.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum((function(){return decode(this)}))),Object.defineProperty(String.prototype,"toBase64",noEnum((function(e){return encode(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",noEnum((function(){return encode(this,!0)})))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}))}).call(this,__webpack_require__(200))},function(e,t,i){var a=i(3);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}},function(e,t,i){"use strict";var a=i(116),n=i(107),r=i(74),s=i(141),o=Math.min,d=[].lastIndexOf,u=!!d&&1/[1].lastIndexOf(1,-0)<0,c=s("lastIndexOf");e.exports=u||c?function(e){if(u)return d.apply(this,arguments)||0;var t=a(this),i=r(t.length),s=i-1;for(arguments.length>1&&(s=o(s,n(arguments[1]))),s<0&&(s=i+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:d},function(e,t,i){"use strict";var a=i(87),n=i(31),r=i(175),s=i(195),o=i(191),d=i(95),u=i(139),c=Object.assign;e.exports=!c||n((function(){var e={},t={},i=Symbol();return e[i]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=c({},e)[i]||"abcdefghijklmnopqrst"!=r(c({},t)).join("")}))?function(e,t){for(var i=d(e),n=arguments.length,c=1,l=s.f,h=o.f;n>c;)for(var _,f=u(arguments[c++]),p=l?r(f).concat(l(f)):r(f),g=p.length,m=0;g>m;)_=p[m++],a&&!h.call(f,_)||(i[_]=f[_]);return i}:c},function(e,t,i){"use strict";var a=i(135),n=i(95),r=i(232),s=i(205),o=i(74),d=i(147),u=i(179);e.exports=function(e){var t,i,c,l,h,_=n(e),f="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:undefined,m=g!==undefined,v=0,b=u(_);if(m&&(g=a(g,p>2?arguments[2]:undefined,2)),b==undefined||f==Array&&s(b))for(i=new f(t=o(_.length));t>v;v++)d(i,v,m?g(_[v],v):_[v]);else for(h=(l=b.call(_)).next,i=new f;!(c=h.call(l)).done;v++)d(i,v,m?r(l,g,[c.value,v],!0):c.value);return i.length=v,i}},function(e,t,i){"use strict";var a=i(33),n=i(158),r=[].reverse,s=[1,2];a({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return n(this)&&(this.length=this.length),r.call(this)}})},function(e,t,i){"use strict";var a=i(33),n=i(74),r=i(285),s=i(106),o=i(286),d="".startsWith,u=Math.min;a({target:"String",proto:!0,forced:!o("startsWith")},{startsWith:function(e){var t=String(s(this));r(e);var i=n(u(arguments.length>1?arguments[1]:undefined,t.length)),a=String(e);return d?d.call(t,a,i):t.slice(i,i+a.length)===a}})},function(e,t,i){"use strict";i(23),i(109);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(6),d=i(154),u=i(145),c=function(){function e(t){n()(this,e),this.TAG="BaseStream",this._ctx=t,this._error=null,this.id=u.a.create(),this._actor=null,this._mediaRanges=new d.a,this._playRanges=new d.a,this._currentTime=0,this._filled=!1,this._hasNoticeEOD=!1,this._manifestType=null,this._isPlaying=!1}return s()(e,[{key:"loaderMode",get:function(){var e="cdn";return this._actor&&(e=this._actor.loaderMode),e}},{key:"mediaRanges",get:function(){return this._mediaRanges}},{key:"playRanges",get:function(){return this._playRanges}},{key:"error",get:function(){var e=this._error;return!e&&this._actor&&(e=this._actor.error),e}},{key:"filled",get:function(){return this._filled}},{key:"currentTime",set:function(e){this._currentTime=e},get:function(){return this._currentTime}},{key:"isPlaying",set:function(e){this._isPlaying=e,this._actor&&(this._actor.isActing=e)},get:function(){return this._isPlaying}},{key:"hasNoticeEOD",set:function(e){this._hasNoticeEOD=e},get:function(){return this._hasNoticeEOD}},{key:"buffer",get:function(){return{len:0,start:0,end:0}}},{key:"manifestType",get:function(){return this._manifestType}},{key:"videoTrackId",get:function(){return this._actor?this._actor.videoTrackId:null}},{key:"audioTrackId",get:function(){return this._actor?this._actor.audioTrackId:null}}]),s()(e,[{key:"reset",value:function(){this._mediaRanges.empty(),this._playRanges.empty(),this._actor&&this._actor.reset(),this._currentTime=0,this._filled=!1,this._reset()}},{key:"_reset",value:function(){}},{key:"destroy",value:function(){this.reset(),this._actor&&this._actor.destroy(),this._destroy&&this._destroy(),delete this._ctx,delete this._actor,delete this._error,delete this._mediaRanges,delete this._playRanges}},{key:"range",value:function(e,t){Array.isArray(t)?this._generateMediaRanges(t):t instanceof d.a&&(this._mediaRanges=t),this._generatePlayRanges(e),this._actor&&this._actor.applyRange&&this._actor.applyRange(this._playRanges);var i=this._playRanges,a=this._mediaRanges;i instanceof d.a&&i.length>0&&a instanceof d.a&&a.length>0&&o.a.log("Range made, ".concat(i.length," play ").concat(i.start(0),"-").concat(i.end(i.length-1),", ").concat(a.length," media ").concat(a.start(0),"-").concat(a.end(a.length-1)))}},{key:"_generateMediaRanges",value:function(e){if(this._mediaRanges.empty(),Array.isArray(e)&&e.length>0)for(var t,i=0;t=e[i];i++)this._mediaRanges.add(t[0],t[1])}},{key:"_generatePlayRanges",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,t=this._mediaRanges,i=t.start(0),a=t.end(t.length-1),n=this._playRanges;if(n.empty(),null===e||e<a){"number"==typeof e&&e<i&&n.add(e,i);for(var r=0;r<t.length;r++){var s=t.start(r),o=t.end(r);"number"==typeof e&&e>=o?e<t.start(r+1)&&n.add(e,t.start(r+1)):"number"==typeof e&&s<=e&&e<o?n.add(e,o):n.add(s,o)}}else n.add(e,Number.POSITIVE_INFINITY)}},{key:"noticeActorPump",value:function(){this._actor&&this._actor.pumpLoader()}},{key:"noticeP2PCheckData",value:function(){this._actor&&this._actor.noticeP2PCheckData()}},{key:"recoverImmediately",value:function(e){this._actor&&this._actor.drainBuffer()}}]),e}();t.a=c},function(e,t,i){"use strict";t.a={mixed:"mixed",video:"video",audio:"audio"}},function(e,t,i){"use strict";i(84);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=function(){function e(t){n()(this,e),this._type=t,this._origin=null,this._bytesArray=[]}return s()(e,[{key:"type",get:function(){return this._type}},{key:"origin",get:function(){return this._origin},set:function(e){this._origin=e}},{key:"byteLength",get:function(){var e=0;return this._bytesArray.forEach((function(t){e+=t.byteLength})),e}},{key:"bytesArray",get:function(){return this._bytesArray},set:function(e){if(!Array.isArray(e))throw"init segment bytes type should be an array";this._bytesArray=e}}]),e}();t.a=o},,,function(e,t,i){var a=i(33),n=i(254);a({target:"Object",stat:!0,forced:Object.assign!==n},{assign:n})},function(e,t,i){var a=i(87),n=i(93),r=i(167);a&&"g"!=/./g.flags&&n.f(RegExp.prototype,"flags",{configurable:!0,get:r})},function(e,t,i){var a=i(30);e.exports=a.Promise},function(e,t,i){var a,n,r,s,o,d,u,c,l=i(30),h=i(128).f,_=i(113),f=i(233).set,p=i(234),g=l.MutationObserver||l.WebKitMutationObserver,m=l.process,v=l.Promise,b="process"==_(m),y=h(l,"queueMicrotask"),k=y&&y.value;k||(a=function(){var e,t;for(b&&(e=m.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(i){throw n?s():r=undefined,i}}r=undefined,e&&e.enter()},b?s=function(){m.nextTick(a)}:g&&!p?(o=!0,d=document.createTextNode(""),new g(a).observe(d,{characterData:!0}),s=function(){d.data=o=!o}):v&&v.resolve?(u=v.resolve(undefined),c=u.then,s=function(){c.call(u,a)}):s=function(){f.call(l,a)}),e.exports=k||function(e){var t={fn:e,next:undefined};r&&(r.next=t),n||(n=t,s()),r=t}},function(e,t,i){var a=i(79),n=i(85),r=i(235);e.exports=function(e,t){if(a(e),n(t)&&t.constructor===e)return t;var i=r.f(e);return(0,i.resolve)(t),i.promise}},function(e,t,i){var a=i(30);e.exports=function(e,t){var i=a.console;i&&i.error&&(1===arguments.length?i.error(e):i.error(e,t))}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},function(e,t,i){var a=i(31);e.exports=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t){var i=Math.abs,a=Math.pow,n=Math.floor,r=Math.log,s=Math.LN2;e.exports={pack:function(e,t,o){var d,u,c,l=new Array(o),h=8*o-t-1,_=(1<<h)-1,f=_>>1,p=23===t?a(2,-24)-a(2,-77):0,g=e<0||0===e&&1/e<0?1:0,m=0;for((e=i(e))!=e||e===1/0?(u=e!=e?1:0,d=_):(d=n(r(e)/s),e*(c=a(2,-d))<1&&(d--,c*=2),(e+=d+f>=1?p/c:p*a(2,1-f))*c>=2&&(d++,c/=2),d+f>=_?(u=0,d=_):d+f>=1?(u=(e*c-1)*a(2,t),d+=f):(u=e*a(2,f-1)*a(2,t),d=0));t>=8;l[m++]=255&u,u/=256,t-=8);for(d=d<<t|u,h+=t;h>0;l[m++]=255&d,d/=256,h-=8);return l[--m]|=128*g,l},unpack:function(e,t){var i,n=e.length,r=8*n-t-1,s=(1<<r)-1,o=s>>1,d=r-7,u=n-1,c=e[u--],l=127&c;for(c>>=7;d>0;l=256*l+e[u],u--,d-=8);for(i=l&(1<<-d)-1,l>>=-d,d+=t;d>0;i=256*i+e[u],u--,d-=8);if(0===l)l=1-o;else{if(l===s)return i?NaN:c?-1/0:1/0;i+=a(2,t),l-=o}return(c?-1:1)*i*a(2,l-t)}}},function(e,t,i){var a=i(30),n=i(31),r=i(206),s=i(72).NATIVE_ARRAY_BUFFER_VIEWS,o=a.ArrayBuffer,d=a.Int8Array;e.exports=!s||!n((function(){d(1)}))||!n((function(){new d(-1)}))||!r((function(e){new d,new d(null),new d(1.5),new d(e)}),!0)||n((function(){return 1!==new d(new o(2),1,undefined).length}))},function(e,t,i){var a=i(107);e.exports=function(e){var t=a(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}},function(e,t,i){var a=i(95),n=i(74),r=i(179),s=i(205),o=i(135),d=i(72).aTypedArrayConstructor;e.exports=function(e){var t,i,u,c,l,h,_=a(e),f=arguments.length,p=f>1?arguments[1]:undefined,g=p!==undefined,m=r(_);if(m!=undefined&&!s(m))for(h=(l=m.call(_)).next,_=[];!(c=h.call(l)).done;)_.push(c.value);for(g&&f>2&&(p=o(p,arguments[2],2)),i=n(_.length),u=new(d(this))(i),t=0;i>t;t++)u[t]=g?p(_[t],t):_[t];return u}},function(e,t,i){"use strict";var a=i(95),n=i(124),r=i(74),s=Math.min;e.exports=[].copyWithin||function(e,t){var i=a(this),o=r(i.length),d=n(e,o),u=n(t,o),c=arguments.length>2?arguments[2]:undefined,l=s((c===undefined?o:n(c,o))-u,o-d),h=1;for(u<d&&d<u+l&&(h=-1,u+=l-1,d+=l-1);l-- >0;)u in i?i[d]=i[u]:delete i[d],d+=h,u+=h;return i}},function(e,t,i){"use strict";var a=/[^\0-\u007E]/,n=/[.\u3002\uFF0E\uFF61]/g,r="Overflow: input needs wider integers to process",s=Math.floor,o=String.fromCharCode,d=function(e){return e+22+75*(e<26)},u=function(e,t,i){var a=0;for(e=i?s(e/700):e>>1,e+=s(e/t);e>455;a+=36)e=s(e/35);return s(a+36*e/(e+38))},c=function(e){var t,i,a=[],n=(e=function(e){for(var t=[],i=0,a=e.length;i<a;){var n=e.charCodeAt(i++);if(n>=55296&&n<=56319&&i<a){var r=e.charCodeAt(i++);56320==(64512&r)?t.push(((1023&n)<<10)+(1023&r)+65536):(t.push(n),i--)}else t.push(n)}return t}(e)).length,c=128,l=0,h=72;for(t=0;t<e.length;t++)(i=e[t])<128&&a.push(o(i));var _=a.length,f=_;for(_&&a.push("-");f<n;){var p=2147483647;for(t=0;t<e.length;t++)(i=e[t])>=c&&i<p&&(p=i);var g=f+1;if(p-c>s((2147483647-l)/g))throw RangeError(r);for(l+=(p-c)*g,c=p,t=0;t<e.length;t++){if((i=e[t])<c&&++l>2147483647)throw RangeError(r);if(i==c){for(var m=l,v=36;;v+=36){var b=v<=h?1:v>=h+26?26:v-h;if(m<b)break;var y=m-b,k=36-b;a.push(o(d(b+y%k))),m=s(y/k)}a.push(o(d(m))),h=u(l,g,f==_),l=0,++f}}++l,++c}return a.join("")};e.exports=function(e){var t,i,r=[],s=e.toLowerCase().replace(n,".").split(".");for(t=0;t<s.length;t++)i=s[t],r.push(a.test(i)?"xn--"+c(i):i);return r.join(".")}},function(e,t,i){"use strict";i(21);var a=i(33),n=i(123),r=i(242),s=i(103),o=i(196),d=i(144),u=i(236),c=i(119),l=i(161),h=i(92),_=i(135),f=i(160),p=i(79),g=i(85),m=i(142),v=i(126),b=i(281),y=i(179),k=i(39),T=n("fetch"),S=n("Headers"),P=k("iterator"),x=c.set,I=c.getterFor("URLSearchParams"),E=c.getterFor("URLSearchParamsIterator"),D=/\+/g,w=Array(4),A=function(e){return w[e-1]||(w[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},q=function(e){try{return decodeURIComponent(e)}catch(t){return e}},O=function(e){var t=e.replace(D," "),i=4;try{return decodeURIComponent(t)}catch(a){for(;i;)t=t.replace(A(i--),q);return t}},L=/[!'()~]|%20/g,C={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},M=function(e){return C[e]},R=function(e){return encodeURIComponent(e).replace(L,M)},B=function(e,t){if(t)for(var i,a,n=t.split("&"),r=0;r<n.length;)(i=n[r++]).length&&(a=i.split("="),e.push({key:O(a.shift()),value:O(a.join("="))}))},N=function(e){this.entries.length=0,B(this.entries,e)},F=function(e,t){if(e<t)throw TypeError("Not enough arguments")},U=u((function(e,t){x(this,{type:"URLSearchParamsIterator",iterator:b(I(e).entries),kind:t})}),"Iterator",(function(){var e=E(this),t=e.kind,i=e.iterator.next(),a=i.value;return i.done||(i.value="keys"===t?a.key:"values"===t?a.value:[a.key,a.value]),i})),V=function(){l(this,V,"URLSearchParams");var e,t,i,a,n,r,s,o,d,u=arguments.length>0?arguments[0]:undefined,c=this,_=[];if(x(c,{type:"URLSearchParams",entries:_,updateURL:function(){},updateSearchParams:N}),u!==undefined)if(g(u))if("function"==typeof(e=y(u)))for(i=(t=e.call(u)).next;!(a=i.call(t)).done;){if((s=(r=(n=b(p(a.value))).next).call(n)).done||(o=r.call(n)).done||!r.call(n).done)throw TypeError("Expected sequence with length 2");_.push({key:s.value+"",value:o.value+""})}else for(d in u)h(u,d)&&_.push({key:d,value:u[d]+""});else B(_,"string"==typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")},H=V.prototype;o(H,{append:function(e,t){F(arguments.length,2);var i=I(this);i.entries.push({key:e+"",value:t+""}),i.updateURL()},"delete":function(e){F(arguments.length,1);for(var t=I(this),i=t.entries,a=e+"",n=0;n<i.length;)i[n].key===a?i.splice(n,1):n++;t.updateURL()},get:function(e){F(arguments.length,1);for(var t=I(this).entries,i=e+"",a=0;a<t.length;a++)if(t[a].key===i)return t[a].value;return null},getAll:function(e){F(arguments.length,1);for(var t=I(this).entries,i=e+"",a=[],n=0;n<t.length;n++)t[n].key===i&&a.push(t[n].value);return a},has:function(e){F(arguments.length,1);for(var t=I(this).entries,i=e+"",a=0;a<t.length;)if(t[a++].key===i)return!0;return!1},set:function(e,t){F(arguments.length,1);for(var i,a=I(this),n=a.entries,r=!1,s=e+"",o=t+"",d=0;d<n.length;d++)(i=n[d]).key===s&&(r?n.splice(d--,1):(r=!0,i.value=o));r||n.push({key:s,value:o}),a.updateURL()},sort:function(){var e,t,i,a=I(this),n=a.entries,r=n.slice();for(n.length=0,i=0;i<r.length;i++){for(e=r[i],t=0;t<i;t++)if(n[t].key>e.key){n.splice(t,0,e);break}t===i&&n.push(e)}a.updateURL()},forEach:function(e){for(var t,i=I(this).entries,a=_(e,arguments.length>1?arguments[1]:undefined,3),n=0;n<i.length;)a((t=i[n++]).value,t.key,this)},keys:function(){return new U(this,"keys")},values:function(){return new U(this,"values")},entries:function(){return new U(this,"entries")}},{enumerable:!0}),s(H,P,H.entries),s(H,"toString",(function(){for(var e,t=I(this).entries,i=[],a=0;a<t.length;)e=t[a++],i.push(R(e.key)+"="+R(e.value));return i.join("&")}),{enumerable:!0}),d(V,"URLSearchParams"),a({global:!0,forced:!r},{URLSearchParams:V}),r||"function"!=typeof T||"function"!=typeof S||a({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,i,a,n=[e];return arguments.length>1&&(t=arguments[1],g(t)&&(i=t.body,"URLSearchParams"===f(i)&&((a=t.headers?new S(t.headers):new S).has("content-type")||a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=m(t,{body:v(0,String(i)),headers:v(0,a)}))),n.push(t)),T.apply(this,n)}}),e.exports={URLSearchParams:V,getState:I}},function(e,t,i){var a=i(79),n=i(179);e.exports=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return a(t.call(e))}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],a=!0,n=!1,r=undefined;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);a=!0);}catch(d){n=!0,r=d}finally{try{a||null==o["return"]||o["return"]()}finally{if(n)throw r}}return i}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,i){var a=i(187);e.exports=function(e){if(a(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,i){var a=i(39)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[a]=!1,"/./"[e](t)}catch(n){}}return!1}},function(e,t,i){var a=i(33),n=i(253);a({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},function(e,t,i){"use strict";i(162),i(163),i(164),i(21),i(100),i(143),i(12),i(102),i(84),i(91);var a=i(8);i(132),i(296),i(149);function n(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName==t}))}var r={parseXmlString:function(e,t){var i=new DOMParser,a=null,n=null;try{n=i.parseFromString(e,"text/xml")}catch(r){throw"XML DOMParser parseFromString error: ".concat(r.message)}return n&&n.documentElement.tagName==t&&(a=n.documentElement),a&&a.getElementsByTagName("parsererror").length>0?null:a},parseAttr:function(e,t,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null,n=null,r=e.getAttribute(t);return null!=r&&(n=i(r)),null==n?a:n},getTextContents:function(e){return Array.from(e.childNodes).every((function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},findChild:function(e,t){var i=n(e,t);return 1!==i.length?null:i[0]},findChildren:n,findChildrenByNodeType:function(e,t){return Array.from(e.childNodes).filter((function(e){return e.nodeType===t}))}},s=(i(89),i(297),i(298),i(245)),o=i.n(s),d=i(27),u=i(78),c=i.n(u),l=(i(190),c.a.mark(h));function h(e){var t,i,a,n,r,s,o,d,u;return c.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:t=-1,i=undefined,a=undefined,n=!0,r=!1,s=undefined,c.prev=6,o=e[Symbol.iterator]();case 8:if(n=(d=o.next()).done){c.next=19;break}if(u=d.value,!(t>=0)){c.next=13;break}return c.next=13,{i:t,item:a,prev:i,next:u};case 13:t++,i=a,a=u;case 16:n=!0,c.next=8;break;case 19:c.next=25;break;case 21:c.prev=21,c.t0=c["catch"](6),r=!0,s=c.t0;case 25:c.prev=25,c.prev=26,n||null==o["return"]||o["return"]();case 28:if(c.prev=28,!r){c.next=31;break}throw s;case 31:return c.finish(28);case 32:return c.finish(25);case 33:if(-1==t){c.next=36;break}return c.next=36,{i:t,prev:i,item:a,next:undefined};case 36:case"end":return c.stop()}}),l,null,[[6,21,25,33],[26,,28,32]])}i(109),i(118),i(18),i(137),i(36);function _(e){return null!=e}function f(e){if(!e)return null;var t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return a.a.warn("Invalid duration string: ".concat(e)),null;var i=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(i)?i:null}function p(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var i=Number(t[1]);if(!isFinite(i))return null;var a=Number(t[2]);return isFinite(a)?{start:i,end:a}:null}function g(e){var t,i;return i=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(i)?null:i}function m(e){var t=Number(e);return t%1==0&&t>0?t:null}function v(e){var t=Number(e);return t%1==0&&t>=0?t:null}function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function y(e,t){return e.filter((function(e){return e.contentType==t}))}function k(e,t,i){var a,n;if(e||t)if(e&&t){var r=!0,s=!1,o=undefined;try{for(var d,u=e.streams[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){var c=d.value,l=!0,h=!1,_=undefined;try{for(var f,p=t.streams[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var g=f.value;a=(g.bandwidth||0)+(c.bandwidth||0),n={language:e.language,primary:e.main||t.main,audio:c,video:g,bandwidth:a},i.push(n)}}catch(P){h=!0,_=P}finally{try{l||null==p["return"]||p["return"]()}finally{if(h)throw _}}}}catch(P){s=!0,o=P}finally{try{r||null==u["return"]||u["return"]()}finally{if(s)throw o}}}else{var m=e||t,v=!0,b=!1,y=undefined;try{for(var k,T=m.streams[Symbol.iterator]();!(v=(k=T.next()).done);v=!0){var S=k.value;a=S.bandwidth||0,n={language:m.language||"und",primary:m.main,audio:e?S:null,video:t?S:null,bandwidth:a},i.push(n)}}catch(P){b=!0,y=P}finally{try{v||null==T["return"]||T["return"]()}finally{if(b)throw y}}}}function T(e,t){e.period=t,e.period.id||(a.a.log("No Period ID given for Period with start time ".concat(t.start,",  Assigning a default")),e.period.id="__qvs_period_"+t.start);var i=r.findChildren(t.node,"AdaptationSet").map((function(t){return function(e,t){var i=t.getAttribute("id"),n=t.getAttribute("contentType")||"",s=t.getAttribute("segmentAlignment"),u=t.getAttribute("lang")||"und",c=r.findChildren(t,"Representation"),l=n===d.a.TEXT;e.adaptationSet={id:i,contentType:n,segmentAlignment:s,language:u};var h=c.map((function(t){return function(e,t,i){var n,s=e.adaptationSet,u=s.contentType,c=t.getAttribute("id"),l=t.getAttribute("mimeType")||"",h=t.getAttribute("codecs"),_=r.parseAttr(t,"bandwidth",m)||0,f=r.findChild(t,"SegmentBase"),y=r.findChild(t,"SegmentList"),k=r.findChild(t,"SegmentTemplate"),T=r.findChildren(t,"BaseURL").map(r.getTextContents),S={contentType:u,id:c,mimeType:l,codecs:h,bandwidth:_,baseUris:T,segmentBase:f,segmentList:y,segmentTemplate:k};switch(u){case d.a.VIDEO:S.width=r.parseAttr(t,"width",v),S.height=r.parseAttr(t,"height",v),S.frameRate=r.parseAttr(t,"frameRate",g);break;case d.a.AUDIO:S.audioSamplingRate=v(t.getAttribute("audioSamplingRate"))}if(e.representation=S,!function(e){var t=0;if(t+=e.segmentBase?1:0,t+=e.segmentList?1:0,0==(t+=e.segmentTemplate?1:0))return a.a.warn("Representation does not contain a segment information source: the Representation must contain one of SegmentBase, SegmentList"),!1;1!=t&&(a.a.warn("Representation ".concat(e.id," contains multiple segment information sources: the Representation should only contain one of SegmentBase,SegmentList, or SegmentTemplate.")),e.segmentBase?(a.a.log("Using SegmentBase by default."),e.segmentList=null,e.segmentTemplate=null):(a.a.log("Using SegmentList by default."),e.segmentTemplate=null));return!0}(S))return a.a.warn("Skipping Representation",S),null;S.segmentList?n=function(e,t){var i=e.representation,n=i.contentType,s=r.findChild(t,"Initialization"),o=r.findChildren(t,"SegmentURL"),d=v(t.getAttribute("startNumber")||""),u=NaN;if("video"===n)u=1e3;else{if("audio"!==n)throw"mpd unknown ".concat(n);u=i.audioSamplingRate}var c={range:r.parseAttr(s,"range",p,{start:0,end:null})},l=o.map((function(t,i){t.getAttribute("indexRange")&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0);var a=v(r.parseAttr(t,"t",v));return 0===i&&(a=0),{startTime:a,duration:v(r.parseAttr(t,"d",v)),range:r.parseAttr(t,"mediaRange",p,{start:0,end:null})}}));l.length>1&&(l[0].duration=l[1].startTime);0==d&&(a.a.warn("SegmentList@startNumber must be > 0"),d=1);return{startNumber:d,timescale:u,initUri:c,mediaUris:l}}(e,S.segmentList):S.segmentBase||S.segmentTemplate?a.a.error("mpd parser still not support parse segmentBase or segmentTemplate"):a.a.error("Must have Segment* with non-text streams.");return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(Object(i),!0).forEach((function(t){o()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({id:s.id,originalId:S.id,segmentIndex:null,mimeType:S.mimeType,codecs:S.codecs,frameRate:S.frameRate,bandwidth:S.bandwidth,width:S.width,height:S.height,language:i,type:u,channelsCount:S.numChannels},n)}(e,t,u)})).filter((function(e){return!!e}));if(0==h.length){if(l)return null;throw new Error("DASH_EMPTY_ADAPTATION_SET")}if(!e.adaptationSet.contentType||e.adaptationSet.contentType==d.a.APPLICATION){var f=h[0].mimeType;h[0].codecs;e.adaptationSet.contentType=function(e){return e.split("/")[0]}(f);var y=!0,k=!1,T=undefined;try{for(var S,P=h[Symbol.iterator]();!(y=(S=P.next()).done);y=!0){S.value.type=e.adaptationSet.contentType}}catch(I){k=!0,T=I}finally{try{y||null==P["return"]||P["return"]()}finally{if(k)throw T}}}var x=c.map((function(e){return e.getAttribute("id")})).filter(_);return{id:e.adaptationSet.id,contentType:e.adaptationSet.contentType,language:u,streams:h,representationIds:x}}(e,t)})).filter(_),n=y(i,d.a.VIDEO),s=y(i,d.a.AUDIO);if(!n.length&&!s.length)throw"DASH_EMPTY_PERIOD";s.length||(s=[null]),n.length||(n=[null]);var u=[],c=!0,l=!1,h=undefined;try{for(var f,T=s[Symbol.iterator]();!(c=(f=T.next()).done);c=!0){var S=f.value,P=!0,x=!1,I=undefined;try{for(var E,D=n[Symbol.iterator]();!(P=(E=D.next()).done);P=!0){k(S,E.value,u)}}catch(w){x=!0,I=w}finally{try{P||null==D["return"]||D["return"]()}finally{if(x)throw I}}}}catch(w){l=!0,h=w}finally{try{c||null==T["return"]||T["return"]()}finally{if(l)throw h}}return{startTime:t.start,variants:u}}var S={parseClipList:function(e){var t=r.findChild(e,"clip_list"),i={},a={BaseURL:"baseUrl",remote_path:"url",start_ts_in_ms:{name:"startTime",parser:v},duration_in_ms:{name:"duration",parser:v},start_pos:{name:"startByte",parser:v},end_pos:{name:"endByte",parser:v},type:"type",size:{name:"size",parser:v}};return t&&r.findChildren(t,"clip").map((function(e){var t={};r.findChildrenByNodeType(e,Node.ELEMENT_NODE).map((function(e){var i=a[e.tagName];if(i){var n="string"==typeof i?i:i.name,s=r.getTextContents(e);i.parser&&(s=i.parser(s)),t[n]=s}})),Array.isArray(i[t.type])||(i[t.type]=[]),i[t.type].push(t)})),i},parseDuration:f,parsePeriods:function(e,t){var i=[],n=r.findChildren(t,"Period"),s=e.presentationDuration,o=0,d=!0,u=!1,c=undefined;try{for(var l,_=h(n)[Symbol.iterator]();!(d=(l=_.next()).done);d=!0){var p=l.value,g=p.i,m=p.item,v=p.next,b=m.getAttribute("id"),y=r.parseAttr(m,"start",f,o),k=r.parseAttr(m,"duration",f),S=null;if(v){var P=r.parseAttr(v,"start",f);null!=P&&(S=P-y)}else null!=s&&(S=s-y);S&&k&&Math.abs(S-k)>1/15&&a.a.warn("There is a gap/overlap between mpd Periods"),null==S&&(S=k);var x=T(e,{id:b,start:y,duration:S,node:m,isLastPeriod:null==S||!v});if(i.push(x),null==S){v&&a.a.warn("Skipping Period",g+1,"and any subsequent Periods:","Period",g+1,"does not have a valid start time.",v),o=null;break}o=y+S}}catch(I){u=!0,c=I}finally{try{d||null==_["return"]||_["return"]()}finally{if(u)throw c}}return null!=s?(o!=s&&a.a.warn("@mediaPresentationDuration does not match the total duration of all Periods."),{periods:i,duration:s,durationDerivedFromPeriods:!1}):{periods:i,duration:o,durationDerivedFromPeriods:!0}}};t.a={parseVP9:function(e){var t=[],i=[];try{var n=r.parseXmlString(e,"MPD"),s=r.parseAttr(n,"mediaPresentationDuration",S.parseDuration),o=S.parseClipList(n),d=!!o.video,u=!!o.audio,c={clips:o,presentationDuration:s,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1},l=S.parsePeriods(c,n).periods,h=s;Object.keys(o).forEach((function(e){var i=o[e],a={};a.type=e,a.duration=h,a.fragments=[],i.map((function(e,t){var i={segments:[]};i.idx=t,i.uri=e.url,i.startByte=e.startByte,i.endByte=e.endByte+1,a.fragments.push(i)})),t[e]=a}));var _=!0,f=!1,p=undefined;try{for(var g,m=function(){var e=g.value.variants[0],a=[];u&&a.push("audio"),d&&a.push("video"),a.forEach((function(a){var n=t[a],r=e[a],s={};if(s.uri=n.fragments[0].uri,s.startByte=r.initUri.range.start,s.endByte=r.initUri.range.end+1,s.duration=0,n){n.initSegment=s,n.segments=[];for(var o=0,d=-1,u=n.fragments[o],c=r.timescale,l=r.mediaUris.length,h=!1,_=0;_<l;_++){var f=_===l-1,p=r.mediaUris[_],g=p.range.start,m=p.range.end+1,v=g-u.startByte,b=m-u.startByte,y=u.uri,k=p.startTime/c,T=p.duration/c;f&&(T=n.duration-k),m<=u.endByte&&(d++,m===u.endByte&&(h=!0,u.startTime=u.segments.length>0?u.segments[0].startTime:k,u.duration=k-u.startTime+T));var S={};S.uri=y,S.idx=d,S.fragIdx=o,S.startTime=k,S.duration=T,S.startByte=v,S.endByte=b,n.segments.push(S),u.segments.push(S),h&&(o++,d=-1,u=n.fragments[o],h=!1)}}i[a]={init:n.initSegment,segments:n.segments,duration:n.duration}}))},v=l[Symbol.iterator]();!(_=(g=v.next()).done);_=!0)m()}catch(b){f=!0,p=b}finally{try{_||null==v["return"]||v["return"]()}finally{if(f)throw p}}}catch(y){return a.a.error("mpd parsed fail: ".concat(y.message)),null}return i}}},function(e,t,i){t.f=i(39)},function(e,t,i){var a=i(214),n=i(92),r=i(289),s=i(93).f;e.exports=function(e){var t=a.Symbol||(a.Symbol={});n(t,e)||s(t,e,{value:r.f(e)})}},function(e,t,i){"use strict";var a=i(33),n=i(30),r=i(157),s=i(103),o=i(292),d=i(231),u=i(161),c=i(85),l=i(31),h=i(206),_=i(144),f=i(184);e.exports=function(e,t,i,p,g){var m=n[e],v=m&&m.prototype,b=m,y=p?"set":"add",k={},T=function(e){var t=v[e];s(v,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!c(e)?undefined:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!c(e))&&t.call(this,0===e?0:e)}:function(e,i){return t.call(this,0===e?0:e,i),this})};if(r(e,"function"!=typeof m||!(g||v.forEach&&!l((function(){(new m).entries().next()})))))b=i.getConstructor(t,e,p,y),o.REQUIRED=!0;else if(r(e,!0)){var S=new b,P=S[y](g?{}:-0,1)!=S,x=l((function(){S.has(1)})),I=h((function(e){new m(e)})),E=!g&&l((function(){for(var e=new m,t=5;t--;)e[y](t,t);return!e.has(-0)}));I||((b=t((function(t,i){u(t,b,e);var a=f(new m,t,b);return i!=undefined&&d(i,a[y],a,p),a}))).prototype=v,v.constructor=b),(x||E)&&(T("delete"),T("has"),p&&T("get")),(E||P)&&T(y),g&&v.clear&&delete v.clear}return k[e]=b,a({global:!0,forced:b!=m},k),_(b,e),g||i.setStrong(b,e,p),b}},function(e,t,i){var a=i(155),n=i(85),r=i(92),s=i(93).f,o=i(165),d=i(426),u=o("meta"),c=0,l=Object.isExtensible||function(){return!0},h=function(e){s(e,u,{value:{objectID:"O"+ ++c,weakData:{}}})},_=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,u)){if(!l(e))return"F";if(!t)return"E";h(e)}return e[u].objectID},getWeakData:function(e,t){if(!r(e,u)){if(!l(e))return!0;if(!t)return!1;h(e)}return e[u].weakData},onFreeze:function(e){return d&&_.REQUIRED&&l(e)&&!r(e,u)&&h(e),e}};a[u]=!0},function(e,t,i){"use strict";var a=i(93).f,n=i(142),r=i(196),s=i(135),o=i(161),d=i(231),u=i(216),c=i(177),l=i(87),h=i(292).fastKey,_=i(119),f=_.set,p=_.getterFor;e.exports={getConstructor:function(e,t,i,u){var c=e((function(e,a){o(e,c,t),f(e,{type:t,index:n(null),first:undefined,last:undefined,size:0}),l||(e.size=0),a!=undefined&&d(a,e[u],e,i)})),_=p(t),g=function(e,t,i){var a,n,r=_(e),s=m(e,t);return s?s.value=i:(r.last=s={index:n=h(t,!0),key:t,value:i,previous:a=r.last,next:undefined,removed:!1},r.first||(r.first=s),a&&(a.next=s),l?r.size++:e.size++,"F"!==n&&(r.index[n]=s)),e},m=function(e,t){var i,a=_(e),n=h(t);if("F"!==n)return a.index[n];for(i=a.first;i;i=i.next)if(i.key==t)return i};return r(c.prototype,{clear:function(){for(var e=_(this),t=e.index,i=e.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=undefined),delete t[i.index],i=i.next;e.first=e.last=undefined,l?e.size=0:this.size=0},"delete":function(e){var t=_(this),i=m(this,e);if(i){var a=i.next,n=i.previous;delete t.index[i.index],i.removed=!0,n&&(n.next=a),a&&(a.previous=n),t.first==i&&(t.first=a),t.last==i&&(t.last=n),l?t.size--:this.size--}return!!i},forEach:function(e){for(var t,i=_(this),a=s(e,arguments.length>1?arguments[1]:undefined,3);t=t?t.next:i.first;)for(a(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!m(this,e)}}),r(c.prototype,i?{get:function(e){var t=m(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),l&&a(c.prototype,"size",{get:function(){return _(this).size}}),c},setStrong:function(e,t,i){var a=t+" Iterator",n=p(t),r=p(a);u(e,t,(function(e,t){f(this,{type:a,target:e,state:n(e),kind:t,last:undefined})}),(function(){for(var e=r(this),t=e.kind,i=e.last;i&&i.removed;)i=i.previous;return e.target&&(e.last=i=i?i.next:e.state.first)?"keys"==t?{value:i.key,done:!1}:"values"==t?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(e.target=undefined,{value:undefined,done:!0})}),i?"entries":"values",!i,!0),c(t)}}},function(e,t,i){"use strict";i(23),i(132),i(21),i(73),i(100),i(143),i(12),i(118),i(18),i(102),i(137),i(25),i(84),i(91),i(201);function a(e){var t={};function i(a){try{if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};e[a].call(n.exports,n,n.exports,i),n.l=!0}catch(r){throw"__webpack_require__ failed ".concat(r.stack||r.message)}return n.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var a=i(i.s=ENTRY_MODULE);return a["default"]||a}var n="\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function r(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,a){var s={};s[a]=[];var o=t.toString(),d=o.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!d)return s;for(var u,c=d[1],l=new RegExp("(\\\\n|\\W)"+r(c)+n,"g");u=l.exec(o);)"dll-reference"!==u[3]&&s[a].push(u[3]);for(l=new RegExp("\\("+r(c)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+n,"g");u=l.exec(o);)e[u[2]]||(s[a].push(u[1]),e[u[2]]=i(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);for(var h,_=Object.keys(s),f=0;f<_.length;f++)for(var p=0;p<s[_[f]].length;p++)h=s[_[f]][p],isNaN(1*h)||(s[_[f]][p]=1*s[_[f]][p]);return s}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}t.a=function(e,t){t=t||{};var n={main:i.m},r=t.all?{main:Object.keys(n.main)}:function(e,t){for(var i={main:[t]},a={main:[]},n={main:{}};o(i);)for(var r=Object.keys(i),d=0;d<r.length;d++){var u=r[d],c=i[u].pop();if(n[u]=n[u]||{},!n[u][c]&&e[u][c]){n[u][c]=!0,a[u]=a[u]||[],a[u].push(c);for(var l=s(e,e[u][c],u),h=Object.keys(l),_=0;_<h.length;_++)i[h[_]]=i[h[_]]||[],i[h[_]]=i[h[_]].concat(l[h[_]])}}return a}(n,e),d="";Object.keys(r).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;r[e][t];)t++;r[e].push(t),n[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+e+" = ("+a.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+r[e].map((function(t){return JSON.stringify(t)+": "+n[e][t].toString()})).join(",")+"});\n"})),d=d+"new (("+a.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+r.main.map((function(e){return JSON.stringify(e)+": "+n.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([d],{type:"text/javascript"}),c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),l=new window.Worker(c,t.worker||{});return l.objectURL=c,l}},function(e,t,i){"use strict";i(21),i(40),i(89),i(12),i(264),i(44),i(428),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(91);var a=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},n=function(e){return new Date(1e3*e-20828448e5)},r=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},s={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:o(e.subarray(78,e.byteLength))}},avcC:function(e){var t,i,a,n,r=new DataView(e.buffer,e.byteOffset,e.byteLength),s={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},o=31&e[5];for(a=6,n=0;n<o;n++)i=r.getUint16(a),a+=2,s.sps.push(new Uint8Array(e.subarray(a,a+i))),a+=i;for(t=e[a],a++,n=0;n<t;n++)i=r.getUint16(a),a+=2,s.pps.push(new Uint8Array(e.subarray(a,a+i))),a+=i;return s},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){new DataView(e.buffer,e.byteOffset,e.byteLength);var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25]}}};return 5===t.decoderConfig.streamType?(t.decoderConfig.decoderConfigDescriptor.audioObjectType=e[26]>>>3&31,t.decoderConfig.decoderConfigDescriptor.samplingFrequencyIndex=(7&e[26])<<1|e[27]>>>7&1,t.decoderConfig.decoderConfigDescriptor.channelConfiguration=e[27]>>>3&15):(t.decoderConfig.decoderConfigDescriptor.audioObjectType=e[35]>>>3&31,t.decoderConfig.decoderConfigDescriptor.samplingFrequencyIndex=(7&e[35])<<8+(128&e[36])>>7,t.decoderConfig.decoderConfigDescriptor.channelConfiguration=(120&e[36])>>3),t},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={majorBrand:a(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;n<e.byteLength;)i.compatibleBrands.push(a(e.subarray(n,n+4))),n+=4;return i},dinf:function(e){return{boxes:o(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:o(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:a(e.subarray(8,12)),name:""},i=8;for(i=24;i<e.byteLength;i++){if(0===e[i]){i++;break}t.name+=String.fromCharCode(e[i])}return t.name=decodeURIComponent(decodeURIComponent(t.name)),t},mdhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a=4,r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(a+=4,r.creationTime=n(i.getUint32(a)),a+=8,r.modificationTime=n(i.getUint32(a)),a+=4,r.timescale=i.getUint32(a),a+=8,r.duration=i.getUint32(a)):(r.creationTime=n(i.getUint32(a)),a+=4,r.modificationTime=n(i.getUint32(a)),a+=4,r.timescale=i.getUint32(a),a+=4,r.duration=i.getUint32(a)),a+=4,t=i.getUint16(a),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((960&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:o(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:o(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(i.streamDescriptor=o(e.subarray(28))[0]),i},moof:function(e){return{boxes:o(e)}},moov:function(e){return{boxes:o(e)}},mvex:function(e){return{boxes:o(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,a={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===a.version?(i+=4,a.creationTime=n(t.getUint32(i)),i+=8,a.modificationTime=n(t.getUint32(i)),i+=4,a.timescale=t.getUint32(i),i+=8,a.duration=t.getUint32(i)):(a.creationTime=n(t.getUint32(i)),i+=4,a.modificationTime=n(t.getUint32(i)),i+=4,a.timescale=t.getUint32(i),i+=4,a.duration=t.getUint32(i)),i+=4,a.rate=t.getUint16(i)+t.getUint16(i+2)/16,i+=4,a.volume=t.getUint8(i)+t.getUint8(i+1)/8,i+=2,i+=2,i+=8,a.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,i+=24,a.nextTrackId=t.getUint32(i),a},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)i.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return i},sidx:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},n=i.getUint16(22);for(t=24;n;t+=12,n--)a.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&i.getUint32(t),subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&i.getUint32(t+8)});return a},stbl:function(e){return{boxes:o(e)}},stco:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=t.getUint32(4),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),entryCount:i,chunkOffsets:[]},n=8;i;n+=4,i--)a.chunkOffsets.push(t.getUint32(n));return a},stsc:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a=i.getUint32(4),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;a;t+=12,a--)n.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return n},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),boxes:o(e.subarray(8))}},stsz:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)a.entries.push(i.getUint32(t));return a},stts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},n=i.getUint32(4);for(t=8;n;t+=8,n--)a.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return a},stss:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),frameIndex:[]},n=i.getUint32(4);for(t=8;n;t+=4,n--)a.frameIndex.push({index:i.getUint32(t)});return a},ctts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),frameIndex:[]},n=i.getUint32(4);if(0==a.version)for(t=8;n;t+=8,n--)a.frameIndex.push({sample_count:i.getUint32(t),sample_offset:i.getUint32(t+4)});else for(t=8;n;t+=8,n--)a.frameIndex.push({sample_count:i.getUint32(t),sample_offset:i.getInt32(t+4)});return a},styp:function(e){return s.ftyp(e)},tfdt:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},tfhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),a={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},n=1&a.flags[2],r=2&a.flags[2],s=8&a.flags[2],o=16&a.flags[2],d=32&a.flags[2];return t=8,n&&(t+=4,a.baseDataOffset=i.getUint32(12),t+=4),r&&(a.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(a.defaultSampleDuration=i.getUint32(t),t+=4),o&&(a.defaultSampleSize=i.getUint32(t),t+=4),d&&(a.defaultSampleFlags=i.getUint32(t)),a},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,a={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===a.version?(i+=4,a.creationTime=n(t.getUint32(i)),i+=8,a.modificationTime=n(t.getUint32(i)),i+=4,a.trackId=t.getUint32(i),i+=4,i+=8,a.duration=t.getUint32(i)):(a.creationTime=n(t.getUint32(i)),i+=4,a.modificationTime=n(t.getUint32(i)),i+=4,a.trackId=t.getUint32(i),i+=4,i+=4,a.duration=t.getUint32(i)),i+=4,i+=8,a.layer=t.getUint16(i),i+=2,a.alternateGroup=t.getUint16(i),i+=2,a.volume=t.getUint8(i)+t.getUint8(i+1)/8,i+=2,i+=2,a.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,a.width=t.getUint16(i)+t.getUint16(i+2)/16,i+=4,a.height=t.getUint16(i)+t.getUint16(i+2)/16,a},traf:function(e){return{boxes:o(e)}},trak:function(e){return{boxes:o(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},a=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&i.flags[2],s=4&i.flags[2],o=1&i.flags[1],d=2&i.flags[1],u=4&i.flags[1],c=8&i.flags[1],l=a.getUint32(4),h=8;for(n&&(i.dataOffset=a.getUint32(h),h+=4),s&&l&&(t={flags:r(e.subarray(h,h+4))},h+=4,o&&(t.duration=a.getUint32(h),h+=4),d&&(t.size=a.getUint32(h),h+=4),c&&(t.compositionTimeOffset=a.getUint32(h),h+=4),i.samples.push(t),l--);l--;)t={},o&&(t.duration=a.getUint32(h),h+=4),d&&(t.size=a.getUint32(h),h+=4),u&&(t.flags=r(e.subarray(h,h+4)),h+=4),c&&(t.compositionTimeOffset=a.getUint32(h),h+=4),i.samples.push(t);return i},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}}},o=function(e){for(var t,i,n,r,o=0,d=[],u=new DataView(e.buffer,e.byteOffset,e.byteLength);o<e.byteLength;)t=u.getUint32(o),i=a(e.subarray(o+4,o+8)),n=t>1?o+t:e.byteLength,(r=(s[i]||function(e){return{data:e}})(e.subarray(o+8,n))).size=t,r.type=i,d.push(r),o=n;return d},d={mp4toJSON:o};t.a=d},function(e,t,i){var a=i(33),n=i(255);a({target:"Array",stat:!0,forced:!i(206)((function(e){Array.from(e)}))},{from:n})},function(e,t,i){var a=i(33),n=i(31),r=i(116),s=i(128).f,o=i(87),d=n((function(){s(1)}));a({target:"Object",stat:!0,forced:!o||d,sham:!o},{getOwnPropertyDescriptor:function(e,t){return s(r(e),t)}})},function(e,t,i){var a=i(33),n=i(87),r=i(213),s=i(116),o=i(128),d=i(147);a({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(e){for(var t,i,a=s(e),n=o.f,u=r(a),c={},l=0;u.length>l;)(i=n(a,t=u[l++]))!==undefined&&d(c,t,i);return c}})},function(e,t){var i={utf8:{stringToBytes:function(e){return i.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(i.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}};e.exports=i},function(e,t,i){"use strict";var a=i(33),n=i(74),r=i(285),s=i(106),o=i(286),d="".endsWith,u=Math.min;a({target:"String",proto:!0,forced:!o("endsWith")},{endsWith:function(e){var t=String(s(this));r(e);var i=arguments.length>1?arguments[1]:undefined,a=n(t.length),o=i===undefined?a:u(n(i),a),c=String(e);return d?d.call(t,c,o):t.slice(o-c.length,o)===c}})},,,function(e,t,i){var a=i(252),n=i(245);function r(e,t,i,s){return(r="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,i,r){var s,o=a(e,t);if(o){if((s=Object.getOwnPropertyDescriptor(o,t)).set)return s.set.call(r,i),!0;if(!s.writable)return!1}if(s=Object.getOwnPropertyDescriptor(r,t)){if(!s.writable)return!1;s.value=i,Object.defineProperty(r,t,s)}else n(r,t,i);return!0})(e,t,i,s)}e.exports=function(e,t,i,a,n){if(!r(e,t,i,a||e)&&n)throw new Error("failed to set property");return i}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return XFactorManager}));var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(100),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(89),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(24),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(36),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(149),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(84),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(153),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(112),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_9__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(0),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_10__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_11__),XFactorManager=function(){function XFactorManager(e){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_10___default()(this,XFactorManager),this.globalVarList=e||[]}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_11___default()(XFactorManager,[{key:"clear",value:function(){this.globalVarList=[]}},{key:"reset",value:function(e){this.globalVarList=e}},{key:"setXFactor",value:function(e,t){this.globalVarList.find((function(t){return t.name===e})).initValue=t}},{key:"getXFactor",value:function(e){return this.globalVarList.find((function(t){return t.name===e}))}},{key:"getXFactorValue",value:function(){return this.getXFactor()?parseInt(this.getXFactor().initValue,10):0}},{key:"isShowInteractElement",value:function(e){var t=this;return!0===(e||[]).some((function(e){return t._expressParse(e)}))?1:0}},{key:"isShowInteract",value:function(e){var t=this;return!0===(e||[]).some((function(e){return t._expressParse(e)}))?1:0}},{key:"getInteractActionSwitchInfo",value:function(e){var t=this;return(e||[]).find((function(e){return t._expressParse(e)}))}},{key:"getEndActionSwitchInfo",value:function(e){var t=this;return(e||[]).find((function(e){return t._expressParse(e)}))}},{key:"doAlgorithm",value:function doAlgorithm(algorithmList){var self=this;if(algorithmList&&0!=algorithmList.length)return algorithmList.forEach((function(exp){var pattern=/^([A-Za-z0-9]+)(=)([A-Za-z0-9]+)(\+|-)(\d*)/,_pattern$exec=pattern.exec(exp),_pattern$exec2=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_9___default()(_pattern$exec,6),v1=_pattern$exec2[1],v2=_pattern$exec2[3],e=_pattern$exec2[4],n=_pattern$exec2[5],r2=self.getXFactorValue(v2),r1=eval("".concat(r2).concat(e).concat(parseInt(n,10)));self.setXFactor(v1,r1>0?r1:0)})),self.globalVarList}},{key:"_expressParse",value:function _expressParse(item){var self=this,express=item.express,expressType=item.expressType,expressPara=item.expressPara,expressParaValue=self.getXFactorValue(expressPara.trim()),__eval=function __eval(str){var pattern=/^([A-Za-z0-9]+)([><!]=?|=)(\d*)/,_pattern$exec3=pattern.exec(str),_pattern$exec4=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_9___default()(_pattern$exec3,4),k=_pattern$exec4[1],s=_pattern$exec4[2],v=_pattern$exec4[3],x=self.getXFactorValue(k);return!0===eval("".concat(x).concat(s).concat(parseInt(v,10)))},__mathParse=function(e,t,i){var a;return(a=Math[e]).call.apply(a,[null].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_8___default()(t.split(",").map((function(e){return e.trim()})).map((function(e){return self.getXFactorValue(e)})))))==i};switch(expressType){case"min":case"max":return __mathParse.apply(void 0,[expressType].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_8___default()(express),[expressParaValue]));case"condition":return express.split("&&").map(__eval).every((function(e){return!0===e}))}}}]),XFactorManager}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(73),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_map__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(197),core_js_modules_es_map__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_map__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(143),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(12),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(24),core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_parse_int__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(18),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(102),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(25),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(84),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(91),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(0),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(1),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_14__),_ChunkSet_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(250),m3u8_parser__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(306),md5__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(169),md5__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(md5__WEBPACK_IMPORTED_MODULE_17__),_Config__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(14),_move_LevelInfo__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(34),_utils_Adapter__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(83),_Jsonp__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(307),_utils_Log__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(8),_RunTime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(13),_ErrorManger__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(101),_utils_Tools__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(15),_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(10),_vp9_ManifestStream__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(288),_VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(199),_utils_Event__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(71),_enum_EventType__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(86),DashParser=function(){function e(t,i,a,n){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13___default()(this,e),this.dashInfoMap===undefined&&(this.dashInfoMap=new Map),this.bidReqMap===undefined&&(this.bidReqMap=new Map),this.close(),this.init(t,i,a,n),this.tvid=i.tvid}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_14___default()(e,[{key:"close",value:function(){this.tvid=null,this.setting=null,this.bitRateList=[],this.updateLevelInfo=null,this.albumID=null,this.ad=!1,this.videoFormatType=null,this.vidList=[],this.chunkNum=-1,this.checkTm=0,this.self=null,this.dashInfoMap.clear(),this.bidReqMap.clear(),this.feedBid=0,this.reLoadStep=0,this.allDuration=0}},{key:"updateSetting",value:function(e){this.setting.ut=e.ut,this.setting.dfp=e.dfp,this.setting.bop=e.bop}},{key:"init",value:function(e,t,i,a){this.checkTm=t.tm-(new Date).getTime(),this.setting=t,this.bitRateList=[],this.vidList=[];var n=JSON.parse(e);if(n.hasOwnProperty("data"))if(n.data.hasOwnProperty("aid")?_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.aid=this.albumID=n.data.aid:_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("manifest json has not  tvid or video data"),n.data.hasOwnProperty("program")&&n.data.program.hasOwnProperty("video")){for(var r=n.data.program.video,s=0;s<r.length;s++)r[s].hasOwnProperty("m3u8")&&(this.videoFormatType=r[s].ff);for(var o=0;o<r.length;o++)if(r[o].hasOwnProperty("_selected")){if(this.allDuration!==r[o].duration&&(this.allDuration=r[o].duration),r[o].hasOwnProperty("bid")&&r[o].ff===this.videoFormatType&&r[o].dr!==_Config__WEBPACK_IMPORTED_MODULE_18__.d)if(a){for(var d=!1,u=0;u<a.length;u++)if(r[o].bid===a[u]){d=!0;break}d||this.bitRateList.push(r[o].bid)}else this.bitRateList.push(r[o].bid);if(r[o].dr===_Config__WEBPACK_IMPORTED_MODULE_18__.d&&(r[o].bid=_Config__WEBPACK_IMPORTED_MODULE_18__.f),r[o].hasOwnProperty("vid")&&this.vidList.push({vid:r[o].vid,rate:r[o].bid}),r[o].hasOwnProperty("m3u8"))if(this.feedBid=r[o].bid,this.dashInfoMap.set(r[o].bid,e),this.videoFormatType===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.M4S){var c=dealSeekableList(r[o],null,this.videoFormatType);_utils_Event__WEBPACK_IMPORTED_MODULE_29__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_30__.a.UpdateDash,{levelID:r[o].bid,data:c.info}),this.chunkNum=c.num}else if(this.videoFormatType===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.TS){var l=parseTSFile(r[o],i?i.stream:null);this.chunkNum=l.chunkNum,_utils_Event__WEBPACK_IMPORTED_MODULE_29__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_30__.a.UpdateDash,{levelID:r[o].bid,data:l.mediaInfo}),l.isRealTs?this.videoFormatType=_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.TS:this.videoFormatType=_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.FTS}else if(this.videoFormatType===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.DASH){var h=null;i&&i.video&&i.audio||(i=_vp9_ManifestStream__WEBPACK_IMPORTED_MODULE_27__.a.parseVP9(r[o].m3u8)),(h=dealSeekableList(r[o],i,this.videoFormatType))&&(this.chunkNum=h.num,_utils_Event__WEBPACK_IMPORTED_MODULE_29__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_30__.a.UpdateDash,{levelID:r[o].bid,data:h.info}))}}}else _utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("manifest json has not  program or video data");else _utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("manifest json has not data info")}},{key:"FetchBitRateFileInfo",value:function(e){if(0===_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.authorFailedStatus&&this.dashInfoMap.has(e)){var t=this.dashInfoMap.get(e),i=JSON.stringify(t),a=getJsonFormatFilesInfo(JSON.parse(i));return a?void _utils_Event__WEBPACK_IMPORTED_MODULE_29__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_30__.a.UpdateDash,{levelID:a.bid,data:a.fileInfo}):void _utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("getJsonFormatFilesInfo return null~~~")}this.bidReqMap.has(e)?this.bidReqMap.set(e,this.bidReqMap.get(e)+1):this.bidReqMap.set(e,1);for(var n=null,r=0;r<this.vidList.length;r++)if(this.vidList[r].rate===e){n=this.vidList[r].vid;break}var s=produceDashUrl(this.setting,e!==_Config__WEBPACK_IMPORTED_MODULE_18__.f?e:_Config__WEBPACK_IMPORTED_MODULE_18__.e,n,this.checkTm,this.bidReqMap.get(e));Object(_Jsonp__WEBPACK_IMPORTED_MODULE_21__.a)(s,{timeout:5e3},this.responFunc.bind(this))}},{key:"responFunc",value:function(e,t){if(e)_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("require dashInfo found err~~ .after 2s try again "+e.message),0===this.reLoadStep&&(this.reLoadStep=setTimeout(this.reLoad.bind(this),2e3));else if(t&&t.hasOwnProperty("code"))if("A00000"===t.code){var i=JSON.parse(JSON.stringify(t));if(i.hasOwnProperty("data")&&i.data.hasOwnProperty("program")&&i.data.program.hasOwnProperty("video"))for(var a=i.data.program.video,n=0;n<a.length;n++)a[n].dr===_Config__WEBPACK_IMPORTED_MODULE_18__.d&&(a[n].bid=_Config__WEBPACK_IMPORTED_MODULE_18__.f);var r=getBidFromDashInfo(i);0===r&&_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("fetch m3u8 info  err ,no Bid has m3u8 ~~");var s=JSON.stringify(i);this.dashInfoMap.set(r,s);var o=getJsonFormatFilesInfo(i);if(!o)return void _utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.warn("getJsonFormatFilesInfo return null~~~");_utils_Event__WEBPACK_IMPORTED_MODULE_29__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_30__.a.UpdateDash,{levelID:o.bid,data:o.fileInfo}),_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.info("loadM3u8FileSuc success~~,bid= "+r)}else"A00020"===t.code&&t.hasOwnProperty("tm")&&(_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.info("dashParser update require dash timestamp "),this.checkTm=t.tm-(new Date).getTime(),0===this.reLoadStep&&(this.reLoadStep=setTimeout(this.reLoad.bind(this),2e3)));else console.Log("FetchBitRateFileInfo data invalid~~~~")}},{key:"reLoad",value:function(){for(var e=0;e<this.bitRateList.length;e++)!this.dashInfoMap.has(this.bitRateList[e])&&this.bidReqMap.get(this.bitRateList[e])<3?this.FetchBitRateFileInfo(this.bitRateList[e],this.self):this.bidReqMap.get(this.bitRateList[e])>=3&&_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.authorFailedStatus>0&&(_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.authorFailedStatus=0,_ErrorManger__WEBPACK_IMPORTED_MODULE_24__.a.errorStage="authorFailed",_ErrorManger__WEBPACK_IMPORTED_MODULE_24__.a.errorFragment=this,_utils_Log__WEBPACK_IMPORTED_MODULE_22__.a.error("[FINAL Error ,author failed ]  , rate "+this.bitRateList[e]));clearTimeout(this.reLoadStep),this.reLoadStep=0}},{key:"curFeedBid",get:function(){return this.feedBid}}]),e}();function getBidFromDashInfo(e){if(e.data.hasOwnProperty("program")&&e.data.program.hasOwnProperty("video"))for(var t=e.data.program.video,i=0;i<t.length;i++)if(t[i].hasOwnProperty("m3u8"))return t[i].bid;return 0}function getUserInfo(){var userInfo={},p00002=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getCookie("P00002");return null!==p00002&&""!==p00002&&(p00002=window.JSON?window.JSON.parse(p00002):eval("("+p00002+")"),userInfo.uid=p00002.uid,userInfo.name=p00002.nickname,userInfo.email=p00002.email),userInfo}function getUid(){return getUserInfo().uid||""}function getKuid(){var e=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getCookie("QC005");return""===e||null===e?_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getCookie("QC006"):e}function produceDashUrl(e,t,i,a,n){var r=(new Date).getTime()+a,s=_Config__WEBPACK_IMPORTED_MODULE_18__.b;_utils_Adapter__WEBPACK_IMPORTED_MODULE_20__.a.isHTTPS&&(s=s.replace(/^http:/gi,"https:"));var o=getUid(),d=getKuid(),u=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getCookie("P00001")||"",c={tvid:e.tvid,bid:t,vid:i,src:e.src,vt:e.vt,rs:e.rs,uid:o,ori:e.ori,ps:1,tm:r,qd_v:e.qd_v,k_uid:d,pt:e.pt,d:e.d,s:e.s,lid:e.lid,cf:e.cf,ct:e.ct,authKey:md5__WEBPACK_IMPORTED_MODULE_17___default()(md5__WEBPACK_IMPORTED_MODULE_17___default()("")+r+e.tvid),k_tag:e.k_tag,ost:e.ost,ppt:e.ppt,bop:e.bop,dfp:e.dfp,locale:e.locale,prio:e.prio,k_ft1:e.k_ft1,k_ft4:e.k_ft4,k_ft5:e.k_ft5,pck:u,k_err_retries:n},l="".concat(s,"?").concat(encodeSearchParams(c));return Array.isArray(e.ut)&&e.ut.forEach((function(e){l+="&ut="+e})),l}function encodeSearchParams(e){var t=[];return Object.keys(e).forEach((function(i){var a=e[i];void 0===a&&(a=""),t.push([i,encodeURIComponent(a)].join("="))})),t.join("&")}function dealSeekableList(e,t,i){var a=null,n=null,r=null,s=0,o=null,d=null,u=null;if(i===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.M4S)a=e.m3u8=JSON.parse(e.m3u8),n=_move_LevelInfo__WEBPACK_IMPORTED_MODULE_19__.a.getFilesInfo(e,"video"),r=_move_LevelInfo__WEBPACK_IMPORTED_MODULE_19__.a.getFilesInfo(e,"audio"),e.duration=_move_LevelInfo__WEBPACK_IMPORTED_MODULE_19__.a.getM4sDuration(e);else{if(i!==_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.DASH)return null;n=t.video.segments,r=t.audio.segments,u={video_track1:{files:[]},audio_track1:{files:[]}},(t.video.duration||t.audio.duration)&&(e.duration=t.video.duration?t.video.duration:t.audio.duration)}for(var c=0,l={},h=0,_=0;_<n.length;_++)if(null!==n[_]&&n[_].hasOwnProperty("seekable")&&n[_].seekable.hasOwnProperty("pos")&&n[_].seekable.hasOwnProperty("time")){var f=n[_].seekable,p=f.pos.length;f.pos[p-1]!==n[_].size&&f.pos.push(n[_].size),f.time[p-1]!==n[_].duration_second&&f.time.push(n[_].duration_second),n[_].sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(n[_].file_name),c+=f.time.length-1,a.payload.wm_a.video_track1.files[_].seekable=f}else if(null!==n[_]&&n[_].hasOwnProperty("seekable")&&n[_].seekable.hasOwnProperty("pos_start")){if(o=n[_].file_name.toString(),0===_||o!==d.file_name||n[_-1].pos_end!==n[_].pos_start?(0===_?(c=n.length,a.payload.wm_a.video_track1.files=[]):(d.size=n[_-1].seekable.pos_end,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].start_second,d.start_second),d.seekable.time.push(d.duration_second),a.payload.wm_a.video_track1.files.push(d),l[d.sourceID]={size:d.size,idx:h},0===n[_].seekable.pos_start&&h++),(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=o,d.start_second=n[_].start_second,d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].start_second,d.start_second)),d.seekable.pos.push(n[_].seekable.pos_start),d.seekable.pos.push(n[_].seekable.pos_end),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(o)):(d.seekable.pos.push(n[_].seekable.pos_end),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].start_second,d.start_second))),_===n.length-1){d.size=n[_].seekable.pos_end,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(e.duration,d.start_second),d.seekable.time.push(d.duration_second),a.payload.wm_a.video_track1.files.push(d),l[d.sourceID]={size:d.size,idx:h};var g=0,m=a.payload.wm_a.video_track1.files;for(Object.keys(l).length!==m.length?_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!0:_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!1;g<m.length;)m[g].size=l[m[g].sourceID].size,m[g].realIdx=l[m[g].sourceID].idx,g++}}else{var v=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(n[_].uri.toString());if(0===_){var b=t.video.init;(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=b.uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),d.seekable.pos.push(b.startByte),d.seekable.pos.push(b.endByte),d.seekable.time.push(0),d.size=b.endByte,d.start_second=-1,d.realIdx=h,u.video_track1.files.push(d),h++,(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=n[_].uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),s=n[_].endByte,d.seekable.pos.push(n[_].startByte),d.seekable.pos.push(n[_].endByte),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].startTime,d.start_second)),c=n.length}else s===n[_].startByte&&d.sourceID===v?(d.seekable.pos.push(n[_].endByte),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].startTime,d.start_second)),s=n[_].endByte):(d.size=n[_-1].endByte,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].startTime,d.start_second),d.seekable.time.push(d.duration_second),u.video_track1.files.push(d),l[d.sourceID]={size:d.size,idx:h},0===n[_].startByte&&h++,(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=n[_].uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),s=n[_].endByte,d.start_second=n[_].startTime,d.seekable.pos.push(n[_].startByte),d.seekable.pos.push(n[_].endByte),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(n[_].startTime,d.start_second)));if(_===n.length-1){d.size=n[_].endByte,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(e.duration,d.start_second),d.seekable.time.push(d.duration_second),u.video_track1.files.push(d),l[d.sourceID]={size:d.size,idx:h};var y=1,k=u.video_track1.files;for(Object.keys(l).length!==k.length-1?_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!0:_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!1;y<k.length;)k[y].size=l[k[y].sourceID].size,k[y].realIdx=l[k[y].sourceID].idx,y++}}for(var T=0;T<r.length;T++)if(null!==r[T]&&r[T].hasOwnProperty("seekable")&&r[T].seekable.hasOwnProperty("pos")&&r[T].seekable.hasOwnProperty("time")){var S=r[T].seekable,P=S.pos.length;S.pos[P-1]!==r[T].size&&S.pos.push(r[T].size),S.time[P-1]!==r[T].duration_second&&S.time.push(r[T].duration_second),r[T].sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(r[T].file_name),a.payload.wm_a.audio_track1.files[T].seekable=S}else if(0===T){var x=t.audio.init;(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=x.uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),d.seekable.pos.push(x.startByte),d.seekable.pos.push(x.endByte),d.seekable.time.push(0),d.size=x.endByte,d.start_second=-1,u.audio_track1.files.push(d),(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=r[T].uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),s=r[T].endByte,d.seekable.pos.push(r[T].startByte),d.seekable.pos.push(r[T].endByte),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(r[T].startTime,d.start_second))}else s===r[T].startByte?(d.seekable.pos.push(r[T].endByte),d.seekable.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(r[T].startTime,d.start_second)),s=r[T].endByte):(d.size=r[T-1].endByte,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(r[T].startTime,d.start_second),d.seekable.time.push(d.duration_second),u.audio_track1.files.push(d),(d=new _VP9ChunkSet__WEBPACK_IMPORTED_MODULE_28__.a).file_name=r[T].uri.toString(),d.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(d.file_name),s=r[T].endByte,d.start_second=r[T].startTime,d.seekable.pos.push(r[T].startByte),d.seekable.pos.push(r[T].endByte)),T===r.length-1&&(d.size=r[T].endByte,d.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(e.duration,d.start_second),d.seekable.time.push(d.duration_second),u.audio_track1.files.push(d));return i===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.M4S?e.m3u8=a:i===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.DASH&&(e.m3u8=u),{info:e,num:c}}function getJsonFormatFilesInfo(e){if(e.hasOwnProperty("data")&&e.data.hasOwnProperty("program")&&e.data.program.hasOwnProperty("video"))for(var t=e.data.program.video,i=0;i<t.length;i++)if(t[i].hasOwnProperty("m3u8")){var a=t[i].ff;if(a===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.M4S){var n=dealSeekableList(t[i],null,a);return{bid:t[i].bid,fileInfo:n.info}}if(a===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.TS){var r=parseTSFile(t[i]);return{bid:t[i].bid,fileInfo:r.mediaInfo}}if(a===_enum_VideoType__WEBPACK_IMPORTED_MODULE_26__.a.DASH){var s=_vp9_ManifestStream__WEBPACK_IMPORTED_MODULE_27__.a.parseVP9(t[i].m3u8),o=dealSeekableList(t[i],s,a);return{bid:t[i].bid,fileInfo:o.info}}}return null}function parseTSFile(e,t){if(""===e.m3u8||null==e.m3u8)return null;var i={},a=0;if(t){var n=[],r=!1,s=t.length,o=new _ChunkSet_js__WEBPACK_IMPORTED_MODULE_15__.a;o.start_second=0,o.file_name=t[0].__url,o.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(o.file_name),t[0].__url.indexOf("sd=")>0&&(r=!0);for(var d=0,u=0,c=0,l=0;l<s;l++){if(l>0){var h=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(t[l].__url),_=t[l].startByte;_===d&&h===o.sourceID||(o.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(c,o.start_second),o.size=d,n.push(o),i[o.sourceID]={size:o.size,idx:a},0===_&&a++,(o=new _ChunkSet_js__WEBPACK_IMPORTED_MODULE_15__.a).file_name=t[l].__url,o.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(o.file_name),o.start_second=c)}var f=t[l].startByte,p=t[l].endByte;l<s-1?u=t[l+1].startTime:e.duration=u=c+t[l].duration,d=p,o.pos.push({sPos:f,ePos:p});var g={};g.startPos=f,g.endPos=d,g.contentlength=g.endPos-g.startPos,r?g.sd=c:(g.tag=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(t[l].__url,"tag"),g.hsize=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(t[l].__url,"hsize"),g.v=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(t[l].__url,"v")),o.loadInfo.push(g),o.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(u,o.start_second)),c=u}o.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(u,o.start_second),o.size=d,i[o.sourceID]={size:o.size,idx:a},n.push(o),Object.keys(i).length!==n.length?_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!0:_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!1;for(var m=0;m<n.length;)n[m].size=i[n[m].sourceID].size,n[m].realIdx=i[n[m].sourceID].idx,m++;return e.m3u8=n,{mediaInfo:e,chunkNum:s,isRealTs:r}}var v=new m3u8_parser__WEBPACK_IMPORTED_MODULE_16__.a;v.push(e.m3u8),v.end();var b=v.manifest,y=[],k=!1,T=b.segments.length,S=new _ChunkSet_js__WEBPACK_IMPORTED_MODULE_15__.a;S.start_second=0,S.file_name=b.segments[0].uri,S.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(S.file_name),b.segments[0].uri.indexOf("sd=")>0&&(k=!0);for(var P=0,x=0,I=0,E=0;E<T;E++){if(E>0){var D=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(b.segments[E].uri),w=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"start");w===P&&D===S.sourceID||(S.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(I,S.start_second),S.size=P,y.push(S),i[S.sourceID]={size:S.size,idx:a},0===parseInt(w)&&a++,(S=new _ChunkSet_js__WEBPACK_IMPORTED_MODULE_15__.a).file_name=b.segments[E].uri,S.sourceID=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getFileNameFromUrl(S.file_name),S.start_second=I,0)}k&&(E<T-1?x=parseInt(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E+1].uri,"sd"))/1e3:e.duration=x=I+b.segments[E].duration,x<=I&&(x=I+b.segments[E].duration));var A=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"start"),q=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"end");P=q,S.pos.push({sPos:parseInt(A),ePos:parseInt(q)});var O={};O.startPos=A,O.endPos=P,O.contentlength=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"contentlength"),k?O.sd=I:(O.tag=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"tag"),O.hsize=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"hsize"),O.v=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.getQueryString(b.segments[E].uri,"v")),S.loadInfo.push(O),S.time.push(_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(x,S.start_second)),I=x}S.duration_second=_utils_Tools__WEBPACK_IMPORTED_MODULE_25__.a.accSub(x,S.start_second),S.size=P,i[S.sourceID]={size:S.size,idx:a},y.push(S),Object.keys(i).length!==y.length?_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!0:_RunTime__WEBPACK_IMPORTED_MODULE_23__.a.MixWaterMark=!1;for(var L=0;L<y.length;)y[L].size=i[y[L].sourceID].size,y[L].realIdx=i[y[L].sourceID].idx,L++;return e.m3u8=y,{mediaInfo:e,chunkNum:T,isRealTs:k}}__webpack_exports__.a=DashParser},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},o=function(){function e(){a(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e].splice(i,1),i>-1},e.prototype.trigger=function(e){var t=this.listeners[e],i=void 0,a=void 0,n=void 0;if(t)if(2===arguments.length)for(a=t.length,i=0;i<a;++i)t[i].call(this,arguments[1]);else for(n=Array.prototype.slice.call(arguments,1),a=t.length,i=0;i<a;++i)t[i].apply(this,n)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),d=function(e){function t(){a(this,t);var i=s(this,e.call(this));return i.buffer="",i}return r(t,e),t.prototype.push=function(e){var t=void 0;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(o),u=function(e){for(var t=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i={},a=t.length,n=void 0;a--;)""!==t[a]&&((n=/([^=]*)=(.*)/.exec(t[a]).slice(1))[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),i[n[0]]=n[1]);return i},c=function(e){function t(){a(this,t);var i=s(this,e.call(this));return i.customParsers=[],i}return r(t,e),t.prototype.push=function(e){var t=void 0,i=void 0;if(0!==(e=e.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"")).length)if("#"===e[0]){for(var a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void this.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"totalduration"},t[1]&&(i.duration=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void this.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void this.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"byterange"},t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),void this.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void this.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"map"},t[1]){var n=u(t[1]);if(n.URI&&(i.uri=n.URI),n.BYTERANGE){var r=n.BYTERANGE.split("@"),s=r[0],o=r[1];i.byterange={},s&&(i.byterange.length=parseInt(s,10)),o&&(i.byterange.offset=parseInt(o,10))}}this.trigger("data",i)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=u(t[1]),i.attributes.RESOLUTION){var d=i.attributes.RESOLUTION.split("x"),c={};d[0]&&(c.width=parseInt(d[0],10)),d[1]&&(c.height=parseInt(d[1],10)),i.attributes.RESOLUTION=c}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}this.trigger("data",i)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=u(t[1])),void this.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void this.trigger("data",i);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return i={type:"tag",tagType:"key"},t[1]&&(i.attributes=u(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void this.trigger("data",i);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return i={type:"tag",tagType:"start"},t[1]&&(i.attributes=u(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void this.trigger("data",i);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",void this.trigger("data",i);this.trigger("data",{type:"tag",data:e.slice(4)})}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}else this.trigger("data",{type:"uri",uri:e})},t.prototype.addParser=function(e){var t=this,i=e.expression,a=e.customType,n=e.dataParser,r=e.segment;"function"!=typeof n&&(n=function(e){return e}),this.customParsers.push((function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:n(e),customType:a,segment:r}),!0}))},t}(o),l=function(e){function t(){a(this,t);var i=s(this,e.call(this));i.lineStream=new d,i.parseStream=new c,i.lineStream.pipe(i.parseStream);var r=i,o=[],u={},l=void 0,h=void 0,_=function(){},f={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},p=0;return i.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},i.parseStream.on("data",(function(e){var t=void 0,i=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(u.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(u.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(u.duration=e.duration),0===e.duration&&(u.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){e.attributes?"NONE"!==e.attributes.METHOD?e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),h={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},"undefined"!=typeof e.attributes.IV&&(h.iv=e.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):h=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,p=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){l={},e.uri&&(l.uri=e.uri),e.byterange&&(l.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||f,e.attributes?(u.attributes||(u.attributes={}),n(u.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||f,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var a=this.manifest.mediaGroups[e.attributes.TYPE];a[e.attributes["GROUP-ID"]]=a[e.attributes["GROUP-ID"]]||{},t=a[e.attributes["GROUP-ID"]],(i={"default":/yes/i.test(e.attributes.DEFAULT)})["default"]?i.autoselect=!0:i.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(i.language=e.attributes.LANGUAGE),e.attributes.URI&&(i.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(i.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(i.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(i.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=i}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){p+=1,u.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){"undefined"==typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),u.dateTimeString=e.dateTimeString,u.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){u.cueOut=e.data},"cue-out-cont":function(){u.cueOutCont=e.data},"cue-in":function(){u.cueIn=e.data}}[e.tagType]||_).call(r)},uri:function(){u.uri=e.uri,o.push(u),!this.manifest.targetDuration||"duration"in u||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),u.duration=this.manifest.targetDuration),h&&(u.key=h),u.timeline=p,l&&(u.map=l),u={}},comment:function(){},custom:function(){e.segment?(u.custom=u.custom||{},u.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(r)})),i}return r(t,e),t.prototype.push=function(e){this.lineStream.push(e)},t.prototype.end=function(){this.lineStream.push("\n")},t.prototype.addParser=function(e){this.parseStream.addParser(e)},t}(o)},function(e,t,i){"use strict";i(35),i(287),i(94),i(89),i(25);var a=i(13),n=i(8),r=i(14),s=0;function o(){}t.a=function(e,t,i){"function"==typeof t&&(i=t,t={}),t||(t={});var d,u,c=t.prefix||"__jp",l=t.name||c+s++,h=t.param||"callback",_=null!=t.timeout?t.timeout:6e4,f=encodeURIComponent,p=document.getElementsByTagName("script")[0]||document.head;function g(){d.parentNode&&d.parentNode.removeChild(d),window[l]=o,u&&clearTimeout(u)}_&&(u=setTimeout((function(){g(),i&&i(new Error("Timeout"))}),_)),window[l]=function(e){g(),i&&i(null,e)},e=(e+=(~e.indexOf("?")?"&":"?")+h+"="+f(l)).replace("?&","?");var m=r.b.lastIndexOf("/");m=e.slice(0,m).lastIndexOf("/");var v=e.slice(m);return e+="&vf="+a.a.encryptFunc(v),n.a.debug("dashFinalUrl ~~~~"+e),(d=document.createElement("script")).src=e,p.parentNode.insertBefore(d,p),function(){window[l]&&g()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(35),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_iterator__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_buffer_slice__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),core_js_modules_es_array_buffer_slice__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_buffer_slice__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(12),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(137),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(44),core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(45),core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(46),core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(47),core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(48),core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(49),core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(50),core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(51),core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(52),core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(53),core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(54),core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(55),core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(56),core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(57),core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(58),core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(59),core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(60),core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(61),core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(62),core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_25__),core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(63),core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_26__),core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(64),core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_27__),core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(65),core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_28__),core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(66),core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_29___default=__webpack_require__.n(core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_29__),core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(67),core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_30__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(0),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_31___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_31__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(1),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_32___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_32__),_utils_Log__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(8),_RunTime__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(13),_PlayerState__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(41),_Config__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(14),_enum_EventType__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(86),_utils_Event__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(71),_enum_VideoType__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(10),_utils_Tools__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(15),mozResponseType="moz-chunked-arraybuffer",isSupportMoz=null,xhrStatusProgress="",XHRLoader=function(){function e(t,i){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_31___default()(this,e),this.videoType=t,this.eventID=i}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_32___default()(e,[{key:"load",value:function(e){if(this.tast=e,this.dataLen=0,this.loader=new XMLHttpRequest,null===isSupportMoz&&/firefox/gi.test(navigator.userAgent.toLowerCase())){try{this.loader.responseType=mozResponseType}catch(t){}isSupportMoz=this.loader.responseType===mozResponseType}if(isSupportMoz?this.loader.responseType=mozResponseType:(this.loader.responseType="arraybuffer",isSupportMoz=!1),this.taskList=[{start:this.tast.begin,end:this.tast.end}],isSupportMoz||(this.taskList=checkTask(this.tast.begin,this.tast.end,Math.min(Math.max(1024*this.tast.rate,32768),1048576),this.tast.segment.fileType)),0===this.taskList.length)return this.running=!1,void _utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"done");_utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"open"),this.check()}},{key:"close",value:function(){this.running=!1,this.loader&&this.loader.abort(),this.loader=null,this.cache&&delete this.cache}},{key:"loadStatus",value:function(e,t){if("Error"!==e&&t&&(this.tast.range={begin:this.range.start+this.base,end:this.range.start+this.base+t.byteLength},this.tast.data=t),"OK"===e){if(-1===this.range.end&&(this.range.end=this.range.start+this.base+t.byteLength),this.mediaType!==_enum_VideoType__WEBPACK_IMPORTED_MODULE_39__.a.FTS&&t.byteLength>this.range.end-this.range.start)return _utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.error("data is not right , need range "+this.range.start+"-"+this.range.end+" dataLen "+t.byteLength),void _utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"error",_PlayerState__WEBPACK_IMPORTED_MODULE_35__.a.LoaderState_dataRangeError);this.dataLen+=t.byteLength,_utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"progress"),this.base+=t.byteLength}else"done"===e?this.check():this.running&&(this.close(),_utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"error",t))}},{key:"check",value:function(){if(this.taskList.length>0){this.range=this.taskList.shift();var e=this.tast.url;if(!isSupportMoz&&e.indexOf("start=")>0&&(e=changeURLArg(this.tast.url,this.range)),-1!==e.indexOf("start=")&&-1!==e.indexOf("end=")||(-1===e.indexOf("?")?-1!==this.range.end&&(e+="?start="+this.range.start+"&end="+this.range.end):-1!==this.range.end&&(e+="&start="+this.range.start+"&end="+this.range.end)),-1===e.indexOf("stauto")&&(e+="&stauto="+_RunTime__WEBPACK_IMPORTED_MODULE_34__.a.absStatus),-1===e.indexOf("ori")&&(e+="&ori=pcw"+_RunTime__WEBPACK_IMPORTED_MODULE_34__.a.platform),-1===e.indexOf("num"))e+="&num="+Date.now().toString();_utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.info("[XHR Loader start ] "+this.range.start+" - "+this.range.end+" , "+e),this.running=!0,this.base=0,this.xhrLoad(e)}else this.running=!1,self.running&&_utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+this.eventID,"done")}},{key:"xhrLoad",value:function(e){this.loader||(this.loader=new XMLHttpRequest,this.loader.responseType=isSupportMoz?mozResponseType:"arraybuffer");var t=0;for(this.cache=null;null===this.cache;)try{t++,this.cache=new Uint8Array(1048576)}catch(n){if(t>_Config__WEBPACK_IMPORTED_MODULE_36__.h)return _utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.error("FetchLoader catch Uint8Array err : "+n.message),void a("tryCatchError")}this.readPos=0,this.dataPos=0;var i=this;xhrStatusProgress="",this.loader.onreadystatechange=function(){xhrStatusProgress+="readyState:"+i.loader.readyState+", status:"+i.loader.status+","},this.loader.onloadend=function(e){_utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.info("XHR Loader onloadend ,"+isSupportMoz);var t=e.currentTarget;if(_utils_Tools__WEBPACK_IMPORTED_MODULE_40__.a.isPoint80443(t.responseURL)){var a=t.status,r=t.response;if(a>=200&&a<300){if(r){var s=new Uint8Array(r);if(s&&s.byteLength>0){if(i.dataPos+s.byteLength>i.cache.byteLength){for(var o=null,d=0;null===o;)try{d++,o=new Uint8Array(i.dataPos+s.byteLength)}catch(n){if(d>_Config__WEBPACK_IMPORTED_MODULE_36__.h){if(_utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.error("FetchLoader catch newUint8Array err : "+n.message),null===i.loader)return;i.loadStatus("Error","statusErr-"+a)}}var u=i.cache.subarray(i.readPos);o.set(u,0),delete i.cache,i.dataPos=i.dataPos-i.readPos,i.readPos=0,i.cache=o}i.cache.set(s,i.dataPos),i.dataPos+=s.byteLength}}if(i.readPos<i.dataPos&&i.loadStatus("OK",i.cache.subarray(i.readPos,i.dataPos)),null===i.loader)return;i.close(),i.loadStatus("done")}else{if(null===i.loader)return;_utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.warn("XHR Loader err , status progress, "+xhrStatusProgress),i.loadStatus("Error","statusErr-"+a)}}else i.loadStatus("Error","isPointNot80|443")},this.loader.onprogress=function(e){if(isSupportMoz){var t=e.target?e.target.response:null;if(t){var a=new Uint8Array(t);if(i.dataPos+a.byteLength>i.cache.byteLength){var n=new Uint8Array(i.dataPos+a.byteLength),r=i.cache.subarray(i.readPos);n.set(r,0),i.dataPos=i.dataPos-i.readPos,i.readPos=0,i.cache=n}i.cache.set(a,i.dataPos),i.dataPos+=a.byteLength}if(i.dataPos-i.readPos>=8192){var s=8192*Math.floor((i.dataPos-i.readPos)/8192);i.loadStatus("OK",i.cache.subarray(i.readPos,i.readPos+s)),i.readPos+=s}}};try{this.loader.open("GET",e,!0),this.loader.withCredentials=!1,this.loader.send()}catch(r){a("tryCatchError")}function a(e){null!==i.loader&&(i.close(),_utils_Event__WEBPACK_IMPORTED_MODULE_38__.a.getEvent().emit(_enum_EventType__WEBPACK_IMPORTED_MODULE_37__.a.LoadStatus+i.eventID,"Error",e))}}}]),e}();function checkTask(e,t,i,a){var n,r=_RunTime__WEBPACK_IMPORTED_MODULE_34__.a.getBufferFunc(),s=0;s="m4s"===a?Math.min(r.buffered.video.len,r.buffered.audio.len):r.len,s*=1e3;for(var o=[],d=0;e<t;)s<1e3?(d=i,s+=1e3):s<2e3?(d=2*i,s+=2e3):s<3e3?(d=3*i,s+=3e3):s<4e3?(d=4*i,s+=4e3):s<5e3?(d=5*i,s+=5e3):s<6e3?(d=6*i,s+=6e3):s<7e3?(d=7*i,s+=7e3):s<8e3?(d=8*i,s+=8e3):(d=10*i,s+=1e4),e+d<t?(t-(n=e+d)<d/2&&(n=t),o.push({start:e,end:n}),e=n):(n=t,o.push({start:e,end:n}),e=n);return _utils_Log__WEBPACK_IMPORTED_MODULE_33__.a.info("XHR Loader check list "+JSON.stringify(o)),o}function changeURLArg(url,range){var pattern1="start=([^&]*)",pattern2="end=([^&]*)",replaceText1="start="+range.start,replaceText2="end="+range.end;if(url.match(pattern1)||url.match(pattern2)){var tmp="/(start=)([^&]*)/gi";url=url.replace(eval(tmp),replaceText1);var tmp2="/(end=)([^&]*)/gi";return url=url.replace(eval(tmp2),replaceText2),url}}__webpack_exports__.a=XHRLoader},function(e){e.exports=JSON.parse('{"name":"@cupid/mars","version":"7.0.37","description":"ad sdk for PCW","directories":{"example":"examples"},"scripts":{"clean":"rm -rf ../dist","dev":"webpack --inline --progress --mode development --config webpack.config.js --colors --watch","eslint":"./node_modules/.bin/eslint","lint":"npm run eslint core && npm run eslint view && echo \'perfect!\'","build":"yarn && npm run clean && npm run lint && webpack"},"author":"heke","devDependencies":{"@babel/core":"^7.4.3","@babel/plugin-transform-modules-commonjs":"^7.1.0","@babel/preset-env":"^7.4.3","babel-eslint":"^10.0.2","babel-loader":"^8.0.5","css-loader":"^2.1.1","eslint":"^6.0.1","less":"^3.9.0","less-loader":"^5.0.0","style-loader":"^0.23.1","webpack":"^4.29.6","webpack-cli":"^3.3.0","yarn":"^1.15.2"},"dependencies":{"html-loader":"^0.5.5"}}')},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,'@-webkit-keyframes iqp-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes iqp-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes iqp-rotate-90{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@keyframes iqp-rotate-90{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@-webkit-keyframes iqp-icon-scale{0%{-webkit-transform:scale(1);transform:scale(1)}40%{-webkit-transform:scale(1.2);transform:scale(1.2)}50%{-webkit-transform:scale(1);transform:scale(1)}60%{-webkit-transform:scale(1.2);transform:scale(1.2)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes iqp-icon-scale{0%{-webkit-transform:scale(1);transform:scale(1)}40%{-webkit-transform:scale(1.2);transform:scale(1.2)}50%{-webkit-transform:scale(1);transform:scale(1)}60%{-webkit-transform:scale(1.2);transform:scale(1.2)}to{-webkit-transform:scale(1);transform:scale(1)}}@-webkit-keyframes iqp-show{0%{opacity:.1}to{opacity:1}}@keyframes iqp-show{0%{opacity:.1}to{opacity:1}}@-webkit-keyframes iqp-hide{0%{opacity:1}to{opacity:0}}@keyframes iqp-hide{0%{opacity:1}to{opacity:0}}@-webkit-keyframes iqp-translatedown{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(56px);transform:translateY(56px)}}@keyframes iqp-translatedown{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(56px);transform:translateY(56px)}}@-webkit-keyframes iqp-translatedown-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(75px);transform:translateY(75px)}}@keyframes iqp-translatedown-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(75px);transform:translateY(75px)}}@-webkit-keyframes iqp-fs-enlarge{0%{font-size:14px}to{font-size:16px}}@keyframes iqp-fs-enlarge{0%{font-size:14px}to{font-size:16px}}@-webkit-keyframes iqp-translatedown-i5{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(46px);transform:translateY(46px)}}@keyframes iqp-translatedown-i5{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(46px);transform:translateY(46px)}}@-webkit-keyframes iqp-translatedown-i5-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(60px);transform:translateY(60px)}}@keyframes iqp-translatedown-i5-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(60px);transform:translateY(60px)}}iqp,iqpdiv{display:block}.iqp-player{position:relative;width:100%;height:100%;min-width:200px;overflow:hidden;text-align:left;white-space:normal;background:#000;color:#fff;font:12px/1.5 PingFangSC-Regular,Helvetica,Arial,Microsoft Yahei,sans-serif;z-index:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none;-webkit-font-smoothing:antialiased}.iqp-player svg{fill:currentColor;overflow:hidden}.iqp-player.iqp-full-screen50 video{width:50%!important;height:50%!important}.iqp-player.iqp-full-screen50 video,.iqp-player.iqp-full-screen75 video{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%)}.iqp-player.iqp-full-screen75 video{width:75%!important;height:75%!important}.iqp-player.iqp-web-screen{position:fixed;left:0;top:0;z-index:4201}.iqp-player *,.iqp-player :after,.iqp-player :before{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.iqp-player a,.iqp-player a:hover,.iqp-player a:visited{color:#fff;text-decoration:none!important}.iqp-player :focus,.iqp-player a:active{outline:0 none}.iqp-player img{border:none;vertical-align:top}.iqp-player ol,.iqp-player ul{list-style:none;margin:0;padding:0}.iqp-player p{margin:0;padding:0}.iqp-player .clearfix:after,.iqp-player .clearfix:before{content:"";display:table}.iqp-player .clearfix:after{clear:both}.iqp-player .iqp-hide-controls::-webkit-media-controls-play-button,.iqp-player .iqp-hide-controls::-webkit-media-controls-start-playback-button{display:none!important;-webkit-appearance:none}.iqp-player .iqp-layer{position:absolute;top:-1px;left:-1px;right:-1px;bottom:-1px;background-color:#000;z-index:100}.iqp-player .iqp-layer-con{position:absolute;width:100%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);text-align:center}.iqp-player.iqp-player-mini{cursor:pointer}.dn{display:none!important}.bottom-public{position:absolute;bottom:0;height:56px;width:100%;z-index:100}.bottom-public .btn-play{border:10px dashed transparent;border-left:15px solid #ababab;display:inline-block;left:20px;top:10px;position:absolute;outline:none}.bottom-public .btn-pause{display:inline-block;left:20px;top:13px}.bottom-public .btn-pause,.bottom-public .btn-pause:before{position:absolute;height:15px;width:2px;background-color:#ababab}.bottom-public .btn-pause:before{content:"";display:block;left:10px}.bottom-public .bottom-public_play,.bottom-public .bottom-public_voice{background:rgba(26,26,26,.8);width:36px;height:36px;border-radius:50%;position:absolute;text-align:left}.bottom-public .bottom-public_play{left:20px}.bottom-public .bottom-public_play .btn-play{left:12px;top:9px;-webkit-transition:none;transition:none;z-index:1}.bottom-public .bottom-public_play .btn-pause{left:12px;top:10px}.bottom-public .bottom-public_play .btn-pause,.bottom-public .bottom-public_play .btn-pause:before{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.bottom-public .bottom-public_play:hover .btn-pause,.bottom-public .bottom-public_play:hover .btn-pause:before{background-color:#00be06}.bottom-public .bottom-public_play:hover .btn-play{border-left-color:#6cc900}.bottom-public .bottom-public_voice{left:74px;text-align:left}.bottom-public .bottom-public_voice i{background:url(//www.iqiyipic.com/common/fix/pcWeb-img/icon-all.png) no-repeat;width:18px;height:14px;position:relative;display:inline-block;top:13px;cursor:pointer;left:5px}.bottom-public .bottom-public_voice .voice-big{left:1px;top:11px;width:26px;background-position:-65px 0!important}.bottom-public .bottom-public_voice .voice-no{left:10px;top:11px;background-position:0 0!important}.bottom-public .bottom-public_voice:hover .voice-big{background-position:-58px -180px!important;left:2px}.bottom-public .know-detail{padding:9px 15px;border-radius:30px;background:rgba(26,26,26,.8);display:block;float:right;color:#fff;margin-right:72px;line-height:18px;font-size:14px}.bottom-public .know-detail:hover{color:#57a900}.bottom-public .public-screen{background:rgba(26,26,26,.8);width:35px;height:35px;border-radius:50%;position:absolute;right:20px;text-align:left}.bottom-public .public-screen i{background:url(//www.iqiyipic.com/common/fix/pcWeb-img/icon-all.png) no-repeat;width:20px;height:20px;display:inline-block;position:relative;top:7px;left:9px}.bottom-public .public-screen:hover .screen-small{background-position:0 -28px}.bottom-public .public-screen:hover .screen-all{background-position:-94px -28px}.bottom-public .public-screen .screen-small{background-position:-34px -28px}.bottom-public .public-screen .screen-all{background-position:-65px -28px}@font-face{font-family:ds-digital;src:url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.eot);src:url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.eot#iefix) format("embedded-opentype"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.woff) format("woff"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.ttf) format("truetype"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.svg#iconfont) format("svg")}.iqp-bottom-detail{position:absolute;bottom:66px;right:20px;width:90px;height:26px;line-height:26px;border-radius:13px;text-align:center;color:#fff;background-color:#00be06;z-index:100;cursor:pointer}.iqp-bottom-detail:before{content:"";width:28px;height:28px;display:inline-block;background:url(//www.iqiyipic.com/common/fix/iq-player/iqp-player-icon.png) 0 -120px;float:right;-webkit-transform:scale(.5);transform:scale(.5);margin:0 2px 0 -14px}.iqp-bottom-detail:hover{background-color:#00c806}.iqp-big-mode .iqp-bottom-detail{bottom:80px}.iqp-player-icon{background:url(//www.iqiyipic.com/common/fix/iq-player/iqp-player-icon.png) no-repeat}',""])},function(e,t){e.exports="<iqpdiv data-player-hook=container class=iqp-player style=width:100%;height:100%> <iqpdiv data-player-hook=ivoslayer style=display:none> </iqpdiv> <iqpdiv tabindex=-1 class=iqp-player data-player-hook=mainlayer> <video width=100% height=100% x-webkit-airplay=allow></video> <iqpdiv data-player-hook=plgcontainer> <iqpdiv class=iqp-barrage></iqpdiv> <div id=qiguanAIBox class=qiguan-baike></div> </iqpdiv> <iqpdiv data-cupid=container></iqpdiv> </iqpdiv> </iqpdiv>"},function(e,t){e.exports='<iqpdiv class="iqp-player iqp-player-pad" tabindex=-1 data-player-hook=container> <video width=100% height=100% x-webkit-airplay=allow></video> <iqpdiv data-player-hook=plgcontainer> </iqpdiv> <iqpdiv data-cupid=container></iqpdiv> </iqpdiv>'},function(e,t){e.exports='<iqpdiv class="iqp-player iqp-player-mobile" tabindex=-1 data-player-hook=container> <video width=100% height=100% x-webkit-airplay=allow></video> <iqpdiv data-player-hook=plgcontainer> </iqpdiv> <iqpdiv data-cupid=container></iqpdiv> </iqpdiv>'},function(e,t){e.exports='<iqpdiv class="iqp-player iqp-player-mini" tabindex=-1 data-player-hook=container> <video width=100% height=100% x-webkit-airplay=allow data-style></video> <iqpdiv data-player-hook=plgcontainer> </iqpdiv> <iqpdiv data-cupid=container></iqpdiv> </iqpdiv>'},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-logo-loading .iqp-logoload-box{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;font-size:0;width:350px;white-space:normal}.iqp-logo-loading .iqp-logoload-gif{width:350px}.iqp-logo-loading .iqp-down-speed{font-size:14px;color:#ddd;position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-bg{width:170px;height:78px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/yxpzft_loading180528.png) no-repeat;margin-bottom:36px;margin-left:auto;margin-right:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-line{width:300px;height:2px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/iqiyi_loading_line180528.gif) no-repeat;background-size:300px 2px;margin-left:auto;margin-right:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-vip .iqp-logoload-bg{width:225px;height:71px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/vipft_loading.png) no-repeat;margin-bottom:20px}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-vip .iqp-logoload-line{width:270px;height:2px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/VIP_loading_line.gif) no-repeat;background-size:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-cp .iqp-logoload-bg{width:119px;height:106px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/aqycpft_loading180528.png) no-repeat}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-db .iqp-logoload-bg{width:260px;height:69px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/qwdbft_loading180528.png) no-repeat;margin-bottom:29px}.iqp-logo-loading .iqp-logo-loading-ft .iqp-down-speed{margin-top:26px}.iqp-big-mode .iqp-down-speed{font-size:20px;margin-top:10px}.iqp-big-mode .iqp-logo-loading .iqp-logoload-box{width:400px}",""])},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-logo-loading .iqp-logoload-box{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;font-size:0;width:350px;white-space:normal}.iqp-logo-loading .iqp-logoload-gif{width:350px}.iqp-logo-loading .iqp-down-speed{font-size:14px;color:#ddd;position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-bg{width:170px;height:78px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/yxpzft_loading180528.png) no-repeat;margin-bottom:36px;margin-left:auto;margin-right:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-line{width:300px;height:2px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/iqiyi_loading_line180528.gif) no-repeat;background-size:300px 2px;margin-left:auto;margin-right:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-vip .iqp-logoload-bg{width:225px;height:71px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/vipft_loading.png) no-repeat;margin-bottom:20px}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-vip .iqp-logoload-line{width:270px;height:2px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/VIP_loading_line.gif) no-repeat;background-size:auto}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-cp .iqp-logoload-bg{width:119px;height:106px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/aqycpft_loading180528.png) no-repeat}.iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-db .iqp-logoload-bg{width:260px;height:69px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/qwdbft_loading180528.png) no-repeat;margin-bottom:29px}.iqp-logo-loading .iqp-logo-loading-ft .iqp-down-speed{margin-top:26px}.iqp-big-mode .iqp-down-speed{font-size:20px;margin-top:10px}.iqp-big-mode .iqp-logo-loading .iqp-logoload-box{width:400px}",""])},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-player-mobile .iqp-logo-loading .iqp-logoload-box{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;font-size:0;width:263px;white-space:normal}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-bg{width:128px;height:59px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/yxpz_loading180528.png) no-repeat;margin-bottom:27px;margin-left:auto;margin-right:auto;background-size:128px 59px}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-line{width:225px;height:1.5px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/iqiyi_loading_line180528.gif) no-repeat;background-size:225px 1.5px;margin-left:auto;margin-right:auto}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-box-vip .iqp-logoload-bg{width:169px;height:53px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/vip_loading.png) no-repeat;background-size:169px 53px;margin-bottom:15px}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-box-vip .iqp-logoload-line{width:202.5px;height:1.5px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/VIP_loading_line.gif) no-repeat;background-size:202.5px 1.5px}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-box-cp .iqp-logoload-bg{width:90px;height:80px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/aqycp_loading180528.png) no-repeat;background-size:90px 80px}.iqp-player-mobile .iqp-logo-loading .iqp-logoload-box-db .iqp-logoload-bg{width:196px;height:52px;background:url(//www.iqiyipic.com/common/fix/pcWeb-img/qwdb_loading180528.png) no-repeat;background-size:196px 52px;margin-bottom:22px}.iqp-player-mobile .iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-bg{background-image:url(//www.iqiyipic.com/common/fix/pcWeb-img/yxpzft_loading180528.png)}.iqp-player-mobile .iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-vip .iqp-logoload-bg{background-image:url(//www.iqiyipic.com/common/fix/pcWeb-img/vipft_loading.png)}.iqp-player-mobile .iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-cp .iqp-logoload-bg{background-image:url(//www.iqiyipic.com/common/fix/pcWeb-img/aqycpft_loading180528.png)}.iqp-player-mobile .iqp-logo-loading .iqp-logo-loading-ft .iqp-logoload-box-db .iqp-logoload-bg{background-image:url(//www.iqiyipic.com/common/fix/pcWeb-img/qwdbft_loading180528.png)}",""])},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-layer-loading{text-align:center;font-size:14px;color:#999}.iqp-layer-loading .iqp-gif-loading{display:inline-block;vertical-align:middle;width:24px;height:24px;margin-right:10px;background:url(//www.iqiyipic.com/common/fix/iq-player/loading.gif) no-repeat}",""])},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-layer-loading{text-align:center;font-size:12px;color:#999}.iqp-layer-loading .iqp-gif-loading{display:inline-block;vertical-align:middle;width:18px;height:18px;margin-right:5px;background:url(//www.iqiyipic.com/common/fix/iq-player/loading.gif) no-repeat;background-size:18px 18px}",""])},function(e,t){e.exports='<iqpdiv data-player-hook=loading style=pointer-events:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:99> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <img lazy_src=//www.iqiyipic.com/player/cn/pcwH5_vip.gif class=iqp-logoload-gif data-player-hook=lazygif /> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <img lazy_src=//www.iqiyipic.com/player/cn/pcwH5_produced.gif class=iqp-logoload-gif data-player-hook=lazygif /> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <img lazy_src=//www.iqiyipic.com/player/cn/pcwH5_exclusive.gif class=iqp-logoload-gif data-player-hook=lazygif /> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal_image> <img class=loadingImage width=100% height=100% /> <iqpdiv class=iqp-btn-mid> <iqpdiv class=iqp-mid-circle> <iqpdiv class=iqp-mid-loading> <svg aria-hidden=true class="iqp-icon iqp-icon-loading"> <use xlink:href=#iqp-svg-loading class="iqp-svg-symbol iqp-svg-loading"> </use> </svg> </iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal> <iqpdiv class=iqp-layer-con> <iqpdiv class=iqp-logoload-box> <img lazy_src=//www.iqiyipic.com/player/cn/pcwH5_common.gif class=iqp-logoload-gif data-player-hook=lazygif /> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class=iqp-logoload-box> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> <iqpdiv class=iqp-down-speed data-player-hook=loadingDownloadSpeed></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-layer-loading" data-player-hook=videolayerLoading style=display:none;z-index:80> <iqpdiv class=iqp-layer-con> <svg class="iqp-icon iqp-icon-loading" aria-hidden=true> <use xlink:href=#iqp-svg-loading></use> </svg> </iqpdiv> </iqpdiv> </iqpdiv>'},function(e,t){e.exports='<iqpdiv data-player-hook=loading style=pointer-events:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:99> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <img src=//www.iqiyipic.com/player/cn/pad_vip.gif class=iqp-logoload-gif> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <img src=//www.iqiyipic.com/player/cn/pad_produced.gif class=iqp-logoload-gif> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <img src=//www.iqiyipic.com/player/cn/pad_exclusive.gif class=iqp-logoload-gif> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal> <iqpdiv class=iqp-layer-con> <iqpdiv class=iqp-logoload-box> <img src=//www.iqiyipic.com/player/cn/pad_common.gif class=iqp-logoload-gif> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class=iqp-logoload-box> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-layer-loading" data-player-hook=videolayerLoading style=display:none;z-index:80> <iqpdiv class=iqp-layer-con> <iqpspan class=iqp-gif-loading></iqpspan> <iqpspan data-player-hook=videoLoadingText>正在全力加载，请稍后…</iqpspan> </iqpdiv> </iqpdiv> </iqpdiv> '},function(e,t){e.exports='<iqpdiv data-player-hook=loading style=pointer-events:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:99> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <div class=iqp-logoload-bg></div> <div class=iqp-logoload-line></div> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingVip_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-vip"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <div class=iqp-logoload-bg></div> <div class=iqp-logoload-line></div> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingQiyiProduced_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-cp"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive> <iqpdiv class=iqp-layer-con> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <div class=iqp-logoload-bg></div> <div class=iqp-logoload-line></div> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingExclusive_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class="iqp-logoload-box iqp-logoload-box-db"> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal> <iqpdiv class=iqp-layer-con> <iqpdiv class=iqp-logoload-box> <div class=iqp-logoload-bg></div> <div class=iqp-logoload-line></div> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-logo-loading" style=display:none data-player-hook=videoLoadingNormal_tw> <iqpdiv class="iqp-layer-con iqp-logo-loading-ft"> <iqpdiv class=iqp-logoload-box> <iqpdiv class=iqp-logoload-bg></iqpdiv> <iqpdiv class=iqp-logoload-line></iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv> <iqpdiv class="iqp-layer iqp-layer-loading" data-player-hook=videolayerLoading style=display:none;z-index:80> <iqpdiv class=iqp-layer-con> <iqpspan class=iqp-gif-loading></iqpspan> <iqpspan data-player-hook=videoLoadingText>正在全力加载，请稍后…</iqpspan> </iqpdiv> </iqpdiv> </iqpdiv> '},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,"@-webkit-keyframes iqp-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes iqp-rotate-360{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes iqp-rotate-90{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@keyframes iqp-rotate-90{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@-webkit-keyframes iqp-icon-scale{0%{-webkit-transform:scale(1);transform:scale(1)}40%{-webkit-transform:scale(1.2);transform:scale(1.2)}50%{-webkit-transform:scale(1);transform:scale(1)}60%{-webkit-transform:scale(1.2);transform:scale(1.2)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes iqp-icon-scale{0%{-webkit-transform:scale(1);transform:scale(1)}40%{-webkit-transform:scale(1.2);transform:scale(1.2)}50%{-webkit-transform:scale(1);transform:scale(1)}60%{-webkit-transform:scale(1.2);transform:scale(1.2)}to{-webkit-transform:scale(1);transform:scale(1)}}@-webkit-keyframes iqp-show{0%{opacity:.1}to{opacity:1}}@keyframes iqp-show{0%{opacity:.1}to{opacity:1}}@-webkit-keyframes iqp-hide{0%{opacity:1}to{opacity:0}}@keyframes iqp-hide{0%{opacity:1}to{opacity:0}}@-webkit-keyframes iqp-translatedown{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(56px);transform:translateY(56px)}}@keyframes iqp-translatedown{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(56px);transform:translateY(56px)}}@-webkit-keyframes iqp-translatedown-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(75px);transform:translateY(75px)}}@keyframes iqp-translatedown-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(75px);transform:translateY(75px)}}@-webkit-keyframes iqp-fs-enlarge{0%{font-size:14px}to{font-size:16px}}@keyframes iqp-fs-enlarge{0%{font-size:14px}to{font-size:16px}}@-webkit-keyframes iqp-translatedown-i5{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(46px);transform:translateY(46px)}}@keyframes iqp-translatedown-i5{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(46px);transform:translateY(46px)}}@-webkit-keyframes iqp-translatedown-i5-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(60px);transform:translateY(60px)}}@keyframes iqp-translatedown-i5-bigmode{0%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(60px);transform:translateY(60px)}}.iqp-layer-loading .iqp-icon-loadingmini{color:#00cc36;width:32px;height:32px;-webkit-animation:iqp-rotate-360 1s infinite;animation:iqp-rotate-360 1s infinite}",""])},function(e,t){e.exports="<iqpdiv data-player-hook=loadingposter class=iqp-poster style=display:none;background-size:cover></iqpdiv>"},function(e,t){e.exports='<iqpdiv data-player-hook=loading style=pointer-events:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:99> <iqpdiv class="iqp-layer iqp-layer-loading" data-player-hook=videolayerLoading> <iqpdiv class=iqp-layer-con> <svg class="iqp-icon iqp-icon-loadingmini" aria-hidden=true> <use xlink:href=#iqp-svg-loadingmini></use> </svg> </iqpdiv> </iqpdiv> </iqpdiv>'},function(e,t,i){(e.exports=i(70)(!1)).push([e.i,".iqp-player-vippay-popup{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;text-align:center;z-index:100}.iqp-player-vippay-popup .iqp-vippay-popup{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:510px;text-align:left;vertical-align:middle}.iqp-player-vippay-popup .iqp-popup-main{text-align:center}.iqp-player-vippay-popup .iqp-major-txt{display:inline-block;max-width:410px;text-align:left;font-size:16px;color:#fff;line-height:26px}.iqp-player-vippay-popup .iqp-btn-switch{direction:rtl}.iqp-player-vippay-popup .iqp-btn-wrap{text-align:center;font-size:0;padding:20px 0 30px;margin:0 -7px}.iqp-player-vippay-popup .iqp-vippay-btn{position:relative;display:inline-block;margin:0 7px;width:242px;height:36px;line-height:36px;background-color:#dab176;color:#582d00;border-radius:18px;text-align:center;font-size:16px;text-decoration:none;cursor:pointer;vertical-align:top;direction:ltr}.iqp-player-vippay-popup .iqp-vippay-btn:hover{color:#582d00;background-color:#e2bc81}.iqp-player-vippay-popup .iqp-vip-popup-profit{overflow:hidden}.iqp-player-vippay-popup .iqp-profit-h3{color:#c8a06a;font-size:16px;padding:4px 0 16px}.iqp-player-vippay-popup .iqp-profit-list{margin-right:-54px;*zoom:1}.iqp-player-vippay-popup .iqp-profit-item{float:left;padding-bottom:20px;padding-right:53px}.iqp-player-vippay-popup .iqp-profit-txt{font-size:12px;color:#fff}.iqp-player-vippay-popup .iqp-sprite-player-pay{display:inline-block;width:26px;height:26px;vertical-align:-8px;margin-right:7px;background:url(//www.iqiyipic.com/common/fix/site-v4/play/sprite-player-pay-200306.png) no-repeat}.iqp-player-vippay-popup .iqp-sprite-player-pay.iqp-free-con-icon{background-position:0 -20px}.iqp-player-vippay-popup .iqp-sprite-player-pay.iqp-no-AD-icon{background-position:-40px -20px}.iqp-player-vippay-popup .iqp-sprite-player-pay.iqp-vip-sign-icon{background-position:-80px -20px}.iqp-player-vippay-popup .iqp-sprite-player-pay.iqp-request-play-icon{background-position:-120px -20px}",""])},function(e,t){e.exports=' <iqpdiv class=iqp-player-vippay-popup data-player-hook=vippay style=display:none;position:absolute;top:0;left:0;height:100%;width:100%> <iqpdiv class=iqp-vippay-popup> <iqpdiv class=iqp-popup-main> <iqp class=iqp-major-txt data-player-hook=viptxt></iqp> <iqpdiv class=iqp-btn-wrap> <a href=javascript:; class=iqp-vippay-btn data-player-hook=playbtn>立即观看</a> </iqpdiv> </iqpdiv> <iqpdiv class=iqp-popup-intro> <iqpdiv class=iqp-vip-popup-profit> <iqph3 class=iqp-profit-h3>VIP会员尊享权益</iqph3> <ul class=iqp-profit-list> <li class=iqp-profit-item> <iqpi class="iqp-sprite-player-pay iqp-free-con-icon"></iqpi> <iqpspan class=iqp-profit-txt>院线新片</iqpspan> </li> <li class=iqp-profit-item> <iqpi class="iqp-sprite-player-pay iqp-vip-sign-icon"></iqpi> <iqpspan class=iqp-profit-txt>尊贵身份</iqpspan> </li> <li class=iqp-profit-item> <iqpi class="iqp-sprite-player-pay iqp-request-play-icon"></iqpi> <iqpspan class=iqp-profit-txt>热剧抢先看</iqpspan> </li> <li class=iqp-profit-item> <iqpi class="iqp-sprite-player-pay iqp-no-AD-icon"></iqpi> <iqpspan class=iqp-profit-txt>广告特权</iqpspan> </li> </ul> </iqpdiv> </iqpdiv> </iqpdiv> </iqpdiv>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){i(221)("Uint16",2,(function(e){return function(t,i,a){return e(this,t,i,a)}}))},,,,function(module,exports,__webpack_require__){var _qda=["IDI3Jz0gMDM=","IDE0IDI4K1I=","Zmxvb3I=","IDAxIDA4Wk4gMjA=","b1VXd2Q=","Z1NsbHg=","SEVBUEY2NA==","JiAwMVwy","KkgnNw==","MzdPIDE4","RlE2IDIz","ek9sWEQ=","NyxZIDE3","anNHdlA=","LyAzMDlb","dkpXZEw=","JEw6SQ==","IDEwWEYgMTM=","dW5zaGlmdA==","KkNSTQ==","NCAwNlQgMDk=","RkR3VUk=","aGFzT3duUHJvcGVydHk=","MVYgMTkgMTE=","UHJvZ3JhbSB0ZXJtaW5hdGVkIHdpdGggZXhpdCg=","UHN3Rms=","aklCeFM=","L0olNQ==","IDI4NSM2","ZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LA==","NStPNg==","UmtIWlM=","TEFzZkI=","IDE3T18gMDE=","ek9veFU=","XlIgMDgq","ISsgMTVY","V1cgMjAgMTM=","IDI3XEogMjM=","aG9zdG5hbWU=","NVxQIDIy","LzkgMDkt","WUJSZlk=","dUFjWEE=","QXZLdE8=","MisgMjNU","cUlFbnQ=","aTE2","c29yeHM=","IDI2LyAxMTs=","IDMxIDAyJyAyNw==","WFFHc1U=","R2Faemo=","dkFLdms=","RisjKA==","PiAyODBa","KS4gQnVpbGQgd2l0aCAtcyBBU1NFUlRJT05TPTEgZm9yIG1vcmUgaW5mby4=","QmNwZnI=","aTY0","KUggMTRO","SEVBUDg=","Y21kNXg=","WW5UZEw=","RCc2IDE5","IDI0YlcgMDU=","IDE1IDI2OT4=","IDMxIy1c","S3dmVU4=","WERXcmk=","dHVEdHk=","dW5kZWZpbmVk","dHJ1bmM=","IDI4XiAxNzM=","VSAwOSUq","RldwYmM=","NS4gMTIgMjI=","IDI2IDA2XiAzMQ==","IlQhIg==","JkdEPA==","X21lbXNldA==","cHJpbnQ=","Wm1makM=","IDE5IDIyWl4=","T09N","TnBXRmI=","bEdDbWo=","VHhzZmc=","WlJjIDA1","IDMwVkY7","bmFtZQ==","IDMxIDIxYSU=","QUkgMTFV","R0FsZFA=","alNEbkw=","VHhRQ3A=","P0s+IDI5","IDI4LSAyOEY=","Y2xpZW50SGVpZ2h0","PiAyODAt","IDI0IDA0Oiw=","b1Z6UHU=","IDIyIDEzIDAxTw==","T0YgMzIgMjA=","SU5JVElBTF9NRU1PUlk=","MTE6TQ==","KVUgMThc","T2d2bnE=","dEh1Q1I=","WlR5bUU=","IDE2TCAwOFo=","Y3NuZm4=","SEVBUFUzMg==","bWVtb3J5SW5pdGlhbGl6ZXJSZXF1ZXN0","XCYgMjc8","Y21kNXhkYXNo","Z25aTnU=","TWRDUWE=","LCg5YA==","TjZQIDE0","U1lrcWc=","eWJjZkw=","YSBwcm9ibGVtIHNlZW1zIHRvIGhhdmUgaGFwcGVuZWQgd2l0aCBNb2R1bGUubWVtb3J5SW5pdGlhbGl6ZXJSZXF1ZXN0LCBzdGF0dXM6IA==","a2JweFk=","IDAxNFAxIDA2","SyAwMyogMDY=","WCYgMDggMjI=","KmMgMDQq","TGNKWFQ=","IDE0IDE1WEw=","TGNIIDE4","IDE5IDEyXkI=","QSAxNTso","RyAyNzMgMjU=","ISAxOTMgMTc=","Vk5BWms=","RyZcXg==","XCAwMiAzMD8=","QXljY3c=","IDE1RiUgMjg=","Q0tvUWI=","QD0gMTdd","IDIzIDAyRyc=","ckxaR3I=","VmRGT3Y=","VmRHY1o=","IDIyIDE1LCAwNQ==","d2lkdGg=","TnZpZEE=","KiAyOSAxMjM=","UUpHTFA=","IDAxIDMyJEA3","dXRmLTE2bGU=","IzEgMzEp","Tm1OanM=","PCAyNCAyMiAzMA==","b3VVeGo=","IiAzMSAyNCAzMg==","dXNlIGFzbQ==","IDAxIDE1SyAxMT4=","KEggMTZP","QlBvVmU=","TlNvd0Y=","VVNWTA==","IDI4OEpd","WCAwNSYgMjg=","Vm9hTFM=","Y1dCR2M=","RS5BIDEx","UU5kbWk=","b2JqZWN0","aUJSdEw=","WmpYWm0=","RV1PIDIx","LjQgMDQgMjI=","ZktwbVY=","d2loZHc=","X2NtZDV4","IURPRw==","IDI5QEhK","IDAxIDE0LzpX","IDE5RTAgMDU=","RiAxNCAwOSE=","JkgpIDIy","a3N2ZHA=","IDE0MlBd","VmZnUmw=","LUQgMjcgMjA=","IDI2JSAyNiAwOQ==","TC4gMDI5","YXJn","SUxuQ2M=","WVVsYXA=","Y29weVdpdGhpbg==","S0JlT3Y=","J1sgMDJM","dG9TdHJpbmc=","b25BYm9ydA==","bG9jYWxob3N0","aTMy","IDI4RSAyNU4=","IDIzIDI3Rjg=","bE5aVWk=","Qk9YbHQ=","Nz8gMTJB","UG1OTWw=","TGZ1TEE=","SzJaKQ==","PyAwNV8gMTM=","IDIxIDAzPGM=","UVBTcFY=","UktxaFk=","Si1NXg==","T05wYXQ=","Q01PIDEz","LiAwOUpO","VTwgMjQ3","SlkgMDNV","RXhpdFN0YXR1cw==","JlMgMTcgMzA=","RiAxNVQ6","aEFJYWM=","RyZcTw==","bm9FeGl0UnVudGltZQ==","MyAzMS87","OEZXTQ==","dEJPU2g=","elB3R3k=","KyAwN1cy","IDAxIDEzOFIj","ZHluQ2FsbF92aQ==","MiAyMFg8","IDE2PSAwMSAxMQ==","XyAxNUhN","Lj0vWg==","dXRmOA==","dXRoUWs=","a3ZyVUQ=","LiAwMi9i","PjtMIQ==","IDMwLyAxMjQ=","IDI5IDA5IDAzJQ==","MSAwOCgx","ckFWZnI=","Z1hGQno=","IDMwIDIzMSI=","IDE1IDEyIDE4IDE0","cHJlbG9hZGVkSW1hZ2Vz","UEhjNg==","O0IgMjlR","IDI3VyAyNEU=","aGVpZ2h0","SkdpS1Q=","NS4gMTEw","cHVzaA==","Q0ROIDI4","TkN2Tmk=","WyAxMCAxMyAyOA==","bG9jYXRlRmlsZQ==","Y2VpbA==","QSAyMC0gMTM=","YWdQUmQ=","WFljVmo=","QkxYQA==","IDI1IDIzIDA5Kg==","WGZDZ24=","IDE5YCAxNyAyMg==","QFQqVA==","QSAxNCAyNTI=","IDAxIDAxIDI4XiAwNQ==","IyAwMFYgMjA=","WUhITHo=","QDwpSg==","IDIxXCAxMSM=","IDExIDE2IDE5KA==","d3htVXY=","alJ5RUo=","aW11bA==","QUQgMDkgMTk=","IDEzP0c9","ckhYWUY=","Q0NHQ2U=","IDAxIDAxMCAwMiAzMA==","Kl8gMDdf","WE9RbHg=","cmVwbGFjZQ==","IDAxIDI4IDE4LyAyNQ==","IDAxIDE0IDAwPT0=","IDMxUiAxMlk=","IDE5QiAwMCE=","WmNRR00=","ITkjIDA2","IDAxIzUgMTcz","IDE0IDE5PCAyOA==","MTlKVA==","SEVBUFU4","VVNFWGs=","OyAxNyAwNkQ=","IDMyIDAwXzw=","cHZTTGk=","VWpBWUE=","IiAwNiAyMCAwNg==","IDIzIDA1MEM=","IDIwIDIyWT8=","IDIxJjUgMDU=","WSAxOFcgMTA=","UXNaVnM=","UUNFSFM=","dFBlUHM=","N2MrVQ==","MFk4WA==","b25lcnJvcg==","V3Z3REY=","dFVzdnU=","IS04IDMx","UEhjOA==","aGNLRmw=","RGdBY3E=","b3VsZko=","WkpwQm4=","Q2hhcmFjdGVyIGNvZGUg","IDI1IDE3IDMwQQ==","c0txeGc=","KDQjIQ==","c3Vic3Ry","ZXlBZ24=","L10pIDE3","c2xpY2U=","Il87Wg==","IDE3T18gMTk=","NyAxMCAyOGA=","dGdBR0k=","V1Z6RVA=","bWJHUkw=","RHBaaWc=","STMiIDI5","TSAwMiAwNSAyMA==","aEplT0E=","dkJScWg=","WWRMUU0=","cHJvdG90eXBl","SEVBUFUxNg==","KTxEIDI0","KjRPNQ==","SmIgMzIgMzE=","VXVCTXk=","IDE3Jz0gMTE=","OSAxMiFc","UERTUko=","MDcgMDMgMDY=","ZnJvbUNoYXJDb2Rl","NlYgMTU2","a1F2SE4=","Qk1OVXg=","IDMxIyAxNE8=","IDE5OFwgMjg=","dEZ6cGM=","Iz9MIDA5","RUNZYlg=","c2NyZWVu","PCIgMTRB","OiAwOSAxMyAzMQ==","ISogMzAgMjE=","YFwgMjBB","QU9IWQ==","UG1HbGQ=","VCAxN1tB","RUcxYw==","NyAxOEYp","IDAxIDIzIDAwXFk=","WXh6SGU=","R1l0SWs=","Uk9XZG0=","JiogMTUgMTE=","LmE0MQ==","OyAyNSlN","IDEwTyggMTk=","IDAxIDMwN0cgMTc=","K0lTIDE3","MisgMDAm","blJUR2o=","aWVPb1c=","aHpqQWg=","QWh3ZlM=","d0NqZUo=","MUNXIg==","IDI0QSQgMDI=","TkpFTmI=","MlMgMDFC","VVNFU2M=","N2MgMjRW","Pi0gMDcgMDQ=","YU5STlg=","JCAyNSM+","MCAyMVIgMDM=","IDI2P0ggMzI=","SSAyOD0gMjU=","IDI2IDA3NCAyNg==","ISAxMVhB","IDE4JC8gMzA=","WHNPVlA=","N05MIDA1","dWNuWHE=","dFpKbUs=","R0VU","IDAxIDIyYi1Q","U0Z6SGw=","N05LYA==","IDMyIDIwQyAyMw==","IDE5QiAwMFs=","MCAzMV8gMTE=","dlpncUU=","RXNBcHA=","IDAxJCAyMzBX","Wml2d0c=","OF4gMDkr","RVpFZWc=","IDIzQSAyOSAxOQ==","Q29udmVydGluZyBiYXNlNjQgc3RyaW5nIHRvIGJ5dGVzIGZhaWxlZC4=","NU1jVQ==","TWRieVY=","Smd5eXA=","JSAwMiAyMiAyMQ==","QktsRkg=","WCAwNSdL","PCAyOVdE","T090dGI=","LVQ+Ig==","TU5mQ28=","JVFeOQ==","amZ0Rmo=","IDIwIDE0V1g=","c2txTno=","cGZ1T2k=","WD5JXA==","X2Vtc2NyaXB0ZW5fZ2V0X3NicmtfcHRy","IDIyIDA4IDMwIDIw","QEAuMw==","IV8gMjQ/","MFogMjcgMTg=","IDMxJCIgMDI=","V05kWms=","c2hpZnQ=","WEtuYWs=","WllxRnc=","TllrclI=","XCdfIDIy","bWlu","Qm1GRHo=","Z2FLRHU=","IDIwMS06","QXNzZXJ0aW9uIGZhaWxlZDog","Sm13dmg=","eVJjb2Q=","WEkgMDEgMjI=","VmIgMTUgMjM=","bGhNdEk=","XCAxODNb","aW5kZXhPZg==","d2dLRGk=","S0dZSmM=","IDAxIig4Mw==","IDE3U00+","KCAzMiAyNS4=","RE1oSnQ=","amVhZno=","IDAxIDI5QVVY","bUhqSEY=","IDE0IDE5PEs=","ak1uYXc=","RE50cnE=","c2V0U3RhdHVz","SiAyOVE3","PVAjVA==","PTYgMjQgMDM=","IDIwIDE0V0s=","YVpkTEM=","TXpiSGk=","bGZxTmc=","UXpyeHo=","IDI3IDE2IDE2IDIw","IDI4IDMwXyM=","WEhQZVY=","IDAxQTw6IDAz","YWRkRXZlbnRMaXN0ZW5lcg==","VEpjcko=","RnlEUXo=","REFWWHE=","KEggMTcgMjI=","QmJOamc=","YWpXQmg=","T0J2YWE=","alZFYkE=","IDI0TDIgMjk=","PmJbMw==","TUQ3Uw==","MCAyMVEi","UmRRcGY=","c3RhdHVz","IDEwWEVc","REg4Qw==","MiAxOD5P","SU95V2M=","ZnpDRU4=","K01YIDIx","IDEwUyAyMkM=","YW1tSEc=","KSAwMiAyNSAwNQ==","dnhrUlU=","IDE0IDIzXyAyMg==","IDI5IDA0OGA=","QUF5akU=","YTIgMDQgMjI=","YUwrRg==","d2FzbUJpbmFyeQ==","SXpMZU8=","NDQgMDZi","Z3JTS2w=","KVteKg==","TENCbVY=","c3RvVHg=","LCBtYWtlIHN1cmUgaXQgaXMgZXhwb3J0ZWQ=","RjU5XA==","T21YY2U=","b05NRkI=","a2RJQ0Q=","Y3NQaFU=","SCAwMC8gMDg=","T3lmd3A=","PCUmIDI4","T3NtdXQ=","OyAyMSAyMl4=","IDA3OS0gMDg=","ZnRkdXQ=","IDMxSUdS","IDE3Ji1j","LCAyNCAzMDA=","NjcgMjAl","UEROT0g=","c0ZFTnI=","bG9hZA==","IDE0IDE5PCk=","IDA3MUggMzE=","UHd4blE=","PCAyNyAyNy0=","IDI4IDAyUjQ=","UmRGZm4=","am9pbg==","KEsgMDFh","Q21JZ0Q=","UEJYVlo=","VCAzMVhO","QkIoIDA5","JiAzMEsgMzI=","KCtSQg==","T2xwWlU=","M0csJg==","J1lGIQ==","L1EgMDIs","ZHBVU1I=","VD8gMjcgMDA=","c1lZakc=","RHVtWnM=","IDI0SyE1","UElDU1U=","R2BfIDE2","ZmNjcXc=","IDAxMTsgMjZE","XTJCIDMw","R3BtSkg=","SFxDTQ==","WnVYSWs=","X2JpdHNoaWZ0NjRTaGw=","NzQ3Og==","MTY1IDE3","Q0Z5alg=","cXpPSmI=","TDMgMzBi","OiAzMlIj","IDIzIDMxIDExPw==","IDI2Mkko","ODYlLA==","IDI4IDAzIDA2IDI1","IDI0IDE2MUI=","dHJuZUM=","aWhOamg=","cGxYYlY=","Y3FicXo=","IDIwIlogMTk=","IDIxOCUgMTI=","VVdtTGM=","TFRnaHI=","Y3lQTmI=","OGA+Sw==","Izs5Rg==","IDAxIDAzIDAxIDI2IDI3","KSAgYXQgb2Zmc2V0IA==","WyMtVQ==","c3ViYXJyYXk=","IDI0Mig/","KlphIDI3","RV1PYw==","S1NlSnA=","IDIzIDExSCAxMA==","aEdkelY=","IDE2NV5h","YXJyYXlidWZmZXI=","eWJ2V1I=","UHBESEI=","IDI0IDA5IDA5IDA5","LyAxMCAyNCAwNg==","IDI3MUVe","MyAxNyAyNCQ=","R0N4dnc=","QmVLcmE=","KiAyMDEgMDk=","WCAyNyAxNkA=","SmZmbUE=","RiUyIDI4","IDIzIDE0NSAyOA==","L1ZQIDI2","ISAxMVgy","RHNvVGo=","VkVYU04=","TXJxTWc=","IjUgMTIgMTg=","bXFtZlQ=","clVwS1E=","TE93bXk=","YmVuT3I=","IDAxIDA4IDA3RyQ=","QkhxWXY=","JD4oIDAz","IiVNLQ==","VCRAMQ==","IyAwOGFI","VyAyNzdS","IDI3IDA0XlU=","J2EmXQ==","d2ljbUw=","IDExMjlY","aXpneGY=","UCAxOFFB","IDE0V0kn","IDAxIDAxMEgr","PCAyOTpY","IDE4JC8gMDg=","dVNQZks=","c2V0","R0AjXA==","amp6S1I=","ZG9jdHlwZQ==","IDE3IDIzIDAyWw==","LTclMA==","ZUNTVVQ=","UnVoZFM=","akxGa2s=","M1FCSA==","TVtCIDE5","IStcSQ==","QSAwNyAwNzk=","ZXRIbWo=","cXVpdA==","O1ZeTw==","clVnS3g=","IDI4IDA1KGM=","ODk2IDEw","IDAxIDMxIDE3LVg=","I18vIw==","LSAxNkEgMTA=","dGZBQ3U=","I0AgMzIgMjc=","IDMyMTggMDY=","cWpSdGs=","b0RZcVA=","JiwgMjcy","IDA5XWI5","NFEiIDEx","IDMwJCgn","b3Fub2Q=","cktqblo=","IDEzNSk8","dHdJRVg=","IDAxIDE3WSAyMV4=","d1dDWlE=","IDAxIDA1JU4gMzE=","RlFRUGI=","b0tmYVQ=","SEVBUDE2","dmhsRWE=","L0kgMzEx","PCAwME1A","KzM/IDMy","KiAwNkti","d1dzaUM=","IDI3LSg/","dXVjSVI=","IDI2W1UgMDY=","LyAyMEgn","VjZSLQ==","QFxSXg==","QSAwNyAwOCAyNw==","VkQgMTU0","Y2xpZW50V2lkdGg=","IDAxIDA0XF9P","IDI3XVggMjU=","IDA5MSAyNyAyMw==","IDIwIllF","Z2tDU1U=","Q2xEYkg=","SyogMTIgMzI=","dE95Ylc=","NDggMTlX","cWR5","WktpUGg=","IDIxIDA5IDIyIDIw","VUMgMTgq","aFN5Ym4=","LCAyM2A0","Li90aGlzLnByb2dyYW0=","IDI1OF0gMDI=","TnlxelU=","cHJvY2Vzczs=","IDI0WlxX","IDI0YlZR","IDI5IDMyIDI2Xg==","cHJlSW5pdA==","TFg0NQ==","IDMxJkI6","cFRLek8=","Z2ZMeWo=","YXJyYXk=","cmVzcG9uc2VUeXBl","LFIhIDE4","IDI1IDAwQCAxNQ==","ZHR1ZUM=","VHFkWUQ=","IDMwJWMgMjI=","LCByZXRyeWluZyA=","IDAxIDI2XFtT","LCAwMiAxNEk=","YWhaUnY=","PiAxNU8gMTQ=","RCkgMjI1","L1AgMTIt","SEVBUEYzMg==","bWVtb3J5SW5pdGlhbGl6ZXJSZXF1ZXN0VVJM","RCNHRw==","OSAxNlggMjk=","QEVVOw==","WVlQQVU=","c1RheXM=","IDAxIDExVCQp","YlZvUFA=","SFxEIDI4","Ll4hLw==","IDIwWTJR","cmJxbEg=","IDI2MkkgMDk=","IVs4Lw==","YDQ4IDEz","IDAxIDI2VUhE","IDI5VVoq","b3h4ZlU=","IDMwIDEyIDEyYQ==","KSAyMUIgMTI=","IDEyJigq","c0VqbUY=","ZXV1RHI=","RFd5Z0g=","OyAxNyAwOCAwNg==","IDAxIDA3IDE1XDE=","ak5zc08=","Jic1Ow==","V25NcHo=","RGtISmg=","Y0VyTlA=","Y2FsbGVkUnVu","XyAxNiIgMDg=","TSAwOSIgMjk=","IDE5QiAwMFY=","eGVFUkc=","aWxvdmVpcWl5aQ==","YXJndW1lbnRz","IDE2IDA0MSAyMw==","IDI2J0Uu","cnZuQnI=","I04gMTYl","QmlSZ1o=","IDEwPU1D","IDE0IDI4LCAwMQ==","SF9RIDIw","YmluZA==","IDI1IDAwPzo=","c2d0WFE=","IDIwRCAzMCAyNw==","IDI3IDI2Siw=","OT0iNg==","SVUgMDkgMDg=","JSMmMg==","YmxvYjo=","UVhtUWs=","KGFCQQ==","IDIyRlsgMDg=","KiAxN0VC","IDIxLjld","eEtQd1o=","YnhDRm0=","IDE1IDI1IDA2IDA1","RzBiIDAw","c3RhY2tSZXN0b3Jl","IiAzMi5L","IDE1RCAyNDc=","L2AgMTIl","anVMT04=","VXlocU4=","b3Blbg==","MiAzMFsl","VXRUVXg=","JElKPw==","PysyIDE4","IDAxJClTJA==","TVIgMDdT","IDAxIDE4JVFb","d2Fybg==","amF2YUVuYWJsZWQ=","IDAxJmJJYg==","bVBSQ0M=","Q0duSVY=","RldQWnM=","LCg6IDA2","Y0NbKA==","IVMlIDA2","MzogMjVJ","IDE3MSoh","IDMxIDAzIDAzIDA3","dGxVcVk=","ZmZhWWg=","IDMwNCAxNyAyMg==","aktPREE=","ZHluQ2FsbF8=","IDIzVzot","QUt4RFA=","KCAwMSZT","IDI2RyAwNUs=","dlFNa08=","Znd2Q08=","eEVKd1g=","IDI1IDA5WiAwOA==","VkxUZFA=","YlpXc2c=","aHJlZg==","bWVzc2FnZQ==","IDI3MUVV","IDIyIDI2VSw=","YnFIaVc=","XVtWYA==","IDE0USAzMiI=","YlFORWM=","VCAzMCdj","d2luZG93Ow==","Z2J2SWQ=","TkxJWlo=","R3hMYXc=","NSAyNSAwNlI=","bnpnY24=","UnV5dm4=","Y21kNXhsaXZl","IDI5WFBC","JyAzMSAwNDY=","IDI5L1ggMjY=","IkAgMDQw","RnR6bW8=","UmVJS2M=","a1Z4V0E=","ISAxMFJD","IUggMTcgMjQ=","IDE2NV47","d0RPdk4=","d1N4QXM=","bWNRU0k=","S3ZvRVM=","IDA5NyAxNFI=","RFhSJA==","a0hCT0M=","RyAwODUgMDU=","VlJPQko=","VW16bVQ=","VEpiWGk=","UCAxOFIt","WyIgMDFG","RWJxcVY=","eWZTSVg=","QSAxNCAyNiAxMA==","S1ZzaWs=","IDMyPDZc","Y3VycmVudFNjcmlwdA==","IDI4NjEq","IDIwJCAwOEk=","SiAxOEwgMTA=","Y0VKTWc=","bEhCRFU=","ITkkIDI5","PWEgMjIp","cUR4RFU=","KyAyOCpJ","aW52YWxpZCB0eXBlIGZvciBzZXRWYWx1ZTog","IDI5IyAzMD0=","eWpsZG0=","R3p3R0Q=","R1dRZ2Y=","LCAwNilK","IDE1IDEyIDE3XA==","JFEgMDko","IDAxIWNhKw==","WmVTbng=","Jyw/IDA5","KCAyMVwgMDU=","ckNzWXg=","TGZrY3E=","PTQgMTgn","SCAxNisgMzA=","UkNyWUM=","IDAxIDA2IDI4R0Y=","aml0c3k=","c2lOVWE=","IDE1MSAyOS8=","IDMwSk4gMDI=","U3ZTU2w=","Ym9keQ==","U0pUR2c=","c3RyaW5n","K1BDQg==","IDIzYyIgMDc=","IDIxIDIwIDIxIDE2","SUpLcVo=","Q2Fubm90IGNhbGwgdW5rbm93biBmdW5jdGlvbiA=","JTknWA==","c3RhY2s=","IDAxIDAwJyAyNDI=","aW9FeUg=","c0JFaEo=","SWlhVm0=","Q2ZKanA=","IDIzW1QgMDI=","QiAwOSsw","ZHVGaGY=","ckVzbng=","RmZ4TVI=","Y2JzSGM=","IDI2QFA1","PCAwMjRC","anVwSlM=","UGl6Rm4=","RFxLIDEz","NiAzMj0gMTM=","NyAwND4r","IDIwIDIxVmE=","IyAyMz0gMDA=","LjUgMzBT","LFc9TA==","LENbSA==","IDA5RCAxMSAwNA==","TTdbOg==","QlRuQUo=","QCAwNSAzMFc=","IDI5IDA1Szk=","RiAzMlpX","IDI2IDE4V2I=","IDEyTUov","IDE0USAzMks=","JyksWA==","SCAwMC8gMjM=","SFVCcUg=","Ym9vbGVhbg==","IDE0MlE3","PkU1IDEw","V0Znekg=","WmtESnI=","cWRfdg==","c3Jj","KmI8YQ==","S2VLR2M=","U0JSSWY=","eE5aRUk=","JD4pIDE5","VCogMDdS","a2JBYk0=","IDEyKWEgMjI=","JiAzMEsgMDM=","eXVSQmM=","OyIgMDcgMTg=","IDE2IDAwIyAxNg==","MiAyMFggMjg=","RHN0bkE=","NCRMPA==","NlcrIDAw","Z3pvVFU=","IlM7OA==","cG9zdFJ1bg==","KS07PA==","X2k2NEFkZA==","OkQoNg==","IDMxLT8gMTc=","UVd0aGs=","MS43MA==","IS05IDMw","IDE3LSYp","IDI5V048","IDIwU1Rh","NU4gMDAgMzI=","amdMZU4=","Y2hhckF0","T0dlZXc=","M0swPg==","RCAxNlNW","NyAxMyggMjI=","Y291bGQgbm90IGxvYWQgbWVtb3J5IGluaXRpYWxpemVyIA==","LT1fJA==","dG9Mb3dlckNhc2U=","QmIgMjdb","V0xualk=","cmhwRlc=","IUpTNw==","LiAxOEhO","aHRtbA==","UGJRbFY=","LCB0eXBlIA==","TE1kck4=","IDAxIDA4IDE0LjA=","cmVzcG9uc2VUZXh0","cmVxdWlyZTs=","MlcgMjMgMjM=","OT0iUw==","ZW5YWmE=","ZmxMZEU=","TEx4dkY=","IDEwIDA5LEg=","UnFwZ0I=","bG9jYXRpb24=","PGEgMTYl","cExVZ0U=","THFLVUg=","TFg1SQ==","V0Fsdk8=","VHFIYlg=","MDxcIg==","YWJvcnQo","d05hV2M=","KCAzMCRe","WHpmc3U=","Si5AIDIw","SW50MzJBcnJheQ==","Pik2OQ==","VmRlRk0=","bFdGTFQ=","bE5nb2g=","dGt6bVY=","IDAxIDA2KSAwNjc=","cG9w","LENAYA==","bWVtb3J5IGluaXRpYWxpemVy","KGEgMDFO","IDIwIDEyIDExIDEy","LCAyM2EgMDI=","Sm1TV2g=","NicgMjhI","JTBLIDMw","ZUtwVEE=","IDA4QFkgMjE=","YndhUU4=","OEI/IDA2","IyAwNyAwNSQ=","IDAxIDE0Pi5h","IyAwOGEgMjY=","UmFFbHk=","IDI1MiAwMWI=","OSAyNiAwNS8=","TCAwMVUw","RVZDTmE=","IDMxIDAyJyM=","QmFRd3A=","SjgkIDE5","MyljMQ==","IDE3VSAyNCE=","KkUgMDVA","IDI4USAwM0Y=","IDE4YSAwM1E=","IDMyIDIyJjE=","K1YgMjI+","UnJzQ2g=","b0dOamg=","Z2V0TmF0aXZlVHlwZVNpemUgaW52YWxpZCBiaXRzIA==","c1Z6eEg=","MTggMDZI","ZktpYWs=","cHJlbG9hZGVkQXVkaW9z","IDMyKj8x","IDMyQVkt","JF01SA==","IDIyTWNf","a2hBVGo=","MlMgMDE/","LCAyMSAwMmM=","WndnT24=","RVwgMDQgMDA=","NCliSQ==","bUlsVko=","IDE5LShL","TkVIIDEx","cFdLUHo=","VU56QlY=","SkpOckY=","IDIxOjlZ","LTdiNw==","NCcgMDAgMjk=","RmNOdWs=","NkYgMjk0","IDA4Xldd","IDAxIDIxIDIyNys=","bGduR0M=","IDE1KyAwNEI=","OSAwM15H","MFklRg==","ZGVXT3c=","ZklGVkg=","QkxYPA==","JTUgMTcgMDk=","REwgMTE6","JVRGWg==","YkpydFU=","MCAxMyAxMyAwMw==","IDI3QSAzMEM=","IDI4IDMwX08=","U3laVXI=","bHFTWUE=","JSAxMykgMjE=","VlQgMDRJ","UmNiZFA=","IDI1NT1S","IDI5LCAwNFQ=","cXNkeGc=","Q1N1SGM=","Z2V0VGltZQ==","a2FCekY=","IDI5NVQw","VWludDhBcnJheQ==","IDMwIDIzIDEyIDI2","dWlwZkw=","U29wbEU=","X21hbGxvYw==","LCAxMSAxNiE=","OSAwN2Fa","QyAwOCAxMlM=","O0s4IDE4","c3Z6Wlk=","QSAwNyAwN1I=","IiAxN1Ql","bW9uaXRvclJ1bkRlcGVuZGVuY2llcw==","SCAzMlogMDg=","IDIyVykgMTc=","bG9n","RHRHblM=","R09Cd2U=","Q0VXTXg=","P0chQA==","RW5oS0k=","SnN3Z2Y=","cmVzcG9uc2U=","LiAyMyxD","ZnVuY3Rpb24lMjBqYXZhRW5hYmxlZCUyOCUyOSUyMCU3QiUyMCU1Qm5hdGl2ZSUyMGNvZGUlNUQlMjAlN0Q=","a29BWlg=","IDI0TiAwMyc=","bGNHc1o=","IDAxIDMyIDI5SSY=","KS07LA==","ZkZLR2M=","a3pvbVE=","Q2pLdnA=","T2JMTng=","IDAxIDEyQ1Us","Y3JYTEk=","OyAwMiAyOFk=","TndRcVM=","QSAyMydU","IDE5IDA3UCAzMA==","bWNkWFg=","IDE2IDA0MFw=","QW5WZ3k=","REJOT1Q=","UU9MYmI=","IDE0IDMxLUg=","bGFzdEluZGV4T2Y=","O0tYWA==","IDAxIDAyIDA0XCAyMA==","LEEgMDRQ","UGpEcmo=","LCg6IDMy","TiAyNkNY","IDEzWyFa","Y2hhckNvZGVBdA==","Ynl0ZUxlbmd0aA==","d01uZFA=","SGNaTWY=","IDI3ITIgMDc=","a2d0eng=","aWFFRGQ=","eWtmbU4=","cGZpcE8=","QD1VIDI5","WFRPVFQ=","IDI5IDE3Yi4=","aWVtdVI=","ODk1Xw==","IDAxIDIwIDAxIDA3MA==","cEpqamo=","aVNvU0c=","IDI0TDIgMjI=","OiAwMiNG","b25SdW50aW1lSW5pdGlhbGl6ZWQ=","IDE5Jj9b","PVxUSw==","JkogMDY5","IDI5WVlc","IDE3IDE2IDMyIDMx","U3VKUkU=","UnVubmluZy4uLg==","VXpDT08=","Rmp6Smw=","U1NOWnA=","b1duWmE=","NEkgMDdf","ekVYcG0=","Y29uY2F0","R1h3c1o=","IDAxKUhXIDAw","IDAxIDI4PzggMDY=","IDE5YCAxNlg=","dmpFWUU=","IDI3QzlC","MSAxMCAyOEY=","RzJNIDMx","Y3dyYXA=","YXBwbHk=","IDMxIDAzIDAyUg==","WXJwZkQ=","JzBgSA==","KzAgMTIgMjg=","IDMwQiYh","QSAxNTsgMjQ=","SzsxIDA1","SCAwM0BH","Rklza1A=","V1RwSmw=","PyQgMjZK","IDE3X1ZS","K08sVg==","Iy8gMjcv","VWNnTko=","KyAwN1Zg","Q1ojIDMw","aEJNeVQ=","IDIyI0Yn","IDAxIDExTSwgMTc=","TTogMDIq","I0oyIDEx","MCAyOTYgMjA=","VlZEUw==","RTYgMzAgMDg=","VzJDXA==","dWJSZWQ=","IDI3KTZA","QSxhIDAx","IU5OLQ==","ZUVESUs=","JD4pIDA0","ZXRLc3g=","IDAxIDI0SyAxOUQ=","PCAwOVlY","cnVu","IDI1VCAxNlM=","a2toUEM=","dEJITm0=","QicgMDEgMTM=","JUxSQQ==","c2hvd24=","Q0ViYQ==","QDdRRQ==","Si4/IDEz","IDI3IDIxSTo=","Q21RV1g=","MFklSQ==","bnVtYmVy","KlsgMjRd","WmlMWnU=","QDdSIDA1","IDIxXCAxMC4=","TCAzMSAyNTk=","cGpuWW8=","QmlKekY=","TVF1bVg=","R2prT0c=","IG5vdCBpbiAweDAwLTB4RkYu","SCAwMCAyM1A=","ISAzMUZF","YXNt","IDIyIDI2VSAyNA==","JSAxMCAzMiAxNg==","IDE5PSNY","ISAyNyAzMSAwNw==","IDIxW0BN","QyQgMDY/","REZEQA==","IDE2IDA5IDI1Jg==","YlJDVXI=","TkFdXg==","O0VQIDI3","ZHluQ2FsbF92","YUlYS1o=","RCkgMThc","MTlKSQ==","SnpNTXE=","IDIxMC5L","b1FEaFM=","RW5HV3Q=","UCAwMCAyNVE=","RV1PUg==","VEJGTEg=","IDEzWyIgMTI=","VGM0Sw==","IDE5IDA1IDIyIDI3","TENka00=","SW50OEFycmF5","Ny0gMjAgMTY=","NU1jYA==","IDI3OyJg","QUNkVEM=","Q2V6Uk4=","NSAyNywgMTQ=","RUdgIDIy","dGl0bGU=","R3dHU3Q=","b2JQTVU=","ZGVjb2Rl","SyAwOCAxOCAyMw==","amlGdFg=","KG5vIHN0YWNrIHRyYWNlIGF2YWlsYWJsZSk=","ZG9jdW1lbnQ=","KiAyMD9S","JSgkIDIx","IDE2IDExJj8=","REpFVWQ=","ZGN0VXc=","IDE0IDAxUyAxNw==","bGVuZ3Ro","RFV3eUY=","IDMyIDA1OSAyNw==","QUt0WnA=","MEMgMDEo","TCAyNEYgMTU=","IDMyMDYgMjU=","QnpudXA=","b3RrR28=","Ukh3VEk=","eGZzR2Y=","IDI4O15J","Rk96cG0=","ZmxvYXQ=","IDIwIDExIDAyWQ==","Z0pCSWg=","YWJz","JSpaTQ==","MTY1Ig==","VFN2SkY=","UyAxNEVC","JEMsIDMy","TWF0aA==","IDMyPGAgMjU=","PSAyNENh","VHJoclQ=","cWRz","IDIyIDMwIDE3UQ==","IDE3VSAyNE0=","Sm9lQXQ=","XTcgMDU0","Uz9aYw==","LiAxNjc5","SHBMdEQ=","LWMgMTdJ","ZnVuY3Rpb24=","QW9kWHc=","TXFXaUc=","Mk1EIDE1","UEpBTWI=","US1ITg==","ZXZlcnk=","emlsUmk=","QmFJam0=","NlVNSw==","L0InIDI1","IDIxIDI4IDE5Yg==","b25sb2Fk","UXdPR08=","QDYgMTE1","TkJMTHY=","MTlLIw==","ZmpBbmo=","SCAwMCAyM0Y=","IDEyVV4gMTQ=","dXNlckFnZW50","PSAwMDcgMDI=","IDMxIDE1O04=","VUh4Z2k=","dVpKQVI=","Zk5OZWM=","X21lbWNweQ==","IDMwYj4gMDg=","Qzk4Lw==","ZG9tYWlu","NiU0YA==","UEVNU3M=","VHVnc3E=","WkNYUmc=","ZG91Ymxl","U01hQXc=","IDEzIDE4XEU=","U01sRFo=","c2VuZA==","cHJlUnVu","MiAwM1wh","c3RhcnRzV2l0aA==","MCAxOSAzMiAxNw==","IDEzQ14gMDk=","M0hNIDA1","IDI3KCAyMFI=","IDMwIDIzMVE=","cmZQVG8=","NyAyN1sgMjk=","IDAxIDA1PD1H","dGhpc1Byb2dyYW0=","IDI5YCAzMS4=","QnlDaFk=","Y2FsbA==","aVBPb3E=","OEhhQA==","IDMyKlA9","c3RhY2tTYXZl","aEVVR3k=","aWFESmc=","YjU9UA==","d3JNdlI=","QCwxIDI4","WFZHLA==","IDI0JCAxMTI=","YnVmZmVy","W29iamVjdCBwcm9jZXNzXQ==","cXFQSG0=","IDMxIDMxV2M=","IDAxIDAxIDI2IDIwIDE3","IDI2JlEgMjI=","KSAxMiAwOGA=","RHJvVXc=","MisgMjJZ","Ky5EIDIz","cHJpbnRFcnI=","KFUgMTNf","N2MgMDJe","IDE3SCwgMTE=","O11WIDE1","eU5kYVM=","IDE2YSMv","QiAzMiAxMUM=","Ik4iIDI3","XCAxMyAxOFE=","ekJaT2M=","TF0pQw==","d0FRbWs=","QVVrYkU=","QSljIDIy","c3RhY2tBbGxvYw==","IDIxJjQ8","dkN1QUI=","VUcgMjE2","IDI1SSMgMDI=","VnpHY0I=","JCAxNjggMTY=","IDIwVSYgMDI=","IDMyIDIyJVA=","aGlzdG9yeQ==","JEsgMjMgMjI=","IDA5Vzol","Kl0vYw==","OCAxNTNF","JUsgMzBG","IDMyPDY4","X2ZyZWU=","IDI0Ylch","Y3pTTXE=","Ij0gMDdV","eElRcXU=","JiAxMiQgMTg=","Um1Zako=","bml1Qm4=","IyAwODot","ME8zLA==","IDI3IDI2SiAwMg==","OyAxNyAwNT8=","SlxjKw==","dkRUWXI=","JSAyNTJF","aFp2anI=","bVNVUEs=","RWhaZVg=","WEN1UHI=","WWFCWmQ=","eVh5Rkg=","MCAxMyAwOVE=","T3dMUk8=","LSAxNTxY","IDA2S1Yj","SFZzRmc=","OSAwNkZY","Uk5JckY=","SEVBUDMy","OEZYIDE3","L05bTQ==","P0s+Vw==","Wk1iY1c=","Z25Qcm8=","RiAzMlpH","aHRYWlU=","NFIgMjBI","LSAwMVwz","RCAwMzw+","VHVzcFY=","QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0=","Q1tdIDAx","bmF2aWdhdG9y","IVc7VA==","IDI0TiAwNCAwMA==","IDEyVV4gMDA=","TG1yU04=","RXp2bWs=","ZnVuYw==","cHJvY2Vzcw==","IDAxIDA2IDAyIDE1Lw==","UHhEaXU=","IDE5LSg8","alNrTnc=","SkVibUc=","RFJGWHg=","RTYgMjle","QkxYWw==","cHVLVW4=","IDAxIDMwWiAxODI=","IDIzVzpQ","bmtqc2c=","WU5NQlI=","c1lyanY=","Y2x6MzI=","SHZWbFo=","SGpsWVU=","KzpQMQ==","IDMyX0k1","RUpOV04=","IDAxIDEyOV03","QiAwOUkgMDg=","TW14Q0c="],a,b;a=_qda,b=269,function(e){for(;--e;)a.push(a.shift())}(++b);var _qdb=function(e,t){var i,a=_qda[e-=0];_qdb.zJmtVh===undefined&&((i=function(){var e;try{e=Function('return (function() {}.constructor("return this")( ));')()}catch(t){e=window}return e}()).atob||(i.atob=function(e){for(var t,i,a=String(e).replace(/=+$/,""),n="",r=0,s=0;i=a.charAt(s++);~i&&(t=r%4?64*t+i:i,r++%4)?n+=String.fromCharCode(255&t>>(-2*r&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return n}),_qdb.DDxtVa=function(e){for(var t=atob(e),i=[],a=0,n=t.length;a<n;a++)i+="%"+("00"+t.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(i)},_qdb.Ekspgf={},_qdb.zJmtVh=!0);var n=_qdb.Ekspgf[e];return n===undefined?(a=_qdb.DDxtVa(a),_qdb.Ekspgf[e]=a):a=n,a};function _qdc(){var d=function(e){if(_qdb("0x5f")!==_qdb("0xf5")){for(var t in e){if(_qdb("0x3df")===_qdb("0x58")){var i=bf(arr[_qdb("0x43c")]);return a5(arr,i),i}if(e[_qdb("0x528")](t))return!1}return!0}X=M,Y=N},e=function(bq){if(_qdb("0x124")==_qdb("0x124"))return eval(bq);v=Z+f|0,b2[_+4>>2]=3|v,i=_+v+4|0,b2[i>>2]=1|b2[i>>2]},f=null,g=function(e){if(_qdb("0x61a")!==_qdb("0xdb")){if(!f){if(_qdb("0x31b")!==_qdb("0x27f"))return _qdb("0x200");bj(bl[_qdb("0x4a0")])}var t="",i=f(e);return i&&(_qdb("0x484")==_qdb("0x484")?(t=a0(i),ba(i)):p+=-14127),t}b2[3]=k|h,ga=v+8|0,ha=v},h=function(){if(_qdb("0x30")==_qdb("0x30")){var e={};e[_qdb("0x2c5")]=2,e.tm=(new Date)[_qdb("0x369")]();var t=window;if(typeof t[_qdb("0x4f3")]===_qdb("0x558"))_qdb("0x43f")==_qdb("0x43f")?e[_qdb("0x1bb")]="u":aJ=v(aJ);else{if(_qdb("0xc2")!=_qdb("0xc2"))return 0;e[_qdb("0x1bb")]=_qdb("0x384")===escape(t[_qdb("0x4f3")][_qdb("0x22b")][_qdb("0x5d5")]())?"a":"i"}for(var i in e[_qdb("0x456")]=0,t)if(_qdb("0x117")===_qdb("0x167")){if(bn)return;if(bn=!0,k[_qdb("0x1fb")]=!0,R)return;at(),au(),k[_qdb("0x3b5")]&&k[_qdb("0x3b5")](),aw()}else if(t[_qdb("0x528")](i)){if(_qdb("0x35c")!=_qdb("0x35c"))return _qdb("0x200");i=i[_qdb("0x2ed")]()}return e}va=f,wa=fa},i=function(){if(_qdb("0x1f3")!==_qdb("0x10c")){var e=h();return e.tm=parseInt(e.tm/1e3),e}ax(k[_qdb("0x486")][_qdb("0xac")]())};if(exports[_qdb("0x54f")]=g,exports[_qdb("0x584")]=h,exports[_qdb("0x255")]=i,typeof ArrayBuffer!==_qdb("0x558")){var j={};j[_qdb("0x579")]=32768;var k=j,k=typeof k!==_qdb("0x558")?k:{},l={},m;for(m in k)_qdb("0x66")!==_qdb("0x4ea")?k[_qdb("0x528")](m)&&(_qdb("0x1a3")!==_qdb("0x570")?l[m]=k[m]:(k=h+e|0,b2[n+4>>2]=3|k,f=n+k+4|0,b2[f>>2]=1|b2[f>>2])):(L=k,M=0,N=0,O=61);var n=[],o=_qdb("0x1c1"),p=function(e,t){if(_qdb("0x5d0")!=_qdb("0x5d0"))return Y[_qdb("0x431")](u8Array[_qdb("0x148")](idx,endPtr));throw t},q=!0,r=!1,s=!1,t=!1,u="",w,x,y,z;if(q||r)if(_qdb("0x5e3")===_qdb("0x407"))w=v,x=u;else{if(r)if(_qdb("0x56")!=_qdb("0x56")){var bu=array[i];bu>255&&(aX&&T(!1,_qdb("0x32")+bu+" ("+String[_qdb("0x50")](bu)+_qdb("0x146")+i+_qdb("0x408")),bu&=255),ret[_qdb("0x60f")](String[_qdb("0x50")](bu))}else u=self[_qdb("0x301")][_qdb("0x245")];else document[_qdb("0x272")]&&(_qdb("0x2de")==_qdb("0x2de")?u=document[_qdb("0x272")][_qdb("0x2c6")]:(da=g,ea=k));if(0!==u[_qdb("0xbc")](_qdb("0x212")))if(_qdb("0x2c3")!=_qdb("0x2c3")){if(k[_qdb("0x2d9")])for(typeof k[_qdb("0x2d9")]==_qdb("0x45f")&&(k[_qdb("0x2d9")]=[k[_qdb("0x2d9")]]);k[_qdb("0x2d9")][_qdb("0x43c")];)ay(k[_qdb("0x2d9")][_qdb("0xac")]());al(ap)}else u=u[_qdb("0x36")](0,u[_qdb("0x39a")]("/")+1);else _qdb("0x385")!==_qdb("0x47f")?u="":d=i("fs");_qdb("0x444")!==_qdb("0x5cb")?(w=function(e){if(_qdb("0xf1")!=_qdb("0xf1"))return func;try{if(_qdb("0x459")==_qdb("0x459")){var t=new XMLHttpRequest;return t[_qdb("0x222")](_qdb("0x86"),e,!1),t[_qdb("0x485")](null),t[_qdb("0x2f8")]}p+=6201}catch(n){if(_qdb("0x37e")==_qdb("0x37e")){var a=b1(e);if(a){if(_qdb("0x421")==_qdb("0x421"))return aY(a);enc1=keyStr[_qdb("0xbc")](input[_qdb("0x2e6")](i++)),enc2=keyStr[_qdb("0xbc")](input[_qdb("0x2e6")](i++)),enc3=keyStr[_qdb("0xbc")](input[_qdb("0x2e6")](i++)),enc4=keyStr[_qdb("0xbc")](input[_qdb("0x2e6")](i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output+=String[_qdb("0x50")](chr1),64!==enc3&&(output+=String[_qdb("0x50")](chr2)),64!==enc4&&(output+=String[_qdb("0x50")](chr3))}throw n}ga=0|b2[la+8>>2],b2[ga+12>>2]=aa,b2[aa+8>>2]=ga,ua=aa}},r&&(_qdb("0x141")!=_qdb("0x141")?(F[_qdb("0x3f7")]||(F[_qdb("0x3f7")]={}),F[_qdb("0x3f7")][text]||(F[_qdb("0x3f7")][text]=1,B(text))):y=function(e){if(_qdb("0x26d")!==_qdb("0x43"))try{if(_qdb("0x123")!==_qdb("0x2ca")){var t=new XMLHttpRequest;return t[_qdb("0x222")](_qdb("0x86"),e,!1),t[_qdb("0x1ce")]=_qdb("0x150"),t[_qdb("0x485")](null),new Uint8Array(t[_qdb("0x382")])}for(typeof k[_qdb("0x2d9")]==_qdb("0x45f")&&(k[_qdb("0x2d9")]=[k[_qdb("0x2d9")]]);k[_qdb("0x2d9")][_qdb("0x43c")];)ay(k[_qdb("0x2d9")][_qdb("0xac")]())}catch(a){if(_qdb("0x23f")!==_qdb("0x204")){var i=b1(e);if(i)return _qdb("0x15b")==_qdb("0x15b")?i:(console[_qdb("0x22a")](_qdb("0x58b")+request[_qdb("0xe4")]+_qdb("0x1d4")+aJ),void bk());throw a}p+=-1598}else p+=-19290}),x=function(e,t,i){if(_qdb("0x1ff")===_qdb("0x40"))return returnType===_qdb("0x295")?a0(ret):returnType===_qdb("0x2c0")?Boolean(ret):ret;var a=new XMLHttpRequest;a[_qdb("0x222")](_qdb("0x86"),e,!0),a[_qdb("0x1ce")]=_qdb("0x150"),a[_qdb("0x46b")]=function(){if(_qdb("0x1a")!=_qdb("0x1a"))p+=20666;else{if(200==a[_qdb("0xe4")]||0==a[_qdb("0xe4")]&&a[_qdb("0x382")])return _qdb("0x5ab")==_qdb("0x5ab")?void t(a[_qdb("0x382")]):(j|=0,b2|=0,(0|(b4|=0))<32?(o(b2<<b4|(j&(1<<b4)-1<<32-b4)>>>32-b4|0),j<<b4):(o(j<<b4-32|0),0));var n=b1(e);if(n){if(_qdb("0x59d")!==_qdb("0x37"))return void t(n[_qdb("0x4a0")]);b2[b4>>2]=h,b4=b4+4|0}i()}},a[_qdb("0x29")]=i,a[_qdb("0x485")](null)}):(n=0|b2[8],h=m>>>3,k=52+(h<<1<<2)|0,i=1<<h,p&i?(i=k+8|0,q=i,r=0|b2[i>>2]):(b2[3]=p|i,q=k+8|0,r=k),b2[q>>2]=n,b2[r+12>>2]=n,b2[n+8>>2]=r,b2[n+12>>2]=k),z=function(e){if(_qdb("0x102")!=_qdb("0x102")){if(!f)return _qdb("0x200");var t="",i=f(urlpara);return i&&(t=a0(i),ba(i)),t}document[_qdb("0x42e")]=e}}var A=k[_qdb("0x562")]||console[_qdb("0x37b")][_qdb("0x20a")](console),B=k[_qdb("0x4aa")]||console[_qdb("0x22a")][_qdb("0x20a")](console);for(m in l){if(_qdb("0x2ef")!=_qdb("0x2ef"))return;l[_qdb("0x528")](m)&&(_qdb("0x132")!==_qdb("0x71")?k[m]=l[m]:p+=-19343)}l=null,k[_qdb("0x201")]&&(n=k[_qdb("0x201")]),k[_qdb("0x491")]&&(o=k[_qdb("0x491")]),k[_qdb("0x188")]&&(p=k[_qdb("0x188")]);var C=16,G=1,H=new Array(0),I={},K=0,L=function(e){_qdb("0x26a")==_qdb("0x26a")?K=e:p+=-28368},M=function(){if(_qdb("0x1fa")!==_qdb("0x2c9"))return K;p+=40880},N=8,O,P;k[_qdb("0xf4")]&&(O=k[_qdb("0xf4")]),k[_qdb("0x5f0")]&&(P=k[_qdb("0x5f0")]);var R=!1,S=0,X=3,Y=typeof TextDecoder!==_qdb("0x558")?new TextDecoder(_qdb("0x5fc")):undefined,a4=typeof TextDecoder!==_qdb("0x558")?new TextDecoder(_qdb("0x5a9")):undefined,a7,a8,a9,aa,ab,ac,ad,ae,af,ah=720,ai=6864,aj=528,ak=k[_qdb("0x579")]||16777216;k[_qdb("0x4a0")]?_qdb("0xa")!=_qdb("0xa")?p+=20048:a7=k[_qdb("0x4a0")]:a7=_qdb("0x37d")===_qdb("0x53c")?k[_qdb("0x4a0")]:new ArrayBuffer(ak),ak=a7[_qdb("0x3a3")],ag(a7),ac[aj>>2]=ai;var am=[],an=[],ao=[],ap=[],aq=!1,ar=!1;Math[_qdb("0x7")]&&-5===Math[_qdb("0x7")](4294967295,5)||(Math[_qdb("0x7")]=function(e,t){if(_qdb("0x398")!==_qdb("0x152")){var i=65535&e,a=65535&t;return i*a+((e>>>16)*a+i*(t>>>16)<<16)|0}U=s,V=P}),Math[_qdb("0x509")]||(Math[_qdb("0x509")]=function(e){if(_qdb("0x555")!=_qdb("0x555")){var t=0;if(null!==str&&str!==undefined&&0!==str){var i=1+(str[_qdb("0x43c")]<<2);t=bf(i),a2(str,t,i)}return t}var a=32,n=e>>16;if(n&&(_qdb("0x3b2")!=_qdb("0x3b2")?ap[_qdb("0x524")](cb):(a-=16,e=n)),(n=e>>8)&&(_qdb("0x49c")==_qdb("0x49c")?(a-=8,e=n):(Z<<=1,ka=g)),(n=e>>4)&&(_qdb("0x3c8")==_qdb("0x3c8")?(a-=4,e=n):(aq=!0,al(an))),n=e>>2){if(_qdb("0x28e")===_qdb("0x352"))return oa=na-I|0,b2[6]=oa,na=0|b2[9],ra=na+I|0,b2[9]=ra,b2[ra+4>>2]=1|oa,b2[na+4>>2]=3|I,o=na+8|0,u=b4,0|o;a-=2,e=n}return(n=e>>1)?a-2:a-e}),Math[_qdb("0x559")]||(Math[_qdb("0x559")]=function(e){if(_qdb("0x2a5")==_qdb("0x2a5"))return e<0?Math[_qdb("0x614")](e):Math[_qdb("0x514")](e);var t=b1(k[_qdb("0x1dc")]);if(!t)return console[_qdb("0x22a")](_qdb("0x58b")+request[_qdb("0xe4")]+_qdb("0x1d4")+aJ),void bk();response=t[_qdb("0x4a0")]});var az=Math[_qdb("0x44c")],aA=Math[_qdb("0x614")],aB=Math[_qdb("0x514")],aC=Math[_qdb("0xb1")],aD=0,aE=null,aF=null;k[_qdb("0x608")]={},k[_qdb("0x33a")]={};var aJ=null,aK=_qdb("0x52f"),aM,aN,aO=704,aW=Uint8Array[_qdb("0x46")][_qdb("0x5d2")]?function(e,t,i){_qdb("0x499")===_qdb("0x206")?k[_qdb("0x528")](m)&&(l[m]=k[m]):a9[_qdb("0x5d2")](e,t,t+i)}:function(e,t,i){_qdb("0x507")==_qdb("0x507")?a9[_qdb("0x17a")](a9[_qdb("0x148")](t,t+i),e):p+=-26218},aX=!1,aZ=typeof atob===_qdb("0x45f")?atob:function(e){if(_qdb("0x405")!==_qdb("0x151")){var t,i,a,n,r,o,d=_qdb("0x4f1"),u="",c=0;e=e[_qdb("0xf")](/[^A-Za-z0-9\+\/\=]/g,"");do{if(_qdb("0x2e7")!=_qdb("0x2e7"))p+=8466;else{if(t=d[_qdb("0xbc")](e[_qdb("0x2e6")](c++))<<2|(n=d[_qdb("0xbc")](e[_qdb("0x2e6")](c++)))>>4,i=(15&n)<<4|(r=d[_qdb("0xbc")](e[_qdb("0x2e6")](c++)))>>2,a=(3&r)<<6|(o=d[_qdb("0xbc")](e[_qdb("0x2e6")](c++))),u+=String[_qdb("0x50")](t),64!==r){if(_qdb("0x236")===_qdb("0x4f7")){for(var l=aZ(s),_=new Uint8Array(l[_qdb("0x43c")]),f=0;f<l[_qdb("0x43c")];++f)_[f]=l[_qdb("0x3a2")](f);return _}u+=String[_qdb("0x50")](i)}if(64!==o){if(_qdb("0x280")!=_qdb("0x280"))return(_=h()).tm=parseInt(_.tm/1e3),_;u+=String[_qdb("0x50")](a)}}}while(c<e[_qdb("0x43c")]);return u}a8[_qdb("0x17a")](array,a7)},b2={};b2[_qdb("0x452")]=Math,b2[_qdb("0x426")]=Int8Array,b2[_qdb("0x30e")]=Int32Array,b2[_qdb("0x36c")]=Uint8Array;var b3=b2,b4={};b4.a=aI,b4.b=L,b4.c=M,b4.d=aS,b4.e=aT,b4.f=aW,b4.g=aV,b4.h=aO;var b5=b4,b6=function(e,t,i){_qdb("0x5af");var a=new(e[_qdb("0x426")])(i),n=new(e[_qdb("0x30e")])(i),r=(new(e[_qdb("0x36c")])(i),t.h,e[_qdb("0x452")][_qdb("0x7")]),s=(t.a,t.b),o=t.c,d=t.d,c=t.e,h=t.f,_=t.g,f=720;function p(e){e|=0;var t=0,s=0,c=0,h=0,_=0,p=0,b=0,P=0,x=0,E=0,D=0,w=0,A=0,q=0,O=0,L=0,C=0,M=0,R=0,F=0,H=0,W=0,j=0,G=0,z=0,Y=0,Q=0,J=0,X=0,$=0,ee=0,te=0,ie=0,ae=0,ne=0,re=0,se=0,oe=0,de=0,ue=0,ce=0,le=0,he=0,_e=0,fe=0,pe=0,ge=0,me=0,ve=0,be=0,ye=0,ke=0,Te=0,Se=0,Pe=0,xe=0,Ie=0,Ee=0,De=0,we=0,Ae=0,qe=0,Oe=0,Le=0,Ce=0,Me=0,Re=0,Be=0,Ne=0,Fe=0,Ue=0,Ve=0,He=0,We=0,je=0,Ge=0,ze=0,Ke=0,Ye=0,Qe=0,Je=0,Xe=0,Ze=0,$e=0,et=0,tt=0,it=0,at=0,nt=0,rt=0,st=0,ot=0,dt=0,ut=0,ct=0,lt=0,ht=0,_t=0,ft=0,pt=0,gt=0,mt=0,vt=0,bt=0,yt=0,kt=0,Tt=0,St=0,Pt=0,xt=0,It=0,Et=0,Dt=0,wt=0,At=0,qt=0,Ot=0,Lt=0,Ct=0,Mt=0,Rt=0,Bt=0,Nt=0,Ft=0,Ut=0,Vt=0,Ht=0,Wt=0,jt=0,Gt=0,zt=0,Kt=0,Yt=0,Qt=0,Jt=0,Xt=0,Zt=0,$t=0,ei=0,ti=0;t=f,f=f+608|0,c=t+592|0,h=t+588|0,_=t+584|0,p=t+580|0,b=t+576|0,P=t+572|0,x=t+568|0,E=t+564|0,D=t+560|0,A=(w=t)+4|0,q=w+8|0,O=w+12|0,L=w+16|0,C=w+20|0,M=w+24|0,R=w+28|0,F=w+32|0,H=(s=t+48|0)+8|0,W=s+16|0,j=s+24|0,G=s+32|0,z=s+40|0,Y=s+48|0,Q=s+56|0,J=s+64|0,X=s+72|0,$=s+80|0,ee=s+88|0,te=s+96|0,ie=s+104|0,ae=s+112|0,ne=s+120|0,re=s+128|0,se=s+136|0,oe=s+144|0,de=s+152|0,ue=s+160|0,ce=s+168|0,le=s+176|0,he=s+184|0,_e=s+192|0,fe=s+200|0,pe=s+208|0,ge=s+216|0,me=s+224|0,ve=s+232|0,be=s+240|0,ye=s+248|0,ke=s+256|0,Te=s+264|0,Se=s+272|0,Pe=s+280|0,xe=s+288|0,Ie=s+296|0,Ee=s+304|0,De=s+312|0,we=s+320|0,Ae=s+328|0,qe=s+336|0,Oe=s+344|0,Le=s+352|0,Ce=s+360|0,Me=s+368|0,Re=s+376|0,Be=s+384|0,Ne=s+392|0,Fe=s+400|0,Ue=s+408|0,Ve=s+416|0,He=s+424|0,We=s+432|0,je=s+440|0,Ge=s+448|0,ze=s+456|0,Ke=s+464|0,Ye=s+472|0,Qe=s+480|0,Je=s+488|0,Xe=s+496|0,Ze=s+504|0,$e=0,et=140,tt=0,it=0,at=0,nt=0,rt=0,st=0,ot=0,dt=0,ut=0,ct=0,lt=0,ht=0,_t=0,ft=0,pt=0,gt=0,mt=0,vt=0,bt=0,yt=0,kt=0,Tt=0,St=0;e:for(;;){switch((255&et)<<24>>24){case 35:if(_qdb("0x460")!==_qdb("0x4e9"))break e;o+=-17900;case 124:if(_qdb("0x25")!==_qdb("0x4f8")){Pt=0,xt=140;break e}z=1&((A=(L=14-((g=(L=(A=L<<(F=(A=L+1048320|0)>>>16&8))+520192|0)>>>16&4)|F|(Y=(A=(L=A<<g)+245760|0)>>>16&2))+((A=L<<Y)>>>15)|0)+7|0)?c>>>A:c)|L<<1;case 112:if(_qdb("0x1e3")==_qdb("0x1e3")){Et=It=0|g(yt<<2),Dt=108,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=It;break}Ie=xe,Ee=De?we:Ae,$=145;case 111:if(_qdb("0x36a")!==_qdb("0x3bd")){Et=$e,Dt=109,wt=tt,At=(Zt=ct+-1|0)>>2,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=It=(nt|~st)^rt,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=(It+(-2&at)&-2|1&at)+(1&It)|0,Qt=dt+((7*ut|0)%16|0)|0,Jt=Tt,Xt=St;break}k[_qdb("0xc9")](_qdb("0x3bc")),setTimeout((function(){setTimeout((function(){k[_qdb("0xc9")]("")}),1),doRun()}),1);case 109:if(_qdb("0xa3")==_qdb("0xa3")){Et=$e,Dt=(0|kt)>((It=ct+32|0)>>2|0)?85:107,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=4077;case 108:if(_qdb("0x25a")!==_qdb("0x96")){Et=$e,Dt=(0|dt)<(0|yt)?104:102,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=44703;case 107:if(_qdb("0x107")==_qdb("0x107")){Et=$e,Dt=(0|kt)>(0|it)?105:99,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}doRun();case 105:if(_qdb("0x3e8")!==_qdb("0x2e5")){Et=$e,Dt=(0|pt)>0?103:101,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-17019;case 104:if(_qdb("0x182")!=_qdb("0x182")){var ii,ai,ni,ri,si,oi,di=_qdb("0x4f1"),ui="",ci=0;input=input[_qdb("0xf")](/[^A-Za-z0-9\+\/\=]/g,"");do{ii=di[_qdb("0xbc")](input[_qdb("0x2e6")](ci++))<<2|(ri=di[_qdb("0xbc")](input[_qdb("0x2e6")](ci++)))>>4,ai=(15&ri)<<4|(si=di[_qdb("0xbc")](input[_qdb("0x2e6")](ci++)))>>2,ni=(3&si)<<6|(oi=di[_qdb("0xbc")](input[_qdb("0x2e6")](ci++))),ui+=String[_qdb("0x50")](ii),64!==si&&(ui+=String[_qdb("0x50")](ai)),64!==oi&&(ui+=String[_qdb("0x50")](ni))}while(ci<input[_qdb("0x43c")]);return ui}n[St+(dt<<2)>>2]=0,Et=$e,Dt=108,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt+1|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 103:if(_qdb("0x2e")==_qdb("0x2e")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=28758;case 102:if(_qdb("0x41b")!==_qdb("0x42f")){Et=$e,Dt=98,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-16370;case 101:if(_qdb("0x2d7")!==_qdb("0xd0")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt+-1-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=46067;case 99:if(_qdb("0x360")!==_qdb("0xab")){Et=$e,Dt=(0|kt)==(0|it)?97:91,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}aI();case 98:if(_qdb("0x567")==_qdb("0x567")){Et=$e,Dt=(0|dt)<(0|ct)?94:92,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return 4;case 97:if(_qdb("0x3f3")!==_qdb("0x2fd")){Et=$e,Dt=(0|pt)>0?95:91,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-20214;case 95:if(_qdb("0x5b8")!==_qdb("0x24c")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}a9[_qdb("0x5d2")](dest,src,src+num);case 94:if(_qdb("0x44b")==_qdb("0x44b")){n[(It=St+(dt>>2<<2)|0)>>2]=a[e+dt>>0]<<(((0|dt)%4|0)<<3)|n[It>>2],Et=$e,Dt=98,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt+1|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}ie=Q,ae=de,ne=ue,$=65;case 92:if(_qdb("0x53e")!==_qdb("0x5b2")){n[c>>2]=0,n[h>>2]=0,n[_>>2]=0,n[p>>2]=0,n[b>>2]=0,n[(Zt=St+((It=ct+32|0)>>2<<2)|0)>>2]=n[Zt>>2]|128<<(((0|It)%4|0)<<3),n[P>>2]=0,n[x>>2]=0,n[E>>2]=0,n[D>>2]=0,n[w>>2]=c,n[A>>2]=P,n[q>>2]=h,n[O>>2]=x,n[L>>2]=_,n[C>>2]=E,n[M>>2]=p,n[R>>2]=D,n[F>>2]=b,Et=$e,Dt=90,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=(0|ct)%4|0,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}func(callback[_qdb("0x5cf")]===undefined?null:callback[_qdb("0x5cf")]);case 91:if(_qdb("0x1bc")==_qdb("0x1bc")){Et=$e,Dt=(0|kt)>(it+1|0)?89:87,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}li|=0;var li=0;return 0|(D((n|=0)+(t|=0)+((li=li+(e|=0)>>>0)>>>0<li>>>0|0)>>>0|0),0|li);case 90:if(_qdb("0x31e")==_qdb("0x31e")){Et=$e,Dt=(0|pt)>0?88:78,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-13213;case 89:if(_qdb("0x140")!==_qdb("0x114")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=5741;case 88:if(_qdb("0xfd")!==_qdb("0x2f4")){Et=$e,Dt=84,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=ct-pt|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}output+=String[_qdb("0x50")](chr3);case 87:if(_qdb("0x38d")!=_qdb("0x38d")){argTypes=argTypes||[];var hi=argTypes[_qdb("0x465")]((function(e){return e===_qdb("0x3fe")})),_i=returnType!==_qdb("0x295");return _i&&hi&&!opts?U(ident):function(){return V(ident,returnType,argTypes,arguments,opts)}}Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 85:if(_qdb("0x34e")!==_qdb("0x506")){Et=$e,Dt=(0|kt)==(14|(It=ct+40|0)>>6<<4)?83:81,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}W=a=x+8|0,S=0|n[a>>2];case 84:if(_qdb("0x516")==_qdb("0x516")){Et=$e,Dt=(0|dt)<(0|ct)?80:78,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[3]=e|a,W=x+8|0,S=x;case 83:if(_qdb("0x285")==_qdb("0x285")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=256+(ct<<3)|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}if(k[_qdb("0x486")])for(typeof k[_qdb("0x486")]==_qdb("0x45f")&&(k[_qdb("0x486")]=[k[_qdb("0x486")]]);k[_qdb("0x486")][_qdb("0x43c")];)ax(k[_qdb("0x486")][_qdb("0xac")]());al(am);case 81:if(_qdb("0x4fe")!==_qdb("0x4f0")){Et=$e,Dt=(0|kt)>(it+1|0)?79:77,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}a[e>>0]=t,e=e+1|0;case 80:if(_qdb("0x46c")==_qdb("0x46c")){It=0|n[w>>2],n[It>>2]=n[It>>2]|a[e+dt>>0]<<(((0|dt)%4|0)<<3),Et=$e,Dt=84,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt+1|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=35796;case 79:if(_qdb("0x24")==_qdb("0x24")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}document[_qdb("0x42e")]=title;case 78:if(_qdb("0x99")==_qdb("0x99")){Et=$e,Dt=74,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=0|d(),Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return;case 77:if(_qdb("0x418")==_qdb("0x418")){Et=$e,Dt=75,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}u=document[_qdb("0x272")][_qdb("0x2c6")];case 75:if(_qdb("0x335")===_qdb("0x5a5"))return V(ident,returnType,argTypes,arguments,opts);Zt=ot>>1,$t=0|I(0|n[(It=s+(ut<<3)|0)>>2],0|n[It+4>>2],0|S(0|Zt,((0|Zt)<0)<<31>>31|0,1),0|o()),o(),Et=$e,Dt=115,wt=tt,At=$t=((Zt=(1&ot)+$t|0)+(-2&yt)&-2|1&yt)+(1&Zt)|0,qt=st,Ot=((ti=$t<<(ei=6+((It=(0|ut)%4|0)<<2)+((0|r(It+-1|0,It))/2|0)|0)|((It=32-ei|0)?$t>>>It:$t))+(-2&nt)&-2|1&nt)+(1&ti)|0,Lt=nt,Ct=rt,Mt=ti,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=ei,Kt=bt,Yt=yt,Qt=Zt,Jt=Tt,Xt=St;break;case 74:if(_qdb("0xb3")!==_qdb("0x2a")){Et=$e,Dt=(0|dt)<8?70:40,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}k[_qdb("0x582")][_qdb("0xd6")](_qdb("0x10e"),bm);case 73:if(_qdb("0x1ed")!==_qdb("0xe")){Et=$e,Dt=36,wt=tt,At=it,qt=((-2&lt)+at&-2|1&lt)+(1&at)|0,Ot=((-2&ht)+nt&-2|1&ht)+(1&nt)|0,Lt=((-2&_t)+rt&-2|1&_t)+(1&rt)|0,Ct=((-2&ft)+st&-2|1&ft)+(1&st)|0,Mt=ot,Rt=dt+16|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}f=a|=0;case 71:if(_qdb("0x3c0")!=_qdb("0x3c0")){var fi=new XMLHttpRequest;return fi[_qdb("0x222")](_qdb("0x86"),url,!1),fi[_qdb("0x485")](null),fi[_qdb("0x2f8")]}v($e),Et=$e,Dt=67,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=0|g(33),Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 70:if(_qdb("0x18a")!==_qdb("0x1f6")){Et=$e,Dt=66,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}a[e>>0]=t,e=e+1|0;case 67:if(_qdb("0x3f")!=_qdb("0x3f"))return a1(str,a9,outPtr,maxBytesToWrite);Et=$e,Dt=(0|ut)<32?63:37,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 66:if(_qdb("0x57c")!==_qdb("0xfe")){Et=$e,Dt=(0|ut)<4?62:42,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}bytes[p]=decoded[_qdb("0x3a2")](p);case 63:if(_qdb("0x563")==_qdb("0x563")){Et=$e,Dt=61,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=(0|ut)/8|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=27468;case 62:if(_qdb("0x4a7")!=_qdb("0x4a7"))return void(n[5]=w);Et=$e,Dt=58,wt=0,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=72871+(359*(ei=ut+1|0)|0)+(0|r(29+(661*ei|0)|0,Zt=dt+1|0))+(0|r(919+(797*vt|0)+(0|r(881*ei|0,ei))+(0|r((8353*ei|0)+(277*Zt|0)|0,Zt))|0,vt))|0,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 61:if(_qdb("0xc5")!==_qdb("0x598")){Et=$e,Dt=0==(0|dt)?59:57,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}k[_qdb("0x378")](aD);case 59:if(_qdb("0x104")==_qdb("0x104")){Et=$e,Dt=47,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=at,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}ce=Se+G|0,n[8]=ce,n[5]=Te,n[ce+4>>2]=1|Te,n[Se+le>>2]=Te,n[Se+4>>2]=3|G;case 58:if(_qdb("0x52c")!==_qdb("0x2a1")){Et=$e,Dt=(0|tt)<16?54:52,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[E+12>>2]=b,n[P>>2]=E;case 57:if(_qdb("0x2c8")==_qdb("0x2c8")){Et=$e,Dt=1==(0|dt)?55:53,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=31318;case 55:if(_qdb("0x2bf")!==_qdb("0x3a4")){Et=$e,Dt=47,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=nt,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}Ae=0,$=143;case 54:if(_qdb("0x260")!==_qdb("0x1d1")){Et=$e,Dt=58,wt=tt+1|0,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=(Zt=1519533197+(0|r(bt,-1946432927))|0)>>>16&1023,zt=vt,Kt=Zt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=33668;case 53:if(_qdb("0x329")!==_qdb("0x59b")){Et=$e,Dt=2==(0|dt)?51:49,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return f=t,0|Pt;case-90:if(_qdb("0x39e")!==_qdb("0x22f")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}P=0|n[_+8>>2],n[P+12>>2]=b,n[b+8>>2]=P,w=b;case 52:if(_qdb("0x36e")==_qdb("0x36e")){Et=$e,Dt=50,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=31&mt,Jt=Tt,Xt=St;break}Ce=me,Me=be;case 51:if(_qdb("0x586")!==_qdb("0x28c")){Et=$e,Dt=47,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=rt,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[3]=O|h,j=A+8|0,I=A;case-92:if(_qdb("0x261")===_qdb("0x44"))return 528;Et=$e,Dt=(0|kt)>(it+1|0)?163:162,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 50:if(_qdb("0x11d")!==_qdb("0x5b3")){Et=$e,Dt=(0|kt)<10?48:46,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}d=p=P+8|0,w=0|n[p>>2];case-93:if(_qdb("0x589")==_qdb("0x589")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[Le+16>>2]=h,n[h+24>>2]=Le;case 49:if(_qdb("0x391")!==_qdb("0x218")){Et=$e,Dt=47,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=st,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}be=_=O+8|0,ye=0|n[_>>2];case-94:if(_qdb("0x5d1")!==_qdb("0x5b7")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-12778;case 48:if(_qdb("0x337")==_qdb("0x337")){Et=$e,Dt=44,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt+32|0,Jt=Tt,Xt=St;break}k[_qdb("0x5f7")](func,callback[_qdb("0x5cf")]);case-95:if(_qdb("0x3a9")==_qdb("0x3a9")){Et=$e,Dt=(0|kt)==(14|(Zt=ct+40|0)>>6<<4)?160:159,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}Ye=1&((Te=(De=14-((ce=(De=(Te=De<<(le=(Te=De+1048320|0)>>>16&8))+520192|0)>>>16&4)|le|(ke=(Te=(De=Te<<ce)+245760|0)>>>16&2))+((Te=De<<ke)>>>15)|0)+7|0)?t>>>Te:t)|De<<1;case 47:if(_qdb("0x4bb")==_qdb("0x4bb")){Et=$e,Dt=45,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=15&((Zt=ut<<2&28^4)?ot>>Zt:ot),Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}a[e>>0]=0|a[t>>0],a[e+1>>0]=0|a[t+1>>0],a[e+2>>0]=0|a[t+2>>0],a[e+3>>0]=0|a[t+3>>0],e=e+4|0,t=t+4|0;case-96:if(_qdb("0x166")!==_qdb("0x60d")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=256+(ct<<3)|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=9333;case 46:if(_qdb("0x556")!==_qdb("0x4ec")){Et=$e,Dt=44,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt+72|0,Jt=Tt,Xt=St;break}o+=-4086;case-97:if(_qdb("0xe8")==_qdb("0xe8")){Et=$e,Dt=(0|kt)>(it+1|0)?158:157,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}for(var pi=0;pi<str[_qdb("0x43c")];++pi)a8[i++>>0]=str[_qdb("0x3a2")](pi);dontAddNull||(a8[i>>0]=0);case 45:if(_qdb("0x13c")==_qdb("0x13c")){Et=$e,Dt=(0|ot)<10?43:41,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}R=s,F=t;case-98:if(_qdb("0x157")==_qdb("0x157")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}u0=(7&u0)<<18|u1<<12|u2<<6|63&u8Array[idx++];case 44:if(_qdb("0x5e6")==_qdb("0x5e6")){ti=0|n[w+((ei=(Zt=ut+pt|0)+(dt<<2)|0)>>2<<2)>>2],n[ti>>2]=n[ti>>2]|kt+16<<(((0|Zt)%4|0)<<3),Et=$e,Dt=66,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[M+20>>2]=p,n[p+24>>2]=M;case-99:if(_qdb("0x334")!==_qdb("0xdd")){Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}ay(k[_qdb("0x2d9")][_qdb("0xac")]());case 43:if(_qdb("0x1cc")==_qdb("0x1cc")){Et=$e,Dt=39,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot+48|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}k[_qdb("0xc9")]("");case-100:if(_qdb("0x339")!==_qdb("0x5")){ti=ot>>1,ei=0|I(0|n[(Zt=s+(ut<<3)|0)>>2],0|n[Zt+4>>2],0|S(0|ti,((0|ti)<0)<<31>>31|0,1),0|o()),o(),Et=$e,Dt=9,wt=tt,At=ei=((ti=(1&ot)+ei|0)+(-2&yt)&-2|1&yt)+(1&ti)|0,qt=st,Ot=((It=ei<<($t=5+((Zt=(0|ut)%4|0)<<2)+((0|r(Zt+-1|0,Zt))/2|0)|0)|((Zt=32-$t|0)?ei>>>Zt:ei))+(-2&nt)&-2|1&nt)+(1&It)|0,Lt=nt,Ct=rt,Mt=It,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=$t,Kt=bt,Yt=yt,Qt=ti,Jt=Tt,Xt=St;break}try{var gi=new XMLHttpRequest;return gi[_qdb("0x222")](_qdb("0x86"),url,!1),gi[_qdb("0x485")](null),gi[_qdb("0x2f8")]}catch(qi){var mi=b1(url);if(mi)return aY(mi);throw qi}case 42:if(_qdb("0x82")!==_qdb("0x34")){Et=$e,Dt=74,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt+1|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}aU(requestedSize);case 41:if(_qdb("0x4cd")==_qdb("0x4cd")){Et=$e,Dt=39,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot+87|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}throw new Error(_qdb("0x94"));case-102:if(_qdb("0x466")!==_qdb("0x430")){Et=$e,Dt=(0|ut)<48?152:115,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[w+20>>2]=P,n[P+24>>2]=w,x=_,r=_,E=p;case 40:if(_qdb("0x12d")!==_qdb("0x532")){$t=0|n[w+((ti=(dt<<2)+pt|0)>>2<<2)>>2],n[$t>>2]=n[$t>>2]|128<<(((0|pt)%4|0)<<3),Et=$e,Dt=36,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}Et=$e,Dt=et,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;case 39:if(_qdb("0x1f9")!==_qdb("0xd4")){a[gt+ut>>0]=ot,Et=$e,Dt=67,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return ptr?Z(a9,ptr,maxBytesToRead):"";case-104:if(_qdb("0x5fd")==_qdb("0x5fd")){Et=$e,Dt=151,wt=tt,At=(ti=ct+-1|0)>>2,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=$t=rt^nt^st,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=($t+(-2&at)&-2|1&at)+(1&$t)|0,Qt=dt+((5+(3*ut|0)|0)%16|0)|0,Jt=Tt,Xt=St;break}return f=e,0|(D=0);case-105:if(_qdb("0x17c")==_qdb("0x17c")){Et=$e,Dt=(0|kt)>(($t=ct+32|0)>>2|0)?137:150,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}v=g,S=F;case 37:if(_qdb("0x288")===_qdb("0xb6")){var vi=k["_"+ident];return T(vi,_qdb("0x29a")+ident+_qdb("0xfb")),vi}a[gt+32>>0]=0,Et=$e,Dt=35,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case-106:if(_qdb("0x3c2")==_qdb("0x3c2")){Et=$e,Dt=(0|kt)>(0|it)?149:146,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=22655;case 36:if(_qdb("0x181")!==_qdb("0x161")){Et=$e,Dt=(0|dt)<(14|($t=ct+40|0)>>6<<4)?33:71,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}O<<=1,h=P;case-107:if(_qdb("0x425")==_qdb("0x425")){Et=$e,Dt=(0|pt)>0?148:147,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}x=e,r=e,E=a;case-108:if(_qdb("0x5e4")!==_qdb("0x478")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return k[_qdb("0x23a")+sig][_qdb("0x3cd")](null,[ptr][_qdb("0x3c3")](args));case-109:if(_qdb("0xb")==_qdb("0xb")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt+-1-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}ge=ee,me=r;case 33:if(_qdb("0x251")!==_qdb("0x2cd")){Et=$e,Dt=31,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=0,Nt=ct,Ft=at,Ut=nt,Vt=rt,Ht=st,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}u="";case-110:if(_qdb("0xf7")!==_qdb("0x38f")){Et=$e,Dt=(0|kt)==(0|it)?145:142,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}var bi=toC[argTypes[p]];bi?(0===stack&&(stack=bh()),cArgs[p]=bi(args[p])):cArgs[p]=args[p];case-111:if(_qdb("0x3ac")==_qdb("0x3ac")){Et=$e,Dt=(0|pt)>0?144:142,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}for(var yi=0,ki=0;ki<str[_qdb("0x43c")];++ki){var Ti=str[_qdb("0x3a2")](ki);Ti>=55296&&Ti<=57343&&(Ti=65536+((1023&Ti)<<10)|1023&str[_qdb("0x3a2")](++ki)),Ti<=127?++yi:yi+=Ti<=2047?2:Ti<=65535?3:4}return yi;case 31:if(_qdb("0x27e")==_qdb("0x27e")){Et=$e,Dt=(0|ut)<16?29:9,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}a[_qdb("0x1bb")]=_qdb("0x384")===escape(L[_qdb("0x4f3")][_qdb("0x22b")][_qdb("0x5d5")]())?"a":"i";case-112:if(_qdb("0x1a1")!==_qdb("0x3d")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}setTimeout((function(){k[_qdb("0xc9")]("")}),1),doRun();case 29:if(_qdb("0x4db")==_qdb("0x4db")){Et=$e,Dt=28,wt=tt,At=(ti=ct+-1|0)>>2,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=$t=st&~nt|rt&nt,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=($t+(-2&at)&-2|1&at)+(1&$t)|0,Qt=dt+((0|ut)%16|0)|0,Jt=Tt,Xt=St;break}De<<=1,Te=le;case-114:if(_qdb("0x142")!=_qdb("0x142"))return 0|f;Et=$e,Dt=(0|kt)>(it+1|0)?141:139,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 28:if(_qdb("0x4dd")==_qdb("0x4dd")){Et=$e,Dt=(0|kt)>(($t=ct+32|0)>>2|0)?16:27,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=32905;case-115:if(_qdb("0x5a2")==_qdb("0x5a2")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-17666;case 27:if(_qdb("0x406")==_qdb("0x406")){Et=$e,Dt=(0|kt)>(0|it)?26:23,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}De=be,we=ve,$=136;case-116:if(_qdb("0x193")!=_qdb("0x193"))return void onload(xhr[_qdb("0x382")]);n[($t=s)>>2]=-680876936,n[$t+4>>2]=-1,n[($t=H)>>2]=-389564586,n[$t+4>>2]=-1,n[($t=W)>>2]=606105819,n[$t+4>>2]=0,n[($t=j)>>2]=-1044525330,n[$t+4>>2]=-1,n[($t=G)>>2]=-176418897,n[$t+4>>2]=-1,n[($t=z)>>2]=1200080426,n[$t+4>>2]=0,n[($t=Y)>>2]=-1473231341,n[$t+4>>2]=-1,n[($t=Q)>>2]=-45705983,n[$t+4>>2]=-1,n[($t=J)>>2]=1770035416,n[$t+4>>2]=0,n[($t=X)>>2]=-1958414417,n[$t+4>>2]=-1,n[($t=$)>>2]=-42063,n[$t+4>>2]=-1,n[($t=ee)>>2]=-1990404162,n[$t+4>>2]=-1,n[($t=te)>>2]=1804603682,n[$t+4>>2]=0,n[($t=ie)>>2]=-40341101,n[$t+4>>2]=-1,n[($t=ae)>>2]=-1502002290,n[$t+4>>2]=-1,n[($t=ne)>>2]=1236535329,n[$t+4>>2]=0,n[($t=re)>>2]=-165796510,n[$t+4>>2]=-1,n[($t=se)>>2]=-1069501632,n[$t+4>>2]=-1,n[($t=oe)>>2]=643717713,n[$t+4>>2]=0,n[($t=de)>>2]=-373897302,n[$t+4>>2]=-1,n[($t=ue)>>2]=-701558691,n[$t+4>>2]=-1,n[($t=ce)>>2]=38016083,n[$t+4>>2]=0,n[($t=le)>>2]=-660478335,n[$t+4>>2]=-1,n[($t=he)>>2]=-405537848,n[$t+4>>2]=-1,n[($t=_e)>>2]=568446438,n[$t+4>>2]=0,n[($t=fe)>>2]=-1019803690,n[$t+4>>2]=-1,n[($t=pe)>>2]=-187363961,n[$t+4>>2]=-1,n[($t=ge)>>2]=1163531501,n[$t+4>>2]=0,n[($t=me)>>2]=-1444681467,n[$t+4>>2]=-1,n[($t=ve)>>2]=-51403784,n[$t+4>>2]=-1,n[($t=be)>>2]=1735328473,n[$t+4>>2]=0,n[($t=ye)>>2]=-1926607734,n[$t+4>>2]=-1,n[($t=ke)>>2]=-378558,n[$t+4>>2]=-1,n[($t=Te)>>2]=-2022574463,n[$t+4>>2]=-1,n[($t=Se)>>2]=1839030562,n[$t+4>>2]=0,n[($t=Pe)>>2]=-35309556,n[$t+4>>2]=-1,n[($t=xe)>>2]=-1530992060,n[$t+4>>2]=-1,n[($t=Ie)>>2]=1272893353,n[$t+4>>2]=0,n[($t=Ee)>>2]=-155497632,n[$t+4>>2]=-1,n[($t=De)>>2]=-1094730640,n[$t+4>>2]=-1,n[($t=we)>>2]=681279174,n[$t+4>>2]=0,n[($t=Ae)>>2]=-358537222,n[$t+4>>2]=-1,n[($t=qe)>>2]=-722521979,n[$t+4>>2]=-1,n[($t=Oe)>>2]=76029189,n[$t+4>>2]=0,n[($t=Le)>>2]=-640364487,n[$t+4>>2]=-1,n[($t=Ce)>>2]=-421815835,n[$t+4>>2]=-1,n[($t=Me)>>2]=530742520,n[$t+4>>2]=0,n[($t=Re)>>2]=-995338651,n[$t+4>>2]=-1,n[($t=Be)>>2]=-198630844,n[$t+4>>2]=-1,n[($t=Ne)>>2]=1126891415,n[$t+4>>2]=0,n[($t=Fe)>>2]=-1416354905,n[$t+4>>2]=-1,n[($t=Ue)>>2]=-57434055,n[$t+4>>2]=-1,n[($t=Ve)>>2]=1700485571,n[$t+4>>2]=0,n[($t=He)>>2]=-1894986606,n[$t+4>>2]=-1,n[($t=We)>>2]=-1051523,n[$t+4>>2]=-1,n[($t=je)>>2]=-2054922799,n[$t+4>>2]=-1,n[($t=Ge)>>2]=1873313359,n[$t+4>>2]=0,n[($t=ze)>>2]=-30611744,n[$t+4>>2]=-1,n[($t=Ke)>>2]=-1560198380,n[$t+4>>2]=-1,n[($t=Ye)>>2]=1309151649,n[$t+4>>2]=0,n[($t=Qe)>>2]=-145523070,n[$t+4>>2]=-1,n[($t=Je)>>2]=-1120210379,n[$t+4>>2]=-1,n[($t=Xe)>>2]=718787259,n[$t+4>>2]=0,n[($t=Ze)>>2]=-343485551,n[$t+4>>2]=-1,Et=$e,Dt=136,wt=tt,At=0,qt=1732584193,Ot=-271733879,Lt=-1732584194,Ct=271733878,Mt=1732584193,Rt=0,Bt=0,Nt=0,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=1,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 26:if(_qdb("0x13d")!==_qdb("0x3b1")){Et=$e,Dt=(0|pt)>0?25:24,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}output+=String[_qdb("0x50")](chr2);case-117:if(_qdb("0x517")==_qdb("0x517")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}fe=h,pe=P;case 25:if(_qdb("0x445")!==_qdb("0x6")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}p=h&~(1<<b),n[3]=p,o=p;case 24:if(_qdb("0x1f2")==_qdb("0x1f2")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt+-1-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}K=value;case-119:if(_qdb("0x356")==_qdb("0x356")){Et=$e,Dt=(0|kt)==(14|($t=ct+40|0)>>6<<4)?135:133,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}0===stack&&(stack=bh()),cArgs[p]=converter(args[p]);case 23:if(_qdb("0x547")==_qdb("0x547")){Et=$e,Dt=(0|kt)==(0|it)?22:19,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}n[M+16>>2]=p,n[p+24>>2]=M;case-120:if(_qdb("0x4cb")!==_qdb("0x345")){Et=$e,Dt=134,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt+1|0,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=dt,Xt=St;break}o+=40069;case 22:if(_qdb("0x540")!==_qdb("0x605")){Et=$e,Dt=(0|pt)>0?21:19,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}this[_qdb("0x56b")]=_qdb("0x5eb"),this[_qdb("0x246")]=_qdb("0x52a")+status+")",this[_qdb("0xe4")]=status;case-121:if(_qdb("0x576")===_qdb("0x4cf")){var Si=b1(url);if(Si)return Si;throw B}Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=256+(ct<<3)|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 21:if(_qdb("0x249")==_qdb("0x249")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}throw toThrow;case-122:if(_qdb("0x493")===_qdb("0x194")){for(var Pi=[],xi=0;xi<array[_qdb("0x43c")];xi++){var Ii=array[xi];Ii>255&&(aX&&T(!1,_qdb("0x32")+Ii+" ("+String[_qdb("0x50")](Ii)+_qdb("0x146")+xi+_qdb("0x408")),Ii&=255),Pi[_qdb("0x60f")](String[_qdb("0x50")](Ii))}return Pi[_qdb("0x115")]("")}Et=$e,Dt=0==(0|a[e+Tt>>0])?128:130,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case-123:if(_qdb("0x3e")!==_qdb("0x243")){Et=$e,Dt=(0|kt)>(it+1|0)?131:129,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}Re=me,Be=be;case 19:if(_qdb("0x292")===_qdb("0x312"))return type===_qdb("0x3fe");Et=$e,Dt=(0|kt)>(it+1|0)?18:17,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 18:if(_qdb("0x4fc")==_qdb("0x4fc")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}if(200==xhr[_qdb("0xe4")]||0==xhr[_qdb("0xe4")]&&xhr[_qdb("0x382")])return void onload(xhr[_qdb("0x382")]);var Ei=b1(url);if(Ei)return void onload(Ei[_qdb("0x4a0")]);onerror();case-125:if(_qdb("0x3ec")==_qdb("0x3ec")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}var Di=ac[aj>>2],wi=Di+size+15&-16;return wi>aT()&&aI(),ac[aj>>2]=wi,Di;case 17:if(_qdb("0x394")==_qdb("0x394")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}if(obj[_qdb("0x528")](prop))return!1;case-126:if(_qdb("0x611")==_qdb("0x611")){Et=$e,Dt=136,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct+1|0,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-7597;case 16:if(_qdb("0x92")==_qdb("0x92")){Et=$e,Dt=(0|kt)==(14|($t=ct+40|0)>>6<<4)?15:14,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=62503;case-127:if(_qdb("0x121")!==_qdb("0x56f")){Et=$e,Dt=127,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}var Ai=y(aJ);a9[_qdb("0x17a")](Ai,N);case 15:if(_qdb("0xd8")!==_qdb("0x41d")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=256+(ct<<3)|0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}return f=e,0|(D=0);case-128:if(_qdb("0x19e")==_qdb("0x19e")){Et=$e,Dt=126,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=ct>>2,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}l[m]=k[m];case 14:if(_qdb("0x303")!==_qdb("0x3a7")){Et=$e,Dt=(0|kt)>(it+1|0)?13:12,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=-17253;case 127:if(_qdb("0x14c")!=_qdb("0x14c"))return n[(0|H())>>2]=48,0|(c=-1);ti=ot>>1,It=0|I(0|n[($t=s+(ut<<3)|0)>>2],0|n[$t+4>>2],0|S(0|ti,((0|ti)<0)<<31>>31|0,1),0|o()),o(),Et=$e,Dt=125,wt=tt,At=((ti=(1&ot)+It|0)+(-2&yt)&-2|1&yt)+(1&ti)|0,qt=st,Ot=nt,Lt=nt,Ct=rt,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=ti,Jt=Tt,Xt=St;break;case 13:if(_qdb("0x380")!==_qdb("0x4e2")){Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break}o+=33580;case 126:Et=$e,Dt=(0|ct)<6?124:122,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 12:Et=$e,Dt=11,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[St+(kt<<2)>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 125:Et=$e,Dt=(0|(0|ut)%4)<2?123:121,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 11:It=ot>>1,$t=0|I(0|n[(ti=s+(ut<<3)|0)>>2],0|n[ti+4>>2],0|S(0|It,((0|It)<0)<<31>>31|0,1),0|o()),o(),Et=$e,Dt=31,wt=tt,At=$t=((It=(1&ot)+$t|0)+(-2&yt)&-2|1&yt)+(1&It)|0,qt=st,Ot=((ti=$t<<(ei=(ti=5*((0|ut)%4|0)|0)+7|0)|((Zt=25-ti|0)?$t>>>Zt:$t))+(-2&nt)&-2|1&nt)+(1&ti)|0,Lt=nt,Ct=rt,Mt=ti,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=ei,Kt=bt,Yt=yt,Qt=It,Jt=Tt,Xt=St;break;case 123:Et=$e,Dt=119,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=4,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 9:Et=$e,Dt=(0|ut)<32?7:154,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 122:Et=$e,Dt=120,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=pt+1|0,Qt=kt,Jt=Tt,Xt=St;break;case 121:Et=$e,Dt=119,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=2,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 7:Et=$e,Dt=6,wt=tt,At=(ei=ct+-1|0)>>2,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=It=st&nt|rt&~st,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=(It+(-2&at)&-2|1&at)+(1&It)|0,Qt=dt+((1+(5*ut|0)|0)%16|0)|0,Jt=Tt,Xt=St;break;case 120:Et=$e,Dt=(0|yt)<33?118:116,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 6:Et=$e,Dt=(0|kt)>((It=ct+32|0)>>2|0)?161:5,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 119:Et=$e,Dt=154,wt=tt,At=it,qt=at,Ot=((ti=((ei=32-(It=(7*((0|ut)%4|0)|0)+vt|0)|0)?it>>>ei:it)|it<<It)+(-2&rt)&-2|1&rt)+(1&ti)|0,Lt=rt,Ct=st,Mt=ti,Rt=dt,Bt=ut+1|0,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=It,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 5:Et=$e,Dt=(0|kt)>(0|it)?4:1,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 118:Et=$e,Dt=116,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=33,Qt=kt,Jt=Tt,Xt=St;break;case 4:Et=$e,Dt=(0|pt)>0?3:2,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 3:Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 116:Et=$e,Dt=(0|yt)>(8+((It=ct+32|0)>>2)|0)?112:114,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 2:Et=$e,Dt=156,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=0|n[n[w+(kt+-1-it<<2)>>2]>>2],Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 115:Et=$e,Dt=(0|ut)<64?111:73,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 1:Et=$e,Dt=(0|kt)==(0|it)?0:164,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;case 114:Et=$e,Dt=112,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=8+((It=ct+32|0)>>2)|0,Qt=kt,Jt=Tt,Xt=St;break;case 0:Et=$e,Dt=(0|pt)>0?166:164,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St;break;default:Et=$e,Dt=et,wt=tt,At=it,qt=at,Ot=nt,Lt=rt,Ct=st,Mt=ot,Rt=dt,Bt=ut,Nt=ct,Ft=lt,Ut=ht,Vt=_t,Ht=ft,Wt=pt,jt=gt,Gt=mt,zt=vt,Kt=bt,Yt=yt,Qt=kt,Jt=Tt,Xt=St}$e=Et,et=Dt,tt=wt,it=At,at=qt,nt=Ot,rt=Lt,st=Ct,ot=Mt,dt=Rt,ut=Bt,ct=Nt,lt=Ft,ht=Ut,_t=Vt,ft=Ht,pt=Wt,gt=jt,mt=Gt,vt=zt,bt=Kt,yt=Yt,kt=Qt,Tt=Jt,St=Xt}return 140==(0|xt)?(f=t,0|Pt):(f=t,0|(Pt=gt))}function g(e){e|=0;var t,i=0,a=0,r=0,s=0,o=0,d=0,u=0,c=0,l=0,h=0,_=0,p=0,g=0,m=0,v=0,y=0,k=0,T=0,S=0,P=0,x=0,I=0,E=0,D=0,w=0,A=0,q=0,O=0,L=0,C=0,M=0,R=0,B=0,N=0,F=0,U=0,V=0,H=0,W=0,j=0,G=0,z=0,K=0,Y=0,Q=0,J=0,X=0,Z=0,$=0,ee=0,te=0,ie=0,ae=0,ne=0,re=0,se=0,oe=0,de=0,ue=0,ce=0,le=0,he=0,_e=0,fe=0,pe=0,ge=0,me=0,ve=0,be=0,ye=0,ke=0,Te=0,Se=0,Pe=0,xe=0,Ie=0,Ee=0,De=0,we=0,Ae=0,qe=0,Oe=0,Le=0,Ce=0,Me=0;t=f,f=f+16|0,i=t;do{if(e>>>0<245){if(r=(a=e>>>0<11?16:e+11&-8)>>>3,s=0|n[3],3&(o=r?s>>>r:s)|0)return l=0|n[(c=(u=52+((d=(1&o^1)+r|0)<<1<<2)|0)+8|0)>>2],(0|(_=0|n[(h=l+8|0)>>2]))==(0|u)?n[3]=s&~(1<<d):(n[_+12>>2]=u,n[c>>2]=_),_=d<<3,n[l+4>>2]=3|_,n[(d=l+_+4|0)>>2]=1|n[d>>2],f=t,0|h;if(a>>>0>(h=0|n[5])>>>0){if(0|o)return o=0|n[(l=(c=52+((u=((d=(r=(_=(d=((_=o<<r&((d=2<<r)|0-d))&0-_)-1|0)>>>12&16)?d>>>_:d)>>>5&8)|_|(r=(o=d?r>>>d:r)>>>2&4)|(o=(l=r?o>>>r:o)>>>1&2)|(l=(c=o?l>>>o:l)>>>1&1))+(l?c>>>l:c)|0)<<1<<2)|0)+8|0)>>2],(0|(_=0|n[(r=o+8|0)>>2]))==(0|c)?(d=s&~(1<<u),n[3]=d,p=d):(n[_+12>>2]=c,n[l>>2]=_,p=s),u=(_=u<<3)-a|0,n[o+4>>2]=3|a,n[(l=o+a|0)+4>>2]=1|u,n[o+_>>2]=u,0|h&&(_=0|n[8],c=52+((o=h>>>3)<<1<<2)|0,p&(d=1<<o)?(g=d=c+8|0,m=0|n[d>>2]):(n[3]=p|d,g=c+8|0,m=c),n[g>>2]=_,n[m+12>>2]=_,n[_+8>>2]=m,n[_+12>>2]=c),n[5]=u,n[8]=l,f=t,0|r;if(r=0|n[4]){for(v=0|n[316+(((l=(c=(u=(l=(r&0-r)-1|0)>>>12&16)?l>>>u:l)>>>5&8)|u|(c=(_=l?c>>>l:c)>>>2&4)|(_=(d=c?_>>>c:_)>>>1&2)|(d=(o=_?d>>>_:d)>>>1&1))+(d?o>>>d:o)<<2)>>2],o=(-8&n[v+4>>2])-a|0,d=v,_=v;;){if(v=0|n[d+16>>2])y=v;else{if(!(c=0|n[d+20>>2]))break;y=c}o=(c=(v=(-8&n[y+4>>2])-a|0)>>>0<o>>>0)?v:o,d=y,_=c?y:_}if((d=_+a|0)>>>0>_>>>0){c=0|n[_+24>>2],v=0|n[_+12>>2];do{if((0|v)==(0|_)){if(l=0|n[(u=_+20|0)>>2])P=l,x=u;else{if(!(T=0|n[(k=_+16|0)>>2])){S=0;break}P=T,x=k}for(u=P,l=x;;){if(T=0|n[(k=u+20|0)>>2])D=T,w=k;else{if(!(E=0|n[(I=u+16|0)>>2]))break;D=E,w=I}u=D,l=w}n[l>>2]=0,S=u}else k=0|n[_+8>>2],n[k+12>>2]=v,n[v+8>>2]=k,S=v}while(0);do{if(0|c){if(v=0|n[_+28>>2],(0|_)==(0|n[(k=316+(v<<2)|0)>>2])){if(n[k>>2]=S,!S){n[4]=r&~(1<<v);break}}else if(n[((0|n[(v=c+16|0)>>2])==(0|_)?v:c+20|0)>>2]=S,!S)break;n[S+24>>2]=c,0|(v=0|n[_+16>>2])&&(n[S+16>>2]=v,n[v+24>>2]=S),0|(v=0|n[_+20>>2])&&(n[S+20>>2]=v,n[v+24>>2]=S)}}while(0);return o>>>0<16?(c=o+a|0,n[_+4>>2]=3|c,n[(r=_+c+4|0)>>2]=1|n[r>>2]):(n[_+4>>2]=3|a,n[d+4>>2]=1|o,n[d+o>>2]=o,0|h&&(r=0|n[8],v=52+((c=h>>>3)<<1<<2)|0,(k=1<<c)&s?(A=k=v+8|0,q=0|n[k>>2]):(n[3]=k|s,A=v+8|0,q=v),n[A>>2]=r,n[q+12>>2]=r,n[r+8>>2]=q,n[r+12>>2]=v),n[5]=o,n[8]=d),f=t,0|(_+8|0)}O=a}else O=a}else O=a}else if(e>>>0<=4294967231)if(r=-8&(v=e+11|0),k=0|n[4]){c=0-r|0,L=(T=v>>>8)?r>>>0>16777215?31:1&((v=(T=14-((E=(T=(v=T<<(I=(v=T+1048320|0)>>>16&8))+520192|0)>>>16&4)|I|(C=(v=(T=v<<E)+245760|0)>>>16&2))+((v=T<<C)>>>15)|0)+7|0)?r>>>v:r)|T<<1:0,T=0|n[316+(L<<2)>>2];e:do{if(T)for(v=c,C=0,I=r<<(31==(0|L)?0:25-(L>>>1)|0),E=T,F=0;;){if((U=(-8&n[E+4>>2])-r|0)>>>0<v>>>0){if(!U){V=0,H=E,W=E,N=65;break e}j=U,G=E}else j=v,G=F;if(z=0==(0|(U=0|n[E+20>>2]))|(0|U)==(0|(E=0|n[E+16+(I>>>31<<2)>>2]))?C:U,!E){M=j,R=z,B=G,N=61;break}v=j,C=z,I<<=1,F=G}else M=c,R=0,B=0,N=61}while(0);if(61==(0|N)){if(0==(0|R)&0==(0|B)){if(!(c=((T=2<<L)|0-T)&k)){O=r;break}K=0|n[316+(((T=(a=(c=(T=(c&0-c)-1|0)>>>12&16)?T>>>c:T)>>>5&8)|c|(a=(_=T?a>>>T:a)>>>2&4)|(_=(d=a?_>>>a:_)>>>1&2)|(d=(o=_?d>>>_:d)>>>1&1))+(d?o>>>d:o)<<2)>>2],Y=0}else K=R,Y=B;K?(V=M,H=K,W=Y,N=65):(Q=M,J=Y)}if(65==(0|N))for(o=V,d=H,_=W;;){if(T=(c=(a=(-8&n[d+4>>2])-r|0)>>>0<o>>>0)?a:o,a=c?d:_,!(X=(c=0|n[d+16>>2])||0|n[d+20>>2])){Q=T,J=a;break}o=T,d=X,_=a}if(0!=(0|J)&&Q>>>0<((0|n[5])-r|0)>>>0&&(_=J+r|0)>>>0>J>>>0){d=0|n[J+24>>2],o=0|n[J+12>>2];do{if((0|o)==(0|J)){if(T=0|n[(a=J+20|0)>>2])$=T,ee=a;else{if(!(s=0|n[(c=J+16|0)>>2])){Z=0;break}$=s,ee=c}for(a=$,T=ee;;){if(s=0|n[(c=a+20|0)>>2])te=s,ie=c;else{if(!(F=0|n[(h=a+16|0)>>2]))break;te=F,ie=h}a=te,T=ie}n[T>>2]=0,Z=a}else c=0|n[J+8>>2],n[c+12>>2]=o,n[o+8>>2]=c,Z=o}while(0);do{if(d){if(o=0|n[J+28>>2],(0|J)==(0|n[(c=316+(o<<2)|0)>>2])){if(n[c>>2]=Z,!Z){c=k&~(1<<o),n[4]=c,ae=c;break}}else if(n[((0|n[(c=d+16|0)>>2])==(0|J)?c:d+20|0)>>2]=Z,!Z){ae=k;break}n[Z+24>>2]=d,0|(c=0|n[J+16>>2])&&(n[Z+16>>2]=c,n[c+24>>2]=Z),(c=0|n[J+20>>2])?(n[Z+20>>2]=c,n[c+24>>2]=Z,ae=k):ae=k}else ae=k}while(0);e:do{if(Q>>>0<16)k=Q+r|0,n[J+4>>2]=3|k,n[(d=J+k+4|0)>>2]=1|n[d>>2];else{if(n[J+4>>2]=3|r,n[_+4>>2]=1|Q,n[_+Q>>2]=Q,d=Q>>>3,Q>>>0<256){k=52+(d<<1<<2)|0,(c=0|n[3])&(o=1<<d)?(ne=o=k+8|0,re=0|n[o>>2]):(n[3]=c|o,ne=k+8|0,re=k),n[ne>>2]=_,n[re+12>>2]=_,n[_+8>>2]=re,n[_+12>>2]=k;break}if(se=(k=Q>>>8)?Q>>>0>16777215?31:1&((o=(k=14-((d=(k=(o=k<<(c=(o=k+1048320|0)>>>16&8))+520192|0)>>>16&4)|c|(s=(o=(k=o<<d)+245760|0)>>>16&2))+((o=k<<s)>>>15)|0)+7|0)?Q>>>o:Q)|k<<1:0,k=316+(se<<2)|0,n[_+28>>2]=se,n[(o=_+16|0)+4>>2]=0,n[o>>2]=0,!(ae&(o=1<<se))){n[4]=ae|o,n[k>>2]=_,n[_+24>>2]=k,n[_+12>>2]=_,n[_+8>>2]=_;break}o=0|n[k>>2];t:do{if((-8&n[o+4>>2]|0)!=(0|Q)){for(k=Q<<(31==(0|se)?0:25-(se>>>1)|0),s=o;c=0|n[(de=s+16+(k>>>31<<2)|0)>>2];){if((-8&n[c+4>>2]|0)==(0|Q)){oe=c;break t}k<<=1,s=c}n[de>>2]=_,n[_+24>>2]=s,n[_+12>>2]=_,n[_+8>>2]=_;break e}oe=o}while(0);a=0|n[(o=oe+8|0)>>2],n[a+12>>2]=_,n[o>>2]=_,n[_+8>>2]=a,n[_+12>>2]=oe,n[_+24>>2]=0}}while(0);return f=t,0|(J+8|0)}O=r}else O=r;else O=-1}while(0);if((J=0|n[5])>>>0>=O>>>0)return oe=J-O|0,de=0|n[8],oe>>>0>15?(Q=de+O|0,n[8]=Q,n[5]=oe,n[Q+4>>2]=1|oe,n[de+J>>2]=oe,n[de+4>>2]=3|O):(n[5]=0,n[8]=0,n[de+4>>2]=3|J,n[(oe=de+J+4|0)>>2]=1|n[oe>>2]),f=t,0|(de+8|0);if((de=0|n[6])>>>0>O>>>0)return oe=de-O|0,n[6]=oe,Q=(J=0|n[9])+O|0,n[9]=Q,n[Q+4>>2]=1|oe,n[J+4>>2]=3|O,f=t,0|(J+8|0);if(0|n[121]?ue=0|n[123]:(n[123]=4096,n[122]=4096,n[124]=-1,n[125]=-1,n[126]=0,n[114]=0,n[121]=-16&i^1431655768,ue=4096),i=O+48|0,(ue=(oe=ue+(J=O+47|0)|0)&(Q=0-ue|0))>>>0<=O>>>0)return f=t,0|0;if(0|(se=0|n[113])&&(re=(ae=0|n[111])+ue|0)>>>0<=ae>>>0|re>>>0>se>>>0)return f=t,0|0;e:do{if(4&n[114])pe=0,N=143;else{se=0|n[9];t:do{if(se){for(re=460;!((ae=0|n[re>>2])>>>0<=se>>>0&&(ae+(0|n[re+4>>2])|0)>>>0>se>>>0);){if(!(ae=0|n[re+8>>2])){N=128;break t}re=ae}if((ae=oe-de&Q)>>>0<2147483647)if((0|(ne=0|b(ae)))==((0|n[re>>2])+(0|n[re+4>>2])|0)){if(-1!=(0|ne)){le=ne,he=ae,N=145;break e}ce=ae}else _e=ne,fe=ae,N=136;else ce=0}else N=128}while(0);do{if(128==(0|N))if(-1!=(0|(se=0|b(0)))&&(r=se,ae=(Z=(0==((ne=(ae=0|n[122])+-1|0)&r|0)?0:(ne+r&0-ae)-r|0)+ue|0)+(r=0|n[111])|0,Z>>>0>O>>>0&Z>>>0<2147483647)){if(0|(ne=0|n[113])&&ae>>>0<=r>>>0|ae>>>0>ne>>>0){ce=0;break}if((0|(ne=0|b(Z)))==(0|se)){le=se,he=Z,N=145;break e}_e=ne,fe=Z,N=136}else ce=0}while(0);do{if(136==(0|N)){if(Z=0-fe|0,!(i>>>0>fe>>>0&fe>>>0<2147483647&-1!=(0|_e))){if(-1==(0|_e)){ce=0;break}le=_e,he=fe,N=145;break e}if((se=J-fe+(ne=0|n[123])&0-ne)>>>0>=2147483647){le=_e,he=fe,N=145;break e}if(-1==(0|b(se))){b(Z),ce=0;break}le=_e,he=se+fe|0,N=145;break e}}while(0);n[114]=4|n[114],pe=ce,N=143}}while(0);if(143==(0|N)&&ue>>>0<2147483647&&!(-1==(0|(ce=0|b(ue)))|1^(_e=(fe=(ue=0|b(0))-ce|0)>>>0>(O+40|0)>>>0)|ce>>>0<ue>>>0&-1!=(0|ce)&-1!=(0|ue)^1)&&(le=ce,he=_e?fe:pe,N=145),145==(0|N)){pe=(0|n[111])+he|0,n[111]=pe,pe>>>0>(0|n[112])>>>0&&(n[112]=pe),pe=0|n[9];e:do{if(pe){for(fe=460;;){if((0|le)==((ge=0|n[fe>>2])+(me=0|n[fe+4>>2])|0)){N=154;break}if(!(_e=0|n[fe+8>>2]))break;fe=_e}if(154==(0|N)&&(_e=fe+4|0,0==(8&n[fe+12>>2]|0))&&le>>>0>pe>>>0&ge>>>0<=pe>>>0){n[_e>>2]=me+he,ce=pe+(ue=0==(7&(ce=pe+8|0)|0)?0:0-ce&7)|0,J=(_e=(0|n[6])+he|0)-ue|0,n[9]=ce,n[6]=J,n[ce+4>>2]=1|J,n[pe+_e+4>>2]=40,n[10]=n[125];break}for(le>>>0<(0|n[7])>>>0&&(n[7]=le),_e=le+he|0,J=460;;){if((0|n[J>>2])==(0|_e)){N=162;break}if(!(ce=0|n[J+8>>2]))break;J=ce}if(162==(0|N)&&0==(8&n[J+12>>2]|0)){n[J>>2]=le,n[(fe=J+4|0)>>2]=(0|n[fe>>2])+he,ce=le+(0==(7&(fe=le+8|0)|0)?0:0-fe&7)|0,ue=_e+(0==(7&(fe=_e+8|0)|0)?0:0-fe&7)|0,fe=ce+O|0,i=ue-ce-O|0,n[ce+4>>2]=3|O;t:do{if((0|pe)==(0|ue))Q=(0|n[6])+i|0,n[6]=Q,n[9]=fe,n[fe+4>>2]=1|Q;else{if((0|n[8])==(0|ue)){Q=(0|n[5])+i|0,n[5]=Q,n[8]=fe,n[fe+4>>2]=1|Q,n[fe+Q>>2]=Q;break}if(1==(3&(Q=0|n[ue+4>>2])|0)){de=-8&Q,oe=Q>>>3;i:do{if(Q>>>0<256){if(se=0|n[ue+8>>2],(0|(Z=0|n[ue+12>>2]))==(0|se)){n[3]=n[3]&~(1<<oe);break}n[se+12>>2]=Z,n[Z+8>>2]=se;break}se=0|n[ue+24>>2],Z=0|n[ue+12>>2];do{if((0|Z)==(0|ue)){if(r=0|n[(ae=(ne=ue+16|0)+4|0)>>2])be=r,ye=ae;else{if(!(ie=0|n[ne>>2])){ve=0;break}be=ie,ye=ne}for(ae=be,r=ye;;){if(ie=0|n[(ne=ae+20|0)>>2])ke=ie,Te=ne;else{if(!(ee=0|n[(te=ae+16|0)>>2]))break;ke=ee,Te=te}ae=ke,r=Te}n[r>>2]=0,ve=ae}else ne=0|n[ue+8>>2],n[ne+12>>2]=Z,n[Z+8>>2]=ne,ve=Z}while(0);if(!se)break;s=316+((Z=0|n[ue+28>>2])<<2)|0;do{if((0|n[s>>2])==(0|ue)){if(n[s>>2]=ve,0|ve)break;n[4]=n[4]&~(1<<Z);break i}if(n[((0|n[(ne=se+16|0)>>2])==(0|ue)?ne:se+20|0)>>2]=ve,!ve)break i}while(0);if(n[ve+24>>2]=se,0|(s=0|n[(Z=ue+16|0)>>2])&&(n[ve+16>>2]=s,n[s+24>>2]=ve),!(s=0|n[Z+4>>2]))break;n[ve+20>>2]=s,n[s+24>>2]=ve}while(0);Se=ue+de|0,Pe=de+i|0}else Se=ue,Pe=i;if(n[(oe=Se+4|0)>>2]=-2&n[oe>>2],n[fe+4>>2]=1|Pe,n[fe+Pe>>2]=Pe,oe=Pe>>>3,Pe>>>0<256){Q=52+(oe<<1<<2)|0,(re=0|n[3])&(s=1<<oe)?(xe=s=Q+8|0,Ie=0|n[s>>2]):(n[3]=re|s,xe=Q+8|0,Ie=Q),n[xe>>2]=fe,n[Ie+12>>2]=fe,n[fe+8>>2]=Ie,n[fe+12>>2]=Q;break}Q=Pe>>>8;do{if(Q){if(Pe>>>0>16777215){Ee=31;break}Ee=1&((s=(oe=14-((Z=(oe=(s=Q<<(re=(s=Q+1048320|0)>>>16&8))+520192|0)>>>16&4)|re|(ne=(s=(oe=s<<Z)+245760|0)>>>16&2))+((s=oe<<ne)>>>15)|0)+7|0)?Pe>>>s:Pe)|oe<<1}else Ee=0}while(0);if(Q=316+(Ee<<2)|0,n[fe+28>>2]=Ee,n[(de=fe+16|0)+4>>2]=0,n[de>>2]=0,!((de=0|n[4])&(oe=1<<Ee))){n[4]=de|oe,n[Q>>2]=fe,n[fe+24>>2]=Q,n[fe+12>>2]=fe,n[fe+8>>2]=fe;break}oe=0|n[Q>>2];i:do{if((-8&n[oe+4>>2]|0)!=(0|Pe)){for(Q=Pe<<(31==(0|Ee)?0:25-(Ee>>>1)|0),de=oe;s=0|n[(we=de+16+(Q>>>31<<2)|0)>>2];){if((-8&n[s+4>>2]|0)==(0|Pe)){De=s;break i}Q<<=1,de=s}n[we>>2]=fe,n[fe+24>>2]=de,n[fe+12>>2]=fe,n[fe+8>>2]=fe;break t}De=oe}while(0);Q=0|n[(oe=De+8|0)>>2],n[Q+12>>2]=fe,n[oe>>2]=fe,n[fe+8>>2]=Q,n[fe+12>>2]=De,n[fe+24>>2]=0}}while(0);return f=t,0|(ce+8|0)}for(fe=460;!((i=0|n[fe>>2])>>>0<=pe>>>0&&(Ae=i+(0|n[fe+4>>2])|0)>>>0>pe>>>0);)fe=0|n[fe+8>>2];i=(fe=(i=(fe=Ae+-47|0)+(0==(7&(ce=fe+8|0)|0)?0:0-ce&7)|0)>>>0<(ce=pe+16|0)>>>0?pe:i)+8|0,_e=le+(J=0==(7&(_e=le+8|0)|0)?0:0-_e&7)|0,Q=(ue=he+-40|0)-J|0,n[9]=_e,n[6]=Q,n[_e+4>>2]=1|Q,n[le+ue+4>>2]=40,n[10]=n[125],n[(ue=fe+4|0)>>2]=27,n[i>>2]=n[115],n[i+4>>2]=n[116],n[i+8>>2]=n[117],n[i+12>>2]=n[118],n[115]=le,n[116]=he,n[118]=0,n[117]=i,i=fe+24|0;do{Q=i,n[(i=i+4|0)>>2]=7}while((Q+8|0)>>>0<Ae>>>0);if((0|fe)!=(0|pe)){if(i=fe-pe|0,n[ue>>2]=-2&n[ue>>2],n[pe+4>>2]=1|i,n[fe>>2]=i,Q=i>>>3,i>>>0<256){_e=52+(Q<<1<<2)|0,(J=0|n[3])&(oe=1<<Q)?(qe=oe=_e+8|0,Oe=0|n[oe>>2]):(n[3]=J|oe,qe=_e+8|0,Oe=_e),n[qe>>2]=pe,n[Oe+12>>2]=pe,n[pe+8>>2]=Oe,n[pe+12>>2]=_e;break}if(Le=(_e=i>>>8)?i>>>0>16777215?31:1&((oe=(_e=14-((Q=(_e=(oe=_e<<(J=(oe=_e+1048320|0)>>>16&8))+520192|0)>>>16&4)|J|(se=(oe=(_e=oe<<Q)+245760|0)>>>16&2))+((oe=_e<<se)>>>15)|0)+7|0)?i>>>oe:i)|_e<<1:0,_e=316+(Le<<2)|0,n[pe+28>>2]=Le,n[pe+20>>2]=0,n[ce>>2]=0,!((oe=0|n[4])&(se=1<<Le))){n[4]=oe|se,n[_e>>2]=pe,n[pe+24>>2]=_e,n[pe+12>>2]=pe,n[pe+8>>2]=pe;break}se=0|n[_e>>2];t:do{if((-8&n[se+4>>2]|0)!=(0|i)){for(_e=i<<(31==(0|Le)?0:25-(Le>>>1)|0),oe=se;J=0|n[(Me=oe+16+(_e>>>31<<2)|0)>>2];){if((-8&n[J+4>>2]|0)==(0|i)){Ce=J;break t}_e<<=1,oe=J}n[Me>>2]=pe,n[pe+24>>2]=oe,n[pe+12>>2]=pe,n[pe+8>>2]=pe;break e}Ce=se}while(0);se=0|n[(i=Ce+8|0)>>2],n[se+12>>2]=pe,n[i>>2]=pe,n[pe+8>>2]=se,n[pe+12>>2]=Ce,n[pe+24>>2]=0}}else 0==(0|(se=0|n[7]))|le>>>0<se>>>0&&(n[7]=le),n[115]=le,n[116]=he,n[118]=0,n[12]=n[121],n[11]=-1,n[16]=52,n[15]=52,n[18]=60,n[17]=60,n[20]=68,n[19]=68,n[22]=76,n[21]=76,n[24]=84,n[23]=84,n[26]=92,n[25]=92,n[28]=100,n[27]=100,n[30]=108,n[29]=108,n[32]=116,n[31]=116,n[34]=124,n[33]=124,n[36]=132,n[35]=132,n[38]=140,n[37]=140,n[40]=148,n[39]=148,n[42]=156,n[41]=156,n[44]=164,n[43]=164,n[46]=172,n[45]=172,n[48]=180,n[47]=180,n[50]=188,n[49]=188,n[52]=196,n[51]=196,n[54]=204,n[53]=204,n[56]=212,n[55]=212,n[58]=220,n[57]=220,n[60]=228,n[59]=228,n[62]=236,n[61]=236,n[64]=244,n[63]=244,n[66]=252,n[65]=252,n[68]=260,n[67]=260,n[70]=268,n[69]=268,n[72]=276,n[71]=276,n[74]=284,n[73]=284,n[76]=292,n[75]=292,n[78]=300,n[77]=300,i=le+(ce=0==(7&(i=le+8|0)|0)?0:0-i&7)|0,fe=(se=he+-40|0)-ce|0,n[9]=i,n[6]=fe,n[i+4>>2]=1|fe,n[le+se+4>>2]=40,n[10]=n[125]}while(0);if((le=0|n[6])>>>0>O>>>0)return he=le-O|0,n[6]=he,pe=(le=0|n[9])+O|0,n[9]=pe,n[pe+4>>2]=1|he,n[le+4>>2]=3|O,f=t,0|(le+8|0)}return n[2]=48,f=t,0|0}function v(e){var t,i=0,a=0,r=0,s=0,o=0,d=0,u=0,c=0,l=0,h=0,_=0,f=0,p=0,g=0,m=0,v=0,b=0,y=0,k=0,T=0,S=0,P=0,x=0,I=0,E=0,D=0,w=0,A=0,q=0,O=0,L=0,C=0;if(e|=0){i=e+-8|0,a=0|n[7],t=i+(e=-8&(r=0|n[e+-4>>2]))|0;do{if(1&r)l=i,h=i,_=e;else{if(s=0|n[i>>2],!(3&r))return;if(d=s+e|0,(o=i+(0-s)|0)>>>0<a>>>0)return;if((0|n[8])==(0|o)){if(3!=(3&(c=0|n[(u=t+4|0)>>2])|0)){l=o,h=o,_=d;break}return n[5]=d,n[u>>2]=-2&c,n[o+4>>2]=1|d,void(n[o+d>>2]=d)}if(c=s>>>3,s>>>0<256){if(s=0|n[o+8>>2],(0|(u=0|n[o+12>>2]))==(0|s)){n[3]=n[3]&~(1<<c),l=o,h=o,_=d;break}n[s+12>>2]=u,n[u+8>>2]=s,l=o,h=o,_=d;break}s=0|n[o+24>>2],u=0|n[o+12>>2];do{if((0|u)==(0|o)){if(p=0|n[(f=(c=o+16|0)+4|0)>>2])v=p,b=f;else{if(!(g=0|n[c>>2])){m=0;break}v=g,b=c}for(f=v,p=b;;){if(g=0|n[(c=f+20|0)>>2])T=g,S=c;else{if(!(k=0|n[(y=f+16|0)>>2]))break;T=k,S=y}f=T,p=S}n[p>>2]=0,m=f}else c=0|n[o+8>>2],n[c+12>>2]=u,n[u+8>>2]=c,m=u}while(0);if(s){if(u=0|n[o+28>>2],(0|n[(c=316+(u<<2)|0)>>2])==(0|o)){if(n[c>>2]=m,!m){n[4]=n[4]&~(1<<u),l=o,h=o,_=d;break}}else if(n[((0|n[(u=s+16|0)>>2])==(0|o)?u:s+20|0)>>2]=m,!m){l=o,h=o,_=d;break}n[m+24>>2]=s,0|(c=0|n[(u=o+16|0)>>2])&&(n[m+16>>2]=c,n[c+24>>2]=m),(c=0|n[u+4>>2])?(n[m+20>>2]=c,n[c+24>>2]=m,l=o,h=o,_=d):(l=o,h=o,_=d)}else l=o,h=o,_=d}}while(0);if(!(l>>>0>=t>>>0)&&1&(i=0|n[(e=t+4|0)>>2])){if(2&i)n[e>>2]=-2&i,n[h+4>>2]=1|_,n[l+_>>2]=_,w=_;else{if((0|n[9])==(0|t)){if(m=(0|n[6])+_|0,n[6]=m,n[9]=h,n[h+4>>2]=1|m,(0|h)!=(0|n[8]))return;return n[8]=0,void(n[5]=0)}if((0|n[8])==(0|t))return m=(0|n[5])+_|0,n[5]=m,n[8]=l,n[h+4>>2]=1|m,void(n[l+m>>2]=m);m=(-8&i)+_|0,S=i>>>3;do{if(i>>>0<256){if(T=0|n[t+8>>2],(0|(b=0|n[t+12>>2]))==(0|T)){n[3]=n[3]&~(1<<S);break}n[T+12>>2]=b,n[b+8>>2]=T;break}T=0|n[t+24>>2],b=0|n[t+12>>2];do{if((0|b)==(0|t)){if(r=0|n[(a=(v=t+16|0)+4|0)>>2])x=r,I=a;else{if(!(c=0|n[v>>2])){P=0;break}x=c,I=v}for(a=x,r=I;;){if(c=0|n[(v=a+20|0)>>2])E=c,D=v;else{if(!(g=0|n[(u=a+16|0)>>2]))break;E=g,D=u}a=E,r=D}n[r>>2]=0,P=a}else f=0|n[t+8>>2],n[f+12>>2]=b,n[b+8>>2]=f,P=b}while(0);if(0|T){if(b=0|n[t+28>>2],(0|n[(d=316+(b<<2)|0)>>2])==(0|t)){if(n[d>>2]=P,!P){n[4]=n[4]&~(1<<b);break}}else if(n[((0|n[(b=T+16|0)>>2])==(0|t)?b:T+20|0)>>2]=P,!P)break;n[P+24>>2]=T,0|(d=0|n[(b=t+16|0)>>2])&&(n[P+16>>2]=d,n[d+24>>2]=P),0|(d=0|n[b+4>>2])&&(n[P+20>>2]=d,n[d+24>>2]=P)}}while(0);if(n[h+4>>2]=1|m,n[l+m>>2]=m,(0|h)==(0|n[8]))return void(n[5]=m);w=m}if(_=w>>>3,w>>>0<256)return l=52+(_<<1<<2)|0,(i=0|n[3])&(e=1<<_)?(A=e=l+8|0,q=0|n[e>>2]):(n[3]=i|e,A=l+8|0,q=l),n[A>>2]=h,n[q+12>>2]=h,n[h+8>>2]=q,void(n[h+12>>2]=l);O=(l=w>>>8)?w>>>0>16777215?31:1&((q=(l=14-((e=(l=(q=l<<(A=(q=l+1048320|0)>>>16&8))+520192|0)>>>16&4)|A|(i=(q=(l=q<<e)+245760|0)>>>16&2))+((q=l<<i)>>>15)|0)+7|0)?w>>>q:w)|l<<1:0,l=316+(O<<2)|0,n[h+28>>2]=O,n[h+20>>2]=0,n[h+16>>2]=0,q=0|n[4],i=1<<O;e:do{if(q&i){A=0|n[l>>2];t:do{if((-8&n[A+4>>2]|0)!=(0|w)){for(e=w<<(31==(0|O)?0:25-(O>>>1)|0),_=A;m=0|n[(C=_+16+(e>>>31<<2)|0)>>2];){if((-8&n[m+4>>2]|0)==(0|w)){L=m;break t}e<<=1,_=m}n[C>>2]=h,n[h+24>>2]=_,n[h+12>>2]=h,n[h+8>>2]=h;break e}L=A}while(0);T=0|n[(A=L+8|0)>>2],n[T+12>>2]=h,n[A>>2]=h,n[h+8>>2]=T,n[h+12>>2]=L,n[h+24>>2]=0}else n[4]=q|i,n[l>>2]=h,n[h+24>>2]=l,n[h+12>>2]=h,n[h+8>>2]=h}while(0);if(h=(0|n[11])-1|0,n[11]=h,!(0|h)){for(h=468;L=0|n[h>>2];)h=L+8|0;n[11]=-1}}}}function b(e){e|=0;var t,i;return 528,(i=(t=0|n[132])+(e+3&-4)|0)>>>0>(0|c())>>>0&&0==(0|_(0|i))?(n[2]=48,0|-1):(n[132]=i,0|t)}function S(e,t,i){return e|=0,t|=0,(0|(i|=0))<32?(s(t<<i|(e&(1<<i)-1<<32-i)>>>32-i|0),e<<i):(s(e<<i-32|0),0)}function P(){return 528}function I(e,t,i,a){var n;return 0|(s((t|=0)+(a|=0)+((n=(e|=0)+(i|=0)>>>0)>>>0<e>>>0|0)>>>0|0),0|n)}var E={};return E[_qdb("0x12e")]=S,E[_qdb("0x5c2")]=p,E[_qdb("0xa5")]=P,E[_qdb("0x4c9")]=v,E[_qdb("0x2db")]=I,E[_qdb("0x370")]=g,E[_qdb("0x479")]=function(e,t,i){e|=0,t|=0;var r,s,o=0;if((0|(i|=0))>=512)return h(0|e,0|t,0|i),0|e;if(r=0|e,s=e+i|0,(3&e)==(3&t)){for(;3&e;){if(!i)return 0|r;a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0,i=i-1|0}for(i=(o=-4&s|0)-64|0;(0|e)<=(0|i);)n[e>>2]=n[t>>2],n[e+4>>2]=n[t+4>>2],n[e+8>>2]=n[t+8>>2],n[e+12>>2]=n[t+12>>2],n[e+16>>2]=n[t+16>>2],n[e+20>>2]=n[t+20>>2],n[e+24>>2]=n[t+24>>2],n[e+28>>2]=n[t+28>>2],n[e+32>>2]=n[t+32>>2],n[e+36>>2]=n[t+36>>2],n[e+40>>2]=n[t+40>>2],n[e+44>>2]=n[t+44>>2],n[e+48>>2]=n[t+48>>2],n[e+52>>2]=n[t+52>>2],n[e+56>>2]=n[t+56>>2],n[e+60>>2]=n[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|o);)n[e>>2]=n[t>>2],e=e+4|0,t=t+4|0}else for(o=s-4|0;(0|e)<(0|o);)a[e>>0]=0|a[t>>0],a[e+1>>0]=0|a[t+1>>0],a[e+2>>0]=0|a[t+2>>0],a[e+3>>0]=0|a[t+3>>0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|s);)a[e>>0]=0|a[t>>0],e=e+1|0,t=t+1|0;return 0|r},E[_qdb("0x561")]=function(e,t,i){t|=0;var r,s=0,o=0,d=0;if(r=(e|=0)+(i|=0)|0,t&=255,(0|i)>=67){for(;3&e;)a[e>>0]=t,e=e+1|0;for(o=t|t<<8|t<<16|t<<24,d=(s=-4&r|0)-64|0;(0|e)<=(0|d);)n[e>>2]=o,n[e+4>>2]=o,n[e+8>>2]=o,n[e+12>>2]=o,n[e+16>>2]=o,n[e+20>>2]=o,n[e+24>>2]=o,n[e+28>>2]=o,n[e+32>>2]=o,n[e+36>>2]=o,n[e+40>>2]=o,n[e+44>>2]=o,n[e+48>>2]=o,n[e+52>>2]=o,n[e+56>>2]=o,n[e+60>>2]=o,e=e+64|0;for(;(0|e)<(0|s);)n[e>>2]=o,e=e+4|0}for(;(0|e)<(0|r);)a[e>>0]=t,e=e+1|0;return r-i|0},E[_qdb("0x4b9")]=function(e){var t;if(_qdb("0x342")!==_qdb("0x433"))return t=f,f=(f=f+(e|=0)|0)+15&-16,0|t;i=buf,k[_qdb("0x54e")]=a8=new Int8Array(buf),k[_qdb("0x1a2")]=aa=new Int16Array(buf),k[_qdb("0x4e5")]=ac=new Int32Array(buf),k[_qdb("0x19")]=a9=new Uint8Array(buf),k[_qdb("0x47")]=ab=new Uint16Array(buf),k[_qdb("0x581")]=ad=new Uint32Array(buf),k[_qdb("0x1db")]=ae=new Float32Array(buf),k[_qdb("0x518")]=af=new Float64Array(buf)},E[_qdb("0x21c")]=function(e){_qdb("0x9e")!==_qdb("0x566")?f=e|=0:(ba=0,p=0)},E[_qdb("0x498")]=function(){if(_qdb("0x1a8")!==_qdb("0xe9"))return 0|f;x(aJ,bj,(function(){throw _qdb("0x2eb")+aJ}))},E}(b3,b5,a7),b7=k[_qdb("0x12e")]=b6[_qdb("0x12e")],b8=k[_qdb("0x5c2")]=b6[_qdb("0x5c2")],b9=k[_qdb("0xa5")]=b6[_qdb("0xa5")],ba=k[_qdb("0x4c9")]=b6[_qdb("0x4c9")],bb=k[_qdb("0x2db")]=b6[_qdb("0x2db")],bc=k[_qdb("0x370")]=b6[_qdb("0x370")],bd=k[_qdb("0x479")]=b6[_qdb("0x479")],be=k[_qdb("0x561")]=b6[_qdb("0x561")],bf=k[_qdb("0x4b9")]=b6[_qdb("0x4b9")],bg=k[_qdb("0x21c")]=b6[_qdb("0x21c")],bh=k[_qdb("0x498")]=b6[_qdb("0x498")],bn;if(k[_qdb("0x40b")]=b6,k[_qdb("0x3cc")]=W,aJ)if(aL(aJ)||(aJ=v(aJ)),s||t){var bi=y(aJ);a9[_qdb("0x17a")](bi,N)}else{aG(_qdb("0x317"));var bj=function(e){e[_qdb("0x3a3")]&&(e=new Uint8Array(e)),a9[_qdb("0x17a")](e,N),k[_qdb("0x582")]&&delete k[_qdb("0x582")][_qdb("0x382")],aH(_qdb("0x317"))},bk=function(){x(aJ,bj,(function(){throw _qdb("0x2eb")+aJ}))},bl=b1(aJ);if(bl)bj(bl[_qdb("0x4a0")]);else if(k[_qdb("0x582")]){var bm=function(){var e=k[_qdb("0x582")],t=e[_qdb("0x382")];if(200!==e[_qdb("0xe4")]&&0!==e[_qdb("0xe4")]){var i=b1(k[_qdb("0x1dc")]);if(!i)return console[_qdb("0x22a")](_qdb("0x58b")+e[_qdb("0xe4")]+_qdb("0x1d4")+aJ),void bk();t=i[_qdb("0x4a0")]}bj(t)};k[_qdb("0x582")][_qdb("0x382")]?setTimeout(bm,0):k[_qdb("0x582")][_qdb("0xd6")](_qdb("0x10e"),bm)}else bk()}if(aF=function a(){bn||bp(),bn||(aF=a)},k[_qdb("0x3f1")]=bp,k[_qdb("0x1c8")])for(typeof k[_qdb("0x1c8")]==_qdb("0x45f")&&(k[_qdb("0x1c8")]=[k[_qdb("0x1c8")]]);k[_qdb("0x1c8")][_qdb("0x43c")]>0;)k[_qdb("0x1c8")][_qdb("0x315")]()();P=!0,bp(),f=k[_qdb("0x3cc")](_qdb("0x54f"),_qdb("0x3fe"),[_qdb("0x295")])}function v(e){if(_qdb("0x85")==_qdb("0x85")){if(k[_qdb("0x613")]){if(_qdb("0x52")==_qdb("0x52"))return k[_qdb("0x613")](e,u);p+=-8155}return u+e}k[_qdb("0x417")](func)}function D(e){if(_qdb("0xf9")!==_qdb("0x2aa")){var t=ac[aj>>2],i=t+e+15&-16;return i>aT()&&(_qdb("0x250")!=_qdb("0x250")?u=u[_qdb("0x36")](0,u[_qdb("0x39a")]("/")+1):aI()),ac[aj>>2]=i,t}b2[x+20>>2]=s,b2[s+24>>2]=x}function E(e){if(_qdb("0x480")!==_qdb("0x36f"))switch(e){case"i1":case"i8":return 1;case _qdb("0x541"):return 2;case _qdb("0x5d8"):return 4;case _qdb("0x54c"):return 8;case _qdb("0x449"):return 4;case _qdb("0x481"):return 8;default:if(_qdb("0x4be")!==_qdb("0x244"))if("*"===e[e[_qdb("0x43c")]-1]){if(_qdb("0x2c4")==_qdb("0x2c4"))return 4;aI(_qdb("0xb5")+text)}else if("i"===e[0]){if(_qdb("0x580")!==_qdb("0x500")){var t=Number(e[_qdb("0x36")](1));return T(t%8==0,_qdb("0x336")+t+_qdb("0x2f5")+e),t/8}a9[_qdb("0x17a")](a9[_qdb("0x148")](src,src+num),dest)}else{if(_qdb("0x294")==_qdb("0x294"))return 0;b2[3]=p|i,q=k+8|0,r=k}else pa=ga,qa=aa,O=136}else w=q,x=k}function F(t){_qdb("0x162")==_qdb("0x162")?(F[_qdb("0x3f7")]||(F[_qdb("0x3f7")]={}),F[_qdb("0x3f7")][t]||(_qdb("0x1b7")!==_qdb("0x375")?(F[_qdb("0x3f7")][t]=1,B(t)):B=e)):(b2[r+16>>2]=k,b2[k+24>>2]=r)}function J(e,t,a){if(_qdb("0x3dc")===_qdb("0x557"))p+=-2509;else if(a&&a[_qdb("0x43c")]){if(_qdb("0xba")!==_qdb("0x5fe"))return k[_qdb("0x23a")+e][_qdb("0x3cd")](null,[t][_qdb("0x3c3")](a));h=(v=14-((i=(v=(h=v<<(k=(h=v+1048320|0)>>>16&8))+520192|0)>>>16&4)|k|(g=(h=(v=h<<i)+245760|0)>>>16&2))+((h=v<<g)>>>15)|0)+7|0,ia=1&(h?Z>>>h:Z)|v<<1}else{if(_qdb("0x57e")!==_qdb("0x443"))return k[_qdb("0x23a")+e][_qdb("0x494")](null,t);p+=21880}}function Q(e,t,i,a){if(_qdb("0x348")==_qdb("0x348"))switch("*"===(i=i||"i8")[_qdb("0x2e6")](i[_qdb("0x43c")]-1)&&(i=_qdb("0x5d8")),i){case"i1":case"i8":a8[e>>0]=t;break;case _qdb("0x541"):aa[e>>1]=t;break;case _qdb("0x5d8"):ac[e>>2]=t;break;case _qdb("0x54c"):aN=[t>>>0,(aM=t,+az(aM)>=1?aM>0?(0|aC(+aB(aM/4294967296),4294967295))>>>0:~~+aA((aM-+(~~aM>>>0))/4294967296)>>>0:0)],ac[e>>2]=aN[0],ac[e+4>>2]=aN[1];break;case _qdb("0x449"):ae[e>>2]=t;break;case _qdb("0x481"):af[e>>3]=t;break;default:aI(_qdb("0x27c")+i)}else k[_qdb("0x5d6")](what)}function T(t,a){if(_qdb("0x455")!=_qdb("0x455"))return l=0|b2[(k=(j=52+((i=(1&h^1)+f|0)<<1<<2)|0)+8|0)>>2],(0|(n=0|b2[(m=l+8|0)>>2]))==(0|j)?b2[3]=g&~(1<<i):(b2[n+12>>2]=j,b2[k>>2]=n),n=i<<3,b2[l+4>>2]=3|n,b2[(i=l+n+4|0)>>2]=1|b2[i>>2],u=b4,0|(o=m);t||(_qdb("0x2f0")===_qdb("0x482")?(b2[n+4>>2]=3|e,b2[i+4>>2]=1|h,b2[i+h>>2]=h,0|m&&(f=0|b2[8],s=52+((k=m>>>3)<<1<<2)|0,(v=1<<k)&g?(G=v=s+8|0,H=0|b2[v>>2]):(b2[3]=v|g,G=s+8|0,H=s),b2[G>>2]=f,b2[H+12>>2]=f,b2[f+8>>2]=H,b2[f+12>>2]=s),b2[5]=h,b2[8]=i):aI(_qdb("0xb5")+a))}function U(e){if(_qdb("0xb7")!==_qdb("0x277")){var t=k["_"+e];return T(t,_qdb("0x29a")+e+_qdb("0xfb")),t}b2[3]=ha|g,Ba=Z+8|0,Ca=Z}function V(e,t,i,a,n){if(_qdb("0x266")==_qdb("0x266")){var r={};r[_qdb("0x295")]=function(e){if(_qdb("0x1f8")!==_qdb("0x77")){var t=0;if(null!==e&&e!==undefined&&0!==e)if(_qdb("0x53d")!=_qdb("0x53d"))p+=-51520;else{var i=1+(e[_qdb("0x43c")]<<2);a2(e,t=bf(i),i)}return t}return a9[_qdb("0x43c")]},r[_qdb("0x1cd")]=function(e){if(_qdb("0x470")!==_qdb("0x28f")){var t=bf(e[_qdb("0x43c")]);return a5(e,t),t}p+=-8094};var s=r;var o=U(e),d=[],c=0;if(a)if(_qdb("0x31")===_qdb("0x1a0"))p+=55087;else for(var l=0;l<a[_qdb("0x43c")];l++)if(_qdb("0x5dc")===_qdb("0x4d9")){var h=str[_qdb("0x3a2")](++l);u=65536+((1023&u)<<10)|1023&h}else{var _=s[i[l]];if(_)_qdb("0x448")===_qdb("0x311")?l=j(_qdb("0x24e")):(0===c&&(c=bh()),d[l]=_(a[l]));else if(_qdb("0x531")==_qdb("0x531"))d[l]=a[l];else{var f=1+(str[_qdb("0x43c")]<<2);g=bf(f),a2(str,g,f)}}var g=o[_qdb("0x3cd")](null,d);return g=function(e){if(_qdb("0x262")!==_qdb("0x220"))return t===_qdb("0x295")?a0(e):t===_qdb("0x2c0")?Boolean(e):e;r[aa+20>>2]=k,r[k+24>>2]=aa,fa=v}(g),0!==c&&bg(c),g}throw _qdb("0x2eb")+aJ}function W(e,t,i,a){if(_qdb("0x3d7")!=_qdb("0x3d7")){return text[_qdb("0xf")](/\b__Z[\w\d_]+/g,(function(e){var t=aP(e);return e===t?e:t+" ["+e+"]"}))}var n=(i=i||[])[_qdb("0x465")]((function(e){if(_qdb("0x1d")==_qdb("0x1d"))return e===_qdb("0x3fe");al(ao)}));if(t!==_qdb("0x295")&&n&&!a){if(_qdb("0x5a0")!==_qdb("0x47e"))return U(e);za=la,Aa=d}return function(){return _qdb("0xbe")==_qdb("0xbe")?V(e,t,i,arguments,a):8}}function Z(t,a,r){if(_qdb("0x219")!==_qdb("0x545")){for(var o=a+r,u=a;t[u]&&!(u>=o);)++u;if(u-a>16&&t[_qdb("0x148")]&&Y){if(_qdb("0x126")!=_qdb("0x126")){for(var c in obj)if(obj[_qdb("0x528")](c))return!1;return!0}return Y[_qdb("0x431")](t[_qdb("0x148")](a,u))}if(_qdb("0x2a7")!==_qdb("0xde"))for(var v="";a<u;)if(_qdb("0x270")===_qdb("0x44f"))b2[j>>2]=-2&b4,b2[m+4>>2]=1|n,b2[l+n>>2]=n,D=n;else{var b=t[a++];if(!(128&b)){if(_qdb("0x100")==_qdb("0x100")){v+=String[_qdb("0x50")](b);continue}b2[n+12>>2]=k,b2[l>>2]=n,p=g}var y=63&t[a++];if(192==(224&b)){if(_qdb("0x26e")==_qdb("0x26e")){v+=String[_qdb("0x50")]((31&b)<<6|y);continue}for(;3&b4;){if(!e)return 0|f;j[b4>>0]=0|j[d>>0],b4=b4+1|0,d=d+1|0,e=e-1|0}for(e=(h=-4&g|0)-64|0;(0|b4)<=(0|e);)b2[b4>>2]=b2[d>>2],b2[b4+4>>2]=b2[d+4>>2],b2[b4+8>>2]=b2[d+8>>2],b2[b4+12>>2]=b2[d+12>>2],b2[b4+16>>2]=b2[d+16>>2],b2[b4+20>>2]=b2[d+20>>2],b2[b4+24>>2]=b2[d+24>>2],b2[b4+28>>2]=b2[d+28>>2],b2[b4+32>>2]=b2[d+32>>2],b2[b4+36>>2]=b2[d+36>>2],b2[b4+40>>2]=b2[d+40>>2],b2[b4+44>>2]=b2[d+44>>2],b2[b4+48>>2]=b2[d+48>>2],b2[b4+52>>2]=b2[d+52>>2],b2[b4+56>>2]=b2[d+56>>2],b2[b4+60>>2]=b2[d+60>>2],b4=b4+64|0,d=d+64|0;for(;(0|b4)<(0|h);)b2[b4>>2]=b2[d>>2],b4=b4+4|0,d=d+4|0}var T=63&t[a++];if(224==(240&b)?_qdb("0x5c0")!=_qdb("0x5c0")?p+=1283:b=(15&b)<<12|y<<6|T:_qdb("0x4a2")===_qdb("0x70")?response=bi[_qdb("0x4a0")]:b=(7&b)<<18|y<<12|T<<6|63&t[a++],b<65536)_qdb("0x591")!==_qdb("0x38b")?v+=String[_qdb("0x50")](b):p+=18907;else if(_qdb("0x521")==_qdb("0x521")){var S=b-65536;v+=String[_qdb("0x50")](55296|S>>10,56320|1023&S)}else Z=L,_=Y}else l=h,m=h,n=i;return v}B=k,C=s}function a0(e,t){if(_qdb("0x310")==_qdb("0x310"))return e?Z(a9,e,t):"";u0=(15&u0)<<12|u1<<6|u2}function a1(t,i,a,r){if(_qdb("0x4d8")!==_qdb("0xa0")){if(!(r>0))return 0;for(var o=a,u=a+r-1,c=0;c<t[_qdb("0x43c")];++c)if(_qdb("0x381")!=_qdb("0x381"))p+=14540;else{var h=t[_qdb("0x3a2")](c);if(h>=55296&&h<=57343){if(_qdb("0x527")===_qdb("0x26"))return s(0|b4,0|d,0|e),0|b4;h=65536+((1023&h)<<10)|1023&t[_qdb("0x3a2")](++c)}if(h<=127)if(_qdb("0x179")===_qdb("0x38a"))p+=-20743;else{if(a>=u)break;i[a++]=h}else if(h<=2047)if(_qdb("0x10d")===_qdb("0x2b"))p+=9382;else{if(a+1>=u)break;i[a++]=192|h>>6,i[a++]=128|63&h}else if(h<=65535)if(_qdb("0x1b6")===_qdb("0x3c4"))for(typeof k[_qdb("0x1c8")]==_qdb("0x45f")&&(k[_qdb("0x1c8")]=[k[_qdb("0x1c8")]]);k[_qdb("0x1c8")][_qdb("0x43c")]>0;)k[_qdb("0x1c8")][_qdb("0x315")]()();else{if(a+2>=u)break;i[a++]=224|h>>12,i[a++]=128|h>>6&63,i[a++]=128|63&h}else{if(_qdb("0x13a")!=_qdb("0x13a"))return l=52+(n<<1<<2)|0,(b4=0|b2[3])&(j=1<<n)?(E=j=l+8|0,F=0|b2[j>>2]):(b2[3]=b4|j,E=l+8|0,F=l),b2[E>>2]=m,b2[F+12>>2]=m,b2[m+8>>2]=F,void(b2[m+12>>2]=l);if(a+3>=u)break;i[a++]=240|h>>18,i[a++]=128|h>>12&63,i[a++]=128|h>>6&63,i[a++]=128|63&h}}return i[a]=0,a-o}var _=u0-65536;t+=String[_qdb("0x50")](55296|_>>10,56320|1023&_)}function a2(e,t,i){if(_qdb("0x3aa")!==_qdb("0x75"))return a1(e,a9,t,i);p+=-11196}function a3(e){if(_qdb("0x476")!==_qdb("0x477")){for(var t=0,i=0;i<e[_qdb("0x43c")];++i)if(_qdb("0x6f")!==_qdb("0x1c3")){var a=e[_qdb("0x3a2")](i);a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e[_qdb("0x3a2")](++i)),a<=127?++t:t+=a<=2047?2:a<=65535?3:4}else p+=46464;return t}p+=-16677}function a5(e,t){_qdb("0x32b")==_qdb("0x32b")?a8[_qdb("0x17a")](e,t):(g=Z+8|0,Ba=g,Ca=0|b2[g>>2])}function a6(e,t,i){if(_qdb("0x111")!==_qdb("0x55c")){for(var a=0;a<e[_qdb("0x43c")];++a){if(_qdb("0x276")===_qdb("0x165")){var n=Number(type[_qdb("0x36")](1));return T(n%8==0,_qdb("0x336")+n+_qdb("0x2f5")+type),n/8}a8[t++>>0]=e[_qdb("0x3a2")](a)}i||(a8[t>>0]=0)}else z=k,A=s}function ag(e){if(_qdb("0x22e")!=_qdb("0x22e")){try{throw new Error}catch(t){B=t}if(!B[_qdb("0x29c")])return _qdb("0x434")}else a7=e,k[_qdb("0x54e")]=a8=new Int8Array(e),k[_qdb("0x1a2")]=aa=new Int16Array(e),k[_qdb("0x4e5")]=ac=new Int32Array(e),k[_qdb("0x19")]=a9=new Uint8Array(e),k[_qdb("0x47")]=ab=new Uint16Array(e),k[_qdb("0x581")]=ad=new Uint32Array(e),k[_qdb("0x1db")]=ae=new Float32Array(e),k[_qdb("0x518")]=af=new Float64Array(e)}function al(e){if(_qdb("0x3bb")==_qdb("0x3bb"))for(;e[_qdb("0x43c")]>0;)if(_qdb("0x19a")!=_qdb("0x19a"))G=1&((F=(l=14-((j=(l=(F=l<<(E=(F=l+1048320|0)>>>16&8))+520192|0)>>>16&4)|E|(b4=(F=(l=F<<j)+245760|0)>>>16&2))+((F=l<<b4)>>>15)|0)+7|0)?D>>>F:D)|l<<1;else{var a=e[_qdb("0xac")]();if(typeof a==_qdb("0x45f")){if(_qdb("0x3d6")==_qdb("0x3d6")){a();continue}a8[a7++>>0]=str[_qdb("0x3a2")](i)}var n=a[_qdb("0x4f9")];typeof n===_qdb("0x3fe")?_qdb("0x30a")===_qdb("0x190")?(s=q,t=k):a[_qdb("0x5cf")]===undefined?_qdb("0x307")!=_qdb("0x307")?(s=U,K=W,A<<=1,P=V):k[_qdb("0x417")](n):_qdb("0x84")===_qdb("0x12b")?p+=-9037:k[_qdb("0x5f7")](n,a[_qdb("0x5cf")]):_qdb("0x45")===_qdb("0x313")?p+=5171:n(a[_qdb("0x5cf")]===undefined?null:a[_qdb("0x5cf")])}else b2[123]=4096,b2[122]=4096,b2[124]=-1,b2[125]=-1,b2[126]=0,b2[114]=0,b2[121]=-16&d^1431655768,la=4096}function as(){if(_qdb("0xd7")===_qdb("0x4b7")){var e=str[_qdb("0x3a2")](i);e>=55296&&e<=57343&&(e=65536+((1023&e)<<10)|1023&str[_qdb("0x3a2")](++i)),e<=127?++len:len+=e<=2047?2:e<=65535?3:4}else{if(k[_qdb("0x486")])if(_qdb("0x5a1")!=_qdb("0x5a1"))p+=-1075;else for(typeof k[_qdb("0x486")]==_qdb("0x45f")&&(k[_qdb("0x486")]=[k[_qdb("0x486")]]);k[_qdb("0x486")][_qdb("0x43c")];)_qdb("0x50a")==_qdb("0x50a")?ax(k[_qdb("0x486")][_qdb("0xac")]()):p+=19656;al(am)}}function at(){if(_qdb("0x364")!=_qdb("0x364")){if(r=(0|b2[6])+n|0,b2[6]=r,b2[9]=m,b2[m+4>>2]=1|r,(0|m)!=(0|b2[8]))return;return b2[8]=0,void(b2[5]=0)}aq=!0,al(an)}function au(){if(_qdb("0x1d7")!=_qdb("0x1d7"))return U(ident);al(ao)}function av(){if(_qdb("0x42b")===_qdb("0x158"))return ja=_-I|0,ka=0|b2[8],ja>>>0>15?(Z=ka+I|0,b2[8]=Z,b2[5]=ja,b2[Z+4>>2]=1|ja,b2[ka+_>>2]=ja,b2[ka+4>>2]=3|I):(b2[5]=0,b2[8]=0,b2[ka+4>>2]=3|_,ja=ka+_+4|0,b2[ja>>2]=1|b2[ja>>2]),o=ka+8|0,u=b4,0|o;ar=!0}function aw(){if(_qdb("0x5c1")!=_qdb("0x5c1"))n-=2,x=y;else{if(k[_qdb("0x2d9")]){if(_qdb("0x14")!=_qdb("0x14"))return _qdb("0x434");for(typeof k[_qdb("0x2d9")]==_qdb("0x45f")&&(k[_qdb("0x2d9")]=[k[_qdb("0x2d9")]]);k[_qdb("0x2d9")][_qdb("0x43c")];){if(_qdb("0x1bf")!=_qdb("0x1bf")){i|=0;var e,i=0,a=0;return(e=(a=0|a[(i=0|G())>>2])+(i+3&-4)|0)>>>0>(0|r())>>>0&&0==(0|t(0|e))?(a[(0|B())>>2]=48,0|-1):(a[i>>2]=e,0|a)}ay(k[_qdb("0x2d9")][_qdb("0xac")]())}}al(ap)}}function ax(e){_qdb("0xe3")!==_qdb("0x1d2")?am[_qdb("0x524")](e):p+=26986}function ay(e){if(_qdb("0x5de")!=_qdb("0x5de")){var t=aP(x);return x===t?x:t+" ["+x+"]"}ap[_qdb("0x524")](e)}function aG(e){if(_qdb("0x2f6")!=_qdb("0x2f6")){var t=new XMLHttpRequest;return t[_qdb("0x222")](_qdb("0x86"),url,!1),t[_qdb("0x1ce")]=_qdb("0x150"),t[_qdb("0x485")](null),new Uint8Array(t[_qdb("0x382")])}if(aD++,k[_qdb("0x378")]){if(_qdb("0x367")===_qdb("0xec"))return x<0?Math[_qdb("0x614")](x):Math[_qdb("0x514")](x);k[_qdb("0x378")](aD)}}function aH(e){if(_qdb("0x25b")==_qdb("0x25b")){if(aD--,k[_qdb("0x378")]&&(_qdb("0x37c")!==_qdb("0x38c")?k[_qdb("0x378")](aD):(b2[b4>>2]=h,b2[b4+4>>2]=h,b2[b4+8>>2]=h,b2[b4+12>>2]=h,b2[b4+16>>2]=h,b2[b4+20>>2]=h,b2[b4+24>>2]=h,b2[b4+28>>2]=h,b2[b4+32>>2]=h,b2[b4+36>>2]=h,b2[b4+40>>2]=h,b2[b4+44>>2]=h,b2[b4+48>>2]=h,b2[b4+52>>2]=h,b2[b4+56>>2]=h,b2[b4+60>>2]=h,b4=b4+64|0)),0==aD)if(_qdb("0x173")!=_qdb("0x173"))b2[4]=F|b4,b2[l>>2]=m,b2[m+24>>2]=l,b2[m+12>>2]=m,b2[m+8>>2]=m;else if(null!==aE&&(_qdb("0x224")!==_qdb("0x128")?(clearInterval(aE),aE=null):(ret_str=a0(p_ret),ba(p_ret))),aF)if(_qdb("0x299")==_qdb("0x299")){var t=aF;aF=null,t()}else b2[3]=_|ja,Ha=pa+8|0,Ia=pa}else objkey=objkey[_qdb("0x2ed")]()}function aI(e){if(_qdb("0xdc")==_qdb("0xdc")){if(k[_qdb("0x5d6")]){if(_qdb("0x3a5")!=_qdb("0x3a5"))return k[_qdb("0x613")](path,u);k[_qdb("0x5d6")](e)}throw A(e+=""),B(e),R=!0,S=1,e=_qdb("0x309")+e+_qdb("0x54a")}p+=-37344}function aL(e){if(_qdb("0x404")!==_qdb("0xee"))return String[_qdb("0x46")][_qdb("0x488")]?e[_qdb("0x488")](aK):0===e[_qdb("0xbc")](aK);B=q,C=j}function aP(e){if(_qdb("0x4af")==_qdb("0x4af"))return e;k[m]=l[m]}function aQ(e){if(_qdb("0x51d")==_qdb("0x51d")){return e[_qdb("0xf")](/\b__Z[\w\d_]+/g,(function(e){if(_qdb("0x320")==_qdb("0x320")){var t=aP(e);return e===t?e:t+" ["+e+"]"}aD++,k[_qdb("0x378")]&&k[_qdb("0x378")](aD)}))}ia=0|b2[7],0==(0|ia)|na>>>0<ia>>>0&&(b2[7]=na),b2[115]=na,b2[116]=oa,b2[118]=0,b2[12]=b2[121],b2[11]=-1,b2[16]=52,b2[15]=52,b2[18]=60,b2[17]=60,b2[20]=68,b2[19]=68,b2[22]=76,b2[21]=76,b2[24]=84,b2[23]=84,b2[26]=92,b2[25]=92,b2[28]=100,b2[27]=100,b2[30]=108,b2[29]=108,b2[32]=116,b2[31]=116,b2[34]=124,b2[33]=124,b2[36]=132,b2[35]=132,b2[38]=140,b2[37]=140,b2[40]=148,b2[39]=148,b2[42]=156,b2[41]=156,b2[44]=164,b2[43]=164,b2[46]=172,b2[45]=172,b2[48]=180,b2[47]=180,b2[50]=188,b2[49]=188,b2[52]=196,b2[51]=196,b2[54]=204,b2[53]=204,b2[56]=212,b2[55]=212,b2[58]=220,b2[57]=220,b2[60]=228,b2[59]=228,b2[62]=236,b2[61]=236,b2[64]=244,b2[63]=244,b2[66]=252,b2[65]=252,b2[68]=260,b2[67]=260,b2[70]=268,b2[69]=268,b2[72]=276,b2[71]=276,b2[74]=284,b2[73]=284,b2[76]=292,b2[75]=292,b2[78]=300,b2[77]=300,ia=oa+-40|0,d=na+8|0,ma=0==(7&d|0)?0:0-d&7,d=na+ma|0,qa=ia-ma|0,b2[9]=d,b2[6]=qa,b2[d+4>>2]=1|qa,b2[na+ia+4>>2]=40,b2[10]=b2[125]}function aR(){if(_qdb("0xce")==_qdb("0xce")){var e=new Error;if(!e[_qdb("0x29c")])if(_qdb("0x3ee")!=_qdb("0x3ee")){var t=k[_qdb("0x582")],i=t[_qdb("0x382")];if(200!==t[_qdb("0xe4")]&&0!==t[_qdb("0xe4")]){var a=b1(k[_qdb("0x1dc")]);if(!a)return console[_qdb("0x22a")](_qdb("0x58b")+t[_qdb("0xe4")]+_qdb("0x1d4")+aJ),void bk();i=a[_qdb("0x4a0")]}bj(i)}else{try{if(_qdb("0x22d")!==_qdb("0x34a"))throw new Error;j<<=1,n=r}catch(i){_qdb("0x542")==_qdb("0x542")?e=i:(F[_qdb("0x3f7")][text]=1,e(text))}if(!e[_qdb("0x29c")]){if(_qdb("0x2d0")!==_qdb("0x25c"))return _qdb("0x434");try{for(var o=aZ(s),d=new Uint8Array(o[_qdb("0x43c")]),u=0;u<o[_qdb("0x43c")];++u)d[u]=o[_qdb("0x3a2")](u);return d}catch(c){throw new Error(_qdb("0x94"))}}}return e[_qdb("0x29c")][_qdb("0x5d5")]()}ar=!0}function aS(){if(_qdb("0x304")!==_qdb("0x1e0"))for(var bH=62635;;)if(_qdb("0x534")===_qdb("0x6e"))bH+=-31894;else switch(bH){case 35004:bM+=3,bH+=29830;break;case 51281:bO[13]=_qdb("0x7b"),bO[26]=_qdb("0x23d"),bO[8]=_qdb("0x5ff"),bO[5]=_qdb("0x5f8"),bH+=-29352;break;case 15330:bQ=bJ[_qdb("0x573")],bH+=30215;break;case 59517:bO[20]=_qdb("0x1f5"),bO[36]=_qdb("0x5e5"),bH+=-36734;break;case 15522:bO[8]=_qdb("0x2d2"),bO[15]=_qdb("0x4b0"),bO[2]=_qdb("0x5cd"),bH+=17880;break;case 63668:bO[4]=_qdb("0xd"),bO[10]=_qdb("0x371"),bO[23]=_qdb("0x3b"),bO[19]=_qdb("0x2d5"),bH+=-33182;break;case 24382:bO[10]=_qdb("0x4d2"),bO[4]=_qdb("0x24d"),bH+=-15580;break;case 59966:bO=bR[230],bH+=-24090;break;case 55294:return bQ;case 38733:bO[0]=_qdb("0x592"),bH+=-33977;break;case 39985:bO=[],bH+=11806;break;case 52405:bU=0,bH+=-16510;break;case 46495:bO[15]=_qdb("0x147"),bO[26]=_qdb("0x5e0"),bH+=-26439;break;case 40717:bO=bR[33],bH+=14728;break;case 5278:bH+=736;break;case 4669:bO[13]=_qdb("0x314"),bO[8]=_qdb("0x154"),bO[34]=_qdb("0x411"),bO[31]=_qdb("0x3e5"),bH+=40850;break;case 570:bO=bR[106],bH+=64357;break;case 3328:bO[13]=_qdb("0x48b"),bO[28]=_qdb("0x564"),bO[1]=_qdb("0xe2"),bO[20]=_qdb("0x2fa"),bH+=-388;break;case 27232:bO[19]=_qdb("0x602"),bO[23]=_qdb("0x56d"),bO[14]=_qdb("0x333"),bO[9]=_qdb("0x9b"),bH+=-5060;break;case 33413:bO[21]=_qdb("0x44e"),bH+=-28416;break;case 19879:bO[22]=_qdb("0x81"),bO[20]=_qdb("0xf8"),bO[13]=_qdb("0x57f"),bO[9]=_qdb("0x43e"),bH+=-14021;break;case 24979:bO[11]=_qdb("0x50d"),bO[1]=_qdb("0x442"),bH+=-12301;break;case 57761:bO[14]=_qdb("0x5c"),bO[7]=_qdb("0x3ed"),bO[17]=_qdb("0x40f"),bH+=997;break;case 24863:bO[13]=_qdb("0x58f"),bO[17]=_qdb("0x33"),bO[5]=_qdb("0x48"),bH+=35670;break;case 11242:bO[2]=_qdb("0x351"),bO[26]=_qdb("0x3d2"),bO[9]=_qdb("0x597"),bO[10]=_qdb("0x572"),bH+=-10325;break;case 25199:bO[20]=_qdb("0x50c"),bO[38]=_qdb("0xd3"),bO[39]=_qdb("0x53b"),bH+=20831;break;case 26780:if(bQ){if(_qdb("0xaf")===_qdb("0x42a")){bX|=0;var bX=0;return bX=u,u=u+bX|0,u=u+15&-16,0|bX}bH+=22655}else _qdb("0x2a4")!==_qdb("0x43a")?bH+=20048:bH+=-36336;break;case 18694:if(bU<=bL[_qdb("0x43c")]&&bI!==bL[_qdb("0x2e6")](bL[_qdb("0x43c")]-bU))if(_qdb("0x30c")===_qdb("0x5f3")){if(null!==aE&&(clearInterval(aE),aE=null),aF){var bZ=aF;aF=null,bZ()}}else bH+=21880;else{if(_qdb("0x51f")!=_qdb("0x51f"))return args&&args[_qdb("0x43c")]?k[_qdb("0x23a")+sig][_qdb("0x3cd")](null,[ptr][_qdb("0x3c3")](args)):k[_qdb("0x23a")+sig][_qdb("0x494")](null,ptr);bH+=-13416}break;case 21238:typeof bU===_qdb("0x45f")?_qdb("0x24f")===_qdb("0xc3")?bH+=-33319:bH+=28758:_qdb("0x5ad")!=_qdb("0x5ad")?(U=Q,V=C):bH+=-16400;break;case 21929:bO[1]=_qdb("0x34c"),bO[22]=_qdb("0x3a6"),bO[20]=_qdb("0x19f"),bO[19]=_qdb("0x83"),bH+=-12439;break;case 64834:bH+=90;break;case 32415:typeof bQ===_qdb("0x3fe")?_qdb("0x268")==_qdb("0x268")?bH+=-28368:(b2[x+16>>2]=bS,b2[bS+24>>2]=x):_qdb("0x463")==_qdb("0x463")?bH+=14413:(bi[_qdb("0x3a3")]&&(bi=new Uint8Array(bi)),a9[_qdb("0x17a")](bi,N),k[_qdb("0x582")]&&delete k[_qdb("0x582")][_qdb("0x382")],aH(_qdb("0x317")));break;case 34637:var bI=bN[_qdb("0x2e6")](bN[_qdb("0x43c")]-bU);bH+=-15943;break;case 1433:bH+=38180;break;case 58328:bO[25]=_qdb("0x69"),bO[11]=_qdb("0x4b1"),bO[19]=_qdb("0x392"),bO[12]=_qdb("0x23"),bH+=-18176;break;case 1196:bO[2]=_qdb("0x551"),bO[12]=_qdb("0x55a"),bH+=32527;break;case 22445:bI=0,bJ=0,bH+=-6284;break;case 240:bO[13]=_qdb("0xa8"),bO[23]=_qdb("0x122"),bO[17]=_qdb("0x57b"),bH+=11688;break;case 52529:bO[3]=_qdb("0x34d"),bO[9]=_qdb("0x258"),bH+=-7823;break;case 2712:bO[0]=_qdb("0x2bb"),bO[18]=_qdb("0x410"),bH+=17167;break;case 33402:bO[18]=_qdb("0x1d3"),bO[7]=_qdb("0x17"),bO[16]=_qdb("0x353"),bO[6]=_qdb("0x2e3"),bH+=-2703;break;case 55865:if(d(bU))_qdb("0x546")!=_qdb("0x546")?bH+=230:bH+=-9037;else{if(_qdb("0x20c")===_qdb("0x3a8"))return o(b2<<bI|(j&(1<<bI)-1<<32-bI)>>>32-bI|0),j<<bI;bH+=-20743}break;case 31114:bO[17]=_qdb("0xcc"),bO[22]=_qdb("0x373"),bO[19]=_qdb("0x1d8"),bH+=748;break;case 32238:bO[9]=_qdb("0x3fd"),bO[21]=_qdb("0x3e2"),bH+=986;break;case 32479:bO[18]=_qdb("0x4e1"),bH+=18915;break;case 46843:bO[33]=_qdb("0x4d3"),bO[28]=_qdb("0x615"),bO[29]=_qdb("0x4f2"),bH+=-5505;break;case 60983:bO[19]=_qdb("0x58e"),bO[13]=_qdb("0x205"),bO[4]=_qdb("0x46f"),bO[17]=_qdb("0x2d6"),bH+=-36714;break;case 47367:bR[92]=[],bH+=-3748;break;case 10884:bO[21]=_qdb("0x2b1"),bH+=32900;break;case 46030:bO[13]=_qdb("0x501"),bH+=-41250;break;case 2096:bO[30]=_qdb("0x440"),bO[16]=_qdb("0x3b7"),bH+=750;break;case 24749:bO=bR[32],bH+=26532;break;case 20960:bJ=bQ,bH+=10954;break;case 42323:bO[14]=_qdb("0x3c6"),bH+=9313;break;case 51250:bO[17]=_qdb("0x321"),bO[4]=_qdb("0x32a"),bO[16]=_qdb("0x25e"),bH+=5743;break;case 54102:bR[58]=[],bH+=-17790;break;case 17812:bO[30]=_qdb("0x33d"),bO[18]=_qdb("0x3eb"),bH+=20297;break;case 64628:try{_qdb("0x45d")!==_qdb("0xd9")?bQ=bU(_qdb("0x4fa")):(aX&&T(!1,_qdb("0x32")+chr+" ("+String[_qdb("0x50")](chr)+_qdb("0x146")+bU+_qdb("0x408")),chr&=255)}catch(c7){}bH+=-63867;break;case 761:!bQ||d(bQ)?_qdb("0x27a")===_qdb("0x171")?bH+=-7967:bH+=4077:_qdb("0x164")===_qdb("0x4d0")?bH+=3792:bH+=46067;break;case 62936:bO[27]=_qdb("0x569"),bH+=1246;break;case 21639:bO[0]=_qdb("0x5e2"),bO[24]=_qdb("0x174"),bO[25]=_qdb("0x28d"),bH+=-16970;break;case 13923:typeof bJ===_qdb("0x45f")?_qdb("0x4ff")===_qdb("0x58a")?(bn||bp(),bn||(aF=runCaller)):bH+=33580:_qdb("0x8e")===_qdb("0xb2")?(v=0|b2[n+8>>2],b2[v+12>>2]=bS,b2[bS+8>>2]=v,x=bS):bH+=32905;break;case 23597:bR[18]=[],bH+=26141;break;case 63122:bO[11]=_qdb("0x1b"),bO[24]=_qdb("0x549"),bH+=-49986;break;case 29063:bQ+=11,bH+=13227;break;case 18237:bO[14]=_qdb("0x340"),bH+=29819;break;case 2940:bO[19]=_qdb("0x4b5"),bH+=50928;break;case 4411:bO[2]=_qdb("0x232"),bO[9]=_qdb("0x45c"),bH+=50988;break;case 4997:bR[9]=[],bH+=5918;break;case 51112:bO[44]=_qdb("0x504"),bO[11]=_qdb("0x3e3"),bH+=-44357;break;case 8479:bO[12]=_qdb("0x59c"),bH+=49018;break;case 32291:bT+="0",bH+=3890;break;case 23524:bO[15]=_qdb("0x198"),bO[3]=_qdb("0x23e"),bH+=35851;break;case 45519:bO[22]=_qdb("0x548"),bH+=-24260;break;case 35446:bO[17]=_qdb("0x472"),bO[2]=_qdb("0x3ce"),bO[14]=_qdb("0x27d"),bO[8]=_qdb("0x365"),bH+=-16112;break;case 64525:bH+=399;break;case 42531:bQ=bQ[_qdb("0x1b1")],bH+=-16369;break;case 64182:bR[100]=[],bH+=-29175;break;case 36999:bO[6]=_qdb("0x116"),bO[16]=_qdb("0x458"),bO[1]=_qdb("0x32f"),bO[3]=_qdb("0x32d"),bH+=-4865;break;case 7011:bM-=bO[0]>>8,bH+=40782;break;case 50351:bO[7]=_qdb("0x326"),bO[9]=_qdb("0x35b"),bH+=-17476;break;case 5734:bO[5]=_qdb("0x4ad"),bH+=33891;break;case 51153:bH+=4141;break;case 10225:bO[23]=_qdb("0x30f"),bO[31]=_qdb("0x49b"),bH+=20178;break;case 307:bJ=-1,bH+=39678;break;case 9704:bO[8]=_qdb("0x135"),bO[5]=_qdb("0x210"),bO[40]=_qdb("0x233"),bH+=54445;break;case 15278:bP?_qdb("0x241")===_qdb("0x213")?aI(_qdb("0x565")):bH+=230:_qdb("0x254")===_qdb("0x357")?cArgs[bU]=args[bU]:bH+=-8155;break;case 23413:bO[16]=_qdb("0x372"),bH+=-19101;break;case 30699:bO[12]=_qdb("0x10f"),bO[4]=_qdb("0xc6"),bH+=3830;break;case 45547:bO[6]=_qdb("0x3a0"),bO[4]=_qdb("0x26c"),bO[10]=_qdb("0x22"),bH+=6265;break;case 376:bO=bR[23],bH+=60607;break;case 64951:bN=bU[_qdb("0x301")],bH+=-870;break;case 23329:var bJ=0;bH+=37050;break;case 46604:bO[30]=_qdb("0x1dd"),bO[19]=_qdb("0x4ab"),bO[4]=_qdb("0x1a4"),bO[43]=_qdb("0x48d"),bH+=-24965;break;case 62343:bO=bR[70],bH+=-17499;break;case 43150:bO[8]=_qdb("0x8c"),bO[9]=_qdb("0x575"),bH+=-11076;break;case 64924:bH+=-10107;break;case 15625:bO[5]=_qdb("0x1c6"),bO[7]=_qdb("0x105"),bO[22]=_qdb("0xa7"),bH+=22692;break;case 11315:bR[23]=[],bH+=-10939;break;case 31802:bO[13]=_qdb("0x523"),bO[8]=_qdb("0x362"),bH+=30694;break;case 18806:bO[9]=_qdb("0x30b"),bO[3]=_qdb("0x510"),bO[21]=_qdb("0x4c7"),bH+=30606;break;case 49996:try{if(_qdb("0x180")!=_qdb("0x180"))return K;bQ=bU("fs")}catch(cf){}bH+=-47871;break;case 16415:bO[27]=_qdb("0x2ee"),bO[23]=_qdb("0x318"),bH+=47885;break;case 6524:bQ=bU[_qdb("0x4c2")],bH+=56674;break;case 9435:bJ=bQ,bH+=33096;break;case 16677:bO[3]=_qdb("0x15d"),bO[9]=_qdb("0x24b"),bO[10]=_qdb("0x110"),bH+=37425;break;case 25639:bT+=bS[_qdb("0x2e6")](bM),bH+=33894;break;case 51812:bR[63]=[],bH+=-45703;break;case 22232:bO[2]=_qdb("0x33c"),bO[18]=_qdb("0x41a"),bH+=-11348;break;case 57825:bO[17]=_qdb("0x149"),bO[11]=_qdb("0x1bd"),bH+=-8556;break;case 35692:bH+=15461;break;case 57260:bQ+=12,bH+=-39937;break;case 7927:bQ+=64,bH+=19673;break;case 7890:bO[5]=_qdb("0x3da"),bH+=18100;break;case 2676:bO[41]=_qdb("0x5f6"),bO[15]=_qdb("0x1b0"),bH+=34785;break;case 22477:bO[15]=_qdb("0x18b"),bO[8]=_qdb("0x5b4"),bO[1]=_qdb("0x374"),bH+=4755;break;case 64081:bN?_qdb("0x187")!==_qdb("0x23c")?bH+=-8748:condition||aI(_qdb("0xb5")+text):_qdb("0x199")===_qdb("0x2ab")?bH+=-13416:bH+=-17253;break;case 43539:"\n"===bI?_qdb("0x8d")===_qdb("0x54b")?setTimeout(bm,0):bH+=-17900:_qdb("0x29e")!=_qdb("0x29e")?(b2[aa+16>>2]=bM,b2[bM+24>>2]=aa):bH+=18907;break;case 29199:bO[26]=_qdb("0x168"),bH+=34638;break;case 27597:bR[40]=[],bH+=-13935;break;case 59134:bQ=bJ[_qdb("0x60c")],bH+=-25837;break;case 24209:bO[42]=_qdb("0x28b"),bH+=30442;break;case 24260:bO[0]=_qdb("0x4"),bO[12]=_qdb("0x2bd"),bH+=33077;break;case 34223:bO[10]=_qdb("0x1e8"),bO[1]=_qdb("0x538"),bO[4]=_qdb("0xe5"),bH+=-31602;break;case 25990:bO[18]=_qdb("0x4b3"),bO[23]=_qdb("0x130"),bH+=34641;break;case 34529:bO[19]=_qdb("0x282"),bO[14]=_qdb("0x577"),bH+=18688;break;case 1188:bO[27]=_qdb("0x1d9"),bO[15]=_qdb("0x11"),bO[41]=_qdb("0x2c"),bO[16]=_qdb("0x45b"),bH+=39372;break;case 42740:bO[8]=_qdb("0xe7"),bO[23]=_qdb("0x338"),bH+=11084;break;case 2125:!bQ||d(bQ)?_qdb("0x160")===_qdb("0x511")?bH+=-10897:bH+=62503:_qdb("0x325")!=_qdb("0x325")?(b2[bI>>2]=b2[bQ>>2],b2[bI+4>>2]=b2[bQ+4>>2],b2[bI+8>>2]=b2[bQ+8>>2],b2[bI+12>>2]=b2[bQ+12>>2],b2[bI+16>>2]=b2[bQ+16>>2],b2[bI+20>>2]=b2[bQ+20>>2],b2[bI+24>>2]=b2[bQ+24>>2],b2[bI+28>>2]=b2[bQ+28>>2],b2[bI+32>>2]=b2[bQ+32>>2],b2[bI+36>>2]=b2[bQ+36>>2],b2[bI+40>>2]=b2[bQ+40>>2],b2[bI+44>>2]=b2[bQ+44>>2],b2[bI+48>>2]=b2[bQ+48>>2],b2[bI+52>>2]=b2[bQ+52>>2],b2[bI+56>>2]=b2[bQ+56>>2],b2[bI+60>>2]=b2[bQ+60>>2],bI=bI+64|0,bQ=bQ+64|0):bH+=44703;break;case 2621:bO[3]=_qdb("0x4f"),bH+=8415;break;case 6755:bO[37]=_qdb("0x5b9"),bO[28]=_qdb("0x358"),bO[25]=_qdb("0x227"),bO[8]=_qdb("0x3f6"),bH+=44495;break;case 30319:bO[32]=_qdb("0x49d"),bO[6]=_qdb("0x3ab"),bH+=29198;break;case 4047:if(bQ>0)if(_qdb("0x550")==_qdb("0x550"))bH+=55087;else for(h=g-4|0;(0|bI)<(0|h);)j[bI>>0]=0|j[bQ>>0],j[bI+1>>0]=0|j[bQ+1>>0],j[bI+2>>0]=0|j[bQ+2>>0],j[bI+3>>0]=0|j[bQ+3>>0],bI=bI+4|0,bQ=bQ+4|0;else _qdb("0x43d")!=_qdb("0x43d")?(bS=bH,t=o):bH+=42781;break;case 38828:bO[41]=_qdb("0x412"),bH+=-33094;break;case 59955:bO[26]=_qdb("0x1b5"),bO[3]=_qdb("0x3ca"),bO[27]=_qdb("0x55"),bH+=-52065;break;case 58475:bO[14]=_qdb("0x553"),bO[10]=_qdb("0x50f"),bH+=-11833;break;case 34541:bO[3]=_qdb("0x4bc"),bO[23]=_qdb("0x5b5"),bO[26]=_qdb("0x229"),bO[21]=_qdb("0x42c"),bH+=-24674;break;case 40891:bO[15]=_qdb("0x9d"),bH+=-14780;break;case 46371:bO[11]=_qdb("0x2be"),bH+=-36667;break;case 49412:bO[15]=_qdb("0x6c"),bH+=-34921;break;case 21343:bQ=bQ[_qdb("0x56b")],bH+=5833;break;case 4780:bO[24]=_qdb("0x415"),bO[18]=_qdb("0x42"),bH+=5445;break;case 62446:bH+=-30155;break;case 21780:bR[164]=[],bH+=38165;break;case 20004:bQ=bQ[_qdb("0x293")],bH+=40951;break;case 2352:bO=bR[6],bH+=31973;break;case 48107:bO[38]=_qdb("0x363"),bO[22]=_qdb("0x490"),bO[14]=_qdb("0x401"),bO[45]=_qdb("0x590"),bH+=-26842;break;case 4264:bO[13]=_qdb("0x127"),bH+=19996;break;case 46233:bM/=bO[0]>>12,bH+=-8151;break;case 12571:bH+=39220;break;case 38344:bQ=bQ[_qdb("0x17d")],bH+=18;break;case 21931:bO[14]=_qdb("0x51c"),bH+=-4020;break;case 1382:if(bR[bU]){if(_qdb("0x237")!=_qdb("0x237"))return k[_qdb("0x23a")+sig][_qdb("0x494")](null,ptr);bH+=-1075}else if(_qdb("0x400")!==_qdb("0x9c"))bH+=5741;else{var cq=new XMLHttpRequest;cq[_qdb("0x222")](_qdb("0x86"),url,!0),cq[_qdb("0x1ce")]=_qdb("0x150"),cq[_qdb("0x46b")]=function(){if(200==cq[_qdb("0xe4")]||0==cq[_qdb("0xe4")]&&cq[_qdb("0x382")])onload(cq[_qdb("0x382")]);else{var e=b1(url);e?onload(e[_qdb("0x4a0")]):onerror()}},cq[_qdb("0x29")]=onerror,cq[_qdb("0x485")](null)}break;case 20118:bO[15]=_qdb("0x5e7"),bO[0]=_qdb("0x175"),bO[27]=_qdb("0x4ba"),bH+=5547;break;case 32928:var bK=0;bH+=16442;break;case 41213:bO[8]=_qdb("0x2e0"),bO[6]=_qdb("0x3ef"),bH+=-9639;break;case 54818:bO[6]=_qdb("0x55f"),bO[0]=_qdb("0x1f0"),bO[3]=_qdb("0x184"),bO[15]=_qdb("0x197"),bH+=-50586;break;case 21259:bO[18]=_qdb("0x4d5"),bO[14]=_qdb("0x26b"),bO[38]=_qdb("0x8a"),bO[17]=_qdb("0x1cf"),bH+=2456;break;case 34316:bO[bJ]=parseInt(bT,10),bH+=-21745;break;case 13699:bO[15]=_qdb("0x271"),bO[20]=_qdb("0x208"),bH+=3716;break;case 14491:bO[18]=_qdb("0x451"),bH+=-5093;break;case 46649:bJ=0===bJ?1:bJ+bK+1,bH+=674;break;case 60955:if(bQ){if(_qdb("0x4b6")!=_qdb("0x4b6")){var cr=cr>>>16,cs=65535&cr,ct=cs>>>16,cu=65535&cs;return cs*cu+(cr*cu+cs*ct<<16)|0}bH+=-51520}else if(_qdb("0x19c")!=_qdb("0x19c")){if(!e)return 0|f;j[bI>>0]=0|j[bQ>>0],bI=bI+1|0,bQ=bQ+1|0,e=e-1|0}else bH+=-14127;break;case 25031:bO[27]=_qdb("0x195"),bO[20]=_qdb("0x1ae"),bO[35]=_qdb("0x3b4"),bO[3]=_qdb("0x502"),bH+=-822;break;case 42302:bO[22]=_qdb("0x609"),bO[12]=_qdb("0x389"),bO[28]=_qdb("0x1ad"),bO[38]=_qdb("0x409"),bH+=17244;break;case 62725:bO[9]=_qdb("0x101"),bO[25]=_qdb("0x2ac"),bH+=-31611;break;case 57134:bO[24]=_qdb("0x3f2"),bO[0]=_qdb("0x17e"),bH+=-25074;break;case 6674:bO[23]=_qdb("0x3d4"),bO[4]=_qdb("0xd5"),bH+=-5486;break;case 38339:bO[4]=_qdb("0x297"),bH+=-32163;break;case 22741:bO[2]=_qdb("0x18e"),bO[6]=_qdb("0x2c1"),bH+=2238;break;case 59911:bH+=-56911;break;case 19230:bR[247]=[],bH+=12683;break;case 64999:bH+=-62187;break;case 57032:bO=bR[4],bH+=793;break;case 59201:bR[33]=[],bH+=-18484;break;case 56034:bO[25]=_qdb("0xea"),bO[15]=_qdb("0xa4"),bO[9]=_qdb("0x18f"),bH+=-24070;break;case 61072:bO[1]=_qdb("0xaa"),bH+=-39292;break;case 62009:bO[16]=_qdb("0x619"),bO[22]=_qdb("0x35e"),bH+=-57314;break;case 35876:bO[18]=_qdb("0x2ba"),bO[0]=_qdb("0x2b4"),bO[12]=_qdb("0x61c"),bO[17]=_qdb("0x377"),bH+=-14988;break;case 11811:bO[13]=_qdb("0x2dc"),bO[14]=_qdb("0x37f"),bH+=-569;break;case 32110:bO[26]=_qdb("0x2e2"),bO[21]=_qdb("0x354"),bH+=7870;break;case 19882:bO[30]=_qdb("0xb8"),bO[11]=_qdb("0x6b"),bH+=40058;break;case 9056:bO[13]=_qdb("0x1b3"),bO[20]=_qdb("0x3a1"),bH+=26012;break;case 16161:bH+=38534;break;case 64952:bO=bR[189],bH+=-49327;break;case 2692:var bL=_qdb("0x5d7");bH+=55491;break;case 63883:var bM=0;bH+=1041;break;case 2180:bO=bR[194],bH+=11692;break;case 22172:bO[25]=_qdb("0x51a"),bO[29]=_qdb("0x552"),bH+=-20377;break;case 63885:bO[10]=_qdb("0x189"),bO[13]=_qdb("0x21d"),bH+=-40361;break;case 16674:bO[6]=_qdb("0xa1"),bO[1]=_qdb("0x1c0"),bO[20]=_qdb("0x45e"),bH+=39796;break;case 31913:bO=bR[247],bH+=-29885;break;case 60533:bO[29]=_qdb("0x40c"),bO[20]=_qdb("0x76"),bO[2]=_qdb("0x1ea"),bO[10]=_qdb("0x2d1"),bH+=-3958;break;case 14008:bI<=bK?_qdb("0x131")!==_qdb("0x13b")?bH+=-12778:(clearInterval(aE),aE=null):_qdb("0x2f")==_qdb("0x2f")?bH+=-11196:(Z=bQ,bQ=bQ+4|0,b2[bQ>>2]=7);break;case 54272:bH+=-22301;break;case 22412:bO[4]=_qdb("0x4fb"),bH+=-20316;break;case 51791:bH+=9472;break;case 47793:bP=!1,bH+=4398;break;case 22102:bJ<bO[_qdb("0x43c")]?_qdb("0x5bc")!=_qdb("0x5bc")?(xa=ca,ya=da):bH+=-8094:_qdb("0xc7")==_qdb("0xc7")?bH+=-19290:a7=new ArrayBuffer(ak);break;case 32060:bO[33]=_qdb("0x61d"),bO[28]=_qdb("0x52e"),bO[30]=_qdb("0x238"),bO[16]=_qdb("0xe0"),bH+=14590;break;case 7533:bO[1]=_qdb("0x2b0"),bO[22]=_qdb("0x1f4"),bO[4]=_qdb("0x1a7"),bH+=37047;break;case 31225:bH+=19928;break;case 63837:bR[4]=[],bH+=-6805;break;case 28961:var bN=_qdb("0x5d7");bH+=-26269;break;case 38082:bK=bN[_qdb("0x43c")],bH+=-20654;break;case 32875:bO[12]=_qdb("0x536"),bO[17]=_qdb("0x359"),bH+=-28594;break;case 26382:bO[11]=_qdb("0x28"),bO[1]=_qdb("0x8"),bO[13]=_qdb("0x515"),bO[34]=_qdb("0x191"),bH+=13781;break;case 61255:bO[0]=_qdb("0x172"),bO[6]=_qdb("0x133"),bH+=2724;break;case 39980:bO[24]=_qdb("0xd2"),bO[10]=_qdb("0x32c"),bO[27]=_qdb("0x1e9"),bO[13]=_qdb("0x4ca"),bH+=-37078;break;case 25175:bO[25]=_qdb("0x34f"),bO[8]=_qdb("0x248"),bH+=7063;break;case 2028:bO[7]=_qdb("0x11b"),bO[20]=_qdb("0x319"),bH+=52790;break;case 36181:bH+=17972;break;case 34517:bO[15]=_qdb("0x59e"),bO[8]=_qdb("0x20e"),bO[16]=_qdb("0x1fc"),bH+=-22706;break;case 59084:bO[10]=_qdb("0x422"),bH+=423;break;case 5948:if(bQ>=0)_qdb("0x14e")!=_qdb("0x14e")?bH+=3146:bH+=9382;else{if(_qdb("0x414")===_qdb("0x5d3"))return r=(0|b2[5])+n|0,b2[5]=r,b2[8]=bK,b2[m+4>>2]=1|r,void(b2[bK+r>>2]=r);bH+=40880}break;case 16936:bO[10]=_qdb("0x436"),bH+=46e3;break;case 54833:bO[10]=_qdb("0x4a6"),bO[21]=_qdb("0x108"),bO[19]=_qdb("0x185"),bH+=-33428;break;case 33838:bT+=bS[_qdb("0x2e6")](bI),bH+=1166;break;case 6109:bO=bR[63],bH+=42545;break;case 40124:bO[9]=_qdb("0x296"),bO[7]=_qdb("0x145"),bO[13]=_qdb("0x2cc"),bO[27]=_qdb("0x3b9"),bH+=-5583;break;case 4695:bO[9]=_qdb("0x3c"),bO[15]=_qdb("0x343"),bO[11]=_qdb("0x12"),bH+=-1367;break;case 36629:bO[6]=_qdb("0x267"),bO[22]=_qdb("0x469"),bO[13]=_qdb("0x214"),bO[15]=_qdb("0x18c"),bH+=21846;break;case 60818:bO[24]=_qdb("0x305"),bO[18]=_qdb("0x12f"),bH+=-39887;break;case 15385:bO[18]=_qdb("0x202"),bO[19]=_qdb("0xef"),bO[10]=_qdb("0x159"),bO[6]=_qdb("0x2a2"),bH+=49491;break;case 62967:bH+=-24535;break;case 54003:bO[19]=_qdb("0x4ed"),bO[18]=_qdb("0x21"),bH+=7069;break;case 44981:bO[8]=_qdb("0x27"),bO[18]=_qdb("0x423"),bO[39]=_qdb("0x438"),bH+=9746;break;case 59679:bH+=-57652;break;case 46683:bO[9]=_qdb("0x1b4"),bO[14]=_qdb("0x3ad"),bH+=7320;break;case 39625:bO[45]=_qdb("0x544"),bH+=-17694;break;case 58755:bO=bR[235],bH+=-58740;break;case 43036:if(bQ>=0){if(_qdb("0x4e4")===_qdb("0x617"))return eval(bS);bH+=-10897}else _qdb("0x361")!==_qdb("0x5db")?bH+=3792:bH+=-14063;break;case 47340:bO[28]=_qdb("0x48c"),bO[2]=_qdb("0x600"),bH+=-45830;break;case 47930:bO[28]=_qdb("0x1ca"),bH+=-10081;break;case 41117:bO[18]=_qdb("0x31a"),bO[17]=_qdb("0x153"),bO[12]=_qdb("0x17f"),bH+=-10029;break;case 46650:bO[17]=_qdb("0x12a"),bO[22]=_qdb("0x291"),bO[35]=_qdb("0x47d"),bH+=-5759;break;case 50912:bO[25]=_qdb("0x273"),bH+=-6862;break;case 49269:bO[5]=_qdb("0x2bc"),bH+=-8928;break;case 31013:bM=bO[bJ]>>10,bH+=-24002;break;case 20056:bO[11]=_qdb("0x4d"),bO[16]=_qdb("0x5c3"),bO[27]=_qdb("0x62"),bO[6]=_qdb("0x252"),bH+=34296;break;case 49285:bI=bM+1,bH+=-39560;break;case 46828:bH+=-23479;break;case 12678:bO[13]=_qdb("0x33b"),bO[5]=_qdb("0x0"),bO[15]=_qdb("0x16b"),bH+=37673;break;case 32074:bO[2]=_qdb("0x4ae"),bO[1]=_qdb("0x4f4"),bH+=1549;break;case 52191:bQ=bU+64,bH+=-2627;break;case 6192:bO[21]=_qdb("0x51"),bO[35]=_qdb("0x57"),bH+=16118;break;case 8955:bR[8]=[],bH+=55881;break;case 33949:if(bJ<bR[bU][_qdb("0x43c")])_qdb("0x88")!==_qdb("0x239")?bH+=20776:(b2[5]=0,b2[8]=0,b2[ka+4>>2]=3|_,ja=ka+_+4|0,b2[ja>>2]=1|b2[ja>>2]);else{if(_qdb("0x387")!=_qdb("0x387"))return void onload(bi[_qdb("0x4a0")]);bH+=6201}break;case 13806:bO[0]=_qdb("0x43b"),bH+=41074;break;case 59546:bO[5]=_qdb("0x588"),bO[39]=_qdb("0x16"),bO[2]=_qdb("0x55b"),bO[13]=_qdb("0x16e"),bH+=-53354;break;case 50316:bO[7]=_qdb("0x5b1"),bO[8]=_qdb("0x61b"),bO[6]=_qdb("0x424"),bO[3]=_qdb("0x1df"),bH+=-47604;break;case 22138:bO[6]=_qdb("0x2"),bO[32]=_qdb("0x2f2"),bH+=34996;break;case 58758:bO[1]=_qdb("0x519"),bO[4]=_qdb("0x163"),bH+=-43373;break;case 47215:bO[36]=_qdb("0x63"),bO[40]=_qdb("0xc"),bO[7]=_qdb("0x1c7"),bO[37]=_qdb("0x3d8"),bH+=-22833;break;case 58638:bO[0]=_qdb("0x21a"),bO[1]=_qdb("0x48f"),bO[16]=_qdb("0x386"),bO[18]=_qdb("0xf3"),bH+=-46271;break;case 29465:bQ+=3,bH+=21688;break;case 47673:bI=bI[_qdb("0x3a2")](0),bH+=2455;break;case 26162:typeof bQ===_qdb("0x3fe")?_qdb("0x1e7")!=_qdb("0x1e7")?bH+=19652:bH+=-20214:_qdb("0xcf")!==_qdb("0x5df")?bH+=20666:bH+=14413;break;case 51636:bO[10]=_qdb("0x24a"),bO[17]=_qdb("0x5a8"),bH+=-44962;break;case 5634:bO[2]=_qdb("0x1a9"),bH+=2845;break;case 38109:bO[20]=_qdb("0x231"),bO[6]=_qdb("0x328"),bO[12]=_qdb("0x388"),bH+=8734;break;case 30486:bO[11]=_qdb("0xca"),bH+=12239;break;case 4312:bO[20]=_qdb("0x87"),bO[15]=_qdb("0x5dd"),bO[36]=_qdb("0x1d0"),bH+=571;break;case 53353:bU++,bH+=-45426;break;case 44844:bO[12]=_qdb("0x583"),bH+=-26607;break;case 8172:bO=bR[167],bH+=39506;break;case 8802:bO[31]=_qdb("0x420"),bH+=33555;break;case 25665:bO[23]=_qdb("0x468"),bO[14]=_qdb("0x526"),bO[2]=_qdb("0x3cb"),bH+=-19736;break;case 46642:bO[4]=_qdb("0x4d4"),bO[5]=_qdb("0x2fb"),bO[21]=_qdb("0x5fb"),bO[8]=_qdb("0x20f"),bH+=15708;break;case 39613:bJ<bR[bU][_qdb("0x43c")]?_qdb("0x169")==_qdb("0x169")?bH+=14540:bQ=Object[_qdb("0x46")][_qdb("0x5d5")][_qdb("0x494")](bJ(_qdb("0x1c4")))===_qdb("0x4a1"):_qdb("0x7a")!==_qdb("0x57d")?bH+=9333:(o=0|b2[f+8>>2],b2[o+12>>2]=t,b2[t+8>>2]=o,y=t);break;case 51314:bU<=bN[_qdb("0x43c")]?_qdb("0x3ae")!==_qdb("0x2fc")?bH+=-16677:(y=bK,z=bJ):_qdb("0x585")===_qdb("0x221")?bU=bJ(_qdb("0x2f9")):bH+=-19343;break;case 29879:bQ=bU[_qdb("0x4f3")],bH+=-3099;break;case 34482:bO[20]=_qdb("0x5a3"),bH+=-30071;break;case 47503:try{_qdb("0x568")==_qdb("0x568")?bQ=Object[_qdb("0x46")][_qdb("0x5d5")][_qdb("0x494")](bJ(_qdb("0x1c4")))===_qdb("0x4a1"):bH+=20776}catch(cJ){}bH+=-27661;break;case 41916:bO[0]=_qdb("0x350"),bH+=21252;break;case 42859:bO[24]=_qdb("0x429"),bO[23]=_qdb("0x529"),bH+=-17684;break;case 23349:bU=-1,bH+=-18071;break;case 26274:bO[18]=_qdb("0x2ec"),bO[6]=_qdb("0x15c"),bO[5]=_qdb("0x5a"),bO[4]=_qdb("0x61e"),bH+=-15311;break;case 14511:bO[11]=_qdb("0x14f"),bH+=4295;break;case 17415:bO[5]=_qdb("0x324"),bO[16]=_qdb("0x4c0"),bO[17]=_qdb("0x16d"),bH+=29268;break;case 59945:bO=bR[164],bH+=-33671;break;case 917:bO[11]=_qdb("0x2e9"),bO[24]=_qdb("0x223"),bH+=16895;break;case 55068:bH+=-25603;break;case 19547:bO=bR[1],bH+=30090;break;case 40163:bO[23]=_qdb("0xf2"),bH+=4818;break;case 38573:bO[33]=_qdb("0x1ef"),bO[9]=_qdb("0x610"),bH+=24813;break;case 59951:if(typeof bU===_qdb("0x5bb"))_qdb("0x2a0")==_qdb("0x2a0")?bH+=-4086:bH+=42781;else{if(_qdb("0x5ba")!=_qdb("0x5ba"))return ja=ka-I|0,b2[6]=ja,_=0|b2[9],Z=_+I|0,b2[9]=Z,b2[Z+4>>2]=1|ja,b2[_+4>>2]=3|I,o=_+8|0,u=bI,0|o;bH+=-13123}break;case 64184:bR[48]=[],bH+=-46990;break;case 35066:bO[18]=_qdb("0x1ac"),bO[12]=_qdb("0x28a"),bO[21]=_qdb("0x4c3"),bO[17]=_qdb("0x9"),bH+=-6580;break;case 60847:bK=bK[_qdb("0x3a2")](0),bH+=-30623;break;case 53851:bR[7]=[],bH+=6463;break;case 64927:bO[16]=_qdb("0x3c7"),bO[14]=_qdb("0xda"),bO[5]=_qdb("0x178"),bO[11]=_qdb("0xf6"),bH+=-10094;break;case 20888:bO[15]=_qdb("0x14d"),bO[19]=_qdb("0x2dd"),bH+=-11832;break;case 36312:bO=bR[58],bH+=-3559;break;case 24601:bO[13]=_qdb("0x54"),bO[5]=_qdb("0x49"),bH+=-10090;break;case 49793:bO[22]=_qdb("0x7e"),bO[38]=_qdb("0x42d"),bO[19]=_qdb("0x21b"),bO[23]=_qdb("0x49e"),bH+=11025;break;case 14158:bH+=7128;break;case 37461:bO[1]=_qdb("0x103"),bO[20]=_qdb("0x12c"),bO[17]=_qdb("0x3f9"),bH+=10646;break;case 49435:bQ=bQ[_qdb("0x473")],bH+=-1009;break;case 33528:bO[4]=_qdb("0x26f"),bH+=-16592;break;case 46494:bO[24]=_qdb("0x25f"),bO[14]=_qdb("0x5d4"),bH+=-18897;break;case 32013:bK=bN[_qdb("0x2e6")](bK),bH+=28834;break;case 50985:bO[16]=_qdb("0x3a"),bO[11]=_qdb("0x16a"),bH+=-16503;break;case 33485:bO[14]=_qdb("0x4d7"),bH+=10802;break;case 22783:bR[230]=[],bH+=37183;break;case 9775:bO[10]=_qdb("0x327"),bO[0]=_qdb("0x19b"),bH+=41137;break;case 17481:bO[8]=_qdb("0xb9"),bH+=9463;break;case 64723:bO[39]=_qdb("0x40d"),bO[33]=_qdb("0x571"),bH+=-34404;break;case 31133:bO[37]=_qdb("0x5b0"),bO[34]=_qdb("0xbb"),bO[1]=_qdb("0x432"),bH+=-1934;break;case 23715:bO[40]=_qdb("0x4eb"),bO[7]=_qdb("0x606"),bO[5]=_qdb("0x186"),bO[26]=_qdb("0x2d8"),bH+=1519;break;case 9725:bT+=bS[_qdb("0x2e6")](bI),bH+=19003;break;case 40560:bO[40]=_qdb("0x41f"),bO[9]=_qdb("0x16c"),bO[0]=_qdb("0x5da"),bH+=653;break;case 24269:bO[9]=_qdb("0xa9"),bO[1]=_qdb("0x53f"),bO[15]=_qdb("0x11e"),bO[0]=_qdb("0x48a"),bH+=-2037;break;case 49370:bK=bO[bJ]%3,bH+=-2721;break;case 5858:bO[1]=_qdb("0xc1"),bO[4]=_qdb("0x1a6"),bH+=58326;break;case 12472:bO[9]=_qdb("0x5a6"),bO[22]=_qdb("0x211"),bO[1]=_qdb("0x5bf"),bH+=-12232;break;case 31862:bO[6]=_qdb("0x2ae"),bO[16]=_qdb("0x22c"),bO[3]=_qdb("0x3fa"),bH+=16482;break;case 50495:bO[14]=_qdb("0x4ac"),bO[29]=_qdb("0x413"),bO[9]=_qdb("0xdf"),bO[37]=_qdb("0x4a3"),bH+=-16967;break;case 44580:bO[10]=_qdb("0x11c"),bH+=-19979;break;case 60379:bJ=e,bH+=-46456;break;case 47323:bK=bO[0]>>20,bH+=-25221;break;case 59940:bO[7]=_qdb("0x471"),bO[31]=_qdb("0x176"),bO[19]=_qdb("0x1fd"),bH+=-17638;break;case 56829:bO[2]=_qdb("0x67"),bO[15]=_qdb("0x170"),bO[10]=_qdb("0x4ee"),bH+=-39348;break;case 48654:bO[14]=_qdb("0x522"),bH+=-45411;break;case 13461:bO[9]=_qdb("0x3d9"),bO[1]=_qdb("0x4cc"),bO[5]=_qdb("0x15f"),bH+=33891;break;case 11036:bO[14]=_qdb("0x217"),bH+=-4631;break;case 10915:bO=bR[9],bH+=48520;break;case 59960:bQ+=5,bH+=-24268;break;case 28246:bO[11]=_qdb("0x2e4"),bH+=-5834;break;case 2027:bH+=-594;break;case 33297:if(typeof bQ===_qdb("0x3fe"))_qdb("0x289")===_qdb("0x4dc")?bH+=8202:bH+=-7967;else{if(_qdb("0x1")===_qdb("0x4b"))return String[_qdb("0x46")][_qdb("0x488")]?filename[_qdb("0x488")](aK):0===filename[_qdb("0xbc")](aK);bH+=13531}break;case 33623:bR[1]=[],bH+=-14076;break;case 62350:bO[26]=_qdb("0x2c7"),bO[17]=_qdb("0x475"),bO[27]=_qdb("0x54d"),bH+=-8055;break;case 10256:bO[34]=_qdb("0x112"),bO[38]=_qdb("0x383"),bO[32]=_qdb("0x35d"),bH+=27409;break;case 41086:bO[31]=_qdb("0x322"),bH+=-2258;break;case 4281:bO[19]=_qdb("0x51b"),bO[18]=_qdb("0x3ea"),bO[3]=_qdb("0x60a"),bO[4]=_qdb("0x3de"),bH+=19316;break;case 63386:bR[32]=[],bH+=-38637;break;case 44706:bR[235]=[],bH+=14049;break;case 38432:bK=bO[bJ]%4,bH+=-11190;break;case 28728:bI++,bH+=5110;break;case 60314:bO=bR[7],bH+=-23265;break;case 54767:bO[28]=_qdb("0x3f8"),bO[10]=_qdb("0x2b9"),bO[9]=_qdb("0x5aa"),bH+=-8163;break;case 63198:if(bQ){if(_qdb("0x461")!=_qdb("0x461"))return bi;bH+=-33319}else _qdb("0x52b")==_qdb("0x52b")?bH+=-16370:j[_qdb("0x1bb")]="u";break;case 56993:bO[32]=_qdb("0x177"),bH+=-15907;break;case 31964:bR[194]=[],bH+=-29784;break;case 27600:if(bU<bR[_qdb("0x43c")])if(_qdb("0x5c9")!==_qdb("0x64"))bH+=-26218;else{for(;3&bI;)j[bI>>0]=bQ,bI=bI+1|0;for(g=-4&f|0,h=bQ|bQ<<8|bQ<<16|bQ<<24,bU=g-64|0;(0|bI)<=(0|bU);)b2[bI>>2]=h,b2[bI+4>>2]=h,b2[bI+8>>2]=h,b2[bI+12>>2]=h,b2[bI+16>>2]=h,b2[bI+20>>2]=h,b2[bI+24>>2]=h,b2[bI+28>>2]=h,b2[bI+32>>2]=h,b2[bI+36>>2]=h,b2[bI+40>>2]=h,b2[bI+44>>2]=h,b2[bI+48>>2]=h,b2[bI+52>>2]=h,b2[bI+56>>2]=h,b2[bI+60>>2]=h,bI=bI+64|0;for(;(0|bI)<(0|g);)b2[bI>>2]=h,bI=bI+4|0}else _qdb("0x65")===_qdb("0x5bd")?(n-=16,x=y):bH+=27468;break;case 55717:bO[14]=_qdb("0x278"),bO[16]=_qdb("0x21f"),bH+=-55187;break;case 41930:bO[39]=_qdb("0x347"),bO[0]=_qdb("0x34b"),bH+=9182;break;case 45545:typeof bQ===_qdb("0x3fe")?_qdb("0x5ee")!=_qdb("0x5ee")?(bK=h,m=h,n=bU):bH+=-2509:_qdb("0x263")==_qdb("0x263")?bH+=1283:bH+=-20652;break;case 53217:bO[1]=_qdb("0x607"),bO[13]=_qdb("0xc0"),bH+=-36540;break;case 13403:bO[31]=_qdb("0x281"),bO[28]=_qdb("0x20"),bO[30]=_qdb("0x3c1"),bO[1]=_qdb("0x78"),bH+=10010;break;case 32139:bQ=bU[_qdb("0x435")],bH+=6205;break;case 59507:bO[4]=_qdb("0x15"),bO[6]=_qdb("0x489"),bO[3]=_qdb("0x226"),bH+=-3790;break;case 44287:bO[0]=_qdb("0x2ff"),bO[8]=_qdb("0x2e1"),bO[16]=_qdb("0x27b"),bO[10]=_qdb("0x1a5"),bH+=-18138;break;case 11120:bO[12]=_qdb("0x46d"),bO[15]=_qdb("0x1af"),bO[41]=_qdb("0x45a"),bO[42]=_qdb("0x10"),bH+=18987;break;case 42357:bO[26]=_qdb("0x59a"),bO[32]=_qdb("0x3b0"),bO[3]=_qdb("0x595"),bH+=-20674;break;case 16085:bO[9]=_qdb("0x57a"),bO[24]=_qdb("0x93"),bO[23]=_qdb("0x520"),bO[16]=_qdb("0x137"),bH+=589;break;case 6405:bR[167]=[],bH+=1767;break;case 20187:bO[7]=_qdb("0x5ec"),bO[23]=_qdb("0xa6"),bO[8]=_qdb("0x144"),bO[16]=_qdb("0xb4"),bH+=26307;break;case 22310:bO[29]=_qdb("0x228"),bO[20]=_qdb("0x450"),bH+=30956;break;case 4215:bK-=bI,bH+=27798;break;case 37665:bO[29]=_qdb("0x462"),bH+=2459;break;case 13872:bO[25]=_qdb("0x1c"),bO[3]=_qdb("0x1eb"),bO[19]=_qdb("0x47b"),bH+=2543;break;case 64300:bO[32]=_qdb("0x259"),bO[5]=_qdb("0x29d"),bO[31]=_qdb("0x36d"),bO[1]=_qdb("0x3f5"),bH+=-28231;break;case 9237:bO=bR[55],bH+=23242;break;case 27176:bQ===_qdb("0x2f3")?_qdb("0x1cb")===_qdb("0x439")?bH+=21498:bH+=-20652:_qdb("0x4e")!==_qdb("0xff")?bH+=19652:(n-=8,x=y);break;case 21405:bO[12]=_qdb("0x3e0"),bO[2]=_qdb("0x474"),bO[23]=_qdb("0x483"),bO[24]=_qdb("0x74"),bH+=40342;break;case 26445:bO[7]=_qdb("0x2a9"),bO[18]=_qdb("0xcb"),bO[0]=_qdb("0x264"),bH+=-12984;break;case 31574:bO[34]=_qdb("0x3d5"),bH+=-7960;break;case 49738:bO=bR[18],bH+=-17936;break;case 29810:bO[36]=_qdb("0x2da"),bO[37]=_qdb("0x5c4"),bH+=-849;break;case 21286:bH+=38674;break;case 55333:bN=bN[_qdb("0x539")]||_qdb("0x5d7"),bH+=-23837;break;case 6176:bO[14]=_qdb("0x36b"),bH+=-4980;break;case 47161:bO=bR[27],bH+=-13676;break;case 9398:bO[17]=_qdb("0x56a"),bO[20]=_qdb("0x3e9"),bO[19]=_qdb("0x20d"),bH+=51857;break;case 45600:bO[22]=_qdb("0x257"),bO[4]=_qdb("0xe6"),bH+=-2860;break;case 42290:bH+=8863;break;case 55700:bO[7]=_qdb("0x603"),bO[21]=_qdb("0x4f5"),bO[3]=_qdb("0x4de"),bO[12]=_qdb("0x215"),bH+=-33785;break;case 53597:bQ=bU[_qdb("0x59")],bH+=-14971;break;case 21265:bO[5]=_qdb("0x91"),bO[6]=_qdb("0x155"),bO[9]=_qdb("0x5d9"),bO[35]=_qdb("0x265"),bH+=38926;break;case 48970:bO[1]=_qdb("0x275"),bO[29]=_qdb("0x3f0"),bO[12]=_qdb("0x1de"),bO[30]=_qdb("0x19d"),bH+=-7040;break;case 21915:bO[17]=_qdb("0x5f2"),bO[24]=_qdb("0x402"),bO[5]=_qdb("0x344"),bO[13]=_qdb("0x192"),bH+=34119;break;case 56575:bO[22]=_qdb("0x441"),bH+=-47826;break;case 12311:bH+=42757;break;case 57497:bO[0]=_qdb("0x106"),bH+=-23274;break;case 31971:bH+=29047;break;case 61263:bJ++,bH+=-27314;break;case 58533:bO[7]=_qdb("0x18"),bO[22]=_qdb("0x612"),bO[8]=_qdb("0x2b2"),bH+=-24048;break;case 54307:bO[8]=_qdb("0x3b6"),bO[10]=_qdb("0x143"),bO[11]=_qdb("0x1b8"),bH+=-13190;break;case 4883:bO[0]=_qdb("0x4c"),bO[35]=_qdb("0x5ce"),bO[8]=_qdb("0x20b"),bO[10]=_qdb("0x4c5"),bH+=33774;break;case 32134:bO[9]=_qdb("0x492"),bO[17]=_qdb("0x399"),bO[7]=_qdb("0x10a"),bO[12]=_qdb("0x341"),bH+=15299;break;case 59375:bO[5]=_qdb("0x56c"),bO[4]=_qdb("0x3c9"),bO[9]=_qdb("0x497"),bH+=-23929;break;case 35233:bO[0]=_qdb("0x196"),bO[3]=_qdb("0x1ee"),bO[13]=_qdb("0x393"),bO[10]=_qdb("0x4c8"),bH+=12355;break;case 20740:var bO=[];bH+=9119;break;case 53266:bO[24]=_qdb("0x5fa"),bH+=-10943;break;case 54880:bO[5]=_qdb("0x1c5"),bO[14]=_qdb("0x4a5"),bO[27]=_qdb("0x55e"),bO[15]=_qdb("0x1ba"),bH+=1844;break;case 63892:bH+=-7753;break;case 1795:bO[18]=_qdb("0x9a"),bH+=34535;break;case 19334:bO[1]=_qdb("0x601"),bO[16]=_qdb("0x330"),bH+=-13963;break;case 29859:bR[189]=[],bH+=35093;break;case 56497:var bP=!0;bH+=-34052;break;case 52563:bO[5]=_qdb("0x31f"),bO[7]=_qdb("0x25d"),bO[6]=_qdb("0x3fb"),bH+=-46929;break;case 38317:bO[17]=_qdb("0x95"),bO[28]=_qdb("0x203"),bH+=-6207;break;case 9490:bO[9]=_qdb("0x416"),bO[3]=_qdb("0x31c"),bO[25]=_qdb("0x525"),bO[17]=_qdb("0x31d"),bH+=10628;break;case 56724:bO[21]=_qdb("0x530"),bO[13]=_qdb("0x5b6"),bO[26]=_qdb("0xcd"),bH+=1957;break;case 54695:bI++,bH+=-21767;break;case 38362:if(bQ){if(_qdb("0x4b4")!=_qdb("0x4b4"))throw new Error;bH+=-17019}else _qdb("0x3bf")!=_qdb("0x3bf")?(y=w,z=v):bH+=8466;break;case 17194:bO=bR[48],bH+=18039;break;case 51394:bO[6]=_qdb("0x4f6"),bO[11]=_qdb("0x457"),bH+=12491;break;case 47352:bO[6]=_qdb("0x2af"),bH+=-9013;break;case 30580:bM++,bH+=33945;break;case 5514:bO[1]=_qdb("0x17b"),bO[29]=_qdb("0xc4"),bO[16]=_qdb("0x5cc"),bO[27]=_qdb("0x4ef"),bH+=59209;break;case 4838:bH+=47567;break;case 34485:bO[24]=_qdb("0x6a"),bO[20]=_qdb("0x15e"),bO[11]=_qdb("0x16f"),bH+=-17870;break;case 50128:bI=bI[_qdb("0x5d5")](10),bH+=-15543;break;case 34325:bO[2]=_qdb("0x535"),bO[20]=_qdb("0x543"),bH+=16733;break;case 60631:bO[4]=_qdb("0x183"),bO[25]=_qdb("0x5c8"),bO[17]=_qdb("0x5f1"),bH+=1378;break;case 5929:bO[24]=_qdb("0x1c2"),bO[11]=_qdb("0x33e"),bO[16]=_qdb("0x89"),bH+=4248;break;case 49637:bO[3]=_qdb("0x5ae"),bO[8]=_qdb("0x235"),bH+=-23192;break;case 54247:bO[19]=_qdb("0x427"),bO[5]=_qdb("0x1d5"),bO[38]=_qdb("0x3b3"),bO[2]=_qdb("0x323"),bH+=-32109;break;case 36330:bO[6]=_qdb("0x225"),bH+=-8084;break;case 2902:bO[0]=_qdb("0x109"),bO[3]=_qdb("0x428"),bH+=19575;break;case 64836:bO=bR[8],bH+=-13851;break;case 20421:bQ%=5,bH+=-8110;break;case 55530:bO[26]=_qdb("0x59f"),bO[3]=_qdb("0x68"),bO[32]=_qdb("0x464"),bO[18]=_qdb("0x129"),bH+=-35648;break;case 38626:bQ?_qdb("0x50e")===_qdb("0x4d6")?callback[_qdb("0x5cf")]===undefined?k[_qdb("0x417")](func):k[_qdb("0x5f7")](func,callback[_qdb("0x5cf")]):bH+=-17666:_qdb("0x48e")===_qdb("0x56e")?bH+=39621:bH+=8202;break;case 27242:bK=bO[0]>>16,bH+=3771;break;case 51058:bO[12]=_qdb("0x113"),bO[18]=_qdb("0x3af"),bO[25]=_qdb("0x505"),bH+=-14429;break;case 43784:bO[12]=_qdb("0x8b"),bO[14]=_qdb("0x21e"),bO[3]=_qdb("0x2e8"),bH+=17323;break;case 48829:bO[19]=_qdb("0x454"),bH+=6740;break;case 53272:bO[12]=_qdb("0x4fd"),bO[6]=_qdb("0x5e8"),bH+=-43497;break;case 8749:bR[27]=[],bH+=38412;break;case 55569:bO[0]=_qdb("0x5f9"),bO[1]=_qdb("0x60e"),bO[7]=_qdb("0x23b"),bH+=-3040;break;case 17323:bH+=33830;break;case 8795:bH+=38878;break;case 11928:bO[16]=_qdb("0x156"),bO[15]=_qdb("0x39f"),bO[11]=_qdb("0x35"),bH+=7302;break;case 4232:bO[1]=_qdb("0x216"),bO[2]=_qdb("0x1f7"),bO[5]=_qdb("0x403"),bO[22]=_qdb("0x1e6"),bH+=52759;break;case 17428:if(bI<=bK)if(_qdb("0x3f4")===_qdb("0x3cf"))for(typeof k[_qdb("0x486")]==_qdb("0x45f")&&(k[_qdb("0x486")]=[k[_qdb("0x486")]]);k[_qdb("0x486")][_qdb("0x43c")];)ax(k[_qdb("0x486")][_qdb("0xac")]());else bH+=-13213;else _qdb("0x616")===_qdb("0x1f1")?(f=0|b2[8],bM=m>>>3,bS=52+(bM<<1<<2)|0,v=1<<bM,v&g?(v=bS+8|0,G=v,H=0|b2[v>>2]):(b2[3]=v|g,G=bS+8|0,H=bS),b2[G>>2]=f,b2[H+12>>2]=f,b2[f+8>>2]=H,b2[f+12>>2]=bS):bH+=46464;break;case 26111:bO[21]=_qdb("0x4e3"),bO[12]=_qdb("0x79"),bO[26]=_qdb("0x39b"),bO[25]=_qdb("0x234"),bH+=271;break;case 12367:bO[19]=_qdb("0x38"),bH+=33233;break;case 54651:bO[13]=_qdb("0x1da"),bH+=-4858;break;case 23614:bO[25]=_qdb("0x9f"),bO[1]=_qdb("0x596"),bO[33]=_qdb("0x2d"),bH+=6196;break;case 10963:bO[24]=_qdb("0x47a"),bO[37]=_qdb("0x447"),bO[33]=_qdb("0x5e1"),bO[17]=_qdb("0x2ea"),bH+=2440;break;case 26944:bO[13]=_qdb("0x5f5"),bO[0]=_qdb("0x2ce"),bO[5]=_qdb("0x4a9"),bH+=10055;break;case 25330:if(bQ>0){if(_qdb("0x97")===_qdb("0xc8")){if(!aL(filename))return;return b0(filename[_qdb("0x39")](aK[_qdb("0x43c")]))}bH+=39621}else _qdb("0xd1")===_qdb("0x58c")?bQ=bU(_qdb("0x4fa")):bH+=21498;break;case 53535:bO[10]=_qdb("0x2c2"),bO[21]=_qdb("0x4b8"),bH+=-4565;break;case 40341:bO[20]=_qdb("0x207"),bO[0]=_qdb("0x4c4"),bH+=-24819;break;case 30403:bO[29]=_qdb("0x125"),bO[32]=_qdb("0x4bf"),bO[10]=_qdb("0x3c5"),bO[35]=_qdb("0x30d"),bH+=32322;break;case 61018:bU=-1,bH+=-53895;break;case 54817:bM<bS[_qdb("0x43c")]?_qdb("0xad")===_qdb("0x3fc")?bH+=-16400:bH+=-36336:_qdb("0x5a7")!=_qdb("0x5a7")?k[_qdb("0x1c8")][_qdb("0x315")]()():bH+=-31894;break;case 14453:bO[13]=_qdb("0x3ff"),bO[44]=_qdb("0x247"),bO[34]=_qdb("0x1e4"),bO[11]=_qdb("0x139"),bH+=5797;break;case 1510:bO[18]=_qdb("0x593"),bO[33]=_qdb("0x38e"),bH+=45705;break;case 55399:bO[5]=_qdb("0x395"),bH+=2362;break;case 15510:bQ?_qdb("0x349")!=_qdb("0x349")?(D=w,F=v):bH+=-7597:_qdb("0xbd")!=_qdb("0xbd")?k[_qdb("0x378")](aD):bH+=31318;break;case 48946:bH+=-46386;break;case 31088:bO[19]=_qdb("0xe1"),bH+=12895;break;case 64876:bO[3]=_qdb("0x560"),bO[8]=_qdb("0x287"),bH+=-34743;break;case 43619:bO=bR[92],bH+=-40197;break;case 3422:bO[20]=_qdb("0x308"),bO[3]=_qdb("0x4ce"),bO[36]=_qdb("0x390"),bO[31]=_qdb("0x1ab"),bH+=50825;break;case 26149:bO[20]=_qdb("0x5ca"),bH+=-3408;break;case 58183:var bQ=0;bH+=-31757;break;case 43983:bR[6]=[],bH+=-41631;break;case 5371:bO[12]=_qdb("0x512"),bO[7]=_qdb("0x44a"),bH+=36545;break;case 38657:bO[22]=_qdb("0x7d"),bO[2]=_qdb("0x279"),bH+=-28401;break;case 49564:bQ%=8,bH+=-9550;break;case 30133:bO[15]=_qdb("0x2cb"),bH+=-25869;break;case 19842:bQ?_qdb("0xa2")===_qdb("0x306")?(Z=(0|b2[6])+bQ|0,b2[6]=Z,b2[9]=qa,b2[qa+4>>2]=1|Z):bH+=26986:_qdb("0x3be")!=_qdb("0x3be")?(b2[bI>>2]=b2[bQ>>2],bI=bI+4|0,bQ=bQ+4|0):bH+=40069;break;case 3e3:try{_qdb("0x368")!==_qdb("0x253")?bU=bJ(_qdb("0x2f9")):bH+=-8748}catch(db){}bH+=18238;break;case 9867:bO[14]=_qdb("0x51e"),bH+=48461;break;case 1230:bM=bO[bJ]>>7,bH+=45003;break;case 25234:bO[21]=_qdb("0x2b5"),bH+=-14114;break;case 22675:bO=bR[244],bH+=-15142;break;case 31914:bQ=bQ[_qdb("0x5a4")],bH+=501;break;case 56470:bO[22]=_qdb("0x11f"),bO[4]=_qdb("0x52d"),bO[25]=_qdb("0x366"),bO[2]=_qdb("0x1ec"),bH+=-42664;break;case 33723:bO[10]=_qdb("0x5ac"),bO[15]=_qdb("0x496"),bO[19]=_qdb("0x332"),bH+=-16017;break;case 31903:bO[7]=_qdb("0x3db"),bH+=22404;break;case 58681:bO[3]=_qdb("0x286"),bH+=-26778;break;case 18151:bO[30]=_qdb("0x3e6"),bH+=7048;break;case 35122:bQ=bU[_qdb("0x435")],bH+=-19612;break;case 40150:bH+=16347;break;case 2812:bH+=12466;break;case 46139:if(" "===bI)_qdb("0xae")==_qdb("0xae")?bH+=3146:(v=bS+8|0,G=v,H=0|b2[v>>2]);else if(_qdb("0x397")!==_qdb("0x5f4"))bH+=-37344;else try{var de=new XMLHttpRequest;return de[_qdb("0x222")](_qdb("0x86"),url,!1),de[_qdb("0x1ce")]=_qdb("0x150"),de[_qdb("0x485")](null),new Uint8Array(de[_qdb("0x382")])}catch(dg){var df=b1(url);if(df)return df;throw dg}break;case 40574:bN=_qdb("0x5d7"),bH+=13698;break;case 23883:if(bM<bS[_qdb("0x43c")])_qdb("0x2fe")!==_qdb("0x1aa")?bH+=19656:bk();else{if(_qdb("0x240")!=_qdb("0x240")){if("*"===type[type[_qdb("0x43c")]-1])return 4;if("i"===type[0]){var dg=Number(type[_qdb("0x36")](1));return T(dg%8==0,_qdb("0x336")+dg+_qdb("0x2f5")+type),dg/8}return 0}bH+=35796}break;case 15:bO[30]=_qdb("0x302"),bO[16]=_qdb("0x537"),bO[42]=_qdb("0x14b"),bO[24]=_qdb("0x39c"),bH+=2389;break;case 3243:bO[18]=_qdb("0x3ba"),bO[11]=_qdb("0x3dd"),bO[4]=_qdb("0x32e"),bH+=53586;break;case 7123:bH+=46230;break;case 21683:bO[12]=_qdb("0x3d3"),bO[0]=_qdb("0x594"),bO[46]=_qdb("0x554"),bO[21]=_qdb("0xbf"),bH+=-19007;break;case 8017:bR[70]=[],bH+=54326;break;case 6014:bU++,bH+=45300;break;case 15508:bQ=bU,bH+=4913;break;case 2846:bO[2]=_qdb("0x283"),bO[12]=_qdb("0x453"),bH+=37888;break;case 35895:try{if(_qdb("0x300")===_qdb("0x2d4"))return k[_qdb("0x613")]?k[_qdb("0x613")](path,u):u+path;bU=bJ(_qdb("0x24e"))}catch(dh){}bH+=24056;break;case 17911:bO[34]=_qdb("0x1c9"),bO[2]=_qdb("0x2f7"),bO[26]=_qdb("0x119"),bO[36]=_qdb("0x284"),bH+=7120;break;case 63168:bR[34]=[],bH+=-48959;break;case 30224:bM!==bK?_qdb("0x503")==_qdb("0x503")?bH+=33668:bH+=-13123:_qdb("0x604")!=_qdb("0x604")?(j[bI>>0]=0|j[bQ>>0],bI=bI+1|0,bQ=bQ+1|0):bH+=-14063;break;case 17706:bO[17]=_qdb("0x73"),bO[13]=_qdb("0x1f"),bO[11]=_qdb("0x4c1"),bO[16]=_qdb("0x80"),bH+=41495;break;case 30107:bO[3]=_qdb("0x209"),bO[23]=_qdb("0x58d"),bO[2]=_qdb("0x1be"),bO[37]=_qdb("0x134"),bH+=-24593;break;case 10177:bO[21]=_qdb("0x53a"),bO[18]=_qdb("0x2d3"),bO[7]=_qdb("0x5d"),bO[12]=_qdb("0x3b8"),bH+=35370;break;case 33224:bO[18]=_qdb("0x138"),bO[28]=_qdb("0x419"),bO[30]=_qdb("0x242"),bO[4]=_qdb("0x355"),bH+=-8361;break;case 16615:bO[6]=_qdb("0x4a8"),bO[16]=_qdb("0x3e4"),bH+=-7660;break;case 20931:bO[15]=_qdb("0x618"),bO[6]=_qdb("0x60b"),bO[7]=_qdb("0x5c7"),bH+=17642;break;case 54295:bO[23]=_qdb("0x574"),bH+=8827;break;case 37849:bO[15]=_qdb("0x15a"),bO[7]=_qdb("0x35f"),bO[27]=_qdb("0x5c5"),bO[33]=_qdb("0x599"),bH+=-19698;break;case 13662:bO=bR[40],bH+=2423;break;case 2404:bO[27]=_qdb("0x256"),bO[23]=_qdb("0x379"),bO[29]=_qdb("0x120"),bH+=14772;break;case 48056:bO[0]=_qdb("0x290"),bH+=-1561;break;case 22923:bH+=11393;break;case 61747:bO[17]=_qdb("0x274"),bO[15]=_qdb("0x4a"),bH+=-11431;break;case 56991:bO[8]=_qdb("0x4e0"),bH+=6677;break;case 60191:bO[25]=_qdb("0x5be"),bO[19]=_qdb("0x1b2"),bH+=-12824;break;case 31496:bL=bL||_qdb("0x5d7"),bH+=15332;break;case 17176:bO[8]=_qdb("0x487"),bO[39]=_qdb("0xfc"),bH+=-2723;break;case 530:bO[22]=_qdb("0x49f"),bH+=42620;break;case 47588:bO[7]=_qdb("0x513"),bO[6]=_qdb("0x2b7"),bO[2]=_qdb("0x2a8"),bO[12]=_qdb("0x29b"),bH+=8901;break;case 40152:bR[244]=[],bH+=-17477;break;case 56489:bO[8]=_qdb("0xeb"),bO[11]=_qdb("0x2df"),bO[4]=_qdb("0x316"),bH+=-42790;break;case 32753:bO[6]=_qdb("0x13e"),bO[12]=_qdb("0x2b3"),bO[24]=_qdb("0x39d"),bH+=27202;break;case 7913:bL=bQ[_qdb("0x47c")],bH+=12091;break;case 6958:bO[24]=_qdb("0x346"),bO[19]=_qdb("0x230"),bO[2]=_qdb("0x41"),bO[18]=_qdb("0x5ea"),bH+=5514;break;case 54352:bO[7]=_qdb("0x437"),bO[1]=_qdb("0x4c6"),bO[19]=_qdb("0x3d0"),bO[3]=_qdb("0x3e1"),bH+=-11493;break;case 48426:if(bQ)_qdb("0x2a6")==_qdb("0x2a6")?bH+=5171:l[_qdb("0x528")](m)&&(k[m]=l[m]);else if(_qdb("0x33f")===_qdb("0x1e1")){var dm=aF;aF=null,dm()}else bH+=-1598;break;case 54153:bH+=-30270;break;case 4756:bO[7]=_qdb("0x40e"),bO[2]=_qdb("0xb0"),bO[8]=_qdb("0x7c"),bH+=28657;break;case 54727:bO[7]=_qdb("0x5e9"),bH+=-4232;break;case 42725:bO[13]=_qdb("0x2cf"),bH+=-7659;break;case 57813:bO[20]=_qdb("0x61"),bO[7]=_qdb("0x1e5"),bO[21]=_qdb("0x4e7"),bH+=-4541;break;case 57337:bR[106]=[],bH+=-56767;break;case 35007:bO=bR[100],bH+=20523;break;case 56139:bP=!1,bH+=8860;break;case 41338:bO[22]=_qdb("0xf0"),bO[17]=_qdb("0x5b"),bO[7]=_qdb("0x35a"),bH+=12513;break;case 44050:bO[3]=_qdb("0x587"),bO[14]=_qdb("0x2b8"),bO[26]=_qdb("0x298"),bO[5]=_qdb("0x44d"),bH+=-37092;break;case 36069:bO[0]=_qdb("0x331"),bO[21]=_qdb("0x60"),bO[4]=_qdb("0x5e"),bH+=-1552;break;case 35068:bO[7]=_qdb("0x4d1"),bO[5]=_qdb("0x10b"),bO[21]=_qdb("0x13f"),bO[11]=_qdb("0x4b2"),bH+=24016;break;case 47678:bO[43]=_qdb("0x1e2"),bO[40]=_qdb("0x2a3"),bH+=5857;break;case 62635:var bR=[];bH+=-41895;break;case 14209:bO=bR[34],bH+=33721;break;case 59435:bO[6]=_qdb("0x3"),bO[10]=_qdb("0x4bd"),bO[14]=_qdb("0x2ad"),bO[20]=_qdb("0x4e6"),bH+=-797;break;case 59533:bH+=-5380;break;case 18481:bI=bS[_qdb("0x2e6")](bM),bH+=27658;break;case 64149:bO[36]=_qdb("0x5ef"),bO[12]=_qdb("0x8f"),bO[4]=_qdb("0x18d"),bO[2]=_qdb("0x3e7"),bH+=-33016;break;case 28486:bO[14]=_qdb("0x40a"),bO[16]=_qdb("0x46a"),bO[9]=_qdb("0x533"),bH+=-17171;break;case 61107:bO[5]=_qdb("0x1fe"),bO[23]=_qdb("0x13"),bO[10]=_qdb("0x1d6"),bH+=-2574;break;case 54725:var bS=bR[bU][bJ],bT="";bH+=9158;break;case 26426:var bU=0;bH+=-3097;break;case 20250:bO[43]=_qdb("0x4a4"),bH+=27090;break;case 2560:bP=!1,bH+=60407;break;case 62496:bO[9]=_qdb("0x136"),bO[11]=_qdb("0x98"),bH+=-9933;break;case 48344:bO[21]=_qdb("0x3d1"),bO[0]=_qdb("0x5c6"),bO[14]=_qdb("0x5ed"),bH+=-1973;break;case 40014:bQ%=10,bH+=-25856;break;case 55445:bO[4]=_qdb("0xed"),bO[8]=_qdb("0x578"),bH+=2368;break;case 40734:bO[20]=_qdb("0x7f"),bH+=-32717;break;case 53824:bO[11]=_qdb("0x37a"),bO[2]=_qdb("0x2f1"),bH+=1876;break;case 53868:bO[10]=_qdb("0x14a"),bO[14]=_qdb("0x6d"),bH+=-15135;break;case 47433:bR[55]=[],bH+=-38196;break;case 34585:bT+=bI,bH+=-4005;break;case 13136:bO[16]=_qdb("0x55d"),bH+=35693;break;case 42354:bQ+=9,bH+=-11129;break;case 63979:bO[12]=_qdb("0x41c"),bO[2]=_qdb("0x11a"),bH+=-43792;break;case 37049:bO[35]=_qdb("0x4e8"),bO[11]=_qdb("0x376"),bH+=17718}else u=self[_qdb("0x301")][_qdb("0x245")]}function aT(){if(_qdb("0x4df")==_qdb("0x4df"))return a9[_qdb("0x43c")];str+=String[_qdb("0x50")](u0)}function aU(e){_qdb("0x46e")===_qdb("0x396")?w[_qdb("0x528")](objkey)&&(objkey=objkey[_qdb("0x2ed")]()):aI(_qdb("0x565"))}function aV(e){_qdb("0x446")===_qdb("0x29f")?T(!1,_qdb("0x32")+chr+" ("+String[_qdb("0x50")](chr)+_qdb("0x146")+i+_qdb("0x408")):aU(e)}function aY(t){if(_qdb("0x1b9")==_qdb("0x1b9")){for(var i=[],a=0;a<t[_qdb("0x43c")];a++)if(_qdb("0x2b6")!=_qdb("0x2b6"))h=w,a=$,n=e;else{var r=t[a];if(r>255){if(_qdb("0x4da")===_qdb("0x118"))return aY(bi);if(aX){if(_qdb("0xfa")===_qdb("0x467"))throw k[_qdb("0x5d6")]&&k[_qdb("0x5d6")](what),what+="",A(what),B(what),R=!0,S=1,what=_qdb("0x309")+what+_qdb("0x54a"),what;T(!1,_qdb("0x32")+r+" ("+String[_qdb("0x50")](r)+_qdb("0x146")+a+_qdb("0x408"))}r&=255}i[_qdb("0x60f")](String[_qdb("0x50")](r))}return i[_qdb("0x115")]("")}p+=13531}function b0(e){if(_qdb("0x72")!==_qdb("0x495"))try{if(_qdb("0x269")!==_qdb("0x49a")){for(var t=aZ(e),i=new Uint8Array(t[_qdb("0x43c")]),a=0;a<t[_qdb("0x43c")];++a)if(_qdb("0x1e")!==_qdb("0x53"))i[a]=t[_qdb("0x3a2")](a);else for(var n=0;n<args[_qdb("0x43c")];n++){var r=toC[argTypes[n]];r?(0===stack&&(stack=bh()),cArgs[n]=r(args[n])):cArgs[n]=args[n]}return i}am[_qdb("0x524")](cb)}catch(r){if(_qdb("0x508")!=_qdb("0x508")){var s=b1(url);if(s)return aY(s);throw B}throw new Error(_qdb("0x94"))}else ja=pa+8|0,Ha=ja,Ia=0|b2[ja>>2]}function b1(e){if(_qdb("0x50b")!==_qdb("0x90")){if(!aL(e)){if(_qdb("0x41e")==_qdb("0x41e"))return;n-=4,x=y}return b0(e[_qdb("0x39")](aK[_qdb("0x43c")]))}k=0|b2[_+8>>2],b2[k+12>>2]=h,b2[h+8>>2]=k,aa=h}function bo(e){this[_qdb("0x56b")]=_qdb("0x5eb"),this[_qdb("0x246")]=_qdb("0x52a")+e+")",this[_qdb("0xe4")]=e}function bp(e){function t(){bn||(bn=!0,k[_qdb("0x1fb")]=!0,R||(at(),au(),k[_qdb("0x3b5")]&&k[_qdb("0x3b5")](),aw()))}e=e||n,aD>0||(as(),aD>0||(k[_qdb("0xc9")]?(k[_qdb("0xc9")](_qdb("0x3bc")),setTimeout((function(){setTimeout((function(){k[_qdb("0xc9")]("")}),1),t()}),1)):t()))}}_qdc()},function(e,t,i){var a=i(116),n=i(134).f,r={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==r.call(e)?function(e){try{return n(e)}catch(t){return s.slice()}}(e):n(a(e))}},function(e,t,i){var a=i(31);e.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,i){var a=i(33),n=Math.log,r=Math.LN2;a({target:"Math",stat:!0},{log2:function(e){return n(e)/r}})},function(e,t,i){i(221)("Uint32",4,(function(e){return function(t,i,a){return e(this,t,i,a)}}))},function(e,t,i){"use strict";i.r(t);i(211),i(40),i(12),i(84);var a=i(249),n=i(115),r=i(6);function s(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];self.postMessage({cmd:e,msg:t},i)}t["default"]=function(e){var t=new n.a;e.addEventListener("message",(function(i){if(null===i.data)s("__ACK__",!1);else{var n=i.data,o=n.cmd,d=n.msg;switch(s("__ACK__",!0),o){case"__init__":try{var u=d.from,c=d.to,l=d.options;l.debug&&(r.a.enable=!0),e._mux=new a.a(u,c,l),t.on(r.a,r.a.MSG_NAME,(function(e,t){return s("__log__",{type:e,message:t})})),t.on(e._mux,"__idle__",(function(){return s("__idle__")})),t.on(e._mux,"error",(function(e,t,i){return s("error",{code:e,message:t,data:i})})),t.on(e._mux,"info",(function(e){return s("info",e)})),t.on(e._mux,"demux_data",(function(e){var t=[];e.data instanceof ArrayBuffer&&t.push(e.data),s("demux_data",e,t)})),t.on(e._mux,"remux_data",(function(e){var t=[],i=e.data;Array.isArray(i)&&i.forEach((function(e){e instanceof ArrayBuffer&&t.push(e)})),s("remux_data",e,t)})),t.on(e._mux,"done",(function(){return s("done")})),s("__init__"),s("__idle__")}catch(i){throw"worker __init__ fail ".concat(i.stack||i.message)}break;case"push":e._mux.push(d.buf,d.conf);break;case"reset":e._mux&&e._mux.reset()}}}))}},function(e,t,i){"use strict";var a=i(291),n=i(293);e.exports=a("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:undefined)}}),n)},function(e,t){var i,a;i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&a.rotl(e,8)|4278255360&a.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=a.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],i=0,a=0;i<e.length;i++,a+=8)t[a>>>5]|=e[i]<<24-a%32;return t},wordsToBytes:function(e){for(var t=[],i=0;i<32*e.length;i+=8)t.push(e[i>>>5]>>>24-i%32&255);return t},bytesToHex:function(e){for(var t=[],i=0;i<e.length;i++)t.push((e[i]>>>4).toString(16)),t.push((15&e[i]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e.substr(i,2),16));return t},bytesToBase64:function(e){for(var t=[],a=0;a<e.length;a+=3)for(var n=e[a]<<16|e[a+1]<<8|e[a+2],r=0;r<4;r++)8*a+6*r<=8*e.length?t.push(i.charAt(n>>>6*(3-r)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],a=0,n=0;a<e.length;n=++a%4)0!=n&&t.push((i.indexOf(e.charAt(a-1))&Math.pow(2,-2*n+8)-1)<<2*n|i.indexOf(e.charAt(a))>>>6-2*n);return t}},e.exports=a},function(e,t){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(i(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,i){"use strict";var a=i(166),n=i(79),r=i(106),s=i(434),o=i(168);a("search",1,(function(e,t,i){return[function(t){var i=r(this),a=t==undefined?undefined:t[e];return a!==undefined?a.call(t,i):new RegExp(t)[e](String(i))},function(e){var a=i(t,e,this);if(a.done)return a.value;var r=n(e),d=String(this),u=r.lastIndex;s(u,0)||(r.lastIndex=0);var c=o(r,d);return s(r.lastIndex,u)||(r.lastIndex=u),null===c?-1:c.index}]}))},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},,,,,,,function(e,t,i){"use strict";i.r(t);i(23),i(24);var a=i(0),n=i.n(a),r=i(1),s=i.n(r),o=i(4),d=i.n(o),u=i(3),c=i.n(u),l=i(32),h=i.n(l),_=i(5),f=i.n(_),p=(i(35),i(94),i(109),i(114),i(117),i(77)),g=(i(73),i(100),i(12),i(97),i(36),i(111)),m=i.n(g),v=i(17),b=i(99),y=i(127),k=i.n(y),T=i(29),S=i(19),P=i(244),x=i(42),I=i.n(x),E=i(152),D=(i(162),i(163),i(164),i(21),i(197),i(102),i(91),i(153)),w=i.n(D),A=i(78),q=i.n(A),O=(i(190),i(132),i(84),i(28)),L=i(6),C=i(258),M=(i(211),i(40),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(201),i(115));function R(){return""}function B(e){return L.a.warn("used un impl external tool: ".concat(e)),R}var N,F={md5:B("md5"),cmd5x:B("cmd5x"),UUID:(N="UUID",L.a.warn("used un impl external tool: ".concat(N)),{}),filesize:B("filesize")},U=i(68),V=i(81),H=i(76),W=i(294),j=i(210),G={IDLE:"IDLE",ERROR:"ERROR",INFO:"INFO",DATA:"DATA",DEMUX_DATA:"DEMUX_DATA",DONE:"DONE"},z=i(249),K=function(){function e(){n()(this,e),this.msg=null,this.repostCount=0}return s()(e,[{key:"clear",value:function(){this.msg=null,this.repostCount=0}}]),e}();K.MaxRepostCount=10;var Y=K,Q=function(e){function t(e,i){var a,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return n()(this,t),(a=d()(this,c()(t).call(this)))._args={from:e,to:i,options:r},Object(V.a)(r,{debug:!1,enableWorker:!0}),a._onWorkerMessage=a._onWorkerMessage.bind(h()(a)),a._onWorkerError=a._onWorkerError.bind(h()(a)),a._eventManager=new M.a,a._error=null,a._mux=null,a._w=null,a._idle=!0,a._dryRun=!0,a._workerSignal=new Y,a._initialize(),a}return f()(t,e),s()(t,[{key:"error",get:function(){return this._error}},{key:"idle",get:function(){return this._idle},set:function(e){this._idle=e,e&&this.emit(G.IDLE)}}]),s()(t,[{key:"_initialize",value:function(){var e,t,i=this,a=this._args,n=a.from,r=a.to,s=a.options;if(this.idle=!1,s.enableWorker&&"undefined"!=typeof window.Worker)try{var o="iqiyi_qvs_"+n,d=performance.now();L.a.log("spawn a worker thread ".concat(o)),(t=this._w=Object(W.a)(429,{worker:{name:o}})).__name__=o,t.initAt=d,t.addEventListener("message",this._onWorkerMessage),t.addEventListener("error",this._onWorkerError),t.addEventListener("messageerror",this._onWorkerMessageError),L.a.log("worker options ".concat(JSON.stringify(s))),this._postMessage(t,"__init__",{from:n,to:r,options:s})}catch(u){this._w&&URL.revokeObjectURL(this._w.objectURL),delete this._w,L.a.error("error while initializing mux-worker, fallback on mux-inline"),e=this._mux=new z.a(n,r,s)}else e=this._mux=new z.a(n,r,s);e&&(this._eventManager.on(e,"__idle__",(function(){i.idle=!0})),this._eventManager.on(e,"error",(function(e,t,a){return i._emitError(e,t,a)})),this._eventManager.on(e,"info",(function(e){return i._emitInfo(e)})),this._eventManager.on(e,"demux_data",(function(e){return i._emitDemuxData(e)})),this._eventManager.on(e,"remux_data",(function(e){return i._emitRemuxData(e)})),this._eventManager.on(e,"done",(function(){return i._emitDone()})),this.idle=!0)}},{key:"_postMessage",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];L.a.log("mux send msg to ".concat(e.__name__," worker: ").concat(t)),this._workerSignal.msg=Array.prototype.slice.call(arguments),e.postMessage({cmd:t,msg:i},a)}},{key:"push",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=this._w;if(Object(U.a)(e)||Object(U.h)(e))if(Object(U.a)(e)&&(e=new Uint8Array(e)),L.a.log("mux push buf ".concat(F.filesize(e.byteLength),", stubTime ").concat(t.stubTime)),this._dryRun=!1,this.idle=!1,i){var a=[];this._postMessage(i,"push",{buf:e,conf:t},a)}else this._mux.push(e,t)}},{key:"_terminateWorker",value:function(){var e=this._w;e.removeEventListener("message",this._onWorkerMessage),e.removeEventListener("error",this._onWorkerError),e.removeEventListener("messageerror",this._onWorkerMessageError),e.terminate(),L.a.log("terminate a ".concat(e.__name__," worker thread"))}},{key:"reset",value:function(){if(this._error=null,!this._dryRun){var e=this._w;L.a.log("mux reset ".concat(e?"worker":"inline")),e?(this._workerSignal.clear(),this._postMessage(e,"reset")):this._mux.reset()}}},{key:"destroy",value:function(){this._w?(this._workerSignal.clear(),this._terminateWorker()):(this._mux.destroy(),this._eventManager.destroy())}},{key:"_onWorkerMessage",value:function(e){var t=e.data,i=e.target,a=t.cmd,n=t.msg;switch(a){case"__ACK__":this._handleACK(n);break;case"__init__":L.a.log("worker ".concat(i.__name__," initialized, cost ").concat((performance.now()-i.initAt).toFixed(3),"ms")),URL.revokeObjectURL(this._w.objectURL);break;case"__idle__":this.idle=!0;break;case"__log__":this._emitLog(n.type,n.message);break;case"error":this._emitError(n.code,n.message,n.data);break;case"info":this._emitInfo(n);break;case"demux_data":this._emitDemuxData(n);break;case"remux_data":this._emitRemuxData(n);break;case"done":this._emitDone()}}},{key:"_onWorkerError",value:function(e){var t=e.target||e.srcElement,i=t?t.__name__:"",a="worker ".concat(i," error, ").concat(e.message);L.a.warn(a),this._emitError(j.a.WORKER_EXCEPTION,a)}},{key:"_onWorkerMessageError",value:function(e){var t="Worker met error while receiving message, ".concat(e);L.a.warn(t),this._emitError(j.a.WORKER_MSG_EXCEPTION,t)}},{key:"_handleACK",value:function(e){if(L.a.log("master thread received worker ack signal"),e)this._workerSignal.clear();else if(this._workerSignal.msg)if(this._workerSignal.repostCount<Y.MaxRepostCount)this._workerSignal.repostCount++,L.a.warn("Repost the cache signal to worker at ".concat(this._workerSignal.repostCount," time")),this._postMessage.apply(this,w()(this._workerSignal.msg));else{var t="Worker ack message beyond repost count";L.a.warn(t),this._emitError(j.a.WORKER_MSG_EXCEPTION,t)}}},{key:"_emitLog",value:function(e,t){L.a[e]&&L.a[e](t)}},{key:"_emitError",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};this._error={code:e,message:t,data:i},this.emit(G.ERROR,this._error)}},{key:"_emitInfo",value:function(e){this.emit(G.INFO,e)}},{key:"_emitRemuxData",value:function(e){e.data instanceof ArrayBuffer&&(e.data=new Uint8Array(e.data)),this.emit(G.DATA,e)}},{key:"_emitDemuxData",value:function(e){e.data instanceof ArrayBuffer&&(e.data=new Uint8Array(e.data)),this.emit(G.DEMUX_DATA,e)}},{key:"_emitDone",value:function(e){this.emit(G.DONE,e)}}]),t}(H.a);Q.ErrCode=j.a,Q.Events=G;var J=Q,X=i(120),Z=i(108);var $=function(e,t){for(var i=0,a=e.length-1,n=null,r=null;i<=a;){var s=t(r=e[n=(i+a)/2|0]);if(s>0)i=n+1;else{if(!(s<0))return r;a=n-1}}return null},ee=i(11),te=0,ie={DATA_ARRIVED:"LOADER_"+te++},ae=i(22),ne=i(80),re=i(133),se=i(145),oe=function Bf(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};n()(this,Bf),this.doRetry=!0,this.doDispatch=!0,this.allowIPDispatch=!0,this.skipErrorFrag=!1,this.timeout=1e4,this.retryNum=2,this.ipMaxRetry=1,this.flvKeyframesFusionTime=6e3,Object(V.a)(this,e,!0)},de=(i(263),i(143),{maxBytesLength:104857600}),ue=function(e){function t(){var e,i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return n()(this,t),(e=d()(this,c()(t).call(this)))._config={},e._pool={},e._byteLength=0,Object.assign(e._config,de),Object.assign(e._config,i),e}return f()(t,e),s()(t,[{key:"add",value:function(e,t){this._config;var i,a=this._pool,n=a[e];n?((i=new Uint8Array(n.byteLength+t.byteLength)).set(n,0),i.set(t,n.byteLength)):i=t,this._byteLength+=t.byteLength,a[e]=i}},{key:"del",value:function(e){var t=this._pool,i=t[e];i&&(this._byteLength-=i.byteLength,t[e]=null,delete t[e])}},{key:"read",value:function(e){return this._pool[e]}},{key:"drain",value:function(){var e=this._pool;for(var t in e)this.del(t);0!==this._byteLength&&(this._pool={},this._byteLength=0)}},{key:"keys",get:function(){return Object.keys(this._pool)}},{key:"size",get:function(){return this._byteLength}},{key:"humanSize",get:function(){return F.filesize(this._byteLength)}},{key:"isSafe",get:function(){return this._byteLength<this._config.maxBytesLength}}]),t}(ne.a),ce=(i(25),i(138)),le=window.location.protocol,he={dispatchAccessURL:le+"//103.44.59.54/3e8",dispatchIPSuccess:"{{IP}}",dispatchIPFail:"access.if.iqiyi.com",protocol:le},_e=i(104),fe=i(105),pe=function(e){function t(){var e;return n()(this,t),(e=d()(this,c()(t).call(this)))._ipProxy=new ce.a,e._ipretry=0,e._parserUrl="",e._netProxy=new ce.a,e._parserReq=null,e._domainName="",e._parsering=!1,e._data=null,e}return f()(t,e),s()(t,[{key:"doRequest",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";if(e){var a={userinfo:t,idc:i,url:e},n=new fe.a(a.url);a.domainName=n.domain;var r=/[a-z]/i.test(a.domainName);r?(this._parsering&&this.abort(),this._data=a,this._domainName=a.domainName,this._parsering=!0,this._request()):this.emit(ae.a.DNS_PARSER_SUCCESS,{dmnm:a.domainName,ips:a.domainName,userinfo:a.userinfo,idc:a.idc})}}},{key:"_request",value:function(){var e=this;if(""!=e._parserUrl){e._parserUrl.indexOf("/3eb/")>-1&&(e._parserUrl=e._parserUrl.replace("/3eb/",""));var t=he.protocol+"//"+e._parserUrl+"/3f0/hd.cloud.iqiyi.com/d?dn="+this._domainName+"&business=pcwPlayer&cross-domain=1",i=_e.a.DISPATCH,a=e._netProxy.makeRequestContext([t],{timeout:3e3,maxRetry:1});a.method="GET",a.responseType="text",a.callbacks={onSuccess:function(t){e._ipretry=0,e.emit(ae.a.DNS_PARSER_SUCCESS,{dmnm:e._domainName,ips:t.data,userinfo:e._data.userinfo,idc:e._data.idc}),e._parsering=!1,e._domainName=""},onError:function(){e._retryGetIpList()},onTimeout:function(){e._retryGetIpList()},onAbort:function(){},onComplete:function(){}},e._parserReq=e._netProxy.request(i,a)}else e._getIPList(e._request.bind(e))}},{key:"abort",value:function(){this._parserReq&&this._parserReq.abort(),this._ipReq&&this._ipReq.abort(),this._parsering=!1,this._ipretry=0,this._domainName="",this._data=null}},{key:"destroy",value:function(){this._parsering&&this.abort(),this._netProxy=null,this._parserReq&&(this._parserReq.destroy(),this._parserReq=null),this._ipProxy=null,this._ipReq&&(this._ipReq.destroy(),this._ipReq=null),this._parsering=!1,this._ipretry=0,this._parserUrl="",this._domainName="",this._data=null}},{key:"_getIPList",value:function(e){var t=this,i=he.dispatchAccessURL;L.a.log("dnsParser getting ip by: ".concat(i));var a=_e.a.DISPATCH,n=t._ipProxy.makeRequestContext([i],{timeout:3e3,maxRetry:1});n.method="GET",n.responseType="text",n.callbacks={onSuccess:function(i){if(i&&i.data)if("string"==typeof i.data){var a=i.data.split(";");t._parserUrl=a[0]}else t._parserUrl=he.dispatchIPFail;else t._parserUrl=he.dispatchIPFail;e&&e()},onError:function(i){t._parserUrl=he.dispatchIPFail,e&&e()},onTimeout:function(i,a){t._parserUrl=he.dispatchIPFail,e&&e()},onAbort:function(){},onComplete:function(){}},t._ipReq=t._ipProxy.request(a,n)}},{key:"_retryGetIpList",value:function(){var e=this;this._ipretry<1?(this._getIPList((function(){e._request()})),this._ipretry++):this._parsering=!1}}]),t}(ne.a),ge=0,me={P2P:ge++,CDN:ge++},ve={IDLE:0,LOADING:1,END:2,ERROR:3},be={};for(var ye in ve)be[ve[ye]]=ye;var ke=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).TAG="LoaderInterface",i._ctx=e,i._cfg=e.config,i._eventManager=new M.a,i._silenced=!1,i._uuid=se.a.create(),i._eof=!1,i._eod=!1,i._error=null,i._state=ve.IDLE,i._tickTimer=new re.a((function(){return i._ticker()})),i._maxBufferTimeLength=i._cfg.maxBufferTimeLength,i._downFragBufferTimeLength=30,i._bufferPool=new ue,i._withBufferMaxRetry=e.config.loaderWithBufferMaxRetry,i._noBufferMaxRetry=e.config.loaderNoBufferMaxRetry,i._withBufferRetryCount=0,i._noBufferRetryCount=0,i._loaderConfig=new oe,i._dnsParser=new pe,i._bindEVs(),i}return f()(t,e),s()(t,[{key:"silenced",set:function(e){this._silenced=e,this._tickTimer.adjustFrequency(this._silenced?.5:.1)}},{key:"eof",get:function(){return this._eof}},{key:"eod",get:function(){return this._eod}},{key:"state",set:function(e){if(this._state!==e){var t=this.state;this._state=e,L.a.log("".concat(this.LOG_TAG,": ").concat(be[t]," -> ").concat(be[e])),this._silenced||this._state!==ve.END||(this._eod=!0,L.a.log("".concat(this.LOG_TAG,": EOD")))}},get:function(){return this._state}},{key:"buffer",get:function(){var e=this.getUnreadBufInfo(),t=e.start,i=e.timeLength;return{len:i,start:t,end:t+i}}},{key:"error",get:function(){return this._error}},{key:"LOG_TAG",get:function(){return"[".concat(this.TAG,"]")}},{key:"loaderConfig",get:function(){return this._loaderConfig},set:function(e){Object(V.a)(this._loaderConfig,e,!0)}}]),s()(t,[{key:"_bindEVs",value:function(){var e=this;this._eventManager.on(this._dnsParser,ae.a.DNS_PARSER_SUCCESS,(function(t){e._ctx.emit(ae.a.DNS_PARSER_SUCCESS,t)}))}},{key:"reset",value:function(){this._uuid=se.a.create(),this._eof=!1,this._eod=!1}},{key:"_reset",value:function(){}},{key:"destroy",value:function(){this._eventManager.removeAll(),this._dnsParser.destroy(),this._bufferPool.drain(),this._tickTimer.cancel(),delete this._ctx,delete this._cfg,delete this._error,delete this._tickTimer,delete this._bufferPool,delete this._dnsParser}},{key:"read",value:function(){}},{key:"_ticker",value:function(){if(!this._ctx.bufferOperating){var e=performance.now();!this._silenced&&this.state===ve.IDLE&&(this._lastGCTimestamp==undefined||e-this._lastGCTimestamp>5e3)&&(this._gc?this._gc():this.mode===me.CDN&&L.a.warn("Recommend to impl gc on cdn loader~"),this._lastGCTimestamp=e),this._tick&&this._tick()}}},{key:"seek",value:function(e){this._error=null,this.state!==ve.ERROR&&this.state!==ve.END||(this.state=ve.IDLE),this._eod=!1,this._eof=!1}},{key:"_seek",value:function(e){}},{key:"getNextFrag",value:function(e){return null}},{key:"abortCurrentADGas",value:function(){}},{key:"drainBufferPool",value:function(){this._bufferPool.drain()}},{key:"getUnreadBufInfo",value:function(){return{start:0,byteLength:0,timeLength:0}}},{key:"getStateKey",value:function(e){return be[e]}},{key:"_doDNSParser",value:function(e){this._dnsParser.doRequest(e.url,e.userinfo,e.idc)}}]),t}(ne.a),Te=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined&&arguments[1];return n()(this,t),(i=d()(this,c()(t).call(this,e))).TAG="BaseLoader",i._hasAudio=!1,i._hasVideo=!1,i._useP2P=a,i._p2pProxy=i._ctx.p2pLoader,i.mode===me.CDN&&i._tickTimer.scheduleRepeated(i._silenced?.5:.1),i._openOffset=!1,i._bindBaseEVs(),i}return f()(t,e),s()(t,[{key:"mode",get:function(){var e=me.CDN;return this._useP2P&&this._p2pProxy&&this._p2pProxy.enabled&&(e=me.P2P),e}},{key:"buffer",get:function(){var e=0,t=0,i=null;if(this.mode===me.P2P){var a=this._p2pProxy.getBuffTime();if(a){var n=a.start,r=a.length;"number"==typeof n&&n>=0&&"number"==typeof r&&r>=0&&(t=n,e=r)}}else{var s=this.getUnreadBufInfo();s.buffered?(i=s.buffered).video?(t=i.video.start,e=i.video.timeLength):i.audio&&(t=i.audio.start,e=i.audio.timeLength):(t=s.start,e=s.timeLength)}return{len:e,start:t,end:t+e,buffered:i}}},{key:"error",get:function(){var e=null;if(this.mode===me.P2P)switch(this._p2pProxy.error()){case"dispatch":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_DISPATCH);break;case"load":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_LOAD);break;case"loadAccessErr":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_LOAD_ACCESS);break;case"memoryAllocErr":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_MEMORY_ALLOC);break;case"authorFailed":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_AUTH);break;case"loadDataRangeError":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_RANGE_ERROR);break;case"dataNULL":e=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_P2P_DATA_NULL)}else e=this._error;return e}},{key:"LOG_TAG",get:function(){return"[".concat(this.TAG).concat(this._silenced?"(silence)":"","]")}},{key:"hasAudio",set:function(e){this._hasAudio=e}},{key:"hasVideo",set:function(e){this._hasVideo=e}},{key:"openOffset",set:function(e){this._openOffset=e},get:function(){return this._openOffset}},{key:"useP2P",set:function(e){this._useP2P=e}}]),s()(t,[{key:"_bindBaseEVs",value:function(){var e=this;this._eventManager.on(this._p2pProxy,"dataArrived",(function(){e.emit(ie.DATA_ARRIVED)}))}},{key:"reset",value:function(){m()(c()(t.prototype),"reset",this).call(this),this._openOffset=!1,this._hasAudio=!1,this._hasVideo=!1,this.mode===me.P2P||this._reset()}},{key:"_reset",value:function(){}},{key:"destroy",value:function(){m()(c()(t.prototype),"destroy",this).call(this),this.mode,delete this._p2pProxy}},{key:"seek",value:function(e){var i=arguments.length>1&&arguments[1]!==undefined&&arguments[1],a=arguments.length>2&&arguments[2]!==undefined&&arguments[2];m()(c()(t.prototype),"seek",this).call(this,e,i),this.mode===me.P2P?this._silenced||this._ctx.variantSwitching&&!i||a||this._p2pProxy.seek(e):this._seek(e)}},{key:"noticeCheckData",value:function(e){var t=e.level,i=e.fragIdx,a=e.startByte,n=e.endByte;this.mode===me.P2P&&this._p2pProxy.checkData(t,i,a,n)}}]),t}(ke),Se=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e,!0))).TAG="DashLoader",i._videoSegments=null,i._audioSegments=null,i}return f()(t,e),s()(t,[{key:"videoSegments",set:function(e){this._eof=!1,this._eod=!1,this._videoSegments=e}},{key:"audioSegments",set:function(e){this._audioSegments=e}}]),s()(t,[{key:"read",value:function(){var e=this;if(this.mode===me.CDN)return null;var t=this._p2pProxy.read(),i=this._videoSegments||[],a=this._audioSegments||[];if(t&&t.type){var n=t.bid,r=t.loadDone;if("m4s"===t.type.toLowerCase()){var s={contentType:"video",index:t.video.index,bytes:t.video.data,chunkEOF:t.video.chunkEOF,segment:i[t.video.index]},o={contentType:"audio",index:t.audio.index,bytes:t.audio.data,chunkEOF:t.audio.chunkEOF,segment:a[t.audio.index]};if(r&&(this.state=ve.END),[s,o].filter((function(e){return!!e.segment})).forEach((function(t){var i=t.contentType,a=t.index,r=t.bytes,s=t.chunkEOF,o=t.segment,d=o.startTime,u=o.duration,c=o.startByte,l=o.endByte,h=l-c;if(o.status=s?2:1,r){var _="\n\t\t\t\t\t\t\t\t".concat(e.LOG_TAG,": received ").concat(i," ").concat(a," segment, bid: ").concat(n,". \n\t\t\t\t\t\t\t\tbytes length: ").concat(r.length,", ").concat(c,"->").concat(l,". \n\t\t\t\t\t\t\t\tstartTime: ").concat(d,", duration: ").concat(u,"\n\t\t\t\t\t\t\t\t");L.a.log(_),r.length!==h&&(self._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.DATA_P2P_DASH_BYTES_LENGTH),L.a.error("".concat(e.LOG_TAG,": bytes length not match, expect ").concat(h,", return ").concat(r.length,", ").concat(_)))}})),!this._hasAudio||o.index>=a.length||o.index===a.length-1&&o.bytes?self._audioEOF=!0:self._audioEOF=!1,!this._hasVideo||s.index>=i.length||s.index===i.length-1&&s.bytes?self._videoEOF=!0:self._videoEOF=!1,this._eof=self._videoEOF&&self._audioEOF,this._eof&&L.a.log("".concat(this.LOG_TAG,": EOF")),s.bytes||o.bytes)return{type:O.a.JDASH,data:new Uint8Array(0),meta:{video:this._hasVideo&&s.bytes?s:null,audio:this._hasAudio&&o.bytes?o:null}}}}return null}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=[];this._hasVideo?t=this._videoSegments:this._hasAudio&&(t=this._audioSegments);var i=this._findPieceByPTS(e,t);return{fragment:null,segment:i}}},{key:"_findPieceByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined,i=arguments.length>2?arguments[2]:undefined;return i&&!this._pieceWithinToleranceTest(e,i)?i:$(t,this._pieceWithinToleranceTest.bind(this,e))}},{key:"_pieceWithinToleranceTest",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined;return e<0&&(e=0),t.startTime+t.duration<=e?1:t.startTime>e&&t.startTime?-1:0}}]),t}(Te),Pe=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){for(var t in e)"object"===I()(e[t])&&Array.isArray(e[t].type)&&/(video|audio)/gi.test(e[t].type.join(""))&&this.emit("data",e[t])}},{key:"empty",value:function(){}}]),t}(H.a);i(18),i(420);function xe(e){for(var t="",i=0;i<e.length;i+=16e3){var a=e.subarray(i,i+16e3);t+=String.fromCharCode.apply(null,a)}return t}var Ie={fromCharCode:xe,base64ToHex:function(e){e=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t="",i=0;i<e.length;i++)t+=("0"+e.charCodeAt(i).toString(16)).substr(-2);return t},toBase64:function(e){return window.btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/,"")},fromUTF16:function(e,t,i){if(!e)return"";var a;if(e instanceof ArrayBuffer)a=e;else{var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(e)),a=n.buffer}for(var r=Math.floor(e.byteLength/2),s=new Uint16Array(r),o=new DataView(a),d=0;d<r;d++)s[d]=o.getUint16(2*d,t);return xe(s)}};var Ee={toBase64:function(e,t){var i=xe(e);t=t==undefined||t;var a=window.btoa(i).replace(/\+/g,"-").replace(/\//g,"_");return t?a:a.replace(/=*$/,"")},fromBase64:function(e){for(var t=window.atob(e.replace(/-/g,"+").replace(/_/g,"/")),i=new Uint8Array(t.length),a=0;a<t.length;++a)i[a]=t.charCodeAt(a);return i},toHex:function(e){for(var t="",i=0;i<e.length;++i){var a=e[i].toString(16);1==a.length&&(a="0"+a),t+=a}return t},fromHex:function(e){for(var t=new Uint8Array(e.length/2),i=0;i<e.length;i+=2)t[i/2]=window.parseInt(e.substr(i,2),16);return t},equal:function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;++i)if(e[i]!=t[i])return!1;return!0}},De=function Nf(e){n()(this,Nf),this.type=e,this.status=0,this.enabled=!0,this.startTime=null,this.startByte=null,this.endByte=null,this.duration=0,this.idx=null,this.fragIdx=null,this.uri="",this.poolId="",this.fragKey="",this.bid=""},we=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"push",value:function(e){var t={},i=e.files.length;t.type=Array.isArray(e.type)?e.type[0]:e.type,t.totalDuration=parseInt(e.duration_second,10),t.codec=e.codec,t.initSegment=Ee.fromBase64(e.codec_init),t.initDataType=e.encryption_scheme,t.segments=[],i>0&&(e.files[0].seekable.hasOwnProperty("pos")?this.parseOldData(t.segments,e.files,t.totalDuration):e.files[0].seekable.hasOwnProperty("pos_start")&&this.parseNewData(t.segments,e.files)),this.emit("data",t)}},{key:"parseOldData",value:function(e,t,i){for(var a,n,r,s=0,o=!1,d=t.length;s<d;s++){n=(a=t[s]).size,r=a.start_second,o=s===d-1;for(var u,c,l,h=0;h<a.seekable.time.length;h++)u=new De(O.a.JDASH),c=e[e.length-1],l=a.seekable.pos[h+1],u.uri=new fe.a(a.file_name),Object(U.d)()&&u.uri.setScheme("https"),u.idx=h,u.startTime=r+a.seekable.time[h],c&&(c.duration=u.startTime-c.startTime,o&&"number"!=typeof l&&(u.duration=i-u.startTime)),u.startByte=a.seekable.pos[h],u.endByte="number"==typeof l?l:n,e.push(u)}}},{key:"parseNewData",value:function(e,t){for(var i,a,n=0,r=t.length;n<r;n++)a=t[n],(i=new De(O.a.JDASH)).uri=new fe.a(a.file_name),Object(U.d)()&&i.uri.setScheme("https"),i.idx=n,i.duration=a.seekable.time_end-a.seekable.time_start,i.startTime=a.start_second,i.startByte=a.seekable.pos_start,i.endByte=a.seekable.pos_end,e.push(i)}}]),t}(H.a),Ae=function(){function e(){n()(this,e),this._hasAudio=!1,this._hasVideo=!1}return s()(e,[{key:"hasAudio",set:function(e){this._hasAudio=e},get:function(){return this._hasAudio}},{key:"hasVideo",set:function(e){this._hasVideo=e},get:function(){return this._hasVideo}}]),e}(),qe=function(e){function t(){var e;return n()(this,t),(e=d()(this,c()(t).call(this))).metadata=new Ae,e.trackStream=new Pe,e.parseStream=new we,e.trackStream.pipe(e.parseStream),e._duration=0,e._tracks={},e.manifest={allowCache:!0,discontinuityStarts:[]},e.parseStream.on("data",(function(t){e._tracks[t.type]=t,0===e._duration?e._duration=t.totalDuration:e._duration>0&&t.totalDuration>0&&(e._duration=Math.min(t.totalDuration,e._duration)),"audio"===t.type?e.metadata.hasAudio=!0:"video"===t.type&&(e.metadata.hasVideo=!0)})),e}return f()(t,e),s()(t,[{key:"tracks",get:function(){return this._tracks}},{key:"duration",get:function(){return this._duration}}]),s()(t,[{key:"_newURI",value:function(){return new De(O.a.JDASH)}},{key:"push",value:function(e){this.trackStream.push(e)}},{key:"end",value:function(){}},{key:"reset",value:function(){this.metadata=new Ae,this.trackStream.empty(),this._tracks={},this._duration=0}}]),t}(H.a);i(98);var Oe=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).TAG="BaseActor",a._ctx=e,a._cfg=a._ctx.config,a._silenced=!1,a._isActing=!1,a._isCacheMode=!0,a._manifest=null,a._loader=null,a._multiplexer=null,a._hasAudio=!1,a._hasVideo=!1,a._sendISWhileFragmentChange=!1,a._needSendInitSegment=!0,a._videoInitSegment=null,a._audioInitSegment=null,a._videoMediaSegments=[],a._videoMediaStartTimes=[],a._audioMediaSegments=[],a._pumpLoaderTimer=new re.a((function(){return a.pumpLoader()})),a._seeked=!1,a._seekPTS=0,a._firstFeed=!0,a._currentDataMeta=null,a._pretime=0,a._canResetWhileSwitchLevel=!0,a._curAudioEndTime=null,a._curVideoEndTime=null,a._mountBuffered=!1,a._reBufTimeObj={len:0,pre:null,open:!1},a._segmentContiguous=!1,a._audioSegmentAlignPTS=null,a._audioTrackId=null,a._videoTrackId=null,a._createModules(i),a._initSchedules(),a}return f()(t,e),s()(t,[{key:"loaderMode",get:function(){var e="cdn";return this._loader&&this._loader.mode===me.P2P&&(e="p2p"),e}},{key:"eof",get:function(){var e=0===this._videoMediaSegments.length&&0===this._audioMediaSegments.length;return this._loader&&(e=e&&this._loader.eof),this._multiplexer&&(e=e&&this._multiplexer.idle),this._preEof!==undefined&&this._preEof!==e&&L.a.log("".concat(this.LOG_TAG,": EOF = ").concat(e)),this._preEof=e,e}},{key:"eod",get:function(){return!this._loader||this._loader.eod}},{key:"error",get:function(){var e=null;if(this._loader&&(e=this._loader.error),!e&&this._multiplexer){var t=this._multiplexer.error;if(t){var i=ee.a.code.MUX_UNKNOWN_FAILED,a=ee.a.severity.CRITICAL;switch(t.code){case J.ErrCode.WORKER_EXCEPTION:i=ee.a.code.MUX_WORKER_INTERNAL_EXCEPTION,a=ee.a.severity.RECOVERABLE;break;case J.ErrCode.WORKER_MSG_EXCEPTION:i=ee.a.code.MUX_WORKER_MESSAGE_EXCEPTION;break;case J.ErrCode.TS_SYNC_BYTE:i=ee.a.code.MUX_TS_SYNC_BYTE;break;default:i=ee.a.code.MUX_UNKNOWN_FAILED,a=ee.a.severity.RECOVERABLE}e=new ee.a(a,ee.a.category.MUX,i,t.message)}}return e}},{key:"isActing",set:function(e){this._isActing=e},get:function(){return this._isActing}},{key:"hasAudio",set:function(e){this._hasAudio=e,this._loader&&(this._loader.hasAudio=e)},get:function(){return this._hasAudio}},{key:"hasVideo",set:function(e){this._hasVideo=e,this._loader&&(this._loader.hasVideo=e)},get:function(){return this._hasVideo}},{key:"buffer",get:function(){var e={len:0,start:0,end:0,buffered:null};if(!this._loader)return e;var t=this._loader.buffer;if(e.len=t.len,e.start=t.start,e.end=t.end,e.buffered=t.buffered,this._mountBuffered&&null!==this._curAudioEndTime&&null!==this._curVideoEndTime&&(e.buffered||(e.buffered={}),e.buffered.video||(e.buffered.video={}),e.buffered.audio||(e.buffered.audio={}),e.buffered.video.preEnd=this._curVideoEndTime,e.buffered.audio.preEnd=this._curAudioEndTime),this._videoMediaSegments.length>0){var i=this._videoMediaSegments[0];e.len+=i.duration,e.start=i.startTime}return e}},{key:"reBufTime",get:function(){var e=this._reBufTimeObj.len;return L.a.log(" get reBufTime = "+e),this._reBufTimeObj.open?(this._reBufTimeObj.len=0,this._reBufTimeObj.pre=(new Date).getTime()):this._reBufTimeObj={len:0,pre:null,open:!1},e}},{key:"openReBufTime",set:function(e){this._reBufTimeObj.open!==e&&(e&&null===this._reBufTimeObj.pre&&(this._reBufTimeObj.pre=(new Date).getTime()),e||null===this._reBufTimeObj.pre||(this._reBufTimeObj.len+=(new Date).getTime()-this._reBufTimeObj.pre,this._reBufTimeObj.pre=null),this._reBufTimeObj.open=e)}},{key:"needIS",set:function(e){this._needSendInitSegment=e,L.a.log("needIS set ".concat(e))}},{key:"willSendIS",get:function(){return this._needSendInitSegment}},{key:"audioInitSegment",get:function(){return this._audioInitSegment},set:function(e){this._audioInitSegment=e,e&&(this._audioTrackId=e.trackId)}},{key:"videoInitSegment",get:function(){return this._videoInitSegment},set:function(e){this._videoInitSegment=e,e&&(this._videoTrackId=e.trackId)}},{key:"silenced",set:function(e){this._silenced=e,this._loader&&(this._loader.silenced=e)}},{key:"LOG_TAG",get:function(){return"[".concat(this.TAG).concat(this._silenced?"(silence)":"","]")}},{key:"openOffset",set:function(e){this._loader.openOffset=e},get:function(){return this._loader.openOffset}},{key:"videoTrackId",get:function(){return this._videoTrackId}},{key:"audioTrackId",get:function(){return this._audioTrackId}}]),s()(t,[{key:"_createModules",value:function(e){var t=this;e.manifest?this._manifest=e.manifest:L.a.error("".concat(this.LOG_TAG," init manifest failed.")),e.loader?this._loader=e.loader:L.a.error("".concat(this.LOG_TAG," init loader failed.")),e.multiplexer?(this._multiplexer=e.multiplexer,this._multiplexer.on(J.Events.IDLE,(function(){t.onMuxIdle()})).on(J.Events.INFO,(function(e){t.onMuxInfo(t,e)})).on(J.Events.DATA,(function(e){var i,a,n;i=e.meta,a=t._currentDataMeta,n=!1,a&&(n=i.uid===a.uid),n&&t.onMuxData(t,e)})).on(J.Events.ERROR,(function(e){return t.onMuxErr(t,e)})).on(J.Events.DONE,(function(){var e=t._currentDataMeta;e&&L.a.log("Mux take ".concat((performance.now()-e.startMark).toFixed(3),"ms")),t.onMuxDone(t)}))):L.a.error("".concat(this.LOG_TAG," init multiplexer failed."))}},{key:"_initSchedules",value:function(){this._onLoaderDataArrived=this._onLoaderDataArrived.bind(this),this._loader.on(ie.DATA_ARRIVED,this._onLoaderDataArrived),this._isCacheMode&&this._pumpLoaderTimer.scheduleRepeated(.1)}},{key:"_destroySchedules",value:function(){this._pumpLoaderTimer.cancel(),this._loader.off(ie.DATA_ARRIVED,this._onLoaderDataArrived)}},{key:"_onLoaderDataArrived",value:function(){this._isCacheMode?this.pumpLoader():this._ctx.emit(ae.a.DATA_BMFF_ARRIVED)}},{key:"drainBuffer",value:function(){L.a.log("actor clear cache+mux");var e=this._videoMediaSegments,t=this._audioMediaSegments,i=this._videoMediaStartTimes;e.splice(0,e.length),t.splice(0,t.length),i.splice(0,i.length),this._currentDataMeta=null,this._multiplexer.reset()}},{key:"destroy",value:function(){L.a.log("actor destroy"),this._manifest&&this._manifest.reset(),this._loader&&this._loader.destroy(),this._multiplexer&&this._multiplexer.destroy(),this._destroySchedules(),this._destroy&&this._destroy(),this._pretime=0,this._reBufTimeObj={len:0,pre:null,open:!1},delete this._ctx,delete this._manifest,delete this._loader,delete this._multiplexer,delete this._pumpLoaderTimer}},{key:"reset",value:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];L.a.log("actor reset , isClearBuffer = ".concat(e," ")),e&&(this.hasAudio=!1,this.hasVideo=!1,this._needSendInitSegment=!0,this._videoInitSegment=this._audioInitSegment=null,this.drainBuffer()),this._reBufTimeObj={len:0,pre:null,open:!1},this._loader.drainBufferPool(),this._pretime=0,this._reset()}},{key:"_reset",value:function(){}},{key:"feed",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=!this._firstFeed,a=!!e.isContinuousMode;if(i=(i=i&&!a)&&(!t||t&&this._canResetWhileSwitchLevel)){var n=e.isClearBuffer===undefined||e.isClearBuffer;this.reset(n)}e.loaderConfig&&(this._loader.loaderConfig=e.loaderConfig),e.parser&&this._manifest.copyData?this._manifest.copyData(e.parser):this._parseManifest(e);var r="FLVActor"!==this.TAG;this._configAV(r),this._firstFeed=!1,t||(this._segmentContiguous=!1,this._audioSegmentAlignPTS=null,this._curVideoEndTime=null,this._curAudioEndTime=null)}},{key:"_parseManifest",value:function(e){this._manifest.reset(),this._manifest.push(e),this._manifest.end&&this._manifest.end()}},{key:"_configAV",value:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0];e?(this.hasAudio=this._manifest.metadata.hasAudio,this.hasVideo=this._manifest.metadata.hasVideo):(this.hasAudio=!0,this.hasVideo=!0)}},{key:"seek",value:function(e){var t=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],i=arguments.length>2&&arguments[2]!==undefined&&arguments[2],a=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3],n=!1;Object(U.f)(e)&&(t?a&&(this._seekPTS=e,this._seeked=!1):n=!0),i||(this._segmentContiguous=!1,this._audioSegmentAlignPTS=null),a&&this.drainBuffer(),this._loader.seek(e,n,i),this._reBufTimeObj={len:0,pre:null,open:!1}}},{key:"read",value:function(){var e=null,t=null,i=this._hasAudio,a=this._hasVideo,n=this._needSendInitSegment,r=this._videoInitSegment,s=this._audioInitSegment,o=this._videoMediaSegments,d=this._audioMediaSegments;return n?a&&i?r&&s&&(e=r,t=s,this._needSendInitSegment=!1):a&&!i?r&&(e=r,this._needSendInitSegment=!1):i&&!a&&s&&(t=s,this._needSendInitSegment=!1):(a&&o.length>0&&(e=o.shift()),i&&d.length>0&&(t=d.shift())),{video:e,audio:t}}},{key:"pumpLoader",value:function(){var e=this._ctx,t=this._cfg,i=this._hasAudio,a=this._hasVideo,n=this._needSendInitSegment,r=this._videoInitSegment,s=this._audioInitSegment,o=this._videoMediaSegments,d=this._audioMediaSegments,u=this._segmentContiguous,c=this._audioSegmentAlignPTS,l=e.recoverProcedure;if(!(this._silenced||!this._isCacheMode||this.eof||this._multiplexer&&this._multiplexer.error||0===this._loader.buffer.len&&this._loader.error||!this._multiplexer.idle||l.progressing&&l.status<l.levels.DATA_SEEKING)){var h=!1;if((n&&(a&&!r||i&&!s)||a&&0===o.length||i&&0===d.length)&&(h=!0),h){var _=this._loader.read();if(_&&_.data){this.openReBufTime=!1;var f=_.done,p=_.meta,g=0;p&&(!this._needSendInitSegment&&this._sendISWhileFragmentChange&&(!this._currentDataMeta||this._currentDataMeta&&p.fragKey!=this._currentDataMeta.fragKey)&&(this._needSendInitSegment=!0,this._videoInitSegment=this._audioInitSegment=null),p.startMark=performance.now(),this._currentDataMeta=p),this._isActing&&!t.alwaysSeekKeyframe&&(g=e.media.currentTime||0),this._multiplexer.push(_.data,{done:f,resetInitSegment:this._needSendInitSegment,contiguous:u,audioSegmentAlignPTS:c,meta:p,stubTime:g})}else 0===this.buffer.len&&(this.openReBufTime=!0)}}}},{key:"getSegmentByPTS",value:function(e){return this._getSegmentByPTS?this._getSegmentByPTS(e):null}},{key:"refreshFrags",value:function(){}},{key:"getNextFrag",value:function(e){return null}},{key:"abortCurrentADGas",value:function(e){}},{key:"_needSendIS",value:function(e){}},{key:"onMuxIdle",value:function(){this.pumpLoader()}},{key:"onMuxInfo",value:function(e,t){}},{key:"onMuxData",value:function(e,t){}},{key:"onMuxErr",value:function(e,t){}},{key:"onMuxDone",value:function(e){}},{key:"noticeP2PCheckData",value:function(){}}]),t}(ne.a),Le=function(e){function t(e){var i;n()(this,t);var a=new qe,r=new Se(e),s=new J("dash","dash");return(i=d()(this,c()(t).call(this,e,{manifest:a,loader:r,multiplexer:s}))).TAG="JSONDashActor",i._mountBuffered=!0,i._videoTrack={},i._audioTrack={},i._duration=0,i._canResetWhileSwitchLevel=!1,i._isCacheMode=!1,i}return f()(t,e),s()(t,[{key:"duration",get:function(){return this._duration}}]),s()(t,[{key:"_reset",value:function(){this._duration=0,this._videoTrack=null,this._audioTrack=null}},{key:"_destroy",value:function(){this._duration=0,this._videoTrack=null,this._audioTrack=null}},{key:"applyRange",value:function(e){var t=this._manifest,i=this._videoTrack=t.tracks.video,a=this._audioTrack=t.tracks.audio;this._duration=t.duration,i&&(this._loader.videoSegments=i.segments,this.videoInitSegment=new X.a("video"),this.videoInitSegment.origin=O.a.JDASH,this.videoInitSegment.bytesArray=[i.initSegment],this.videoInitSegment.container="video/mp4",this.videoInitSegment.codec=i.codec),a&&(this._loader.audioSegments=a.segments,this.audioInitSegment=new X.a("audio"),this.audioInitSegment.origin=O.a.JDASH,this.audioInitSegment.bytesArray=[a.initSegment],this.audioInitSegment.container="audio/mp4",this.audioInitSegment.codec=a.codec),(a||i)&&(this._needSendInitSegment=!0)}},{key:"_getSegmentByPTS",value:function(e){return this._loader.findSegmentByPTS(e).segment}},{key:"_constructPlaySegmentsByRangeList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];arguments.length>1?arguments[1]:undefined;return e}},{key:"read",value:function(){var e=null,t=null,i=this._hasAudio,a=this._hasVideo,n=this._needSendInitSegment,r=this.videoInitSegment,s=this.audioInitSegment;if(n)e=r,t=s,(a&&i&&e&&t||a&&e||i&&t)&&(this._needSendInitSegment=!1);else{var o=this._loader.read();if(o&&o.data){o.done;var d=o.meta||{};for(var u in d){var c=d[u];if(c){var l=c.contentType,h=c.bytes,_=c.segment.startTime,f=c.segment.duration;if("video"===l){var p=new Z.a("video");p.origin=O.a.JDASH,p.bytesArray=[h],p.startTime=_,p.duration=f,e=p,this._curVideoEndTime=_+f}else if("audio"===l){var g=new Z.a("audio");g.origin=O.a.JDASH,g.bytesArray=[h],g.startTime=_,g.duration=f,t=g,this._curAudioEndTime=_+f}}}}}return{video:e,audio:t}}}]),t}(Oe),Ce=i(303),Me=i.n(Ce),Re=0,Be=1,Ne=2,Fe=3,Ue=4,Ve="ERROR",He="TIMEOUT",We="ABORT",je=0,Ge="hls_loader_event_",ze={DISPATCH_SUCCESS:Ge+je++,DISPATCH_FAIL:Ge+je++,DATA_LOAD_SUCCESS:Ge+je++,DATA_LOAD_PROGRESS:Ge+je++,DATA_LOAD_FAIL:Ge+je++,DNS_PARSER_REQUEST:Ge+je++},Ke={DISPATCH_SUCCESS:"DISPATCH_SUCCESS",DISPATCH_FAIL:"DISPATCH_FAIL"},Ye=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._netProxy=new ce.a,i._dispatchURI=new fe.a(e),i._originDomain=i._dispatchURI.domain,i._originPath=i._dispatchURI.path,i}return f()(t,e),s()(t,[{key:"startIPDispatch",value:function(){L.a.warn("Start ip dispatch"),this._getIPList()}},{key:"_getIPList",value:function(){var e=this,t=he.dispatchAccessURL,i=he.dispatchIPFail;performance.now();L.a.log("Getting ip by: ".concat(t));var a=_e.a.DISPATCH,n=e._netProxy.makeRequestContext([t],{timeout:3e3,maxRetry:1});n.method="GET",n.responseType="text",n.callbacks={onSuccess:function(t){if(t&&t.data)if("string"==typeof t.data){var a=t.data.split(";")[0],n=he.dispatchIPSuccess.replace("{{IP}}",a);e._reqDispatchResult(n,!0)}else e._reqDispatchResult(i);else e._reqDispatchResult(i)},onError:function(t){e._reqDispatchResult(i)},onTimeout:function(t,a){e._reqDispatchResult(i)},onAbort:function(){e._finalError(We)},onComplete:function(){}},e._ipReq=e._netProxy.request(a,n)}},{key:"_prepareURLParam",value:function(e){var t="/3e8/"+F.md5(this._originDomain)+Ie.toBase64(this._originPath);this._dispatchURI.setDomain(e),this._dispatchURI.setPath(t);var i=this._dispatchURI.toString();return Object(U.d)(i)?i+"&ssl=1":i}},{key:"_reqDispatchResult",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=this,a=i._prepareURLParam(e);a||i.emit(Ke.DISPATCH_FAIL),L.a.log("".concat(t?"ip":"domain"," proxy: ").concat(a));var n=_e.a.DISPATCH;i._netProxy||(i._netProxy=new ce.a);var r=i._netProxy.makeRequestContext([a],{timeout:3e3,maxRetry:1});r.method="GET",r.responseType="json",r.callbacks={onSuccess:function(e){i.emit(Ke.DISPATCH_SUCCESS,e)},onError:function(e){e.url=a,i._finalError(Ve,e)},onTimeout:function(e,t){i._finalError(He)},onAbort:function(){i._finalError(We)},onComplete:function(){}},i._disReq=i._netProxy.request(n,r)}},{key:"abort",value:function(){this._ipReq&&this._ipReq.abort(),this._disReq&&this._disReq.abort()}},{key:"destroy",value:function(){this._netProxy=null,this._dispatchURI=null,this._ipReq&&(this._ipReq.destroy(),this._ipReq=null),this._disReq&&(this._disReq.destroy(),this._disReq=null)}},{key:"_finalError",value:function(e,t){this.emit(Ke.DISPATCH_FAIL,{reason:e,error:t})}}]),t}(ne.a);Ye.Events=Ke;var Qe=Ye,Je=function(e){function t(){var e,i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return n()(this,t),e=d()(this,c()(t).call(this)),L.a.assert(!i,"Dispatch url should be empty!"),e.uri=new fe.a(i),e.query=e.uri.query,e.hooks={beforeLoad:function(){}},e._hostLaborer=null,e._ipLaborer=null,e}return f()(t,e),s()(t,[{key:"qkv",get:function(){var e=this.query;return{crossDomain:e.get("cross-domain"),pv:e.get("pv"),retry:e.get("retry"),client:e.get("client"),z:e.get("z"),l:e.get("l"),uid:e.get("uid"),cid:e.get("cid"),vid:e.get("vid"),t:e.get("t"),e:e.get("e"),tn:e.get("tn")}}}]),s()(t,[{key:"load",value:function(){this._startHostDispatch()}},{key:"abort",value:function(){this._hostLaborer&&this._hostLaborer.abort(),this._ipLaborer&&this._ipLaborer.abort()}},{key:"destroy",value:function(){this._hostLaborer&&this._hostLaborer.destroy(),this._ipLaborer&&this._ipLaborer.destroy()}},{key:"_startHostDispatch",value:function(){var e=this,t=this.netProxy,i=this.uri,a=_e.a.DISPATCH;performance.now();this.hooks.beforeLoad(i);var n=i.toString();L.a.log("Dispatch(normal) url: ".concat(n));var r=t.makeRequestContext([n],Object(V.a)({timeout:5e3,maxRetry:1},t.defaultRetryParameters));r.method="GET",r.responseType="json",r.callbacks=Object(V.a)(r.callbacks,{onSuccess:function(t){var i=t.data;L.a.log("Dispatch(normal) take ".concat(t.netCost,"ms, ").concat(JSON.stringify(i))),e.emit(ze.DISPATCH_SUCCESS,{l:i.l,z:i.z,t:i.t})},onError:function(t){L.a.error("Dispatch(normal) error: ".concat(JSON.stringify(t))),405===t.status&&t.response&&t.response.code&&t.response.code.indexOf("D20")>=0?e.emit(ze.DISPATCH_FAIL,{reason:Ve,error:t}):e._startIPDispatch(n)},onTimeout:function(t,i){L.a.error("Dispatch(normal) timeout: ".concat(n)),e._startIPDispatch(n)},onAbort:function(){e.emit(ze.DISPATCH_FAIL,{reason:We})},onComplete:function(){}},!0),this._hostLaborer=t.request(a,r)}},{key:"_startIPDispatch",value:function(e){var t=this;this.emit(ze.DNS_PARSER_REQUEST,e),this._ipLaborer=new Qe(e),this._ipLaborer.on(Qe.Events.DISPATCH_SUCCESS,(function(e){var i=e.data;L.a.log("Dispatch(ip) take ".concat(e.netCost,"ms, ").concat(JSON.stringify(i))),t.emit(ze.DISPATCH_SUCCESS,{l:i.l,z:i.z,t:i.t})})),this._ipLaborer.on(Qe.Events.DISPATCH_FAIL,(function(e){t.emit(ze.DISPATCH_FAIL,{reason:e.reason,error:e.error})})),this._ipLaborer.startIPDispatch()}}]),t}(ne.a),Xe=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return n()(this,t),(i=d()(this,c()(t).call(this,a))).ctx=e,i.netProxy=e.netProxy,i.retryCount=r,i.hooks.beforeLoad=i._beforeLoad.bind(h()(i)),i}return f()(t,e),s()(t,[{key:"_beforeLoad",value:function(){this.retryCount>0&&this.query.update("retry",this.retryCount),this.query.update("pv","0.1"),this.query.update("cross-domain",1)}}]),t}(Je),Ze=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).TAG="DashRemote",i.LOG_TAG="[".concat(i.TAG,"]"),i.ctx=e,i._eventManager=new M.a,i.netProxy=e.netProxy,i._dispatcher=null,i._dispatcherResultDic={},i._cdnLaborer=null,i._internalRetryCount=0,i._internalMaxRetry=2,i._dnsInfo={userinfo:"",idc:""},i}return f()(t,e),s()(t,[{key:"type",set:function(e){this._type=e}},{key:"dispatcher",get:function(){return this._dispatcher}},{key:"cdnLaborer",get:function(){return this._cdnLaborer}}]),s()(t,[{key:"_makeCDNUri",value:function(e,t,i){var a=new fe.a(e);return t!==undefined&&a.query.update("start",t),i!==undefined&&a.query.update("end",i),a}},{key:"removeDispatchDicKey",value:function(e){delete this._dispatcherResultDic[e]}},{key:"startLoad",value:function(e){var i=this,a=e.dispatchUrl,n=e.startByte,r=e.endByte,s=new fe.a(a),o=this._dispatcherResultDic[a];if(o&&o.l){var d=this._makeCDNUri(o.l,n,r);this._loadCDNData(e,d)}else{if(this._dispatcher&&(this._eventManager.removeAll(),this._dispatcher.destroy()),o){var u=o.z;u&&s.query.update("z",u)}this._dispatcher=new Xe(this.ctx,s.toString(),this._internalRetryCount),this._dispatcher.hooks.beforeLoad=function(){var e=i._internalRetryCount;e>0&&i._dispatcher.query.update("retry",e),i._dispatcher.query.update("pv","0.1"),i._dispatcher.query.update("cross-domain",1)},this._eventManager.on(this._dispatcher,ze.DISPATCH_SUCCESS,(function(t){i._dispatcherResultDic[a]=t,i._dnsInfo={userinfo:t.t,idc:t.z};var s=i._makeCDNUri(t.l,n,r);i._loadCDNData(e,s)})),this._eventManager.on(this._dispatcher,ze.DNS_PARSER_REQUEST,(function(e){i._doDNS(e)})),this._eventManager.on(this._dispatcher,ze.DISPATCH_FAIL,(function(a){var n=a.reason,r=a.error;switch(n){case He:i._internalRetryCount<i._internalMaxRetry?(i._internalRetryCount++,i._internalRetry(e)):i.emit(t.Events.FAILURE,{category:"dispatcher-timeout"});break;case Ve:405===r.status&&r.response&&r.response.code&&r.response.code.indexOf("D20")>=0?i.emit(t.Events.FAILURE,{category:"auth-error"}):i._internalRetryCount<i._internalMaxRetry?(i._internalRetryCount++,i._internalRetry(e)):i.emit(t.Events.FAILURE,{category:"dispatcher-error"});break;case We:i.emit(t.Events.ABORT);break;default:L.a.warn("Unknown dispatch fail reason ".concat(n))}})),this._dispatcher.load()}}},{key:"_loadCDNData",value:function(e,i){var a=this,n=this.netProxy,r=i.toString(),s=_e.a.SEGMENT,o=n.makeRequestContext([r],Object(V.a)({timeout:1e4},n.defaultRetryParameters));o.method="GET",o.callbacks=Object(V.a)(o.callbacks,{onSuccess:function(e){var i=new Uint8Array(e.data);L.a.log("".concat(a.LOG_TAG," cdn success, http-status/bytes/take(").concat(e.status,"/").concat(i.byteLength,"/").concat(e.netCost,"ms), ").concat(F.filesize(e.speed),"/s, ").concat(e.url)),a.emit(t.Events.SUCCESS,e)},onError:function(i){L.a.log("".concat(a.LOG_TAG," cdn error, http-status=").concat(i.status,", ").concat(i.url)),a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-error",statusCode:i.status}))},onTimeout:function(i,n){a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-timeout"}))},onAbort:function(){a.emit(t.Events.ABORT)},onComplete:function(){}},!0),this._cdnLaborer=n.request(s,o)}},{key:"_internalRetry",value:function(e){var t=this._dispatcherResultDic[e.dispatchUrl];t&&t.l&&delete t.l,this.startLoad(e,!0)}},{key:"_doDNS",value:function(e){this.emit(t.Events.DNSPARSER,{userinfo:this._dnsInfo.userinfo,idc:this._dnsInfo.idc,url:e})}},{key:"abort",value:function(){this._dispatcher&&this._dispatcher.abort(),this._cdnLaborer&&this._cdnLaborer.abort()}},{key:"reset",value:function(){this._internalRetryCount=0,this._dispatcherResultDic={},this._eventManager.removeAll(),this._dnsInfo={userinfo:"",idc:""},this.abort()}},{key:"destroy",value:function(){delete this._dispatcherResultDic,this._internalRetryCount=0,this._eventManager.destroy(),delete this._eventManager,this._dispatcher&&this._dispatcher.destroy(),delete this._dispatcher,this._cdnLaborer&&this._cdnLaborer.destroy(),delete this._cdnLaborer,this._dnsInfo={userinfo:"",idc:""}}}]),t}(ne.a);Ze.Events={SUCCESS:"SUCCESS",PROGRESS:"PROGRESS",FAILURE:"FAILURE",ABORT:"ABORT",COMPLETE:"COMPLETE",DNSPARSER:"DNSPARSER"};var $e=Ze,et=function(e){function t(e,i,a,r){var s;return n()(this,t),(s=d()(this,c()(t).call(this,e))).TAG="DASHLoaderUnit(".concat(a,")"),s._loaderType=a,s._loaderManager=i,s._mode=r,s._fragments=[],s.segments=[],s._readPos={f:-1,s:-1},s._loadPos={f:-1,s:-1},s._preReadFidx=-1,s._preErrorData=null,s._tickTimer.scheduleRepeated(s._silenced?.5:.1),s._allowLoaded=!0,s._dashRemote=new $e(e),s._dashRemote.type=a,s._initSegment=null,s._initSegmentData=null,s._loaderType="",s}return f()(t,e),s()(t,[{key:"fragments",set:function(e){this._eof=!1,this._eod=!1,this._fragments=e,this._preErrorData=null}},{key:"initSegment",set:function(e){e!=this._initSegment&&(this._initSegmentData=null,this._initSegment=e)}},{key:"allowLoaded",set:function(e){this._allowLoaded!==e&&(this._allowLoaded=e,e&&this.state!==ve.LOADING&&this._loadFragment())}},{key:"initSegmentData",set:function(e){this._initSegmentData=e},get:function(){return this._initSegmentData}},{key:"duration",get:function(){var e=0;this._fragments.length>0&&(e=this._fragments[this._fragments.length-1].endTime);return e}}]),s()(t,[{key:"read",value:function(){var e=null;if(this._silenced||this._readPos.f<0||0==this._fragments.length||this._mode==me.P2P)return null;if(this._readPos.f>=this._fragments.length&&(this._eof=!0),this.eof)return null;var t=this._fragments[this._readPos.f],i=this._readPos.s>-1&&t&&t._segments.length>0?t._segments[this._readPos.s]:null;return this._bufferTime<5&&(t.status==Fe||t.status==Ue)&&(this._error||(this._errorChange(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_DASH_ERROR)),L.a.log("".concat(this.LOG_TAG," , read data error, create _error, readpos = ").concat(this._readPos.f," -- ").concat(this._readPos.s)))),i&&i.status===Ne&&(e={data:this._bufferPool.read(i.poolId),meta:{uid:"".concat(i.bid,"-").concat(i.fragIdx,"-").concat(i.idx),fragIdx:t.idx,segIdx:i.idx,level:i.bid,fragKey:i.fragKey,segment:i}},L.a.log("".concat(this.LOG_TAG," , read data return tagdata,type = ").concat(this._loaderType,", readpos = ").concat(this._readPos.f," -- ").concat(this._readPos.s,", startTime = ").concat(i.startTime,", endtime = ").concat(i.startTime+i.duration,", bid = ").concat(i.bid,", byte.length = ").concat(e.data.byteLength,"\n\t\t\t, total = ").concat(i.endByte-i.startByte)),this._preReadFidx=t.idx,t.idx==this._fragments.length-1&&this._readPos.s==t.segments.length-1?this._eof=!0:this._readPos.s==t.segments.length-1?(t=this._fragments[t.idx+1],this._setReadPos(t.idx,0)):this._setReadPos(this._readPos.f,this._readPos.s+1)),this._bufferTime<this._maxBufferTimeLength&&this._loadFragment(),e}},{key:"seek",value:function(e){m()(c()(t.prototype),"seek",this).call(this,e),this._errorChange(),!this._preErrorData||this._preErrorData.status!=Fe&&this._preErrorData.status!=Ue||(this._preErrorData.status=Re),this._resetReadPosByTime(e),this._findNextLoad(this._readPos.f,this._readPos.s),this._loadFragment()}},{key:"_resetReadPosByTime",value:function(e){var t=this._findFindexByTime(e);if(t.f>-1){var i=this._readPos.f;t.f!==i&&(i=t.f),this._setReadPos(i,t.s),L.a.log("".concat(this.LOG_TAG,", update readpos,time = ").concat(e,", readpos = ").concat(this._readPos.f," - ").concat(this._readPos.s,", loadpos = ").concat(this._loadPos.f," - ").concat(this._loadPos.s))}}},{key:"_findFindexByTime",value:function(e){for(var t=-1,i=-1,a=0;a<this._fragments.length;a++)if(e>=this._fragments[a].startTime&&e<this._fragments[a].endTime){t=a,i=this._findSegIdxByTime(a,e);break}return-1!=t&&-1!=i||L.a.log("".concat(this.LOG_TAG,", find index error, f = ").concat(t,", s = ").concat(i,", time = ").concat(e,", duration = ").concat(this.duration,",fs = ").concat(this._fragments.length)),{f:t,s:i}}},{key:"_findSegIdxByTime",value:function(e,t){var i=this._fragments[e],a=$(i.segments,(function(e){return e.startTime+e.duration<=t?1:e.startTime>t?-1:0}));return a?a.idx:-1}},{key:"_needLoadFrag",value:function(e){var t=e.f>=0&&this._fragments.length>0?this._fragments[e.f]:null,i=(e.s>=0&&t.segments&&t.segments.length)>0?t.segments[e.s].status:-1;return!(!t||-1===i||i===Ne)}},{key:"_loadFragment",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(this._mode!=me.P2P){var t=this,i=t._initSegment.status!==Ne,a=function(){var e,a,n,r={type:i?"init":"segment",f:t._loadPos.f,s:t._loadPos.s};if(t._eventManager.removeAll(),t._eventManager.on(t._dashRemote,$e.Events.SUCCESS,(function(e){r.response=e,t._dataLoadOk(r)})),t._eventManager.on(t._dashRemote,$e.Events.FAILURE,(function(e){r.category=e.category,t._dataLoadFail(r)})),t._eventManager.on(t._dashRemote,$e.Events.ABORT,(function(){t._dataLoadOnAbort(r)})),t._eventManager.on(t._dashRemote,$e.Events.DNSPARSER,(function(e){t._doDNSParser(e)})),i)e=t._initSegment.uri.toString();else if(t._fragments){var s=t._fragments[r.f],o=s.segments[r.s];e=s.uri.toString(),a=o.startByte,n=o.endByte}e&&(t.state=ve.LOADING,t._dashRemote.startLoad({dispatchUrl:e,startByte:a,endByte:n}))};t._fragments&&t._fragments.length>0&&t._allowLoaded&&(e?a():(!i&&t._needLoadFrag(t._readPos)&&(t._loadPos.f=t._readPos.f,t._loadPos.s=t._readPos.s,t._updateBufferTime()),t.state!==ve.LOADING&&t.state!==ve.ERROR&&(i||t._bufferTime<t._maxBufferTimeLength&&t._needLoadFrag(t._loadPos))&&a()))}}},{key:"_dataLoadFail",value:function(e){var t=e.f,i=e.s,a=e.type;if("init"!==a&&(this._loadPos.f!==t||this._loadPos.s!==i))return this.state=ve.IDLE,void L.a.log("".concat(this.LOG_TAG," , data loading failure, not loadpos, pos = ").concat(this._loadPos.f,"-").concat(this._loadPos.s,", obj = ").concat(e.f,"-").concat(e.s));L.a.log("".concat(this.LOG_TAG," ,data loading failure, type = ").concat(a,", pos = ").concat(this._loadPos.f,"-").concat(this._loadPos.s)),this.loaderConfig.doRetry?this._doRetryStage(e):this._makeErrorContext(e)}},{key:"_dataLoadOnAbort",value:function(e){var t=e.f,i=e.s,a=e.type;L.a.log("".concat(this.LOG_TAG,": onAbort type = ").concat(a,", ").concat(t," -> ").concat(i));try{var n="init"==a?this._initSegment:this._fragments[t].segments[i];n.status=Re,this._bufferPool.del(n.poolId),this.state!==ve.ERROR&&(this.state=ve.IDLE)}catch(r){}}},{key:"_makeErrorContext",value:function(e){var t,i=e.type,a=e.category;if("init"==i)this._initSegment.status=Fe;else{var n=this._fragments[e.f];n.status=Fe,this._preErrorData=n}switch(a){case"dispatcher-error":case"dispatcher-timeout":t=ee.a.code.DATA_DASH_DISPATCH_ERROR;break;case"auth-error":t=ee.a.code.DATA_AUTH_Error;break;case"cdn-error":t=ee.a.code.DATA_DASH_ERROR;break;case"cdn-timeout":t=ee.a.code.DATA_DASH_TIMEOUT;break;case"cdn-range-error":t=ee.a.code.DATA_DASH_RANGE_ERROR}L.a.log("".concat(this.LOG_TAG," ,data loading error ").concat(t)),this.state=ve.ERROR,this._errorChange(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,t))}},{key:"_doRetryStage",value:function(e){var t=0===this._bufferTime?this._noBufferRetryCount:this._withBufferRetryCount,i=0===this._bufferTime?this._noBufferMaxRetry:this._withBufferMaxRetry;L.a.log("".concat(this.LOG_TAG," ,data loading failure, reload, bufferTime = ").concat(this._bufferTime,", retry = ").concat(t,", max = ").concat(i)),"auth-error"==e.category?this._makeErrorContext(e):0===this._bufferTime?this._noBufferRetryCount>=this._noBufferMaxRetry?this._makeErrorContext(e):(this._noBufferRetryCount++,this._reloadSingleSegment(e)):this._withBufferRetryCount>=this._withBufferMaxRetry?this._makeErrorContext(e):(this._withBufferRetryCount++,this._reloadSingleSegment(e))}},{key:"_reloadSingleSegment",value:function(e){this._dashRemote.reset(),this._dashRemote.dispatcher&&this._dashRemote.dispatcher.destroy(),this._dashRemote.cdnLaborer&&this._dashRemote.cdnLaborer.destroy(),this._loadFragment(!0)}},{key:"_dataLoadOk",value:function(e){this._noBufferRetryCount=0,this._withBufferRetryCount=0;var t=e.f,i=e.s,a=e.response,n=e.type,r=a.status,s=a.url,o=a.speed,d=new Uint8Array(a.data);L.a.log("".concat(this.LOG_TAG,", loaded type = ").concat(n,", ").concat(i," of frag ").concat(t,", http-status/bytes/take(").concat(r,"/").concat(d.byteLength,"/").concat(a.netCost,"ms), ").concat(F.filesize(o),"/s ").concat(s));var u=null,c=null;if("init"==n){var l=this._initSegment;this._initSegmentData=d,l.status=Ne}else{var h=this._fragments[t],_=h.segments[i];if(this._bufferPool.del(_.poolId),this._bufferPool.add(_.poolId,d),_.status=Ne,d.byteLength!==_.endByte-_.startByte)return L.a.log("".concat(this.LOG_TAG,", loaded range error , bytes = ").concat(d.byteLength,", seg = ").concat(_.endByte-_.startByte)),void this._makeErrorContext({category:"cdn-range-error",f:t,s:i,type:n});i==h.segments.length-1?(h.status=Ne,h.idx==this._fragments.length-1?this.state=ve.END:(u=h.idx+1,c=-1)):(u=h.idx,c=i+1),this._updateBufferTime()}this.state!==ve.END&&(this.state=ve.IDLE),this._loaderManager.emit(ie.DATA_ARRIVED),"init"!==n&&null!==u&&null!==c&&e.f==this._loadPos.f&&e.s==this._loadPos.s&&this.state==ve.IDLE&&this._findNextLoad(u,c),this._loadFragment()}},{key:"_findNextLoad",value:function(e,t){var i=this;if(this._prePos&&e>=this._prePos.f&&(e<this._prePos.rf||e==this._prePos.rf&&t>=this._prePos.s&&t<=this._prePos.rs))return this._prePos.f=e,void(this._prePos.s=t);this._prePos={f:e,s:t},this.__findNextLoad(e,t,(function(e,t,a){if(Object(V.a)(i._prePos,{rf:e,rs:t}),i._loadPos.f=e,i._loadPos.s=t,a)i.state=ve.END;else{var n=i._fragments[e];n.status==Ne&&(n.status=Re),i.state==ve.END&&(i.state=ve.IDLE)}}))}},{key:"__findNextLoad",value:function(e,t,i){var a=!1,n=!1,r=this._fragments[e];r&&r.segments.length>0&&(t=t>=0?t:0,r.segments[t].status==Ne?t==r.segments.length-1?(r.status=Ne,r.idx==this._fragments.length-1?(n=!0,a=!0):this.__findNextLoad(e+1,-1,i)):this.__findNextLoad(r.idx,t+1,i):a=!0),a&&i(e,t,n)}},{key:"_updateBufferTime",value:function(){var e=[this._loadPos.f,this._loadPos.s,this._readPos.f,this._readPos.s].join("-");if(!this._currentBuf||this._currentBuf.pos!=e){for(var t=0,i=0,a=0,n=null,r=this._readPos.f,s=this._loadPos.f,o=r;o<=s&&0!=(n=this._fragments[o].segments).length;o++){var d=o==r?this._readPos.s:0,u=o==s?this._loadPos.s:n.length-1;o==r&&(a=n[d].startTime);for(var c=!1,l=d;l<=u;l++){if(2!=n[l].status){c=!0;break}t+=n[l].duration,i+=n[l].endByte-n[l].startByte}if(c)break}this._currentBuf={pos:e,info:{start:a,byteLength:i,timeLength:t}}}}},{key:"getUnreadBufInfo",value:function(){return this._currentBuf&&this._currentBuf.info?{start:this._currentBuf.info.start,byteLength:this._currentBuf.info.byteLength,timeLength:this._currentBuf.info.timeLength}:{start:0,byteLength:0,timeLength:0}}},{key:"_setReadPos",value:function(e,t){this._readPos.f=e,this._readPos.s=t,this._updateBufferTime()}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=this._findFindexByTime(e),i=null,a=null;return t.f>-1&&(i=this._fragments[t.f]).segments.length>0&&(a=i.segments[t.s]),i&&a?{fragment:i,segment:a}:(L.a.error("loader findSegmentByPTS error, null"),null)}},{key:"_errorChange",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this._error=e,this.emit(t.ERROR_CHANGE,e)}},{key:"_gc",value:function(){if(!(this._readPos.f<0||this._readPos.s<0||this._loadPos.f<0||this._loadPos.s<0||this._loadPos.f<this._readPos.f))for(var e,t,i,a,n,r,s=this._bufferPool.keys,o=this._readPos.f,d=this._loadPos.f,u=0;u<s.length;u++)i=(a=s[u]).split("-"),e=parseInt(i[1],10),t=parseInt(i[2],10),e<o||e>d?this._gcSeg(a,e,t):e==o&&e==d?(n=this._readPos.s,r=this._loadPos.s,(t<n||t>r)&&this._gcSeg(a,e,t)):e==o?t<(n=this._readPos.s)&&this._gcSeg(a,e,t):e==d&&t>(r=this._loadPos.s)&&this._gcSeg(a,e,t)}},{key:"_gcSeg",value:function(e,t,i){var a=this._fragments[t],n=a.segments[i];this._bufferPool.del(e),a.status==Ne&&(a.status=Re),n.status=Re}},{key:"reset",value:function(){m()(c()(t.prototype),"reset",this).call(this),this._dashRemote.reset(),this._fragments.splice(0,this._fragments.length),this._readPos.f=this._readPos.s=-1,this._loadPos.f=this._loadPos.s=-1,this._currentBuf=null,this.state=ve.IDLE,this._preErrorData=null,this._dashRemote.reset()}},{key:"_bufferTime",get:function(){return this._currentBuf&&this._currentBuf.info?this._currentBuf.info.timeLength:0}}]),t}(ke),tt=et;et.ERROR_CHANGE="error_change";var it=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e))).TAG="DashLoader",i._ctx=e,i._timeGap=10,i._audioInitData=null,i._videoInitData=null,i._videoInitConfig=null,i._audioInitConfig=null,i}return f()(t,e),s()(t,[{key:"silenced",set:function(e){Me()(c()(t.prototype),"silenced",e,this,!0),this._hasVideo&&(this._videoLoader.silenced=e),this._hasAudio&&(this._audioLoader.silenced=e)}},{key:"videoInitData",get:function(){if(!this._videoInitData){var e=this._videoLoader.initSegmentData;if(e||this.mode!=me.P2P||(this._readInitInP2P(),e=this._videoLoader.initSegmentData),e){var t=this._videoInitConfig,i=t.codec,a=t.mimeType;this._videoInitData=new X.a("video"),this._videoInitData.bytesArray=[e],this._videoInitData.container=a,this._videoInitData.codec=i,L.a.log("dashLoader video initSegment, codec=".concat(i,", mimeType=").concat(a,", length=").concat(e.byteLength))}}return this._videoInitData}},{key:"audioInitData",get:function(){if(!this._audioInitData){var e=this._audioLoader.initSegmentData;if(e||this.mode!=me.P2P||(this._readInitInP2P(),e=this._audioLoader.initSegmentData),e){var t=this._audioInitConfig,i=t.codec,a=t.mimeType;this._audioInitData=new X.a("audio"),this._audioInitData.bytesArray=[e],this._audioInitData.container=a,this._audioInitData.codec=i,L.a.log("dashLoader audio initSegment, codec=".concat(i,", mimeType=").concat(a,", length=").concat(e.byteLength))}}return this._audioInitData}},{key:"timeGap",set:function(e){this._timeGap=e}}]),s()(t,[{key:"setVideoStream",value:function(e,t){this._videoLoader.fragments=e,this._videoLoader.segments=t}},{key:"setAudioStream",value:function(e,t){this._audioLoader.fragments=e,this._audioLoader.segments=t}},{key:"setVideoConfig",value:function(e){var t=this,i=e.initSegment,a=e.codec,n=e.mimeType;return(!this._preVideoInit||this._preVideoInit!=i)&&(this._preVideoInit=i,this._videoInitData=null,this._videoLoader=new tt(this._ctx,this,"video",this.mode),this._videoLoader.on(tt.ERROR_CHANGE,(function(e){t._error=e})),this._videoLoader.initSegment=i,this._videoInitConfig={codec:a,mimeType:n},!0)}},{key:"setAudioConfig",value:function(e){var t=this,i=e.initSegment,a=e.codec,n=e.mimeType;return(!this._preAudioInit||this._preAudioInit!=i)&&(this._preAudioInit=i,this._audioInitData=null,this._audioLoader=new tt(this._ctx,this,"audio",this.mode),this._audioLoader.on(tt.ERROR_CHANGE,(function(e){t._error=e})),this._audioLoader.initSegment=i,this._audioInitConfig={codec:a,mimeType:n},!0)}},{key:"read",value:function(){return this.mode===me.P2P?this._readP2P():this._readCDN()}},{key:"_readCDN",value:function(){if(this.eof)return null;var e,t,i=!1,a=!1,n=!1;if(this._hasAudio&&this._hasVideo){var r=this._audioLoader.buffer.start,s=this._videoLoader.buffer.start;r-s>this._timeGap?i=!0:s-r>this._timeGap?a=!0:i=a=!0}else i=this._hasVideo,a=this._hasAudio;if(a&&!this._audioLoader.eof){var o=this._audioLoader.read();o&&(t={contentType:"audio",bytes:o.data,segment:o.meta.segment})}if(i&&!this._videoLoader.eof){var d=this._videoLoader.read();d&&(e={contentType:"video",bytes:d.data,segment:d.meta.segment})}return this._hasAudio&&this._hasVideo?(n=this._audioLoader.eod&&this._videoLoader.eod,this._eof=this._audioLoader.eof&&this._videoLoader.eof):this._hasAudio?(n=this._audioLoader.eod,this._eof=this._audioLoader.eof):this._hasVideo&&(n=this._videoLoader.eod,this._eof=this._videoLoader.eof),n&&(this.state=ve.END),e||t?{meta:{video:e||null,audio:t||null}}:null}},{key:"_tick",value:function(){this._checkCDNBuffer()}},{key:"_checkCDNBuffer",value:function(){var e=this._videoLoader,t=this._audioLoader,i=this._timeGap,a=this._hasAudio,n=this._hasVideo;if(a&&n){var r=e.getUnreadBufInfo().timeLength,s=!!e.initSegmentData,o=t.getUnreadBufInfo().timeLength;if(s!==!!t.initSegmentData||r<i!=o<i){var d=!s||r<i;e.allowLoaded=d,t.allowLoaded=!d}else e.allowLoaded=t.allowLoaded=!0}}},{key:"_readP2P",value:function(){var e=this,t=this._p2pProxy.read(),i=this._videoLoader.segments,a=this._audioLoader.segments;if(t&&t.type){var n=t.bid,r=t.loadDone;if("dash"===t.type.toLowerCase()){var s={contentType:"video",level:n,index:t.video.index,bytes:t.video.data,chunkEOF:t.video.chunkEOF,segment:i[t.video.index]},o={contentType:"audio",level:n,index:t.audio.index,bytes:t.audio.data,chunkEOF:t.audio.chunkEOF,segment:a[t.audio.index]};if(r&&(this.state=ve.END),[s,o].filter((function(e){return!!e.segment})).forEach((function(t){var i=t.contentType,a=t.index,r=t.bytes,s=t.chunkEOF,o=t.segment,d=o.startTime,u=o.duration,c=o.startByte,l=o.endByte,h=l-c;if(o.status=s?2:1,r){var _="\n                                ".concat(e.LOG_TAG,": received ").concat(i," ").concat(a," segment, bid: ").concat(n,".\n\t\t\t\t\t\t\t\tbytes length: ").concat(r.length,", ").concat(c,"->").concat(l,". \n\t\t\t\t\t\t\t\tstartTime: ").concat(d,", duration: ").concat(u,"\n\t\t\t\t\t\t\t\t");L.a.log(_),r.length!==h&&(self._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.DATA_P2P_DASH_BYTES_LENGTH),L.a.error("".concat(e.LOG_TAG,": bytes length not match, expect ").concat(h,", return ").concat(r.length,", ").concat(_)))}})),!this._hasAudio||o.index>=a.length||o.index===a.length-1&&o.bytes?self._audioEOF=!0:self._audioEOF=!1,!this._hasVideo||s.index>=i.length||s.index===i.length-1&&s.bytes?self._videoEOF=!0:self._videoEOF=!1,this._eof=self._videoEOF&&self._audioEOF,this._eof&&L.a.log("".concat(this.LOG_TAG,": EOF")),s.bytes||o.bytes)return{meta:{video:this._hasVideo&&s.bytes?s:null,audio:this._hasAudio&&o.bytes?o:null}}}}return null}},{key:"_readInitInP2P",value:function(e){if(e||(e=this._p2pProxy.read(!0)),e&&e.type){var t=e.type.toLowerCase(),i=e.bid;if("dash"===t){"".concat(this.LOG_TAG,": init crc hash, bid: ").concat(i);e.video&&e.video.data.byteLength>0&&(this._videoLoader.initSegmentData=e.video.data),e.audio&&e.audio.data.byteLength>0&&(this._audioLoader.initSegmentData=e.audio.data)}}}},{key:"getUnreadBufInfo",value:function(){var e=null,t=null;return this._videoLoader&&(e=this._videoLoader.getUnreadBufInfo()),this._audioLoader&&(t=this._audioLoader.getUnreadBufInfo()),{buffered:{video:e,audio:t}}}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return this._hasVideo?this._videoLoader.findSegmentByPTS(e):this._hasAudio?this._audioLoader.findSegmentByPTS(e):{fragment:null,segment:null}}},{key:"_seek",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=arguments.length>2&&arguments[2]!==undefined&&arguments[2];[{type:"video",exist:this._hasVideo,loader:this._videoLoader},{type:"audio",exist:this._hasAudio,loader:this._audioLoader}].forEach((function(a){var n=a.type,r=a.exist,s=a.loader;if(r){var o=e;Object(U.e)(e)&&(o=e[n]),s.seek(o,t,i)}}))}},{key:"drainBufferPool",value:function(){this._hasVideo&&this._videoLoader.drainBufferPool(),this._hasAudio&&this._audioLoader.drainBufferPool()}},{key:"reset",value:function(){this._videoLoader&&this._videoLoader.reset(),this._audioLoader&&this._audioLoader.reset(),this._videoInitData=null,this._audioInitData=null}},{key:"destroy",value:function(){m()(c()(t.prototype),"destroy",this).call(this),this._videoLoader&&this._videoLoader.destroy(),this._audioLoader&&this._audioLoader.destroy(),this._hasVideo=this._hasAudio=!1,delete this._audioLoader,delete this._videoLoader}},{key:"_gc",value:function(){this._videoLoader&&this._videoLoader._gc(),this._audioLoader&&this._audioLoader._gc()}}]),t}(Te);i(296),i(149);function at(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName==t}))}var nt={parseXmlString:function(e,t){var i=new DOMParser,a=null,n=null;try{n=i.parseFromString(e,"text/xml")}catch(r){throw"XML DOMParser parseFromString error: ".concat(r.message)}return n&&n.documentElement.tagName==t&&(a=n.documentElement),a&&a.getElementsByTagName("parsererror").length>0?(L.a.error("XML valid error"),null):a},parseAttr:function(e,t,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null,n=null,r=e.getAttribute(t);return null!=r&&(n=i(r)),null==n?a:n},getTextContents:function(e){return Array.from(e.childNodes).every((function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},findChild:function(e,t){var i=at(e,t);return 1!=i.length?null:i[0]},findChildren:at,findChildrenByNodeType:function(e,t){return Array.from(e.childNodes).filter((function(e){return e.nodeType===t}))}},rt=function(){function e(t){n()(this,e),this.type=t,this.status=0,this.enabled=!0,this.seekable=!0,this.startTime=null,this.startByte=null,this.endByte=null,this.mediumStartByte=null,this.mediumEndByte=null,this.duration=0,this.idx=null,this.uri="",this.isAd=!1,this._segments=[],this.gas=null,this.offset=0,this._key=se.a.create(),this.bid=""}return s()(e,[{key:"endTime",get:function(){return this.startTime+this.duration}},{key:"segments",get:function(){return this._segments}},{key:"key",get:function(){return this._key}}]),e}(),st=(i(89),i(297),i(298),i(245)),ot=i.n(st),dt="video",ut="audio",ct="text",lt="application",ht=q.a.mark(_t);function _t(e){var t,i,a,n,r,s,o,d,u;return q.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:t=-1,i=undefined,a=undefined,n=!0,r=!1,s=undefined,c.prev=6,o=e[Symbol.iterator]();case 8:if(n=(d=o.next()).done){c.next=19;break}if(u=d.value,!(t>=0)){c.next=13;break}return c.next=13,{i:t,item:a,prev:i,next:u};case 13:t++,i=a,a=u;case 16:n=!0,c.next=8;break;case 19:c.next=25;break;case 21:c.prev=21,c.t0=c["catch"](6),r=!0,s=c.t0;case 25:c.prev=25,c.prev=26,n||null==o["return"]||o["return"]();case 28:if(c.prev=28,!r){c.next=31;break}throw s;case 31:return c.finish(28);case 32:return c.finish(25);case 33:if(-1==t){c.next=36;break}return c.next=36,{i:t,prev:i,item:a,next:undefined};case 36:case"end":return c.stop()}}),ht,null,[[6,21,25,33],[26,,28,32]])}i(118),i(137);function ft(e){return null!=e}function pt(e){if(!e)return null;var t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return L.a.warn("Invalid duration string: ".concat(e)),null;var i=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(i)?i:null}function gt(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var i=Number(t[1]);if(!isFinite(i))return null;var a=Number(t[2]);return isFinite(a)?{start:i,end:a}:null}function mt(e){var t,i;return i=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(i)?null:i}function vt(e){var t=Number(e);return t%1==0&&t>0?t:null}function bt(e){var t=Number(e);return t%1==0&&t>=0?t:null}function yt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function kt(e,t){return e.filter((function(e){return e.contentType==t}))}function Tt(e,t,i){var a,n;if(e||t)if(e&&t){var r=!0,s=!1,o=undefined;try{for(var d,u=e.streams[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){var c=d.value,l=!0,h=!1,_=undefined;try{for(var f,p=t.streams[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var g=f.value;a=(g.bandwidth||0)+(c.bandwidth||0),n={language:e.language,primary:e.main||t.main,audio:c,video:g,bandwidth:a},i.push(n)}}catch(P){h=!0,_=P}finally{try{l||null==p["return"]||p["return"]()}finally{if(h)throw _}}}}catch(P){s=!0,o=P}finally{try{r||null==u["return"]||u["return"]()}finally{if(s)throw o}}}else{var m=e||t,v=!0,b=!1,y=undefined;try{for(var k,T=m.streams[Symbol.iterator]();!(v=(k=T.next()).done);v=!0){var S=k.value;a=S.bandwidth||0,n={language:m.language||"und",primary:m.main,audio:e?S:null,video:t?S:null,bandwidth:a},i.push(n)}}catch(P){b=!0,y=P}finally{try{v||null==T["return"]||T["return"]()}finally{if(b)throw y}}}}function St(e,t){e.period=t,e.period.id||(L.a.log("No Period ID given for Period with start time ".concat(t.start,",  Assigning a default")),e.period.id="__qvs_period_"+t.start);var i=nt.findChildren(t.node,"AdaptationSet").map((function(t){return function(e,t){var i=t.getAttribute("id"),a=t.getAttribute("contentType")||"",n=t.getAttribute("segmentAlignment"),r=t.getAttribute("lang")||"und",s=nt.findChildren(t,"Representation"),o=a===ct;e.adaptationSet={id:i,contentType:a,segmentAlignment:n,language:r};var d=s.map((function(t){return function(e,t,i){var a,n=e.adaptationSet,r=n.contentType,s=t.getAttribute("id"),o=t.getAttribute("mimeType")||"",d=t.getAttribute("codecs"),u=nt.parseAttr(t,"bandwidth",vt)||0,c=nt.findChild(t,"SegmentBase"),l=nt.findChild(t,"SegmentList"),h=nt.findChild(t,"SegmentTemplate"),_=nt.findChildren(t,"BaseURL").map(nt.getTextContents),f={contentType:r,id:s,mimeType:o,codecs:d,bandwidth:u,baseUris:_,segmentBase:c,segmentList:l,segmentTemplate:h};switch(r){case dt:f.width=nt.parseAttr(t,"width",bt),f.height=nt.parseAttr(t,"height",bt),f.frameRate=nt.parseAttr(t,"frameRate",mt);break;case ut:f.audioSamplingRate=bt(t.getAttribute("audioSamplingRate"))}if(e.representation=f,!function(e){var t=0;if(t+=e.segmentBase?1:0,t+=e.segmentList?1:0,0==(t+=e.segmentTemplate?1:0))return L.a.warn("Representation does not contain a segment information source: the Representation must contain one of SegmentBase, SegmentList"),!1;1!=t&&(L.a.warn("Representation ".concat(e.id," contains multiple segment information sources: the Representation should only contain one of SegmentBase,SegmentList, or SegmentTemplate.")),e.segmentBase?(L.a.log("Using SegmentBase by default."),e.segmentList=null,e.segmentTemplate=null):(L.a.log("Using SegmentList by default."),e.segmentTemplate=null));return!0}(f))return L.a.warn("Skipping Representation",f),null;f.segmentList?a=function(e,t){var i=e.representation,a=i.contentType,n=nt.findChild(t,"Initialization"),r=nt.findChildren(t,"SegmentURL"),s=bt(t.getAttribute("startNumber")||""),o=NaN;if("video"===a)o=1e3;else{if("audio"!==a)throw"mpd unknown ".concat(a);o=i.audioSamplingRate}var d={range:nt.parseAttr(n,"range",gt,{start:0,end:null})},u=r.map((function(t,i){t.getAttribute("indexRange")&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0);var a=bt(nt.parseAttr(t,"t",bt));return 0===i&&(a=0),{startTime:a,duration:bt(nt.parseAttr(t,"d",bt)),range:nt.parseAttr(t,"mediaRange",gt,{start:0,end:null})}}));u.length>1&&(u[0].duration=u[1].startTime);0==s&&(L.a.warn("SegmentList@startNumber must be > 0"),s=1);return{startNumber:s,timescale:o,initUri:d,mediaUris:u}}(e,f.segmentList):f.segmentBase||f.segmentTemplate?L.a.error("mpd parser still not support parse segmentBase or segmentTemplate"):L.a.error("Must have Segment* with non-text streams.");return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(i),!0).forEach((function(t){ot()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):yt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({id:n.id,originalId:f.id,segmentIndex:null,mimeType:f.mimeType,codecs:f.codecs,frameRate:f.frameRate,bandwidth:f.bandwidth,width:f.width,height:f.height,language:i,type:r,channelsCount:f.numChannels},a)}(e,t,r)})).filter((function(e){return!!e}));if(0==d.length){if(o)return null;throw new Error("DASH_EMPTY_ADAPTATION_SET")}if(!e.adaptationSet.contentType||e.adaptationSet.contentType==lt){var u=d[0].mimeType;d[0].codecs;e.adaptationSet.contentType=function(e){return e.split("/")[0]}(u);var c=!0,l=!1,h=undefined;try{for(var _,f=d[Symbol.iterator]();!(c=(_=f.next()).done);c=!0){_.value.type=e.adaptationSet.contentType}}catch(g){l=!0,h=g}finally{try{c||null==f["return"]||f["return"]()}finally{if(l)throw h}}}var p=s.map((function(e){return e.getAttribute("id")})).filter(ft);return{id:e.adaptationSet.id,contentType:e.adaptationSet.contentType,language:r,streams:d,representationIds:p}}(e,t)})).filter(ft),a=kt(i,dt),n=kt(i,ut);if(!a.length&&!n.length)throw"DASH_EMPTY_PERIOD";n.length||(n=[null]),a.length||(a=[null]);var r=[],s=!0,o=!1,d=undefined;try{for(var u,c=n[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var l=u.value,h=!0,_=!1,f=undefined;try{for(var p,g=a[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){Tt(l,p.value,r)}}catch(m){_=!0,f=m}finally{try{h||null==g["return"]||g["return"]()}finally{if(_)throw f}}}}catch(m){o=!0,d=m}finally{try{s||null==c["return"]||c["return"]()}finally{if(o)throw d}}return{startTime:t.start,variants:r}}var Pt={parseClipList:function(e){var t=nt.findChild(e,"clip_list"),i={},a={BaseURL:"baseUrl",remote_path:"url",start_ts_in_ms:{name:"startTime",parser:bt},duration_in_ms:{name:"duration",parser:bt},start_pos:{name:"startByte",parser:bt},end_pos:{name:"endByte",parser:bt},type:"type",size:{name:"size",parser:bt}};return t&&nt.findChildren(t,"clip").map((function(e){var t={};nt.findChildrenByNodeType(e,Node.ELEMENT_NODE).map((function(e){var i=a[e.tagName];if(i){var n="string"==typeof i?i:i.name,r=nt.getTextContents(e);i.parser&&(r=i.parser(r)),t[n]=r}})),Array.isArray(i[t.type])||(i[t.type]=[]),i[t.type].push(t)})),i},parseDuration:pt,parsePeriods:function(e,t){var i=[],a=nt.findChildren(t,"Period"),n=e.presentationDuration,r=0,s=!0,o=!1,d=undefined;try{for(var u,c=_t(a)[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var l=u.value,h=l.i,_=l.item,f=l.next,p=_.getAttribute("id"),g=nt.parseAttr(_,"start",pt,r),m=nt.parseAttr(_,"duration",pt),v=null;if(f){var b=nt.parseAttr(f,"start",pt);null!=b&&(v=b-g)}else null!=n&&(v=n-g);v&&m&&Math.abs(v-m)>1/15&&L.a.warn("There is a gap/overlap between mpd Periods"),null==v&&(v=m);var y=St(e,{id:p,start:g,duration:v,node:_,isLastPeriod:null==v||!f});if(i.push(y),null==v){f&&L.a.warn("Skipping Period",h+1,"and any subsequent Periods:","Period",h+1,"does not have a valid start time.",f),r=null;break}r=g+v}}catch(k){o=!0,d=k}finally{try{s||null==c["return"]||c["return"]()}finally{if(o)throw d}}return null!=n?(r!=n&&L.a.warn("@mediaPresentationDuration does not match the total duration of all Periods."),{periods:i,duration:n,durationDerivedFromPeriods:!1}):{periods:i,duration:r,durationDerivedFromPeriods:!0}}},xt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).ctx=e,i.metadata=new Ae,i.duration=0,i.bid=null,i.tracks={},i.manifestType=null,i}return f()(t,e),s()(t,[{key:"push",value:function(e){var t=this;try{!function(){var i=e.manifestType,a=e.bid,n=e.data,r=t,s=se.a.create(),o=nt.parseXmlString(n,"MPD"),d=nt.parseAttr(o,"mediaPresentationDuration",Pt.parseDuration),u=Pt.parseClipList(o),c=!!u.video,l=!!u.audio,h={clips:u,presentationDuration:d,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1},_=Pt.parsePeriods(h,o).periods;t.duration=d,t.metadata.hasAudio=l,t.metadata.hasVideo=c,t.bid=a,t.manifestType=i,Object.keys(u).forEach((function(e){var a=u[e],n={};n.type=e,n.duration=t.duration,n.fragments=[],a.map((function(e,a){var r=new rt(i);r.idx=a,r.bid=t.bid,r.uri=new fe.a(e.url),r.mediumStartByte=e.startByte,r.mediumEndByte=e.endByte+1,r.startByte=0,r.endByte=r.mediumEndByte-r.mediumStartByte,Object(U.d)()&&r.uri.setScheme("https"),n.fragments.push(r)})),t.tracks[e]=n}));var f=!0,p=!1,g=undefined;try{for(var m,v=function(){var e=m.value.variants[0],a=[];l&&a.push("audio"),c&&a.push("video"),a.forEach((function(a){var n=t.tracks[a],o=e[a],d=o.codecs;if(n){var u=new De(i);u.uri=new fe.a(n.fragments[0].uri),u.startByte=o.initUri.range.start,u.endByte=o.initUri.range.end+1,u.uri.query.add("start",u.startByte),u.uri.query.add("end",u.endByte),n.codec=d,n.mimeType=o.mimeType,n.initSegment=u,n.segments=[];for(var c=0,l=-1,h=n.fragments[c],_=o.timescale,f=o.mediaUris.length,p=!1,g=0;g<f;g++){var m=g===f-1,v=o.mediaUris[g],b=v.range.start,y=v.range.end+1,k=b-h.mediumStartByte,T=y-h.mediumStartByte,S=new fe.a(h.uri),P=v.startTime/_,x=v.duration/_;m&&(x=n.duration-P),y<=h.mediumEndByte&&(l++,y===h.mediumEndByte&&(p=!0,h.startTime=h.segments.length>0?h.segments[0].startTime:P,h.duration=P-h.startTime+x)),S.query.update("start",k),S.query.update("end",T);var I=new De(i);I.uri=S,I.idx=l,I.fragIdx=c,I.startTime=P,I.duration=x,I.startByte=k,I.endByte=T,I.poolId=s+"-"+c+"-"+l,I.bid=r.bid,n.segments.push(I),h.segments.push(I),p&&(c++,l=-1,h=n.fragments[c],p=!1)}}}))},b=_[Symbol.iterator]();!(f=(m=b.next()).done);f=!0)v()}catch(y){p=!0,g=y}finally{try{f||null==b["return"]||b["return"]()}finally{if(p)throw g}}}()}catch(i){return L.a.error("mpd parsed fail: ".concat(i.stack," - ").concat(i.message)),this.ctx.emit(ae.a.ERROR,{category:ee.a.category.MANIFEST,code:ee.a.code.MFT_FAILED_TO_PARSE_MPD_XML,severity:ee.a.severity.CRITICAL})}}},{key:"copyData",value:function(e){for(var t in e){/^_/gi.test(t)||(this[t]=e[t])}}},{key:"reset",value:function(){this.metadata=new Ae,this.tracks={},this.duration=0,this.bid=null,this.manifestType=null}}]),t}(H.a),It=function(e){function t(e){var i;n()(this,t);var a=new xt,r=new it(e),s=new J("dash","dash",{enableWorker:!1});return(i=d()(this,c()(t).call(this,e,{manifest:a,loader:r,multiplexer:s}))).TAG="DashActor",i._loader,i._mountBuffered=!0,i._videoTrack={},i._audioTrack={},i._duration=0,i._canResetWhileSwitchLevel=!1,i._sendISWhileFragmentChange=!0,i._isCacheMode=!1,i}return f()(t,e),s()(t,[{key:"duration",get:function(){return this._duration}}]),s()(t,[{key:"feed",value:function(e){var i=arguments.length>1&&arguments[1]!==undefined&&arguments[1];m()(c()(t.prototype),"feed",this).call(this,e,i);var a=this._manifest,n=this._cfg,r=this._loader,s=a.manifestType,o=a.tracks.video,d=a.tracks.audio,u=!1;switch(s){case O.a.DASH_VP9:r.useP2P=n.useVP9P2P;break;case O.a.DASH_AV1:r.useP2P=n.useAV1P2P}if(o){var l=r.setVideoConfig(o);u=u||l}if(d){var h=r.setAudioConfig(d);u=u||h}u&&(this._needSendInitSegment=!0)}},{key:"_reset",value:function(){this._lastReadVideoMeta=null,this._duration=0,this._videoTrack=null,this._audioTrack=null,this._loader.reset()}},{key:"_destroy",value:function(){this._reset()}},{key:"applyRange",value:function(e){var t=this._manifest,i=this._videoTrack=t.tracks.video,a=this._audioTrack=t.tracks.audio;if(this._duration=t.duration,i){var n=this._constructPlaySegmentsByRangeList(i.fragments,e);this._loader.setVideoStream(n.fragments,n.segments)}if(a){var r=this._constructPlaySegmentsByRangeList(a.fragments,e);this._loader.setAudioStream(r.fragments,r.segments)}}},{key:"_constructPlaySegmentsByRangeList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],t=arguments.length>1?arguments[1]:undefined,i=[],a=t.start(0),n=t.end(t.length-1);return e.forEach((function(e,t){var r=e.segments;r.length>0&&r.map((function(r,s,o){var d=r.startTime,u=r.startTime+r.duration;return r.enabled=(d>=a||u>a)&&(u<=n||d<n),r.fragIdx=t,r.fragKey=e.key,r.flattenIdx=i.length,i.push(r),r}))})),{fragments:e,segments:i}}},{key:"_getSegmentByPTS",value:function(e){return this._loader.findSegmentByPTS(e).segment}},{key:"read",value:function(){var e=null,t=null,i=this._hasAudio,a=this._hasVideo,n=this._needSendInitSegment,r=this._manifest;if(n)i&&(t=this._loader.audioInitData)&&(t.origin=r.manifestType),a&&(e=this._loader.videoInitData)&&(e.origin=r.manifestType),a&&i&&e&&t||a&&!i&&e||i&&!a&&t?this._needSendInitSegment=!1:t=e=null;else{var s=this._loader.read();if(s){var o=s.meta||{};for(var d in this._lastReadVideoMeta=o.video||this._lastReadVideoMeta,o){var u=o[d];if(u){var c=u.contentType,l=u.bytes,h=u.segment.startTime,_=u.segment.duration;if("video"===c){var f=new Z.a("video");f.origin=r.manifestType,f.bytesArray=[l],f.startTime=h,f.duration=_,e=f,this._curVideoEndTime=h+_}else if("audio"===c){var p=new Z.a("audio");p.origin=r.manifestType,p.bytesArray=[l],p.startTime=h,p.duration=_,t=p,this._curAudioEndTime=h+_}}}}}return{video:e,audio:t}}},{key:"noticeP2PCheckData",value:function(){var e=this._lastReadVideoMeta;if(e){var t=e.segment.startByte,i=e.segment.endByte;i-t>200&&(i=t+200),this._loader.noticeCheckData({level:e.level,fragIdx:e.segment.fragIdx,startByte:t,endByte:i})}}}]),t}(Oe),Et=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return n()(this,t),(i=d()(this,c()(t).call(this,a))).ctx=e,i.netProxy=e.netProxy,i.retryCount=r,i.hooks.beforeLoad=i._beforeLoad.bind(h()(i)),i}return f()(t,e),s()(t,[{key:"_beforeLoad",value:function(){this.retryCount>0&&this.query.update("retry",this.retryCount),this.query.update("pv","0.1"),this.query.update("cross-domain",1)}}]),t}(Je),Dt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).TAG="HLSRemote",i.LOG_TAG="[".concat(i.TAG,"]"),i.ctx=e,i._eventManager=new M.a,i.netProxy=e.netProxy,i._dispatcher=null,i._dispatcherResultDic={},i._cdnLaborer=null,i._internalRetryCount=0,i._internalMaxRetry=2,i._dnsInfo={userinfo:"",idc:""},i}return f()(t,e),s()(t,[{key:"dispatcher",get:function(){return this._dispatcher}},{key:"cdnLaborer",get:function(){return this._cdnLaborer}}]),s()(t,[{key:"_makeCDNUri",value:function(e,t,i){var a=new fe.a(e);return a.query.update("start",t),a.query.update("end",i),a}},{key:"removeDispatchDicKey",value:function(e){delete this._dispatcherResultDic[e]}},{key:"startLoad",value:function(e){var i=this,a=(arguments.length>1&&arguments[1]!==undefined&&arguments[1],e.fragment),n=new fe.a(e.uri.toString()),r=a.uri.path,s=this._dispatcherResultDic[r],o={startByte:e.pieces[0].startByte,endByte:e.pieces[e.pieces.length-1].endByte};if(s&&s.l){var d=this._makeCDNUri(s.l,o.startByte,o.endByte);this._loadCDNData(e,d)}else{if(this._dispatcher&&(this._eventManager.removeAll(),this._dispatcher.destroy()),s){var u=s.z;u&&n.query.update("z",u)}this._dispatcher=new Et(this.ctx,n.toString(),this._internalRetryCount),this._eventManager.on(this._dispatcher,ze.DISPATCH_SUCCESS,(function(t){i._dispatcherResultDic[r]=t,i._dnsInfo={userinfo:t.t,idc:t.z};var a=i._makeCDNUri(t.l,o.startByte,o.endByte);i._loadCDNData(e,a)})),this._eventManager.on(this._dispatcher,ze.DNS_PARSER_REQUEST,(function(e){i._doDNS(e)})),this._eventManager.on(this._dispatcher,ze.DISPATCH_FAIL,(function(a){var n=a.reason,r=a.error;switch(n){case He:i._internalRetryCount<i._internalMaxRetry?(i._internalRetryCount++,i._internalRetry(e)):i.emit(t.Events.FAILURE,{category:"dispatcher-timeout"});break;case Ve:405===r.status&&r.response&&r.response.code&&r.response.code.indexOf("D20")>=0?i.emit(t.Events.FAILURE,{category:"auth-error"}):i._internalRetryCount<i._internalMaxRetry?(i._internalRetryCount++,i._internalRetry(e)):i.emit(t.Events.FAILURE,{category:"dispatcher-error"});break;case We:i.emit(t.Events.ABORT);break;default:L.a.warn("Unknown dispatch fail reason ".concat(n))}})),this._dispatcher.load()}}},{key:"_loadCDNData",value:function(e,i){var a=this,n=this.netProxy,r=i.toString(),s=_e.a.SEGMENT,o=n.makeRequestContext([r],Object(V.a)({timeout:1e4},n.defaultRetryParameters));o.method="GET",o.callbacks=Object(V.a)(o.callbacks,{onProgress:function(e,i){a.emit(t.Events.PROGRESS,e,i)},onSuccess:function(e){var i=new Uint8Array(e.data);L.a.log("".concat(a.LOG_TAG," cdn success, http-status/bytes/take(").concat(e.status,"/").concat(i.byteLength,"/").concat(e.netCost,"ms), ").concat(F.filesize(e.speed),"/s, ").concat(e.url)),a.emit(t.Events.SUCCESS,{bytes:i})},onError:function(i){L.a.log("".concat(a.LOG_TAG," cdn error, http-status=").concat(i.status,", ").concat(i.url)),a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-error",statusCode:i.status}))},onTimeout:function(i,n,s){a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(L.a.log("".concat(a.LOG_TAG," cdn timeout, ").concat(s.url)),a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-timeout"}))},onAbort:function(){a.emit(t.Events.ABORT)},onComplete:function(){}},!0),this._cdnLaborer=n.request(s,o)}},{key:"_internalRetry",value:function(e){var t=this._dispatcherResultDic[e.uri.path];t&&t.l&&delete t.l,this.startLoad(e,!0)}},{key:"_doDNS",value:function(e){this.emit(t.Events.DNSPARSER,{userinfo:this._dnsInfo.userinfo,idc:this._dnsInfo.idc,url:e})}},{key:"abort",value:function(){this._dispatcher&&this._dispatcher.abort(),this._cdnLaborer&&this._cdnLaborer.abort()}},{key:"reset",value:function(){this._internalRetryCount=0,this._dispatcherResultDic={},this._eventManager.removeAll(),this._dnsInfo={userinfo:"",idc:""},this.abort()}},{key:"destroy",value:function(){delete this._dispatcherResultDic,this._internalRetryCount=0,this._eventManager.destroy(),delete this._eventManager,this._dispatcher&&this._dispatcher.destroy(),delete this._dispatcher,this._cdnLaborer&&this._cdnLaborer.destroy(),delete this._cdnLaborer,this._dnsInfo={userinfo:"",idc:""}}}]),t}(ne.a);Dt.Events={SUCCESS:"SUCCESS",PROGRESS:"PROGRESS",FAILURE:"FAILURE",ABORT:"ABORT",COMPLETE:"COMPLETE",DNSPARSER:"DNSPARSER"};var wt=Dt,At=function(){function e(t){n()(this,e),this._fragment=t.frag,this._fragIdx=t.fragIdx,this._range=t.range,this._bufferInfo=t.bufferInfo,this._pieces=[];for(var i=this._fragment.segments,a=t.range[0],r=t.range[1],s=this._pieces,o=a;o<=r;o++)s.push(i[o]);if(1===s.length){var d=s[0];this._uri=d.uri}}return s()(e,[{key:"uri",get:function(){return this._uri}},{key:"fragIdx",get:function(){return this._fragIdx}},{key:"pieces",get:function(){return this._pieces}},{key:"buffer",get:function(){return this._bufferInfo}},{key:"fragment",get:function(){return this._fragment}}]),s()(e,[{key:"destroy",value:function(){this._pieces=[],this._fragment=null,this._range=null,this._fragIdx=null}}]),e}(),qt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e,e.config.useP2P))).TAG="HLSLoader",i._fragments=[],i._segments=[],i._readPos={f:-1,s:-1,b:-1},i._downPos={f:-1,s:-1,b:-1},i._maxSegmentSearchTolerance=e.config.hlsMaxSegmentSearchTolerance,i._hlsRemote=new wt(e),i}return f()(t,e),s()(t,[{key:"fragsWithSegs",set:function(e){this._eof=!1,this._eod=!1,this._fragments=e.frags,this._segments=e.segs,this._maxSegmentSearchTolerance=e.isAccurateTimeStamp?0:this._ctx.config.hlsMaxSegmentSearchTolerance}},{key:"segments",set:function(e){this._segments=e}}]),s()(t,[{key:"_reset",value:function(){this._fragments.splice(0,this._fragments.length),this._segments.splice(0,this._segments.length),this._readPos.f=this._readPos.s=this._readPos.b=-1,this._downPos.f=this._downPos.s=this._downPos.b=-1,this._lastBufPos=undefined,this._lastBufInf=undefined,this.state!==ve.IDLE&&(this.state===ve.LOADING?this._abort():this.state=ve.IDLE),this._withBufferRetryCount=0,this._noBufferRetryCount=0,this._hlsRemote.reset()}},{key:"read",value:function(){return this.mode===me.P2P?this._readP2P():this._readCDN()}},{key:"_seek",value:function(e){this._withBufferRetryCount=0,this._noBufferRetryCount=0,e-=this._maxSegmentSearchTolerance;var t=this.findSegmentByPTS(e),i=t.fragment,a=t.segment;if(!i||!a)throw Error("seek pts/frag/segment(".concat(e,"/").concat(i,"/").concat(a,")"));var n=this._getFloatNumByIdx(i.idx,a.idx),r=this._getFloatNumByIdx(this._readPos.f,this._readPos.s),s=this._getFloatNumByIdx(this._downPos.f,this._downPos.s),o=n>=r&&n<=s;this._readPos.f=i.idx,this._readPos.s=a.idx,this._readPos.b=0,this._downPos.f=i.idx,this._downPos.s=a.idx,this._downPos.b=0,this._findPieceByPos(this._downPos).segment.status===Ne&&this._moveToNextDownPosOrEOD(),o||this.state!==ve.LOADING||this._abort(),this._tick()}},{key:"_tick",value:function(){this._checkFetchOrEOD()}},{key:"_checkFetchOrEOD",value:function(){if(!this._eod&&!this._ctx.error&&this._segments&&0!==this._segments.length&&this.state===ve.IDLE){var e=this.getUnreadBufInfo();if(e.timeLength>this._maxBufferTimeLength)return;this._checkLoad(e)}}},{key:"_getFloatNumByIdx",value:function(e,t){return parseFloat(e+"."+t)}},{key:"getUnreadBufInfo",value:function(){var e=this._fragments,t=this._downPos.f,i=this._downPos.s,a=this._readPos.f,n=this._readPos.s,r=0,s=0,o=0,d={start:o,byteLength:r,timeLength:s};if(this.eof){if(this.eof){var u=e[e.length-1];d.start=u.endTime}}else{var c=[a,n,t,i].join("-");if(this._lastBufPos&&this._lastBufPos===c)return this._lastBufInf;for(var l=a;l<=t;l++){var h=e[l];if(h){var _=h.segments,f=l===a?n:0,p=l===t?i:_.length-1;l===a&&(o=_[n].startTime);for(var g=f;g<=p;g++){var m=_[g],v=this._bufferPool.read(m.poolId);if(v)r+=v.byteLength,s+=m.duration;else if(!(l===t&&g===p))throw new Error("A discontinuous buffer was detected. ".concat(m.poolId))}}}d.start=o,d.byteLength=r,d.timeLength=s,this._lastBufPos=c,this._lastBufInf=d}return d}},{key:"_readP2P",value:function(){var e=null,t=this._p2pProxy.read();if(t&&t.type){var i=t.bid,a=t.loadDone,n=t.type.toLowerCase(),r=t.stream;if("ts"===n&&(a&&(this.state=ve.END),r)){var s=r.index,o=r.data,d=r.chunkEOF,u=r.spos,c=this._segments,l=c[s],h=i||l.bid;this._eof=s>c.length-1||s===c.length-1&&d||!l.enabled&&!this._getNextAvailableSegByFlatten(s),this._eof&&L.a.log("".concat(this.LOG_TAG,": EOF")),o&&(L.a.log("".concat(this.LOG_TAG,": Read seg flatten idx ").concat(s," ->[0,").concat(c.length-1,"], status/startTime/duration(").concat(this.getStateKey(l.status),"/").concat(l.startTime.toFixed(3),"/").concat(l.duration.toFixed(3),"), bid = ").concat(l.bid,", length = ").concat(o.byteLength,", total = ").concat(l.endByte-l.startByte,", fragIdx = ").concat(l.fragIdx," - ").concat(l.idx)),e={type:O.a.HLS,data:o,done:d,meta:{uid:"".concat(h,"-").concat(l.fragIdx,"-").concat(l.idx),level:h,fragIdx:l.fragIdx,segIdx:l.idx,fragKey:l.fragKey,byteOffset:u}})}}return e}},{key:"_readCDN",value:function(){if(this.eof)return null;var e=this._findPieceByPos(this._readPos),t=e.fragment,i=e.segment;if(!i)return null;if(!i.enabled)return this._moveToNextReadPosOrEOF(),null;if(i.status!==Be&&i.status!==Ne)return this._tryToSyncReadAndDownPos(),null;var a=this._fragments.length,n=this._readPos.f,r=this._readPos.s,s=this._readPos.b,o=i.startByte+s,d=this._bufferPool.read(i.poolId),u=null,c=!1,l=i.bid;return s>=d.byteLength?u=null:(L.a.log("".concat(this.LOG_TAG,": Read seg ").concat(i.poolId,",  flatten idx ").concat(i.flattenIdx,"->[0,").concat(this._segments.length-1,"] & inner seg idx ").concat(r,"->[0,").concat(t.segments.length-1,"] of frag ").concat(n,"->[0,").concat(a-1,"], status ").concat(this.getStateKey(i.status),", bid=").concat(l,", duration=").concat(i.duration,",bytes=").concat(i.endByte-i.startByte)),u=d.subarray(s,d.byteLength)),i.status===Be?this._readPos.b=d.byteLength:i.status===Ne&&(c=!0,this._moveToNextReadPosOrEOF()),{type:O.a.HLS,data:u,done:c,meta:{uid:"".concat(l,"-").concat(n,"-").concat(r),level:l,fragIdx:n,segIdx:r,fragKey:i.fragKey,byteOffset:o}}}},{key:"_abort",value:function(){this._hlsRemote.abort()}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=this._findPieceByPTS(e,this._fragments),i=null;return t&&(i=this._findPieceByPTS(e,t.segments)),{fragment:t,segment:i}}},{key:"findPrevSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=null,i=this.findSegmentByPTS(e),a=i.segment;return a&&a.flattenIdx>0&&(t=this._segments[a.flattenIdx-1]),t}},{key:"_findPieceByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined,i=arguments.length>2?arguments[2]:undefined;return i&&!this._pieceWithinToleranceTest(e,i)?i:$(t,this._pieceWithinToleranceTest.bind(this,e))}},{key:"_findPieceByPos",value:function(e){var t=this._fragments[e.f],i=null;return t&&(i=t.segments[e.s]),{fragment:t,segment:i}}},{key:"_pieceWithinToleranceTest",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined;return e<0&&(e=0),t.startTime+t.duration<=e?1:t.startTime>e&&t.startTime?-1:0}},{key:"_checkLoad",value:function(e){var t=this._findPieceByPos(this._downPos),i=t.fragment,a=t.segment;if(!i||!a)return L.a.error("".concat(this.LOG_TAG,": load frag/segment(").concat(i,"/").concat(a,"), down pos(").concat(JSON.stringify(this._downPos),")"));var n=new At({frag:i,fragIdx:this._downPos.f,range:[this._downPos.s,this._downPos.s],bufferInfo:e});this._loadSingleSegment(n)}},{key:"_isCurrentDownSeg",value:function(e){return!!e&&e.idx===this._downPos.s&&e.fragIdx===this._downPos.f}},{key:"_loadContiguousSegments",value:function(e){}},{key:"_loadSingleSegment",value:function(e){var t=this,i=arguments.length>1&&arguments[1]!==undefined&&arguments[1],a=e.pieces,n=e.fragIdx,r=e.buffer,s=this,o=a[0],d=this._fragments[n],u=this._fragments.length;if(!i){if(o.status===Be)return;if(o.status===Ne)return}s.state=ve.LOADING;var c=function(e,t){},l=function(e){var t=e.bytes,i="seg ".concat(o.idx,"->[0,").concat(d.segments.length-1,"]"),a="frag ".concat(n,"->[0,").concat(u-1,"]");s._bufferPool.del(o.poolId),s._bufferPool.add(o.poolId,t),o.status=Ne,L.a.log("".concat(s.LOG_TAG,": Loaded ").concat(o.poolId,", buffer(").concat(r.timeLength.toFixed(3),"s), ").concat(i," of ").concat(a,"}")),s._isCurrentDownSeg(o)&&s._moveToNextDownPosOrEOD(),s.state!==ve.ERROR&&(s.state=ve.IDLE),s.emit(ie.DATA_ARRIVED)},h=function(i){var a=t.getUnreadBufInfo().timeLength>0;"auth-error"==i.category?t._doFinalError(i,e,o):a?t._withBufferRetryCount<t._withBufferMaxRetry?(t._withBufferRetryCount++,t._reloadSingleSegment(e)):t._doFinalError(i,e,o):t._noBufferRetryCount<t._noBufferMaxRetry?(t._noBufferRetryCount++,t._reloadSingleSegment(e)):t._doFinalError(i,e,o)},_=function(){var e="seg ".concat(o.idx,"->[0,").concat(d.segments.length-1,"]"),t="frag ".concat(n,"->[0,").concat(u-1,"]");L.a.log("".concat(s.LOG_TAG,": onAbort ").concat(e," of ").concat(t,", buffer ").concat(r.timeLength,"s")),o.status=Re,s._bufferPool.del(o.poolId),s.state!==ve.ERROR&&(s.state=ve.IDLE)},f=function(e){s._doDNSParser(e)};this._eventManager.removeAll(),this._eventManager.on(this._hlsRemote,wt.Events.PROGRESS,c),this._eventManager.on(this._hlsRemote,wt.Events.SUCCESS,l),this._eventManager.on(this._hlsRemote,wt.Events.FAILURE,h),this._eventManager.on(this._hlsRemote,wt.Events.ABORT,_),this._eventManager.on(this._hlsRemote,wt.Events.DNSPARSER,f),this._hlsRemote.startLoad(e)}},{key:"_reloadSingleSegment",value:function(e){this._hlsRemote.reset(),this._hlsRemote.dispatcher&&this._hlsRemote.dispatcher.destroy(),this._hlsRemote.cdnLaborer&&this._hlsRemote.cdnLaborer.destroy(),this._loadSingleSegment(e,!0)}},{key:"_doFinalError",value:function(e,t,i){var a=e.category,n=e.statusCode,r=t.fragIdx,s=this._fragments[r],o=this._fragments.length;switch(a){case"cdn-error":case"dispatcher-error":case"auth-error":if(this._isCurrentDownSeg(i)){i.status=Fe,this.state=ve.ERROR,L.a.log("".concat(this.LOG_TAG,": onError: ").concat(i.fragIdx,"-").concat(i.idx));var d="";switch(a){case"cdn-error":d=ee.a.code.DATA_HLS_CDN_ERROR;break;case"auth-error":d=ee.a.code.DATA_AUTH_Error;break;case"dispatcher-error":d=ee.a.code.DATA_HLS_DISPATCH_ERROR}this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,d,n)}else{var u="seg ".concat(i.idx,"->[0,").concat(s.segments.length-1,"]"),c="frag ".concat(r,"->[0,").concat(o-1,"]");L.a.error("".concat(this.LOG_TAG,": onError ").concat(u," of ").concat(c,", buffer ").concat(t.buffer.timeLength,"s"))}break;case"cdn-timeout":case"dispatcher-timeout":if(this._isCurrentDownSeg(i))i.status=Ue,this.state=ve.ERROR,L.a.log("".concat(this.LOG_TAG,": onTimeout: ").concat(i.fragIdx,"-").concat(i.idx)),this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,"cdn-timeout"===a?ee.a.code.DATA_HLS_DISPATCH_TIMEOUT:ee.a.code.DATA_HLS_CDN_TIMEOUT);else{var l="seg ".concat(i.idx,"->[0,").concat(s.segments.length-1,"]"),h="frag ".concat(r,"->[0,").concat(o-1,"]");L.a.error("".concat(this.LOG_TAG,": onTimeout ").concat(l," of ").concat(h,", buffer ").concat(t.buffer.timeLength,"s"))}break;default:this.state!==ve.ERROR&&(this.state=ve.IDLE)}}},{key:"_getNextAvailableSegByFlatten",value:function(e){var t=this._segments[e];return t?t.enabled?t:this._getNextAvailableSegByFlatten(e+1):null}},{key:"_moveToNextDownPosOrEOD",value:function(){var e=this._findPieceByPos(this._downPos).segment,t=this._getNextAvailableSegByFlatten(e.flattenIdx+1);t?(this._downPos.f=t.fragIdx,this._downPos.s=t.idx,this._downPos.b=0,t.status===Ne&&this._moveToNextDownPosOrEOD()):this.state=ve.END}},{key:"_moveToNextReadPosOrEOF",value:function(){var e=this._fragments[this._readPos.f].segments[this._readPos.s],t=this._getNextAvailableSegByFlatten(e.flattenIdx+1);t?(this._readPos.f=t.fragIdx,this._readPos.s=t.idx,this._readPos.b=0):(this._eof=!0,L.a.log("".concat(this.LOG_TAG,": EOF")))}},{key:"_tryToSyncReadAndDownPos",value:function(){var e=!1;(this._readPos.f>this._downPos.f||this._readPos.s>this._downPos.s)&&(e=!0),e&&(this._downPos.f=this._readPos.f,this._downPos.s=this._readPos.s,this._downPos.b=0)}},{key:"_gc",value:function(){if(!(this._readPos.f<0||this._readPos.s<0||this._downPos.f<0||this._downPos.s<0))for(var e=this._fragments[this._readPos.f].segments[this._readPos.s].flattenIdx,t=this._fragments[this._downPos.f].segments[this._downPos.s].flattenIdx,i=this._segments,a=this._bufferPool,n=a.keys,r=0;r<n.length;r++){var s=n[r],o=s.split("-"),d=parseInt(o[1],10),u=parseInt(o[2],10),c=this._fragments[d];if(c){var l=c.segments[u];if(l){var h=l.flattenIdx;if(h<e||h>t)i[h].status=Re,a.del(s)}else a.del(s)}else a.del(s)}}}]),t}(Te),Ot=function(e){function t(e){var i;n()(this,t),i=d()(this,c()(t).call(this));var a=h()(i);return a.ctx=e,a._bid="",a.metadata=new Ae,a.protocol=window.location.protocol,a._accurateTimestamp=!1,a.reset(),i}return f()(t,e),s()(t,[{key:"totalDuration",get:function(){var e=this.fragments,t=0;if(e.length>0){var i=e[e.length-1];if(i.segments.length>0){var a=i.segments[i.segments.length-1];t=a.startTime+a.duration}}return t}},{key:"segments",get:function(){for(var e,t=this.fragments,i=[],a=0;a<t.length;a++){e=t[a];for(var n=0;n<e.segments.length;n++)i.push(e.segments[n])}return i}},{key:"isAccurateTimeStamp",get:function(){return this._accurateTimestamp}}]),s()(t,[{key:"push",value:function(e){this._premanifest=+new Date,this._bid=e.bid,this.metadata.hasAudio=!0,this.metadata.hasVideo=!0,this._parseFunc(e.data)}},{key:"_parseFunc",value:function(e){if(e&&""!=e){this.fragments=[];var t=this._parseData(e),i=t.durations,a=t.urls,n=t.sds,r=t.starts,s=t.ends,o=t.parts,d=a.length;if(this._accurateTimestamp=n&&n.length>0,d>0){var u,c,l,h,_,f,p=0,g=0,m=0;n.length>0&&(n[0]=0);for(var v=0;v<d;v++){var b=v===d-1,y=this.protocol+a[v],k=i[v],T=r[v],S=s[v],P=o[v],x=void 0;b&&0===k&&(k=.04),l&&l===P||(l&&(x=u),(u=new rt(O.a.HLS)).idx=p,g=0,this.fragments.push(u),p+=1),(c=new De(O.a.HLS)).uri=new fe.a(y),c.idx=g,c.startByte=T,c.endByte=S,c.poolId=this.uuid+"-"+u.idx+"-"+g,c.bid=this._bid,c.duration=k,g+=1,this._accurateTimestamp?(m=n[v]/1e3,f>-1&&m<f&&(L.a.log("manifest correct sd , ".concat(m," -> ").concat(f+_.duration)),m=f+_.duration),c.startTime=m,_&&(_.duration=m-_.startTime),_=c,f=m):(c.startTime=m,m+=k),u.segments.push(c),x&&this._resetFragInfo(x,h),b&&this._resetFragInfo(u,y),l=P,h=y}}}}},{key:"_parseData",value:function(e){for(var t,i=[],a=[],n=[],r=[],s=[],o=[],d=/(#EXTINF:\d+)|(\/\/\S*)/g,u=/(start=\d+)|(end=\d+)/g,c=/(&sd=\d+)|(\/\/\S*\?)/g;null!==(t=d.exec(e));)t[0].indexOf("#EXTINF")>-1?i.push(parseInt(t[0].replace("#EXTINF:",""),10)):a.push(t[0]);for(;null!==(t=u.exec(e));)t[0].indexOf("start=")>-1?r.push(parseInt(t[0].replace("start=",""),10)):s.push(parseInt(t[0].replace("end=",""),10));for(;null!==(t=c.exec(e));)t[0].indexOf("&sd=")>-1?n.push(parseInt(t[0].replace("&sd=",""),10)):o.push(t[0]);return{durations:i,urls:a,sds:n,starts:r,ends:s,parts:o}}},{key:"_resetFragInfo",value:function(e,t){var i=e.segments[0],a=e.segments[e.segments.length-1];e.startTime=i.startTime,e.duration=a.startTime+a.duration-e.startTime,e.bid=this._bid;var n=i.startByte,r=a.endByte;t=(t=(t=t.replace(/start=\d+&/g,"start="+n+"&")).replace(/contentlength=\d+&/g,"contentlength="+(r-n)+"&")).replace(/sd=\d+&/g,"sd="+1e3*i.startTime+"&"),e.uri=new fe.a(t)}},{key:"end",value:function(){this._endmanifest=+new Date,L.a.log("hlsmanifest parse m3u8,"+(this._endmanifest-this._premanifest))}},{key:"reset",value:function(){this.metadata=new Ae,this._accurateTimestamp=!1,this.fragments=[],this.uuid=se.a.create()}},{key:"copyData",value:function(e){this.uuid=e.uuid,this._accurateTimestamp=e.isAccurateTimeStamp,this.metadata.hasAudio=e.metadata.hasAudio,this.metadata.hasVideo=e.metadata.hasVideo,this.fragments=[];var t=e.fragments;L.a.log("manifest copyData , segments.length = ".concat(t.length,", ").concat(e.segments.length));for(var i=0;i<t.length;i++){t[i].status=0;for(var a=0;a<t[i].segments.length;a++)t[i].segments[a].status=0;this.fragments.push(t[i])}}}]),t}(H.a),Lt=function(e){function t(e){var i;n()(this,t);var a=new Ot,r=new qt(e),s=new J("m2ts","mp4",{debug:E.a.DEBUG,enableWorker:e.config.enableWorker});return(i=d()(this,c()(t).call(this,e,{manifest:a,loader:r,multiplexer:s}))).TAG="HLSActor",i._fragments=[],i._segments=[],i._rangeTSTolerance=e.config.hlsRangeTSTolerance,i._maxSegmentSearchTolerance=e.config.hlsMaxSegmentSearchTolerance,i._sendISWhileFragmentChange=!0,i}return f()(t,e),s()(t,[{key:"duration",get:function(){var e=0,t=this._fragments;if(t.length>0){var i=t[t.length-1];e=i.startTime+i.duration}return e}}]),s()(t,[{key:"_destroy",value:function(){this._fragments.splice(0,this._fragments.length),this._segments.splice(0,this._segments.length)}},{key:"applyRange",value:function(e){var t=this._manifest.isAccurateTimeStamp;this._maxSegmentSearchTolerance=t?0:this._ctx.config.hlsMaxSegmentSearchTolerance,this._rangeTSTolerance=t?0:this._ctx.config.hlsRangeTSTolerance;var i=this._constructPlaySegmentsByRangeList(this._manifest.fragments,e);this._fragments=i.fragments,this._segments=i.segments,this._manifestDuration=this.duration,this._loader.fragsWithSegs={frags:this._fragments,segs:this._segments,isAccurateTimeStamp:t}}},{key:"_constructPlaySegmentsByRangeList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],t=arguments.length>1?arguments[1]:undefined,i=[],a=this._rangeTSTolerance,n=t.start(0)-a,r=t.end(t.length-1)+a;return L.a.log("".concat(this.LOG_TAG," qvs reset timerange = ").concat(n,"-").concat(r)),e.forEach((function(e,t){var a=e.segments;a.length>0&&a.map((function(a,s,o){var d=a.startTime,u=a.startTime+a.duration;return a.enabled=(d>=n||u>n)&&(u<=r||d<r),a.fragIdx=t,a.fragKey=e.key,a.flattenIdx=i.length,i.push(a),a}))})),{fragments:e,segments:i}}},{key:"_reset",value:function(){this._fragments.splice(0,this._fragments.length),this._segments.splice(0,this._segments.length),this._loader.reset()}},{key:"_getSegmentByPTS",value:function(e){return this._loader.findSegmentByPTS(e).segment}},{key:"_getPrevSegmentByPTS",value:function(e){return this._loader.findPrevSegmentByPTS(e)}},{key:"onMuxData",value:function(e,t){switch(t.fragmentType){case"initSegment":var i=t.contentType,a=t.container,n=t.codec,r=t.trackId,s=t.data;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(i," initSegment, ").concat(a,"_").concat(n)),"video"===i||"audio"===i){var o=new X.a(i);o.origin=O.a.HLS,o.bytesArray=s,o.trackId=r,o.container=a,o.codec=n,"video"===i?e.videoInitSegment=o:"audio"===i&&(e.audioInitSegment=o)}break;case"fragment":var d=t.contentType,u=t.data,c=t.duration,l=t.startDTS,h=t.startPTS,_=t.nextSegmentPTS;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(d,", startDTS/startPTS/end/duration(").concat(l.toFixed(3),"/").concat(h.toFixed(3),"/").concat((h+c).toFixed(3),"/").concat(c.toFixed(3),")")),c<0)return void L.a.warn("".concat(e.LOG_TAG," ignore parsed, due the duration ").concat(c));if("video"===d){var f=new Z.a("video");if(f.origin=O.a.HLS,f.bytesArray=u,f.startTime=l,f.duration=c,e._currentDataMeta){var p=e._currentDataMeta.fragIdx,g=e._currentDataMeta.segIdx,m=e._fragments[p];if(m){var v=m.segments[g];v.knownPTS||e._updateSegStartTime(v,l)}}e._videoMediaStartTimes.push(f.startTime),e._videoMediaSegments.push(f)}else if("audio"===d){var b=new Z.a("audio");b.origin=O.a.HLS,b.bytesArray=u,b.startTime=h,b.duration=c,e._audioSegmentAlignPTS=_,e._audioMediaSegments.push(b)}}e._ctx.emit(ae.a.DATA_BMFF_ARRIVED)}},{key:"onMuxErr",value:function(e,t){t.code===J.ErrCode.TS_SYNC_BYTE&&e._loader.noticeCheckData(t.data)}},{key:"onMuxDone",value:function(e){e._videoMediaStartTimes.length>0&&(e._onVideoSegmentParsed(e._videoMediaStartTimes[0]),e._videoMediaStartTimes=[])}},{key:"_onVideoSegmentParsed",value:function(e){if(!this._seeked)if(e<=this._seekPTS)this._seeked=!0;else if(this._seekPTS>0){var t=this._getPrevSegmentByPTS(e);if(t){var i=t.startTime+this._maxSegmentSearchTolerance,a=t.enabled;a||(t.enabled=!0),L.a.error("".concat(this.LOG_TAG," seekPTS ").concat(this._seekPTS," should correct to ").concat(i)+(a?"":", & enabled prev seg"))}else L.a.warn("".concat(this.LOG_TAG," can't correct seek time by seek pts ").concat(this._seekPTS))}}},{key:"_updateSegStartTime",value:function(e,t){var i,a=this._manifest.isAccurateTimeStamp,n=this._manifestDuration,r=this._segments,s=e.flattenIdx;if(e.knownPTS=!0,!a){for(e.startTime=t,i=s;i>0;i--){if(this._updateSegPTS(r,i,i-1).knownPTS)break}for(i=s;i<r.length-1;i++){if(this._updateSegPTS(r,i,i+1).knownPTS)break}}var o=r[r.length-1];o&&n>o.startTime&&(o.duration=n-o.startTime),a||this._updateFragPTS(this._fragments)}},{key:"_updateSegPTS",value:function(e,t,i){var a=0===i,n=e[t],r=e[i];if(r.knownPTS){var s="".concat(this.LOG_TAG," adjust segment pts encounter negative duration computed for seg");i>t?(!n.knownPTS&&r.startTime<=n.startTime&&r.startTime>0&&(n.startTime=r.startTime-.001),n.duration=r.startTime-n.startTime,n.duration<0&&L.a.warn("".concat(s," ").concat(n.fragIdx,"/").concat(n.idx,"!"))):(!n.knownPTS&&n.startTime<=r.startTime&&(n.startTime=r.startTime+.001),r.duration=n.startTime-r.startTime,r.duration<0&&L.a.warn("".concat(s," ").concat(n.fragIdx,"/").concat(n.idx,"!")))}else if(i>t){var o=n.startTime+n.duration;r.startTime=o}else r.startTime=a?0:Math.max(n.startTime-r.duration,0);return r}},{key:"_updateFragPTS",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],a=e[t+1],n=i.segments;i.startTime=n[0].startTime,i.duration=a?a.segments[0].startTime-i.startTime:n[n.length-1].startTime+n[n.length-1].duration-i.startTime}}},{key:"_needSendIS",value:function(e){e&&(this.videoInitSegment=this.audioInitSegment=null)}}]),t}(Oe),Ct="flv_freeDispatch",Mt="flv_memberDispatch",Rt="flv_IPDispatch",Bt="Success",Nt="Fail",Ft="flv_dispatch_success",Ut="flv_dispatch_fail",Vt="flv_auth_fail",Ht="dns_parser_request",Wt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).name=Ct,i._netProxy=new ce.a,i._request=null,i._data=null,i._fragment=e,i}return f()(t,e),s()(t,[{key:"request",value:function(e){var t=this,i=t._fragment.uri.toString();t._data=null;var a=F.UUID.getFluid();i+=-1==i.indexOf("?")?"?":"&",i+="tn="+Math.random(),-1==(i+="&su="+a).indexOf("&pv=")&&(i+="&pv=0.1"),-1==i.indexOf("&qyid=")&&(i+="&qyid="+a),e.retryCount>0&&(i+="&retry="+e.retryCount),i+="&client="+e.currentUserIP,i+="&z="+e.preDispatchArea,i+="&mi="+e.mi,i+="&bt="+e.preDefinition,i+="&ct="+e.currentDefinition,e.preAverageSpeed>0&&(i+="&s="+e.preAverageSpeed),i+="&e="+e.preErrorCode;var n=_e.a.DISPATCH;L.a.log("Dispatch(normal) url: ".concat(i));var r={timeout:3e3,maxRetry:1,result:!1},s=t._netProxy.makeRequestContext([i],r);s.method="GET",s.responseType="json",s.callbacks={onSuccess:function(i){if(t._data=i.data,L.a.log("Dispatch(normal) take ".concat(i.netCost,"ms, ").concat(JSON.stringify(t._data))),e.preDispatchArea=t._data.z,""==e.currentUserIP&&t._data.t){var a=String(t._data.t).split("-");e.currentUserArea=a[0],e.currentUserIP=a[1]}t.emit(Ft)},onError:function(a){L.a.error("Dispatch(normal) error: ".concat(JSON.stringify(a))),e.preErrorURL=i,a.url=i,t.emit(Ut,a)},onTimeout:function(a,n){L.a.error("Dispatch(normal) timeout: ".concat(i)),e.preErrorURL=i,t.emit(Ut,{stats:a,context:n,url:i})},onAbort:function(){},onComplete:function(){}},t._request=t._netProxy.request(n,s)}},{key:"getData",value:function(){return this._data}},{key:"destroy",value:function(){this._netProxy=null,this._request=null,this._data=null,this._fragment=null}}]),t}(ne.a),jt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).name=Mt,i._netProxy=new ce.a,i._request=null,i._data=null,i._fragment=e,i}return f()(t,e),s()(t,[{key:"request",value:function(e){var t=this,i=t._fragment.uri.toString();t._data=null;var a=F.UUID,n=F.cmd5x,r=a.getFluid();i+=-1==i.indexOf("?")?"?":"&",-1==(i+="t="+e.key).indexOf("&cid=")&&(i+="&cid="+e.communicationlId),-1==i.indexOf("&vid=")&&(i+="&vid="+e.vid),-1==i.indexOf("&QY00001=")&&(i+="&QY00001="+e.QY00001),e.retryCount>0&&(i+="&retry="+e.retryCount),i+="&su="+r,i+="&client="+e.currentUserIP,i+="&z="+e.preDispatchArea,i+="&mi="+e.mi,i+="&bt="+e.preDefinition,i+="&ct="+e.currentDefinition,e.preAverageSpeed>0&&(i+="&s="+e.preAverageSpeed),-1==(i+="&e="+e.preErrorCode).indexOf("&qyid=")&&(i+="&qyid="+r),-1==i.indexOf("&ib=")&&(i+="&ib=4"),-1==i.indexOf("&ptime=")&&(i+="&ptime="+(e.auth_ptime==Infinity?0:e.auth_ptime)),-1==i.indexOf("&pv=")&&(i+="&pv=0.1"),i+="&tn="+Math.random();var s=e.key+t._fragment.rid;i+="&ibt="+n(s,s),L.a.log("Dispatch(member) url: ".concat(i));var o=_e.a.DISPATCH,d=t._netProxy.makeRequestContext([i],{timeout:3e3,maxRetry:1});d.method="GET",d.responseType="json",d.callbacks={onSuccess:function(i){t._data=i.data,L.a.log("Dispatch(member) take ".concat(i.netCost,"ms, ").concat(JSON.stringify(t._data))),e.preDispatchArea=t._data.z,""==e.currentUserIP&&t._data.t&&(e.currentUserIP=String(t._data.t).split("-")[1]),t.emit(Ft)},onError:function(a){L.a.error("Dispatch(member) error: ".concat(JSON.stringify(a))),e.preErrorURL=i,a.url=i,t.emit(Ut,a)},onTimeout:function(a,n){L.a.error("Dispatch(member) timeout: ".concat(i)),e.preErrorURL=i,t.emit(Ut,{stats:a,context:n,url:i})},onAbort:function(){},onComplete:function(){}},t._request=t._netProxy.request(o,d)}},{key:"getData",value:function(){return this._data}},{key:"destroy",value:function(){this._netProxy=null,this._request=null,this._data=null,this._fragment=null}}]),t}(ne.a),Gt=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).name=Rt,a._netProxy=new ce.a,a._request=null,a._data=null,a._fragment=e,a._loaderConfig=i,a}return f()(t,e),s()(t,[{key:"request",value:function(e,t){var i=this;i._data=null;var a=i._prepareURLParam(e,t);a||i.emit(Ut);var n=_e.a.DISPATCH,r={timeout:3e3,maxRetry:this._loaderConfig.ipMaxRetry};i._netProxy||(i._netProxy=new ce.a);var s=i._netProxy.makeRequestContext([a],r);s.method="GET",s.responseType="json",s.callbacks={onSuccess:function(t){if(i._data=t.data,e.preDispatchArea=i._data.z,""==e.currentUserIP&&i._data.t){var a=String(i._data.t).split("-");e.currentUserArea=a[0],e.currentUserIP=a[1]}i.emit(Ft)},onError:function(e){e.url=a,i.emit(Ut,e)},onTimeout:function(e,t){i.emit(Ut,{stats:e,context:t,url:a})},onAbort:function(){},onComplete:function(){}},i._request=i._netProxy.request(n,s)}},{key:"startIPRequest",value:function(e){var t=this,i=he.dispatchAccessURL,a=he.dispatchIPFail,n=_e.a.DISPATCH,r=t._netProxy.makeRequestContext([i],{timeout:3e3,maxRetry:this._loaderConfig.ipMaxRetry});r.method="GET",r.responseType="text",r.callbacks={onSuccess:function(i){if(i&&i.data)if("string"==typeof i.data){var n=i.data.split(";")[0],r=he.dispatchIPSuccess.replace("{{IP}}",n);t.request(e,r)}else t.request(e,a);else t.request(e,a)},onError:function(i){t.request(e,a)},onTimeout:function(i,n){t.request(e,a)},onAbort:function(){},onComplete:function(){}},t._netProxy.request(n,r)}},{key:"_prepareURLParam",value:function(e,t){if(!this._fragment)return null;var i=this._fragment.uri.domain,a=this._fragment.uri.path,n=(this._fragment.uri.query.toString(),"/3e8/"+F.md5(i)+Ie.toBase64(a)),r=new fe.a(e.preErrorURL);return r.setDomain(t),r.setPath(n),Object(U.d)(r.toString())?r.toString()+"&ssl=1":r.toString()}},{key:"getData",value:function(){return this._data}},{key:"destroy",value:function(){this._netProxy=null,this._request=null,this._data=null,this._fragment=null}}]),t}(ne.a),zt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._disResultDic=null,i._fragment=null,i._ro=null,i._stateCode="",i._fileData=null,i._paramsData={},i._loaderConfig=e,i}return f()(t,e),s()(t,[{key:"reset",value:function(){this.stopDispatcher(),this._disResultDic=null,this._fragment=null,this._ro=null,this._stateCode="",this._fileData=null,this._paramsData={},this._loadPos=null}},{key:"stopDispatcher",value:function(){this._destroyRemote(),this._fragment=null,this._stateCode="",this._fileData=null}},{key:"getDisResult",value:function(e){return this._disResultDic&&this._disResultDic[e]?this._disResultDic[e]:null}},{key:"setDisResultLose",value:function(e,t){this._disResultDic&&this._disResultDic[e]&&delete this._disResultDic[e],this._fragment&&t==this._fragment&&(this._fragment=null)}},{key:"dispatcher",value:function(e,t,i){this._fragment!=e&&(this._paramsData=t,this._paramsData.rid=e.rid,this._loadPos=i,this.stopDispatcher(),this._fragment=e,t.movieIsMember?(this._ro=new jt(e),this._stateCode=Mt):(this._ro=new Wt(this._fragment),this._stateCode=Ct),this._ro.on(Ft,this._onDispatchSuccess.bind(this)),this._ro.on(Ut,this._onDispatchFail.bind(this)),this._ro.request(this._paramsData))}},{key:"_destroyRemote",value:function(){this._ro&&(this._ro.removeAllListeners(Ft),this._ro.removeAllListeners(Ut),this._ro.destroy(),this._ro=null)}},{key:"_onDispatchSuccess",value:function(){if(null!=this._ro){this._stateCode+="_"+Bt,this._fileData=this._ro.getData();var e=this._fragment.uri.path;e&&(this._disResultDic||(this._disResultDic={}),this._disResultDic[e]=this._fileData),this._destroyRemote(),this._sendResult(Ft)}}},{key:"_onDispatchFail",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};null!=this._ro&&(this._stateCode+="_"+Nt,this._fileData=this._ro.getData(),L.a.error("dispatch error: ".concat(this._stateCode,", ").concat(JSON.stringify(e))),405===e.status&&e.response&&e.response.code&&e.response.code.indexOf("D20")>=0?(this._destroyRemote(),this._sendResult(Vt)):!this._loaderConfig.allowIPDispatch||this._ro.name!=Mt&&this._ro.name!=Ct?(this._destroyRemote(),this._sendResult(Ut)):(this.emit(Ht,e.url),this._IPDispatch()))}},{key:"_IPDispatch",value:function(){this._destroyRemote(),this._ro=new Gt(this._fragment,this._loaderConfig),this._stateCode=Rt,this._ro.on(Ft,this._onDispatchSuccess.bind(this)),this._ro.on(Ut,this._onDispatchFail.bind(this)),this._ro.startIPRequest(this._paramsData)}},{key:"_sendResult",value:function(e){this.emit(e,{state:this._stateCode,data:this._fileData,f:this._loadPos.f,s:this._loadPos.s})}}]),t}(ne.a),Kt=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this)))._netProxy=e,a._dispatcherProxy=new zt(i),a._retryMax=3,a._timeout=1e4,a._dispatcherParam=null,a._laborer=null,a._dnsInfo={userinfo:"",idc:""},a._loaderConfig=i,a}return f()(t,e),s()(t,[{key:"dispatcherParam",set:function(e){this._dispatcherParam=e}}]),s()(t,[{key:"loadData",value:function(e,t,i){var a=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3],n=arguments.length>4&&arguments[4]!==undefined?arguments[4]:2,r=arguments.length>5&&arguments[5]!==undefined?arguments[5]:1e4;this._dispatcherParam.retryCount=0,this._retryMax=n,this._timeout=r,this._loadData(e,t,i,a)}},{key:"_loadData",value:function(e,t,i){var a=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3],n=this,r=e.uri.toString(),s=e.uri.path,o={};if(a?o=n._dispatcherProxy.getDisResult(s):o.l=e.uri.toString(),o){L.a.log("flv-remote load, ".concat(e.idx,", ").concat(t,"-").concat(i,", retry = ").concat(this._dispatcherParam.retryCount,", max = ").concat(this._retryMax));var d="";d=e.isHeaderLoaded?"range="+e.getRange(t,i):"range="+e.getRange(0),r=o.l+(-1==o.l.indexOf("?")?"?":"&")+d;var u=_e.a.SEGMENT,c=n._netProxy.makeRequestContext([r],Object(V.a)({timeout:n._timeout},n._netProxy.defaultRetryParameters));c.method="GET",c.callbacks={onProgress:function(){},onSuccess:function(a){n._dispatcherParam.retryCount=0,n._sendResult(Bt,a,e.idx,t,i)},onError:function(s){L.a.log("Load fail, http-status(".concat(s.status,"), ").concat(r)),n._doDNS(r),n._dataRetry(e,t,i,Fe,a)},onTimeout:function(){L.a.log("Load timeout, ".concat(r)),n._doDNS(r),n._dataRetry(e,t,i,Ue,a)},onAbort:function(){L.a.log("Load abort, ".concat(r))},onComplete:function(){}},n._laborer=n._netProxy.request(u,c)}else n._dispatcherProxy.removeAllListeners(),n._dispatcherProxy.on(Ut,(function(){n._dataRetry(e,t,i,Ut,!0)})),n._dispatcherProxy.on(Vt,(function(){n._sendResult(Nt,Vt,e.idx,t,i)})),n._dispatcherProxy.on(Ft,(function(r){n._dnsInfo={userinfo:r.data.t,idc:r.data.z},n._loadData(e,t,i,a)})),this._dispatcherProxy.on(Ht,(function(e){n._doDNS(e)})),L.a.log("flv-remote dispatch, ".concat(e.idx,", ").concat(t,"-").concat(i," , retry = ").concat(this._dispatcherParam.retryCount,", max = ").concat(this._retryMax)),n._dispatcherProxy.dispatcher(e,n._dispatcherParam,{f:e.idx,s:t})}},{key:"_dataRetry",value:function(e,t,i,a,n){this._dispatcherParam.retryCount>=this._retryMax?this._sendResult(Nt,a,e.idx,t,i):(L.a.log("remote , data loading failure, retry"),this._dispatcherParam.retryCount++,this._dispatcherProxy.setDisResultLose(e.uri.path,e),this._loadData(e,t,i,n))}},{key:"_sendResult",value:function(e,t,i,a,n){this.emit(e,{data:t,f:i,s:a,e:n})}},{key:"reloadData",value:function(e,t,i){var a=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3];this.destroy(),this.loadData(e,t,i,a)}},{key:"destroy",value:function(){this._dispatcherProxy.stopDispatcher(),this._dispatcherProxy.removeAllListeners(),this._laborer&&this._laborer.abort(),this._laborer=null}},{key:"_doDNS",value:function(e){this.emit(Ht,{userinfo:this._dnsInfo.userinfo,idc:this._dnsInfo.idc,url:e})}}]),t}(ne.a),Yt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e,!1))).TAG="FLVLoader",i._fragments=[],i._uuid=null,i._readPos={f:-1,s:-1,h:!1},i._loadPos={f:-1,s:-1,e:-1},i._seekTime=0,i._dispatcherParam=null,i._flvRemote=new Kt(e.netProxy,i.loaderConfig),i._preReadFidx=-1,i._preLoadFidx=-1,i._preErrorData=null,i._lastError=!1,i}return f()(t,e),s()(t,[{key:"fragments",set:function(e){this._eof=!1,this._eod=!1,this._uuid=se.a.create(),this._fragments=e,this._preErrorData=null}},{key:"dispatcherParam",set:function(e){this._dispatcherParam=e,this._flvRemote._dispatcherParam=e}},{key:"duration",get:function(){var e=0;this._fragments.length>0&&(e=this._fragments[this._fragments.length-1].endTime);return e}}]),s()(t,[{key:"read",value:function(){var e=null;if(this._silenced||this._readPos.f<0||0==this._fragments.length)return null;if(this._readPos.f>=this._fragments.length&&(this._eof=!0),this.eof)return L.a.log("".concat(this.LOG_TAG,": read data eof")),null;var t=this._fragments[this._readPos.f],i=this._readPos.s>-1&&t&&t._segments.length>0?t._segments[this._readPos.s]:null;if(this._bufferTime<5&&(t.status==Fe||t.status==Ue)){if(L.a.log("".concat(this.LOG_TAG,", read data error, readpos = ").concat(this._readPos.f," -- ").concat(this._readPos.s)),this.loaderConfig.skipErrorFrag){var a=this._readPos.f+1;return a<this._fragments.length?(this.emit("fidxError",{gas:t.gas,end:!1}),this._readPos.f=a,this._readPos.s=0):this._lastError||(this._lastError=!0,this._eof=!0,this.state=ve.END,this.emit("fidxError",{gas:t.gas,end:!0})),null}return this._error||(this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.DATA_FLV_ERROR),L.a.log("".concat(this.LOG_TAG," , read data error, create _error"))),null}return i&&i.status===Ne&&(i.idx>=2&&(L.a.log("".concat(this.LOG_TAG," , read data return tagdata,readpos = ").concat(this._readPos.f," -- ").concat(this._readPos.s,", startTime = ").concat(i.startTime,", endtime = ").concat(i.startTime+i.duration,", rfoffset = ").concat(t.offset,", bid = ").concat(i.bid,", ad = ").concat(t.isAd)),e={type:O.a.FLV,data:this._bufferPool.read(i.poolId),done:!0,meta:{uid:"".concat(i.bid,"-").concat(i.fragIdx,"-").concat(i.idx),fragIdx:t.idx,segIdx:i.idx,vac:t.vaconfig,fragKey:i.fragKey}},this._preReadFidx!=t.idx&&this.emit("readFidxChanged",t.idx),this.openOffset&&(e.meta.offset=t.offset),this._preReadFidx=t.idx),t.idx==this._fragments.length-1&&this._readPos.s==t.segments.length-1?this._eof=!0:this._readPos.s==t.segments.length-1?(t=this._fragments[t.idx+1],this._readPos.h=!1,this._setReadPos(t.idx,0)):this._setReadPos(this._readPos.f,this._readPos.s+1)),this._loadFragment(),e}},{key:"initSegs",value:function(e){if(0!=e.keyframePositions.length&&0!=e.keyframeTimes.length){var t=this._fragments[e.f];t.vaconfig={ac:e.ac,vc:e.vc,naluSizeLength:e.naluSizeLength};var i=e.keyframePositions.join(","),a=e.keyframeTimes.join(",");if(L.a.log("".concat(this.LOG_TAG,",initSegs keyframePositions = ").concat(i,",keyframeTimes = ").concat(a)),t.segments.length>0)L.a.log("".concat(this.LOG_TAG,",initSegs has created segments , return"));else{t.isAd&&(t.totalBytes=e.filesize,t.duration=e.duration);for(var n=e.keyframePositions,r=e.keyframeTimes,s=0,o=0,d=0,u=0,c=t.startTime,l=t.endTime,h=t.totalBytes,_=0;_<=n.length;_++){0==_?(d=0,u=n[_]-1,s=c,o=0==r[_]?c:r[_]):_<n.length?(d=n[_-1],u=n[_]-1,s=0==r[_-1]?c:r[_-1],o=0==r[_]?c:r[_]):(d=n[_-1],u=h-1,s=r[_-1],o=l);var f=new De(O.a.FLV);f.idx=_,f.startTime=s,f.duration=o-s,f.startByte=d,f.endByte=u,f.poolId="flv-"+this._uuid+"-"+t.idx+"-"+f.idx,f.fragIdx=t.idx,f.fragKey=t.key,f.bid=t.bid,t.segments.push(f)}t.idx==this._readPos.f&&-1==this._readPos.s&&t.startTime<=this._seekTime&&t.endTime>this._seekTime&&t.segments.length&&(this._resetReadPosByTime(this._seekTime),this._findNextLoad(this._readPos.f,this._readPos.s)),e=null,this._loadFragment()}}}},{key:"_seek",value:function(e){this._seekTime=e,this._seekTime>this.duration?this._eof=!0:(!this._preErrorData||this._preErrorData.status!=Fe&&this._preErrorData.status!=Ue||(this._preErrorData.status=Re),L.a.log("".concat(this.LOG_TAG," , seek, time = ").concat(e)),this._resetReadPosByTime(this._seekTime),this._findNextLoad(this._readPos.f,this._readPos.s),this._loadFragment())}},{key:"_resetReadPosByTime",value:function(e){var t=this._findFindexByTime(e);if(t.f>-1){var i=this._readPos.f;t.f!==i&&(i=t.f,this._readPos.h=!1),this._setReadPos(i,t.s),L.a.log("".concat(this.LOG_TAG," , reset readpos,time = ").concat(e,", readpos = ").concat(this._readPos.f," -- ").concat(this._readPos.s))}}},{key:"_findFindexByTime",value:function(e){for(var t=-1,i=-1,a=0;a<this._fragments.length;a++)if(e>=this._fragments[a].startTime&&e<this._fragments[a].endTime){t=a,i=this._findSegIdxByTime(a,e);break}return{f:t,s:i}}},{key:"_findSegIdxByTime",value:function(e,t){var i=this._fragments[e],a=$(i.segments,(function(e){return e.startTime+e.duration<=t?1:e.startTime>t?-1:0}));return a?a.idx:-1}},{key:"_needLoadFrag",value:function(e){var t=e.f>=0&&this._fragments.length>0?this._fragments[e.f]:null,i=(e.s>=0&&t.segments&&t.segments.length)>0?t.segments[e.s].status:-1;return!(!t||t.headerStatus===Ne&&(-1===i||i===Ne))}},{key:"_decideLoadEndPos",value:function(){var e=this._loadPos.f,t=this._loadPos.s,i=t;if(t>2){var a=this._fragments[e],n=a.segments,r=n[this._loadPos.s],s=n[n.length-1];if(r){var o=this.loaderConfig.flvKeyframesFusionTime/1e3,d=r.startTime+o;d>=a.endTime&&(d=s.startTime);var u=this._findSegIdxByTime(e,d);-1!==u&&(i=u)}}return i}},{key:"_loadFragment",value:function(){var e=this;if(e._fragments&&e._fragments.length>0&&(e._needLoadFrag(e._readPos)&&(e._loadPos.f=e._readPos.f,e._loadPos.s=e._readPos.s,e._loadPos.e=e._decideLoadEndPos(),e._updateBufferTime()),e.state!==ve.LOADING&&e.state!==ve.ERROR&&e._bufferTime<this._maxBufferTimeLength&&e._needLoadFrag(e._loadPos))){var t=e._fragments[e._loadPos.f];e._preLoadFidx!==t.idx&&(e.emit("fidxLoadStart",t.gas),e._preLoadFidx=t.idx),e._flvRemote.removeAllListeners(),e._flvRemote.on(Nt,(function(t){e._dataLoadFail(t)})),e._flvRemote.on(Bt,(function(t){e._noBufferRetryCount=0,e._withBufferRetryCount=0,e._dataLoadOk(t)})),e._flvRemote.on(Ht,(function(t){e._doDNSParser(t)})),e.state=ve.LOADING,e._flvRemote.loadData(t,this._loadPos.s,this._loadPos.e,this.loaderConfig.doDispatch,this.loaderConfig.retryNum,this.loaderConfig.timeout)}}},{key:"_dataLoadFail",value:function(e){if(this._loadPos.f!==e.f||this._loadPos.s!==e.s)return this.state=ve.IDLE,void L.a.log("".concat(this.LOG_TAG," , data loading failure, not loadpos, pos = ").concat(this._loadPos.f,"-").concat(this._loadPos.s,", obj = ").concat(e.f,"-").concat(e.s));var t=this._fragments[e.f];L.a.log("".concat(this.LOG_TAG," ,data loading failure, pos = ").concat(this._loadPos.f,"-").concat(this._loadPos.s,",ad=").concat(t.isAd)),this.loaderConfig.doRetry?this._doRetryStage(e):this.loaderConfig.skipErrorFrag?(this.state=ve.IDLE,this._fragments[e.f].status=Fe,e.f+1<this._fragments.length&&(this._loadPos.f=e.f+1,this._loadPos.s=0)):this._makeErrorContext(e)}},{key:"_makeErrorContext",value:function(e){var t,i=this._fragments[e.f];switch(i.status=Fe,e.data){case Ut:t=ee.a.code.DATA_FLV_DISPATCH_ERROR;break;case Vt:t=ee.a.code.DATA_AUTH_Error;break;case Fe:t=ee.a.code.DATA_FLV_ERROR;break;case Ue:t=ee.a.code.DATA_FLV_TIMEOUT}L.a.log("".concat(this.LOG_TAG," ,data loading error ").concat(t)),this._preErrorData=i,this.state=ve.ERROR,this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,t)}},{key:"_doRetryStage",value:function(e){var t=this._fragments[this._loadPos.f],i=0===this._bufferTime?this._noBufferRetryCount:this._withBufferRetryCount,a=0===this._bufferTime?this._noBufferMaxRetry:this._withBufferMaxRetry;L.a.log("".concat(this.LOG_TAG," ,data loading failure, reload, bufferTime = ").concat(this._bufferTime,", retry = ").concat(i,", max = ").concat(a)),e.data==Vt?this._makeErrorContext(e):0===this._bufferTime?this._noBufferRetryCount>=this._noBufferMaxRetry?this._makeErrorContext(e):(this._noBufferRetryCount++,this._flvRemote.reloadData(t,this._loadPos.s,this._loadPos.e,this.loaderConfig.doDispatch)):this._withBufferRetryCount>=this._withBufferMaxRetry?this._makeErrorContext(e):(this._withBufferRetryCount++,this._flvRemote.reloadData(t,this._loadPos.s,this._loadPos.e,this.loaderConfig.doDispatch))}},{key:"_dataLoadOk",value:function(e){var t=e.f,i=e.s,a=e.e,n=e.data,r=new Uint8Array(n.data),s=n.status,o=n.url,d=n.speed,u=this._fragments[t],c=u.segments,l=c[a],h=null,_=null;if(L.a.log("".concat(this.LOG_TAG,", loaded ").concat(i,"-").concat(a," of frag ").concat(t,", http-status/bytes/take/flv-header(").concat(s,"/").concat(r.byteLength,"/").concat(n.netCost,"ms/").concat(u.isHeaderLoaded,"), ").concat(F.filesize(d),"/s ").concat(o)),u.isHeaderLoaded){for(var f=c[i].startByte,p=i;p<=a;p++){var g=u.segments[p];if(!this._bufferPool.read(g.poolId)){var m=g.startByte-f,v=g.endByte-f,b=r.subarray(m,v);this._bufferPool.add(g.poolId,b)}g.status=Ne}l.idx==u.segments.length-1?(u.status=Ne,u.idx==this._fragments.length-1?this.state=ve.END:(h=u.idx+1,_=-1)):(h=u.idx,_=l.idx+1)}else u.headerStatus=Ne,this.emit("fragmentHeader",r,{f:u.idx}),h=u.idx,_=e.s>=0?e.s:0;this._updateBufferTime(),this.state!==ve.END&&(this.state=ve.IDLE),null!==h&&null!==_&&e.f==this._loadPos.f&&e.s==this._loadPos.s&&this.state==ve.IDLE&&this._findNextLoad(h,_),this._loadFragment()}},{key:"_findNextLoad",value:function(e,t){var i=this;if(this._prePos&&e>=this._prePos.f&&(e<this._prePos.rf||e==this._prePos.rf&&t>=this._prePos.s&&t<=this._prePos.rs))return this._prePos.f=e,void(this._prePos.s=t);this._prePos={f:e,s:t},this.__findNextLoad(e,t,(function(e,t,a){if(Object(V.a)(i._prePos,{rf:e,rs:t}),i._loadPos.f=e,i._loadPos.s=t,i._loadPos.e=i._decideLoadEndPos(),a)i.state=ve.END;else{var n=i._fragments[e];n.status==Ne&&(n.status=Re),i.state==ve.END&&(i.state=ve.IDLE)}}))}},{key:"__findNextLoad",value:function(e,t,i){var a=!1,n=!1,r=this._fragments[e];r.headerStatus!==Ne?(t=-1,a=!0):r.segments.length>0&&(t=t>=0?t:0,r.segments[t].status==Ne?t==r.segments.length-1?(r.status=Ne,r.idx==this._fragments.length-1?(n=!0,a=!0):this.__findNextLoad(e+1,-1,i)):this.__findNextLoad(r.idx,t+1,i):a=!0),a&&i(e,t,n)}},{key:"_updateBufferTime",value:function(){var e=[this._loadPos.f,this._loadPos.s,this._readPos.f,this._readPos.s].join("-");if(!this._currentBuf||this._currentBuf.pos!=e){for(var t=0,i=0,a=0,n=null,r=this._readPos.f,s=this._loadPos.f,o=r;o<=s&&0!=(n=this._fragments[o].segments).length;o++){var d=o==r?this._readPos.s:0,u=o==s?this._loadPos.e:n.length-1;o==r&&(a=n[d].startTime);for(var c=!1,l=d;l<=u;l++){if(2!=n[l].status){c=!0;break}t+=n[l].duration,i+=n[l].endByte-n[l].startByte}if(c)break}this._currentBuf={pos:e,info:{start:a,byteLength:i,timeLength:t}}}}},{key:"getUnreadBufInfo",value:function(){return this._currentBuf&&this._currentBuf.info?{start:this._currentBuf.info.start,byteLength:this._currentBuf.info.byteLength,timeLength:this._currentBuf.info.timeLength}:{start:0,byteLength:0,timeLength:0}}},{key:"_cancelLoaderData",value:function(){this._flvRemote.removeAllListeners(),this._flvRemote.destroy(),this.state=ve.IDLE}},{key:"_setReadPos",value:function(e,t){this._readPos.f=e,this._readPos.s=t,this._updateBufferTime()}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=this._findFindexByTime(e),i=null,a=null;return t.f>-1&&(i=this._fragments[t.f]).segments.length>0&&(a=i.segments[t.s]),i&&a?{fragment:i,segment:a}:null}},{key:"refreshFrags",value:function(){this._eof&&(this._eof=!1,this._readPos.f+1<this._fragments.length&&(this._readPos.f=this._readPos.f+1,this._readPos.s=0)),this.state==ve.END&&(this.state=ve.NOT_LOADED),this._findNextLoad(this._readPos.f,this._readPos.s),this._loadFragment()}},{key:"getNextFrag",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;if(e+1<this._fragments.length)for(var t=null,i=e+1;i<this._fragments.length;i++)if((t=this._fragments[i]).status!==Fe&&t.status!==Ue)return t;return null}},{key:"abortCurrentADGas",value:function(e){var t=this.getNextFrag(e);return t?(this._readPos.f=t.idx,this._readPos.s=0,this._eof=!1,t.offset=0):this._eof=!0,this._preReadFidx=-1,L.a.log("".concat(this.LOG_TAG," , abortCurrentADGas done,abort= ").concat(e,",next=").concat(this._readPos.f,",eof = ").concat(this._eof,",length = ").concat(this._fragments.length)),t}},{key:"_gc",value:function(){if(!(this._readPos.f<0||this._readPos.s<0||this._loadPos.f<0||this._loadPos.s<0||this._loadPos.f<this._readPos.f))for(var e,t,i,a,n,r,s=this._bufferPool.keys,o=this._readPos.f,d=this._loadPos.f,u=0;u<s.length;u++)i=(a=s[u]).split("-"),e=parseInt(i[2],10),t=parseInt(i[3],10),e<o||e>d?this._gcSeg(a,e,t):e==o&&e==d?(n=this._readPos.s,r=this._loadPos.s,(t<n||t>r)&&this._gcSeg(a,e,t)):e==o?t<(n=this._readPos.s)&&this._gcSeg(a,e,t):e==d&&t>(r=this._loadPos.s)&&this._gcSeg(a,e,t)}},{key:"_gcSeg",value:function(e,t,i){var a=this._fragments[t],n=a.segments[i];this._bufferPool.del(e),a.status==Ne&&a.status,n.status=Re}},{key:"_reset",value:function(){this._cancelLoaderData(),this._fragments.splice(0,this._fragments.length),this._readPos.f=this._readPos.s=-1,this._loadPos.f=this._loadPos.s=this._loadPos.e=-1,this._readPos.h=!1,this._seekTime=0,this._currentBuf=null,this._dispatcherParam=null,this.state=ve.IDLE,this._preErrorData=null,this._lastError=!1}},{key:"_bufferTime",get:function(){return this._currentBuf&&this._currentBuf.info?this._currentBuf.info.timeLength:0}}]),t}(Te),Qt=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e)))._headerStatus=0,i._totalBytes=0,i._vaconfig=null,i}return f()(t,e),s()(t,[{key:"totalBytes",get:function(){return this._totalBytes},set:function(e){this._totalBytes=e}},{key:"headerStatus",get:function(){return this._headerStatus},set:function(e){this._headerStatus=e}},{key:"isHeaderLoaded",get:function(){return this._headerStatus===Ne}},{key:"rid",get:function(){if(!this._rid){var e=this.uri.path.split("/");if(e&&e.length>0)(e=e[e.length-1].split("."))&&e.length>0&&(this._rid=e[0])}return this._rid}},{key:"vaconfig",get:function(){return this._vaconfig},set:function(e){this._vaconfig=e}}]),s()(t,[{key:"getRange",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return null===t&&(t=e),this._headerStatus===Ne?this.segments[e].startByte+"-"+this.segments[t].endByte:"0-8800"}}]),t}(rt),Jt=function(e){function t(){var e;return n()(this,t),(e=d()(this,c()(t).call(this))).metadata=new Ae,e.fragments=[],e.dispatcherParam=null,e}return f()(t,e),s()(t,[{key:"push",value:function(e){e.segments&&this._analyzeSegments(e),e.dispatchParams!==undefined&&(this.dispatcherParam=e.dispatchParams,Object(V.a)(this.dispatcherParam,{dispatcherServerTime:"",key:"",currentUserIP:"",preDispatchArea:"",preDefinition:"",preAverageSpeed:0,preErrorCode:"",retryCount:0}))}},{key:"_analyzeSegments",value:function(e){this.fragments=[];var t=e.segments,i="boolean"!=typeof e.seekable||e.seekable;if(t&&t.length>0){var a=t.length;this.fragments=new Array(a);for(var n=null,r=0,s=null,o=null;r<a;++r)s=t[r],o=t[r+1],(n=new Qt(O.a.FLV)).idx=r,s.isAd&&(n.isAd=!0,n.seekable=i),n.startTime=s.startTime,n.duration=o?o.startTime-s.startTime:s.duration,n.totalBytes=s.totalBytes,n.uri=new fe.a(s.dispatUrl),n.bid=e.bid,Object(U.d)()&&n.uri.setScheme("https"),n.gas=s.gas,this.fragments[r]=n}}},{key:"end",value:function(){}},{key:"reset",value:function(){this.metadata=new Ae,this.fragments=[],this.dispatcherParam=null}}]),t}(H.a),Xt=function(e){function t(e){var i;n()(this,t);var a=new Jt,r=new Yt(e),s=new J("flv","mp4",{debug:E.a.DEBUG,enableWorker:e.config.enableWorker});return(i=d()(this,c()(t).call(this,e,{manifest:a,loader:r,multiplexer:s}))).TAG="FLVActor",i._fragments=[],i._sendISWhileFragmentChange=!0,i._loader.on("fragmentHeader",(function(e,t){i._multiplexer.push(e,t)})),i._loader.on("readFidxChanged",(function(e){if(i.openOffset){var t=i._fragments[e];t.offset=i._pretime,L.a.log("".concat(i.LOG_TAG," change fragment offset, isAD = ").concat(t.isAd,", idx = ").concat(t.idx,", offset = ").concat(t.offset))}})),i._loader.on("fidxLoadStart",(function(e){i.emit("fidxLoadStart",e)})),i._loader.on("fidxError",(function(e){i.emit("fidxError",e)})),i}return f()(t,e),s()(t,[{key:"duration",get:function(){return this._loader.duration}}]),s()(t,[{key:"onMuxInfo",value:function(e,t){var i=t.type,a=t.data;switch(i){case"headerComplete":a.hasAudio&&a.hasVideo||L.a.warn("".concat(a.hasAudio?"video":"audio"," is not present in current flv")),e.hasAudio=a.hasAudio,e.hasVideo=a.hasVideo,e._loader.initSegs(a);break;case"endtimestamp":e._pretime=a}}},{key:"onMuxData",value:function(e,t){switch(t.fragmentType){case"initSegment":var i=t.contentType,a=t.container,n=t.codec,r=t.trackId,s=t.data;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(i," initSegment, ").concat(a,"_").concat(n)),"video"===i||"audio"===i){var o=new X.a(i);o.origin=O.a.HLS,o.bytesArray=s,o.trackId=r,o.container=a,o.codec=n,"video"===i?e.videoInitSegment=o:"audio"===i&&(e.audioInitSegment=o)}break;case"fragment":var d=t.contentType,u=t.data,c=t.duration,l=t.startDTS,h=t.startPTS,_=t.nextSegmentPTS;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(d,", startDTS/startPTS/end/duration(").concat(l.toFixed(3),"/").concat(h.toFixed(3),"/").concat((h+c).toFixed(3),"/").concat(c.toFixed(3),")")),"video"===d){var f=new Z.a("video");f.origin=O.a.FLV,f.bytesArray=u,f.startTime=l,f.duration=c,e._videoMediaSegments.push(f)}else if("audio"===d){var p=new Z.a("audio");p.origin=O.a.FLV,p.bytesArray=u,p.startTime=h,p.duration=c,e._audioSegmentAlignPTS=_,e._audioMediaSegments.push(p)}}e._ctx.emit(ae.a.DATA_BMFF_ARRIVED)}},{key:"applyRange",value:function(e){this._fragments=this._constructPlaySegmentsByRangeList(this._manifest.fragments,e),this._loader.fragments=this._fragments,this._loader.dispatcherParam=this._manifest.dispatcherParam}},{key:"_constructPlaySegmentsByRangeList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],t=arguments.length>1?arguments[1]:undefined,i=.5,a=t.start(0)-i,n=t.end(t.length-1)+i;return e.forEach((function(e){var t=e.segments;t.length>0&&t.map((function(e,t,i){var r=e.startTime,s=e.startTime+e.duration;return e.enabled=(r>=a||s>a)&&(s<=n||r<n),e}))})),e}},{key:"_getSegmentByPTS",value:function(e){var t=this._loader.findSegmentByPTS(e);return t?t.segment:null}},{key:"refreshFrags",value:function(){if(this._fragments.length>0){var e=this._manifest.fragments;if(e.length>0){for(var t=0;t<e.length;t++){var i=e[t];i.idx=this._fragments.length,this._fragments.push(i)}this._loader.refreshFrags()}}else this._fragments=this._fragments.concat(this._manifest.fragments),this._loader.fragments=this._fragments,this._loader.dispatcherParam=this._manifest.dispatcherParam}},{key:"getNextFrag",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;return this._loader.getNextFrag(e)}},{key:"abortCurrentADGas",value:function(e){return this._pretime=0,this._needSendInitSegment=!0,this.videoInitSegment=this.audioInitSegment=null,this.drainBuffer(),this._loader.abortCurrentADGas(e)}},{key:"_reset",value:function(){this._pretime=0,this._fragments.splice(0,this._fragments.length),this._loader.reset()}},{key:"_needSendIS",value:function(e){e&&(this.videoInitSegment=this.audioInitSegment=null)}}]),t}(Oe),Zt=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return n()(this,t),(i=d()(this,c()(t).call(this,a))).ctx=e,i.netProxy=e.netProxy,i.retryCount=r,i.hooks.beforeLoad=i._beforeLoad.bind(h()(i)),i}return f()(t,e),s()(t,[{key:"_beforeLoad",value:function(){this.retryCount>0&&this.query.update("retry",this.retryCount),this.query.update("pv","0.1"),this.query.update("rj","1"),this.query.update("cross-domain",1)}}]),t}(Je),$t=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).TAG="MP4Remote",i.LOG_TAG="[".concat(i.TAG,"]"),i.ctx=e,i._eventManager=new M.a,i.netProxy=e.netProxy,i._dispatcher=null,i._dispatcherResultDic={},i._cdnLaborer=null,i._internalRetryCount=0,i._internalMaxRetry=2,i._dnsInfo={userinfo:"",idc:""},i}return f()(t,e),s()(t,[{key:"dispatcher",get:function(){return this._dispatcher}},{key:"cdnLaborer",get:function(){return this._cdnLaborer}}]),s()(t,[{key:"_makeCDNUri",value:function(e,t,i){var a=new fe.a(e);return a.query.update("start",t),a.query.update("end",i),a}},{key:"removeDispatchDicKey",value:function(e){delete this._dispatcherResultDic[e]}},{key:"startLoad",value:function(e){var i,a=this,n=(arguments.length>1&&arguments[1]!==undefined&&arguments[1],e.fragment),r=n.uri,s=n.uri.path,o=this._dispatcherResultDic[s];if(i=e.fragment.isHeaderLoaded?{startByte:e.pieces[0].startByte,endByte:e.pieces[e.pieces.length-1].endByte}:e.fragment.getRange(),"pan.iqiyi.com"===r.domain){var d=r.toString(),u=this._makeCDNUri(d,i.startByte,i.endByte-1);this._loadCDNData(e,u)}else if(o&&o.l){var c=this._makeCDNUri(o.l,i.startByte,i.endByte);this._loadCDNData(e,c)}else{if(this._dispatcher&&(this._eventManager.removeAll(),this._dispatcher.destroy()),o){var l=o.z;l&&r.query.update("z",l)}this._dispatcher=new Zt(this.ctx,r.toString(),this._internalRetryCount),this._eventManager.on(this._dispatcher,ze.DISPATCH_SUCCESS,(function(t){a._dispatcherResultDic[s]=t,a._dnsInfo={userinfo:t.t,idc:t.z};var n=a._makeCDNUri(t.l,i.startByte,i.endByte);a._loadCDNData(e,n)})),this._eventManager.on(this._dispatcher,ze.DNS_PARSER_REQUEST,(function(e){a._doDNS(e)})),this._eventManager.on(this._dispatcher,ze.DISPATCH_FAIL,(function(i){var n=i.reason,r=i.error;switch(n){case He:a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):a.emit(t.Events.FAILURE,{category:"dispatcher-timeout"});break;case Ve:405===r.status&&r.response&&r.response.code&&r.response.code.indexOf("D20")>=0?a.emit(t.Events.FAILURE,{category:"auth-error"}):a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):a.emit(t.Events.FAILURE,{category:"dispatcher-error"});break;case We:a.emit(t.Events.ABORT);break;default:L.a.warn("Unknown dispatch fail reason ".concat(n))}})),this._dispatcher.load()}}},{key:"_loadCDNData",value:function(e,i){var a=this,n=this.netProxy,r=i.toString(),s=_e.a.SEGMENT,o=n.makeRequestContext([r],Object(V.a)({timeout:1e4},n.defaultRetryParameters));o.method="GET",o.callbacks=Object(V.a)(o.callbacks,{onProgress:function(e,i){a.emit(t.Events.PROGRESS,e,i)},onSuccess:function(e){var i=new Uint8Array(e.data);L.a.log("".concat(a.LOG_TAG," cdn success, http-status/bytes/take(").concat(e.status,"/").concat(i.byteLength,"/").concat(e.netCost,"ms), ").concat(F.filesize(e.speed),"/s, ").concat(e.url)),a.emit(t.Events.SUCCESS,{bytes:i})},onError:function(i){L.a.log("".concat(a.LOG_TAG," cdn error, http-status=").concat(i.status,", ").concat(i.url)),a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-error",statusCode:i.status}))},onTimeout:function(i,n,s){a._internalRetryCount<a._internalMaxRetry?(a._internalRetryCount++,a._internalRetry(e)):(L.a.log("".concat(a.LOG_TAG," cdn timeout, ").concat(s.url)),a._doDNS(r),a.emit(t.Events.FAILURE,{category:"cdn-timeout"}))},onAbort:function(){a.emit(t.Events.ABORT)},onComplete:function(){}},!0),this._cdnLaborer=n.request(s,o)}},{key:"_internalRetry",value:function(e){this.startLoad(e,!0)}},{key:"_doDNS",value:function(e){this.emit(t.Events.DNSPARSER,{userinfo:this._dnsInfo.userinfo,idc:this._dnsInfo.idc,url:e})}},{key:"abort",value:function(){this._dispatcher&&this._dispatcher.abort(),this._cdnLaborer}},{key:"reset",value:function(){this._internalRetryCount=0,this._dispatcherResultDic={},this._eventManager.removeAll(),this._dnsInfo={userinfo:"",idc:""},this.abort()}},{key:"destroy",value:function(){delete this._dispatcherResultDic,this._internalRetryCount=0,this._eventManager.destroy(),delete this._eventManager,this._dispatcher&&this._dispatcher.destroy(),delete this._dispatcher,this._cdnLaborer&&this._cdnLaborer.destroy(),delete this._cdnLaborer,this._dnsInfo={userinfo:"",idc:""}}}]),t}(ne.a);$t.Events={SUCCESS:"SUCCESS",PROGRESS:"PROGRESS",FAILURE:"FAILURE",ABORT:"ABORT",COMPLETE:"COMPLETE",DNSPARSER:"DNSPARSER"};var ei=$t,ti=function(){function e(t){n()(this,e),this._fragment=t.frag,this._fragIdx=t.fragIdx,this._range=t.range,this._bufferInfo=t.bufferInfo,this._pieces=[];for(var i=this._fragment.segments,a=t.range[0],r=t.range[1],s=this._pieces,o=a;o<=r;o++)s.push(i[o]);if(1===s.length){var d=s[0];this._uri=d.uri}}return s()(e,[{key:"uri",get:function(){return this._uri}},{key:"fragIdx",get:function(){return this._fragIdx}},{key:"pieces",get:function(){return this._pieces}},{key:"buffer",get:function(){return this._bufferInfo}},{key:"fragment",get:function(){return this._fragment}}]),s()(e,[{key:"destroy",value:function(){this._pieces=[],this._fragment=null,this._range=null,this._fragIdx=null}}]),e}(),ii=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e))).TAG="MP4Loader",i._fragments=[],i._segments=[],i._readPos={f:0,s:-1,b:-1},i._downPos={f:0,s:-1,b:-1},i._seekTime=0,i._maxSegmentSearchTolerance=e.config.hlsMaxSegmentSearchTolerance,i._mp4Remote=new ei(e),i}return f()(t,e),s()(t,[{key:"initSegs",value:function(e){if(0!=e.keyframePositions.length&&0!=e.keyframeTimes.length){var t=this._fragments[0];t.vaconfig={ac:e.ac,vc:e.vc,naluSizeLength:e.naluSizeLength};var i=e.keyframePositions.join(","),a=e.keyframeTimes.join(",");if(L.a.log("".concat(this.LOG_TAG,",initSegs keyframePositions = ").concat(i,",keyframeTimes = ").concat(a)),t.segments.length>0)L.a.log("".concat(this.LOG_TAG,",initSegs has created segments , return"));else{for(var n=e.keyframePositions,r=e.keyframeTimes,s=0,o=0,d=0,u=0,c=t.endTime,l=t.totalBytes,h=0;h<n.length;h++){h<n.length-1?(d=n[h],u=n[h+1],s=r[h],o=r[h+1]):(d=n[h],u=l,s=r[h],o=c);var _=new De(O.a.FLV);_.idx=h,_.flattenIdx=h,_.startTime=s,_.duration=o-s,_.startByte=d,_.endByte=u,_.poolId="mp4-"+this._uuid+"-"+t.idx+"-"+_.idx,_.fragIdx=t.idx,_.fragKey=t.key,_.bid=t.bid,_.uri=t.uri,t.segments.push(_)}this._segments=t.segments,e=null,t.headerStatus=Ne,this._segmentsEnd()}}}},{key:"duration",get:function(){var e=0;return this._fragments.length>0&&(e=this._fragments[this._fragments.length-1].endTime),e}},{key:"fragments",set:function(e){this._eof=!1,this._eod=!1,this._fragments=e,this._preErrorData=null}}]),s()(t,[{key:"_reset",value:function(){this._fragments.splice(0,this._fragments.length),this._segments.splice(0,this._segments.length),this._readPos.f=this._readPos.s=this._readPos.b=-1,this._downPos.f=this._downPos.s=this._downPos.b=-1,this._lastBufPos=undefined,this._lastBufInf=undefined,this.state!==ve.IDLE&&(this.state===ve.LOADING?this._abort():this.state=ve.IDLE),this._withBufferRetryCount=0,this._noBufferRetryCount=0,this._mp4Remote.reset()}},{key:"read",value:function(){return this._readCDN()}},{key:"_seek",value:function(e){if(this._seekTime=e,this._fragments[0].isHeaderLoaded)this._segmentsEnd();else{var t=new ti({frag:this._fragments[0],fragIdx:this._fragments[0].idx,range:[0,99999],bufferInfo:0});this._loadSingleSegment(t)}}},{key:"_segmentsEnd",value:function(){this._withBufferRetryCount=0,this._noBufferRetryCount=0,this._seekTime-=this._maxSegmentSearchTolerance;var e=this.findSegmentByPTS(this._seekTime),t=e.fragment,i=e.segment;if(t&&i){var a=this._getFloatNumByIdx(t.idx,i.idx),n=this._getFloatNumByIdx(this._readPos.f,this._readPos.s),r=this._getFloatNumByIdx(this._downPos.f,this._downPos.s),s=a>=n&&a<=r;this._readPos.f=t.idx,this._readPos.s=i.idx,this._readPos.b=0,this._downPos.f=t.idx,this._downPos.s=i.idx,this._downPos.b=0,this._findPieceByPos(this._downPos).segment.status===Ne&&this._moveToNextDownPosOrEOD(),s||this.state!==ve.LOADING||this._abort(),this._tick()}}},{key:"_tick",value:function(){this._checkFetchOrEOD()}},{key:"_checkFetchOrEOD",value:function(){if(!this._eod&&!this._ctx.error&&this._segments&&0!==this._segments.length&&this.state===ve.IDLE){var e=this.getUnreadBufInfo();if(e.timeLength>this._maxBufferTimeLength)return;this._checkLoad(e)}}},{key:"_getFloatNumByIdx",value:function(e,t){return parseFloat(e+"."+t)}},{key:"getUnreadBufInfo",value:function(){var e=this._fragments,t=this._downPos.f,i=this._downPos.s,a=this._readPos.f,n=this._readPos.s,r=0,s=0,o=0,d={start:o,byteLength:r,timeLength:s};if(0==this._segments.length)return d;if(this.eof){if(this.eof){var u=e[e.length-1];d.start=u.endTime}}else{var c=[a,n,t,i].join("-");if(this._lastBufPos&&this._lastBufPos===c)return this._lastBufInf;for(var l=a;l<=t;l++){var h=e[l];if(h){var _=h.segments,f=l===a?n:0,p=l===t?i:_.length-1;l===a&&(o=_[n].startTime);for(var g=f;g<=p;g++){var m=_[g],v=this._bufferPool.read(m.poolId);if(v)r+=v.byteLength,s+=m.duration;else if(!(l===t&&g===p))throw new Error("A discontinuous buffer was detected. ".concat(m.poolId))}}}d.start=o,d.byteLength=r,d.timeLength=s,this._lastBufPos=c,this._lastBufInf=d}return d}},{key:"_readCDN",value:function(){if(this.eof||!this._fragments[0].isHeaderLoaded)return null;var e=this._findPieceByPos(this._readPos),t=e.fragment,i=e.segment;if(!i)return null;if(!i.enabled)return this._moveToNextReadPosOrEOF(),null;if(i.status!==Be&&i.status!==Ne)return this._tryToSyncReadAndDownPos(),null;var a=this._fragments.length,n=this._readPos.f,r=this._readPos.s,s=this._readPos.b,o=i.startByte+s,d=this._bufferPool.read(i.poolId),u=null,c=!1,l=i.bid;return s>=d.byteLength?u=null:(L.a.log("".concat(this.LOG_TAG,": Read seg ").concat(i.poolId,",  flatten idx ").concat(i.flattenIdx,"->[0,").concat(this._segments.length-1,"] & inner seg idx ").concat(r,"->[0,").concat(t.segments.length-1,"] of frag ").concat(n,"->[0,").concat(a-1,"], status ").concat(this.getStateKey(i.status),", bid=").concat(l,", duration=").concat(i.duration,",bytes=").concat(i.endByte-i.startByte)),u=d.subarray(s,d.byteLength)),i.status===Be?this._readPos.b=d.byteLength:i.status===Ne&&(c=!0,this._moveToNextReadPosOrEOF()),{type:O.a.MP4,data:u,done:c,meta:{uid:"".concat(l,"-").concat(n,"-").concat(r),level:l,fragIdx:n,segIdx:r,fragKey:i.fragKey,byteOffset:o,isHeader:!1}}}},{key:"_abort",value:function(){this._mp4Remote.abort()}},{key:"findSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=this._findPieceByPTS(e,this._fragments),i=null;return t&&(i=this._findPieceByPTS(e,t.segments)),{fragment:t,segment:i}}},{key:"findPrevSegmentByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=null,i=this.findSegmentByPTS(e),a=i.segment;return a&&a.flattenIdx>0&&(t=this._segments[a.flattenIdx-1]),t}},{key:"_findPieceByPTS",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined,i=arguments.length>2?arguments[2]:undefined;return i&&!this._pieceWithinToleranceTest(e,i)?i:$(t,this._pieceWithinToleranceTest.bind(this,e))}},{key:"_findPieceByPos",value:function(e){var t=this._fragments[e.f],i=null;return t&&(i=t.segments[e.s]),{fragment:t,segment:i}}},{key:"_pieceWithinToleranceTest",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1?arguments[1]:undefined;return e<0&&(e=0),t.startTime+t.duration<=e?1:t.startTime>e&&t.startTime?-1:0}},{key:"_checkLoad",value:function(e){var t=this._findPieceByPos(this._downPos),i=t.fragment,a=t.segment;if(!i||!a)return L.a.error("".concat(this.LOG_TAG,": load frag/segment(").concat(i,"/").concat(a,"), down pos(").concat(JSON.stringify(this._downPos),")"));var n=new ti({frag:i,fragIdx:this._downPos.f,range:[this._downPos.s,this._downPos.s],bufferInfo:e});this._loadSingleSegment(n)}},{key:"_isCurrentDownSeg",value:function(e){return!!e&&e.idx===this._downPos.s&&e.fragIdx===this._downPos.f}},{key:"_loadContiguousSegments",value:function(e){}},{key:"_loadSingleSegment",value:function(e){var t=this,i=(arguments.length>1&&arguments[1]!==undefined&&arguments[1],e.pieces),a=e.fragIdx,n=e.buffer,r=this,s=i[0],o=this._fragments[a],d=this._fragments.length;r.state=ve.LOADING;var u=function(e,t){},c=function(e){var i=e.bytes;t._fragments[0].isHeaderLoaded?(r._bufferPool.del(s.poolId),r._bufferPool.add(s.poolId,i),s.status=Ne,r._isCurrentDownSeg(s)&&r._moveToNextDownPosOrEOD(),r.state!==ve.ERROR&&(r.state=ve.IDLE),r.emit(ie.DATA_ARRIVED)):(r.state!==ve.ERROR&&(r.state=ve.IDLE),t.emit("mp4FragmentHeader",i,{meta:{isHeader:!0}}))},l=function(i){var a=t.getUnreadBufInfo().timeLength>0;"auth-error"==i.category?t._doFinalError(i,e,s):a?t._withBufferRetryCount<t._withBufferMaxRetry?(t._withBufferRetryCount++,t._reloadSingleSegment(e)):t._doFinalError(i,e,s):t._noBufferRetryCount<t._noBufferMaxRetry?(t._noBufferRetryCount++,t._reloadSingleSegment(e)):t._doFinalError(i,e,s)},h=function(){if(s){var e="seg ".concat(s.idx,"->[0,").concat(o.segments.length-1,"]"),t="frag ".concat(a,"->[0,").concat(d-1,"]");L.a.log("".concat(r.LOG_TAG,": onAbort ").concat(e," of ").concat(t,", buffer ").concat(n.timeLength,"s")),s.status=Re,r._bufferPool.del(s.poolId)}r.state!==ve.ERROR&&(r.state=ve.IDLE)},_=function(e){r._doDNSParser(e)};this._eventManager.removeAll(),this._eventManager.on(this._mp4Remote,ei.Events.PROGRESS,u),this._eventManager.on(this._mp4Remote,ei.Events.SUCCESS,c),this._eventManager.on(this._mp4Remote,ei.Events.FAILURE,l),this._eventManager.on(this._mp4Remote,ei.Events.ABORT,h),this._eventManager.on(this._mp4Remote,ei.Events.DNSPARSER,_),this._mp4Remote.startLoad(e)}},{key:"_reloadSingleSegment",value:function(e){this._mp4Remote.reset(),this._mp4Remote.dispatcher&&this._mp4Remote.dispatcher.destroy(),this._mp4Remote.cdnLaborer&&this._mp4Remote.cdnLaborer.destroy(),this._loadSingleSegment(e,!0)}},{key:"_doFinalError",value:function(e,t,i){var a=e.category,n=e.statusCode,r=t.fragIdx,s=this._fragments[r],o=this._fragments.length;switch(a){case"cdn-error":case"dispatcher-error":case"auth-error":if(this._isCurrentDownSeg(i)){i.status=Fe,this.state=ve.ERROR,L.a.log("".concat(this.LOG_TAG,": onError: ").concat(i.fragIdx,"-").concat(i.idx));var d="";switch(a){case"cdn-error":d=ee.a.code.DATA_MP4_CDN_ERROR;break;case"auth-error":d=ee.a.code.DATA_AUTH_Error;break;case"dispatcher-error":d=ee.a.code.DATA_MP4_DISPATCH_ERROR}this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,d,n)}else if(i){var u="seg ".concat(i.idx,"->[0,").concat(s.segments.length-1,"]"),c="frag ".concat(r,"->[0,").concat(o-1,"]");L.a.error("".concat(this.LOG_TAG,": onError ").concat(u," of ").concat(c,", buffer ").concat(t.buffer.timeLength,"s"))}break;case"cdn-timeout":case"dispatcher-timeout":if(this._isCurrentDownSeg(i))i.status=Ue,this.state=ve.ERROR,L.a.log("".concat(this.LOG_TAG,": onTimeout: ").concat(i.fragIdx,"-").concat(i.idx)),this._error=new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,"cdn-timeout"===a?ee.a.code.DATA_MP4_DISPATCH_ERROR:ee.a.code.DATA_MP4_CDN_TIMEOUT);else if(i){var l="seg ".concat(i.idx,"->[0,").concat(s.segments.length-1,"]"),h="frag ".concat(r,"->[0,").concat(o-1,"]");L.a.error("".concat(this.LOG_TAG,": onTimeout ").concat(l," of ").concat(h,", buffer ").concat(t.buffer.timeLength,"s"))}break;default:this.state!==ve.ERROR&&(this.state=ve.IDLE)}}},{key:"_getNextAvailableSegByFlatten",value:function(e){var t=this._segments[e];return t?t.enabled?t:this._getNextAvailableSegByFlatten(e+1):null}},{key:"_moveToNextDownPosOrEOD",value:function(){var e=this._findPieceByPos(this._downPos).segment,t=this._getNextAvailableSegByFlatten(e.flattenIdx+1);t?(this._downPos.f=t.fragIdx,this._downPos.s=t.idx,this._downPos.b=0,t.status===Ne&&this._moveToNextDownPosOrEOD()):this.state=ve.END}},{key:"_moveToNextReadPosOrEOF",value:function(){var e=this._fragments[this._readPos.f].segments[this._readPos.s],t=this._getNextAvailableSegByFlatten(e.flattenIdx+1);t?(this._readPos.f=t.fragIdx,this._readPos.s=t.idx,this._readPos.b=0):(this._eof=!0,L.a.log("".concat(this.LOG_TAG,": EOF")))}},{key:"_tryToSyncReadAndDownPos",value:function(){var e=!1;(this._readPos.f>this._downPos.f||this._readPos.s>this._downPos.s)&&(e=!0),e&&(this._downPos.f=this._readPos.f,this._downPos.s=this._readPos.s,this._downPos.b=0)}},{key:"getNextFrag",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;if(e+1<this._fragments.length)for(var t=null,i=e+1;i<this._fragments.length;i++)if((t=this._fragments[i]).status!==Fe&&t.status!==Ue)return t;return null}},{key:"abortCurrentADGas",value:function(e){var t=this.getNextFrag(e);return t?(this._readPos.f=t.idx,this._readPos.s=0,this._eof=!1,t.offset=0):this._eof=!0,this._preReadFidx=-1,L.a.log("".concat(this.LOG_TAG," , abortCurrentADGas done,abort= ").concat(e,",next=").concat(this._readPos.f,",eof = ").concat(this._eof,",length = ").concat(this._fragments.length)),t}},{key:"_gc",value:function(){if(!(this._readPos.f<0||this._readPos.s<0||this._downPos.f<0||this._downPos.s<0))for(var e=this._fragments[this._readPos.f].segments[this._readPos.s].flattenIdx,t=this._fragments[this._downPos.f].segments[this._downPos.s].flattenIdx,i=this._segments,a=this._bufferPool.keys,n=0;n<a.length;n++){var r=a[n].split("-"),s=parseInt(r[1],10),o=parseInt(r[2],10),d=this._fragments[s];if(d){var u=d.segments[o];if(u){var c=u.flattenIdx;if(c<e||c>t)i[c].status=Re}}}}}]),t}(Te),ai=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e)))._headerStatus=0,i._totalBytes=0,i._vaconfig=null,i}return f()(t,e),s()(t,[{key:"totalBytes",get:function(){return this._totalBytes},set:function(e){this._totalBytes=e}},{key:"headerStatus",get:function(){return this._headerStatus},set:function(e){this._headerStatus=e}},{key:"isHeaderLoaded",get:function(){return this._headerStatus===Ne}},{key:"vaconfig",get:function(){return this._vaconfig},set:function(e){this._vaconfig=e}}]),s()(t,[{key:"getRange",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return null===t&&(t=e),this._headerStatus===Ne?this.segments[e].startByte+"-"+this.segments[t].endByte:{startByte:0,endByte:Math.floor(.02*this._totalBytes)}}}]),t}(rt),ni=function(e){function t(e){var i;n()(this,t),i=d()(this,c()(t).call(this));var a=h()(i);return a.ctx=e,a._bid="",a.metadata=new Ae,a.protocol=window.location.protocol,a._accurateTimestamp=!1,i.dispatcherParam={},a.reset(),i}return f()(t,e),s()(t,[{key:"push",value:function(e){this._premanifest=+new Date,this.metadata.hasAudio=!0,this.metadata.hasVideo=!0,Object(V.a)(this.dispatcherParam,{dispatcherServerTime:"",key:"",currentUserIP:"",preDispatchArea:"",preDefinition:"",preAverageSpeed:0,preErrorCode:"",retryCount:0}),this._parseFunc(e)}},{key:"_parseFunc",value:function(e){this.fragments=[];var t=new ai(O.a.MP4),i=e.data;i=i.replace("http://","https://"),t.idx=0,t.bid=e.bid,t.uri=new fe.a(i),t.startTime=0,t.duration=e.duration,t.totalBytes=e.size,this.fragments.push(t)}},{key:"end",value:function(){}},{key:"reset",value:function(){this.metadata=new Ae,this._accurateTimestamp=!1,this.fragments=[],this.uuid=se.a.create()}}]),t}(H.a),ri=function(e){function t(e){var i;n()(this,t);var a=new ni,r=new ii(e),s=new J("mp4","mp4",{debug:E.a.DEBUG,enableWorker:e.config.enableWorker});return(i=d()(this,c()(t).call(this,e,{manifest:a,loader:r,multiplexer:s}))).TAG="MP4Actor",i._fragments=[],i._sendISWhileFragmentChange=!0,i._loader.on("mp4FragmentHeader",(function(e,t){i._multiplexer.push(e,t)})),i._loader.on("readFidxChanged",(function(e){if(i.openOffset){var t=i._fragments[e];t.offset=i._pretime,L.a.log("".concat(i.LOG_TAG," change fragment offset, isAD = ").concat(t.isAd,", idx = ").concat(t.idx,", offset = ").concat(t.offset))}})),i._loader.on("fidxLoadStart",(function(e){i.emit("fidxLoadStart",e)})),i._loader.on("fidxError",(function(e){i.emit("fidxError",e)})),i}return f()(t,e),s()(t,[{key:"duration",get:function(){return this._loader.duration}}]),s()(t,[{key:"onMuxInfo",value:function(e,t){var i=t.type,a=t.data;switch(i){case"headerComplete":a.hasAudio&&a.hasVideo||L.a.warn("".concat(a.hasAudio?"video":"audio"," is not present in current flv")),e.hasAudio=a.hasAudio,e.hasVideo=a.hasVideo,e._loader.initSegs(a);break;case"endtimestamp":e._pretime=a}}},{key:"onMuxData",value:function(e,t){switch(t.fragmentType){case"initSegment":var i=t.contentType,a=t.container,n=t.codec,r=t.trackId,s=t.data;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(i," initSegment, ").concat(a,"_").concat(n)),"video"===i||"audio"===i){var o=new X.a(i);o.origin=O.a.MP4,o.bytesArray=s,o.trackId=r,o.container=a,o.codec=n,"video"===i?e.videoInitSegment=o:"audio"===i&&(e.audioInitSegment=o)}break;case"fragment":var d=t.contentType,u=t.data,c=t.duration,l=t.startDTS,h=t.startPTS,_=t.nextSegmentPTS;if(L.a.log("".concat(e.LOG_TAG," parsed ").concat(d,", startDTS/startPTS/end/duration(").concat(l.toFixed(3),"/").concat(h.toFixed(3),"/").concat((h+c).toFixed(3),"/").concat(c.toFixed(3),")")),"video"===d){var f=new Z.a("video");f.origin=O.a.FLV,f.bytesArray=u,f.startTime=l,f.duration=c,e._videoMediaSegments.push(f)}else if("audio"===d){var p=new Z.a("audio");p.origin=O.a.FLV,p.bytesArray=u,p.startTime=h,p.duration=c,e._audioSegmentAlignPTS=_,e._audioMediaSegments.push(p)}}e._ctx.emit(ae.a.DATA_BMFF_ARRIVED)}},{key:"applyRange",value:function(e){this._fragments=this._constructPlaySegmentsByRangeList(this._manifest.fragments,e),this._loader.fragments=this._fragments}},{key:"_constructPlaySegmentsByRangeList",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[],t=arguments.length>1?arguments[1]:undefined,i=.5,a=t.start(0)-i,n=t.end(t.length-1)+i;return e.forEach((function(e){var t=e.segments;t.length>0&&t.map((function(e,t,i){var r=e.startTime,s=e.startTime+e.duration;return e.enabled=(r>=a||s>a)&&(s<=n||r<n),e}))})),e}},{key:"_getSegmentByPTS",value:function(e){var t=this._loader.findSegmentByPTS(e);return t?t.segment:null}},{key:"refreshFrags",value:function(){if(this._fragments.length>0){var e=this._manifest.fragments;if(e.length>0){for(var t=0;t<e.length;t++){var i=e[t];i.idx=this._fragments.length,this._fragments.push(i)}this._loader.refreshFrags()}}else this._fragments=this._fragments.concat(this._manifest.fragments),this._loader.fragments=this._fragments}},{key:"getNextFrag",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;return this._loader.getNextFrag(e)}},{key:"abortCurrentADGas",value:function(e){return this._pretime=0,this._needSendInitSegment=!0,this.videoInitSegment=this.audioInitSegment=null,this.drainBuffer(),this._loader.abortCurrentADGas(e)}},{key:"_reset",value:function(){this._pretime=0,this._fragments.splice(0,this._fragments.length),this._loader.reset()}},{key:"_needSendIS",value:function(e){e&&(this.videoInitSegment=this.audioInitSegment=null)}}]),t}(Oe),si=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e))).TAG="MovieStream",a._silenced=!1,a.silenced=i,a._actor=null,a}return f()(t,e),s()(t,[{key:"eof",get:function(){return!!this._actor&&this._actor.eof}},{key:"eod",get:function(){return!!this._actor&&this._actor.eod}},{key:"duration",get:function(){return this._actor?this._actor.duration:0}},{key:"silenced",get:function(){return this._silenced},set:function(e){this._silenced=e,this._actor&&(this._actor.silenced=e)}},{key:"needInitSegment",set:function(e){this._actor&&(this._actor.needIS=e)}},{key:"willSendInitSegment",get:function(){return!!this._actor&&this._actor.willSendIS}},{key:"audioInitSegment",get:function(){return this._actor?this._actor.audioInitSegment:null}},{key:"buffer",get:function(){var e={len:0,start:0,end:0,buffered:null};try{if(this._actor){var t=this._actor.buffer;t&&(e=t)}}catch(i){}return e}},{key:"reBufTime",get:function(){return this._actor.reBufTime}},{key:"openReBufTime",set:function(e){this._actor.openReBufTime=e}}]),s()(t,[{key:"_reset",value:function(){}},{key:"push",value:function(e){var t=!!e.isSwitchLevel,i=e.playSourceType,a=e.playSourceContent;this._filled=!0,this._initActor(i),this._actor.feed(a,t)}},{key:"_initActor",value:function(e){var t=this;if(this._manifestType=e,[[O.a.HLS,Lt],[O.a.FLV,Xt],[O.a.MP4,ri],[O.a.DASH_VP9,It],[O.a.DASH_AV1,It],[O.a.JDASH,Le]].filter((function(t){return t[0]===e})).forEach((function(e){var i=e[1],a=t._actor;a&&a instanceof i||(a&&a.destroy(),t._actor=new i(t._ctx))})),!this._actor)throw new Error("".concat(e," actor init failed!"));this._actor.silenced=this._silenced}},{key:"seek",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2];this._actor&&this._actor.seek(e,!0,t,i)}},{key:"read",value:function(){var e=null;return this._actor&&!this.eof&&(e=this._actor.read()),e}},{key:"getSegmentByPTS",value:function(e){var t=null;return this._actor&&(t=this._actor.getSegmentByPTS(e)),t}},{key:"refreshFrags",value:function(){this._actor&&this._actor.refreshFrags()}}]),t}(C.a),oi={PRE_ROLL:0,MID_ROLL:1,POST_ROLL:2,BRIEF_ROLL:3},di=i(154),ui=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e))).TAG="RollStream",a._silenced=!1,a.silenced=i,a._actor=null,a._rollType=null,a._isAD=!1,a._range=new di.a,a._range.add(0,Infinity),a.acceptContinuousMode=!0,a._done=!1,a._offset=0,a._loadstartEvts=[],a._loadErrorEvts=[],a._loadstartOpen=!1,a._curFragment=null,a._abortNextFrag=!1,a}return f()(t,e),s()(t,[{key:"_sendWillEnded",value:function(){this._ctx.emit(ae.a.STATE_CHANGE,{state:"willended"})}},{key:"_sendEnded",value:function(){L.a.log("rollstream, change fragment , ended = "+this._curFragment.idx),this._ctx.emit(ae.a.STATE_CHANGE,{state:"ended"})}},{key:"_changeCurrFrag",value:function(e){var t=this._ctx;L.a.log("rollstream, change fragment , playing="+(e?e.idx:null)+",eof = "+this._actor.eof+",done="+this.done),e&&(this._curFragment=e,t.media.readyState>=2&&t.emit(ae.a.STATE_CHANGE,{state:"playing"}))}},{key:"offset",get:function(){return this._offset}},{key:"mediaRanges",get:function(){return this._range}},{key:"playRanges",get:function(){return this._range}},{key:"rollType",get:function(){return this._rollType}},{key:"isAD",get:function(){return this._isAD}},{key:"seekable",get:function(){var e=!1;return this._curFragment&&(e=this._curFragment.seekable),e}},{key:"eof",get:function(){return this._actor&&this._done&&this._actor.eof}},{key:"eod",get:function(){return!!this._actor&&this._actor.eod}},{key:"duration",get:function(){return this._curFragment?this._curFragment.duration:this._actor?this._actor.duration:0}},{key:"silenced",get:function(){return this._silenced},set:function(e){this._silenced=e,this._actor&&(this._actor.silenced=e)}},{key:"needInitSegment",set:function(e){this._actor&&(this._actor.needIS=e)}},{key:"willSendInitSegment",get:function(){return!!this._actor&&this._actor.willSendIS}},{key:"audioInitSegment",get:function(){return this._actor?this._actor.audioInitSegment:null}},{key:"buffer",get:function(){var e={len:0,start:0,end:0};try{if(this._actor){var t=this._actor.buffer;t&&(e=t)}}catch(i){}return e}},{key:"done",get:function(){return this._done}},{key:"currentTime",set:function(e){if(this._currentTime=e,null==this._curFragment)this._curFragment=this._actor.getNextFrag();else{var t=this._curFragment.startTime+this._curFragment.offset,i=this._curFragment.endTime+this._curFragment.offset;e>=t&&e<i?e+.5>=i&&this._sendWillEnded():e>=i&&(this._sendEnded(),this._changeCurrFrag(this._actor.getNextFrag(this._curFragment.idx)))}},get:function(){return this._curFragment?this._currentTime-this._curFragment.offset:0}}]),s()(t,[{key:"_reset",value:function(){this._rollType=null,this._isAD=!1,this._offset=0,this._loadstartOpen=!1}},{key:"push",value:function(e){var t=e.playSourceContent,i=e.playSourceType,a=!!e.done;this.acceptContinuousMode&&(t.isContinuousMode=!0),this._isAD=t.isAD,this._isAD?t.loaderConfig=new oe({doRetry:!1,allowIPDispatch:!1,skipErrorFrag:!0,retryNum:1,ipMaxRetry:0,timeout:5e3}):(this.ignoreError=!0,t.loaderConfig=new oe({doRetry:!1,doDispatch:!1,retryNum:1,timeout:5e3})),this._filled||this._actor||this._initActor(i),this._rollType=t.rollType,this._filled=!0,this._done=a,a&&this._rollType!==oi.BRIEF_ROLL||(this._offset=t.offset),this._actor.feed(t)}},{key:"_initActor",value:function(e){var t=this,i=!1;switch(this._manifestType=e,e){case O.a.FLV:this._actor&&this._actor instanceof Xt||(this._actor&&(this._actor.removeAllListeners(),this._actor.destroy()),i=!0,this._actor=new Xt(this._ctx))}if(!this._actor)throw new Error("".concat(e," actor init failed!"));this._actor.silenced=this._silenced,i&&this._actor&&(this._actor.openOffset=!0,this._actor.on("fidxLoadStart",(function(e){t._loadstartOpen||t.silenced?t._loadstart(e):t._loadstartEvts.push(e)})),this._actor.on("fidxError",(function(e){t._loadstartOpen||t.silenced?t._loadError(e.gas):t._loadErrorEvts.push(e.gas),t._curFragment&&e.gas&&e.gas==t._curFragment.gas&&t._changeCurrFrag(t._actor.getNextFrag(t._curFragment.idx))})))}},{key:"seek",value:function(e){this._actor&&this._actor.seek(e)}},{key:"read",value:function(){return this._actor?this._actor.read():null}},{key:"getSegmentByPTS",value:function(e){return this._actor?this._actor.getSegmentByPTS(e):null}},{key:"refreshFrags",value:function(){this._actor&&(this._actor.refreshFrags(),this._abortNextFrag&&(this._changeCurrFrag(this._actor.getNextFrag(this._curFragment.idx)),this._abortNextFrag=!1))}},{key:"openLoadStart",value:function(){if(!this._loadstartOpen){for(var e=this._loadstartEvts.length,t=this._loadErrorEvts.length,i=e>t?e:t,a=0;a<i;a++){if(a>0){var n=this._loadstartEvts[a];n&&this._loadstart(n)}var r=this._loadErrorEvts[a];r&&this._loadError(r)}this._loadstartEvts=[],this._loadErrorEvts=[],this._loadstartOpen=!0}}},{key:"_loadstart",value:function(e){this._ctx.emit(ae.a.STATE_CHANGE,{state:"loadstart",gas:e})}},{key:"_loadError",value:function(e){this._ctx.emit(ae.a.ERROR,{category:ee.a.category.DATA_SOURCE,code:ee.a.code.DATA_AD_ERROR,data:[{gas:e}],severity:ee.a.severity.IGNORABLE})}},{key:"getCurrentADGas",value:function(){return null==this._curFragment&&(this.currentTime=0),this._curFragment?this._curFragment.gas:undefined}},{key:"abortCurrentADGas",value:function(){var e=null;return this._actor&&this._curFragment&&(e=this._actor.abortCurrentADGas(this._curFragment.idx),L.a.log("=rollstream, abortCurrentADGas done, current = ",this._curFragment.idx,",next = ",e?e.idx:"ended"),this._sendEnded(),this._changeCurrFrag(e),this.done||null!=e||(this._abortNextFrag=!0)),null==e&&this.done}}]),t}(C.a),ci=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,i))).TAG="BriefRollStream",a.acceptContinuousMode=!1,a}return f()(t,e),t}(ui),li=(i(185),i(430),0),hi={STAGE_BEGIN:"stage_event_"+li++,STAGE_END:"stage_event_"+li++,PLAYING_STREAM_CHANGED:"stage_event_"+li++,PLAYING_STREAM_PROGRESS:"stage_event_"+li++,ROLL_EOD:"stage_event_"+li++,MOVIE_EOD:"stage_event_"+li++},_i=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._ctx=e,i._set=new Set,i._playingStream=null,i._playingStreamBufferEnd=0,i.briefs={},i}return f()(t,e),s()(t,[{key:"playingStream",get:function(){return this._playingStream},set:function(e){if(this.has(e)){var t="RollStream"===e.TAG&&e.isAD,i=this._playingStream;L.a.log("stage change playing stream to ".concat(e.TAG,", isAD=").concat(t)),this._playingStream=e,i&&(i.isPlaying=!1),e.isPlaying=!0,this.emit(hi.PLAYING_STREAM_CHANGED,e)}else L.a.warn("playing stream change failed~")}},{key:"isRolling",get:function(){var e=this._playingStream,t=!!e;return t&&(t="RollStream"===e.TAG&&e.isAD||"BriefRollStream"===e.TAG),t}},{key:"rollingType",get:function(){var e=this._playingStream;return e?e.rollType:null}},{key:"isPatching",get:function(){var e=this._playingStream,t=!!e;return t&&(t=e===this.patchStream&&!e.isAD),t}},{key:"isLast",get:function(){var e=this._playingStream,t=!!e;return t&&(t=e===this.movieStream&&!this._hasPatch||e==this.patchStream),t}},{key:"_hasPatch",get:function(){var e=this.patchStream;return e&&e.rollType==oi.POST_ROLL&&!e.error}},{key:"rollStream",get:function(){var e=null,t=!0,i=!1,a=undefined;try{for(var n,r=this.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if("RollStream"===s.TAG&&s.isAD){e=s;break}}}catch(o){i=!0,a=o}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return e}},{key:"latestBriefRollStream",get:function(){var e=this.briefs.length;return e>0?this.briefs[e-1]:null}},{key:"movieStream",get:function(){var e=null,t=!0,i=!1,a=undefined;try{for(var n,r=this.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(s instanceof si){e=s;break}}}catch(o){i=!0,a=o}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return e}},{key:"matStream",get:function(){var e=null,t=!0,i=!1,a=undefined;try{for(var n,r=this.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(s.TAG&&"MATStream"===s.TAG){e=s;break}}}catch(o){i=!0,a=o}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return e}},{key:"patchStream",get:function(){var e=null,t=!0,i=!1,a=undefined;try{for(var n,r=this.values()[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if(s instanceof ui&&!s.isAD){e=s;break}}}catch(o){i=!0,a=o}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return e}},{key:"size",get:function(){return this._set.size}}]),s()(t,[{key:"_startSchedules",value:function(){var e=this;this._destroySchedules(),this._secClockTimer=new re.a((function(){return e._doSecClockJob()})),this._secClockTimer.scheduleRepeated(1)}},{key:"_destroySchedules",value:function(){this._secClockTimer&&(this._secClockTimer.cancel(),this._secClockTimer=null)}},{key:"add",value:function(e){var t=!1,i=!1,a=e.TAG;if("RollStream"===a)if(e.isAD){if(t=!0,this.rollStream)return L.a.error("stage should has only one roll stream"),this;if(e.rollType===oi.PRE_ROLL&&this.movieStream)return L.a.error("stage now has a movie stream, but add a pre roll"),this}else if(this.patchStream)return L.a.error("stage should has only one patch stream"),this;if("BriefRollStream"===a){var n=e.offset,r=this.briefs[n]=this.briefs[n]||[],s=r.length;t=!0,s>0&&(r[s-1].next=e),r.push(e)}return"MovieStream"===a&&(i=!0,this.movieStream)?(L.a.error("stage should has just a movie stream"),this):"MATStream"===a&&this.matStream?(L.a.error("stage should has just a mat stream"),this):(this._set.add(e),1===this.size&&(t||i)&&(this.playingStream=e,this.emit(hi.STAGE_BEGIN),this._startSchedules()),this)}},{key:"clear",value:function(){this._playingStream=null,this.briefs={},this._set.clear()}},{key:"delete",value:function(e){if("BriefRollStream"===e.TAG){var t=e.offset,i=this.briefs[t];if(Array.isArray(i))for(var a=0;a<i.length;a++)if(i[a]===e){i.splice(a,1);break}}return this._set["delete"](e)}},{key:"forEach",value:function(e,t){t?this._set.forEach(e,t):this._set.forEach(e)}},{key:"has",value:function(e){return this._set.has(e)}},{key:"keys",value:function(){return this._set.keys()}},{key:"values",value:function(){return this._set.values()}},{key:"entries",value:function(){return this._set.entries()}},{key:"endOfPlayingStream",value:function(){this.tryToSwitchStream(!0)}},{key:"tryToSwitchStream",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0],t=this._playingStream;if(t){var i="RollStream"===t.TAG&&!t.isAD,a="RollStream"===t.TAG&&t.isAD,n="BriefRollStream"===t.TAG,r=t instanceof si,s=this.rollStream,o=this.patchStream,d=this.movieStream,u=this.matStream;if(a){if(e){var c=t.rollType;switch(c){case oi.PRE_ROLL:var l=0,h=this.briefs[l]||[];h.length>0?this.playingStream=h.shift():d&&(this.playingStream=d);break;case oi.MID_ROLL:d&&(this.playingStream=d);break;case oi.POST_ROLL:this.emit(hi.STAGE_END)}this["delete"](t),t.destroy(),t=null}}else if(n)e&&(t.next?this.playingStream=t.next:d&&(this.playingStream=d),this["delete"](t),t.destroy(),t=null);else if(r)if(e)this._hasPatch?this.playingStream=o:s&&s.rollType==oi.POST_ROLL?this.playingStream=s:this.emit(hi.STAGE_END);else{if(s&&s.rollType===oi.MID_ROLL){var _=s.offset,f=t.currentTime;if(f>=_){this.playingStream=s;var p=f+.1;t.needInitSegment=!0,t.range(p),t.seek(p),u&&(u.needInitSegment=!0)}}var g=this.briefs,m=Object.keys(g);if(m.length>0){for(var v=0;v<m.length;v++){var b=m[v],y=g[b];Array.isArray(y)&&0!==y.length||delete g[b]}var k=Object.keys(g).sort().map((function(e){return parseInt(e,10)}));if(k.length>0)for(var T=0;T<k.length;T++){var S=k[T],P=t.currentTime,x=Math.floor(P);if(x>S)delete g[S];else if(x===S){this.playingStream=g[S].shift();var I=P+.1;t.needInitSegment=!0,t.range(I),t.seek(I),u&&(u.needInitSegment=!0);break}}}}else i&&e&&(t.rollType==oi.POST_ROLL&&(s&&s.rollType==oi.POST_ROLL?this.playingStream=s:this.emit(hi.STAGE_END)),this["delete"](t),t.destroy(),t=null)}}},{key:"_doSecClockJob",value:function(){var e=this._playingStream;if(e){if(!e.hasNoticeEOD&&e.eod)switch(e){case this.movieStream:e.hasNoticeEOD=!0,this.emit(hi.MOVIE_EOD);break;case this.rollStream:e.hasNoticeEOD=!0,this.emit(hi.ROLL_EOD)}var t=e.buffer.end;t!==this._playingStreamBufferEnd&&(this._playingStreamBufferEnd=t,this.emit(hi.PLAYING_STREAM_PROGRESS))}}}]),t}(ne.a);_i.Events=hi;var fi=_i,pi=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this)))._eventManager=new M.a,i._config=a,i._ctx=e,i._mainStage=new fi(e),i._subStage=new fi(e),i._matSynced=!1,i._stageSyncingAudioIS=null,i._stageSyncingAudioSegment=null,i.shouldSendMatInitSegment=!0,i._bindEvents(),i}return f()(t,e),s()(t,[{key:"mainStage",get:function(){return this._mainStage}},{key:"subStage",get:function(){return this._subStage}},{key:"playingStream",get:function(){var e=null;return this._mainStage&&(e=this._mainStage.playingStream),e}},{key:"currentTime",set:function(e){var t=this.playingStream;t&&(t.currentTime=e,this._mainStage.tryToSwitchStream(!1))}},{key:"duration",get:function(){var e=this.playingStream;return e?e.duration:0}},{key:"eof",get:function(){var e=!1,t=this._mainStage,i=this.playingStream;if(this.isRolling||this.isPatching)e=i.eof;else{var a=t.movieStream;a&&(e=a.eof)&&this.matEnabled&&(e=null===this._stageSyncingAudioSegment||t.matStream.eof)}return e}},{key:"eod",get:function(){var e=!1,t=this._mainStage,i=this.playingStream;if(this.isRolling||this.isPatching)e=i.eod;else{var a=t.movieStream;a&&(e=a.eod)&&this.matEnabled&&(e=t.matStream.eod)}return e}},{key:"preloaded",get:function(){return!!this._subStage&&this._subStage.size>0}},{key:"mediaRanges",get:function(){var e=new di.a,t=this._mainStage,i=this.playingStream;if(this.isRolling||this.isPatching)e=i.mediaRanges;else{var a=t.movieStream;a&&(e=a.mediaRanges)}return e}},{key:"playRanges",get:function(){var e=new di.a,t=this._mainStage,i=this.playingStream;if(this.isRolling||this.isPatching)e=i.playRanges;else{var a=t.movieStream;a&&(e=a.playRanges)}return e}},{key:"error",get:function(){var e=null,t=this._mainStage,i=this.playingStream;if(this.isRolling||this.isPatching)e=i.error;else{var a=t.movieStream;a&&(e=a.error),!e&&this.matEnabled&&(e=t.matStream.error)}return e}},{key:"matEnabled",get:function(){var e=this._mainStage.matStream;return!!e&&e.enabled}},{key:"isRolling",get:function(){var e=!1;return this.mainStage&&(e=this.mainStage.isRolling),e}},{key:"rollingType",get:function(){var e=null;return this.mainStage&&(e=this.mainStage.rollingType),e}},{key:"isPatching",get:function(){var e=!1;return this.mainStage&&(e=this.mainStage.isPatching),e}},{key:"isLast",get:function(){var e=!1;return this.mainStage&&(e=this.mainStage.isLast),e}},{key:"reBufTime",get:function(){return this.playingStream?this.playingStream.reBufTime:0}},{key:"openReBufTime",set:function(e){this.playingStream&&(this.playingStream.openReBufTime=e)}}]),s()(t,[{key:"_bindEvents",value:function(){this._eventManager.on(this._mainStage,fi.Events.PLAYING_STREAM_CHANGED,this._onStageStreamChanged.bind(this)),this._eventManager.on(this._mainStage,fi.Events.PLAYING_STREAM_PROGRESS,this._onStageStreamProgress.bind(this)),this._eventManager.on(this._mainStage,fi.Events.ROLL_EOD,this._onRollEOD.bind(this)),this._eventManager.on(this._mainStage,fi.Events.MOVIE_EOD,this._onMovieEOD.bind(this)),this._eventManager.on(this._mainStage,fi.Events.STAGE_BEGIN,this._onStageBegin.bind(this)),this._eventManager.on(this._mainStage,fi.Events.STAGE_END,this._onStageEnd.bind(this))}},{key:"_unbindEvents",value:function(){this._eventManager.removeAll()}},{key:"configure",value:function(e){e.datasource&&Object(V.a)(this._config,e.datasource,!0,!0)}},{key:"loadRoll",value:function(e,t,i){var a,n=this._ctx,r=this._mainStage,s=t.isAD,o=t.rollType;if(L.a.log("datasource loadRoll, done=".concat(i,", isAd=").concat(s)),"boolean"!=typeof t.isAD&&(s=t.isAD=!1),s){if(o===oi.BRIEF_ROLL){if(a=r.latestBriefRollStream,i||(a=new ci(n,!1)),i=!0,!a||a&&a.done&&i)return}else if((a=r.rollStream)||i||(a=new ui(n,!1)),!a||a&&a.done&&i)return}else{if(a=r.patchStream)return void L.a.log("datasource loadRoll error, has patchStream");a=new ui(n,!1)}var d=!a.filled;a.push({playSourceType:e,playSourceContent:t,done:i}),a.refreshFrags(),r.has(a)||r.add(a),d&&a.seek(0),i&&n.emit(ae.a.MANIFEST_LOADED)}},{key:"preloadRoll",value:function(e,t,i){var a=this._ctx,n=this._subStage,r=n.rollStream;if(L.a.log("datasource preloadRoll, done=".concat(i,",type=").concat(t.type)),r||i||(r=new ui(a,!0)),r&&!(r&&r.done&&i)){var s=!r.filled;r.push({playSourceType:e,playSourceContent:t,done:i}),r.refreshFrags(),s&&r.seek(0),n.has(r)||n.add(r)}}},{key:"load",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,a=arguments.length>3?arguments[3]:undefined,n=arguments.length>4&&arguments[4]!==undefined&&arguments[4],r=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null,s=this._ctx,o=this._mainStage,d=o.movieStream,u=this.bufferInfo();if(d||(d=new si(s,!1)),L.a.log("datasource load, isSwitchVariant=".concat(n)),d.push({isSwitchLevel:n,playSourceType:e,playSourceContent:t}),!n||i||a||(i=d.currentTime),d.range(i,a),o.has(d)||o.add(d),d.playRanges.length>0){if(d instanceof si){var c=d.playRanges.start(0),l=t.isClearBuffer===undefined||t.isClearBuffer;if(n){var h=e===O.a.JDASH||e===O.a.DASH_VP9||e===O.a.DASH_AV1;if(h){var _=u.buffered;if(_){var f=_.video.start,p=_.audio.start;r&&(null!==r.video&&(f=r.video),null!==r.audio&&(p=r.audio)),(c=new Map).video=f,c.audio=p}}}d.seek(c,n,l)}}else s._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.UNSUPPORTED_PLAY_RANGE));s.emit(ae.a.MANIFEST_LOADED)}},{key:"preload",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,a=arguments.length>3?arguments[3]:undefined,n=this._ctx,r=this._subStage,s=r.movieStream;s||(s=new si(n,!0)),s.push({playSourceType:e,playSourceContent:t}),s.range(i,a),s.playRanges.length>0&&s instanceof si&&s.seek(s.playRanges.start(0)),r.has(s)||r.add(s),L.a.log("datasource preload , duration = ".concat(s.duration))}},{key:"loadAltAudio",value:function(e){var t,a,n,r,s,o,d=arguments;return q.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return t=d.length>1&&d[1]!==undefined?d[1]:null,u.next=3,q.a.awrap(i.e(2).then(i.bind(null,584)));case 3:a=u.sent["default"],n=this._ctx,r=this._mainStage,s=r.movieStream,(o=r.matStream)||(o=new a(this._ctx)),r.has(o)||r.add(o),e?(o.enabled=!0,this._matSynced=!1,o.push({playSourceContent:e,trackId:s.audioTrackId}),o.range(t,s.mediaRanges.toArray()),o.playRanges.length<=0&&n._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DATA_SOURCE,ee.a.code.UNSUPPORTED_PLAY_RANGE))):(o.enabled=!1,o.reset(),s.needInitSegment=!0);case 10:case"end":return u.stop()}}),null,this)}},{key:"endOfPlayingStream",value:function(){this.mainStage.endOfPlayingStream()}},{key:"switchStage",value:function(){var e=this._ctx,t=this._mainStage,i=this._subStage;e.emit(ae.a.DATA_STAGE_SWITCHING),L.a.log("qvs.datasource , switchStage");var a=!0,n=!1,r=undefined;try{for(var s,o=t.values()[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){s.value.destroy()}}catch(f){n=!0,r=f}finally{try{a||null==o["return"]||o["return"]()}finally{if(n)throw r}}t.clear();var d=!0,u=!1,c=undefined;try{for(var l,h=i.values()[Symbol.iterator]();!(d=(l=h.next()).done);d=!0){var _=l.value;_.silenced=!1,t.add(_)}}catch(f){u=!0,c=f}finally{try{d||null==h["return"]||h["return"]()}finally{if(u)throw c}}i.clear(),e.emit(ae.a.DATA_STAGE_SWITCHED)}},{key:"seek",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2];e=parseFloat(e);var a=this._ctx,n=this._mainStage,r=this.playRanges,s=this.playingStream;a.recoverProcedure.progressing&&(a.recoverProcedure.status=a.recoverProcedure.levels.DATA_SEEKING),this.isRolling?s.seekable&&s.seek(e):(this.clearMatSyncState(),r.contain(e)||(n.movieStream.range(e),this.matEnabled&&n.matStream.range(e)),n.movieStream.seek(e,t,i),this.matEnabled&&n.matStream.seek(e))}},{key:"range",value:function(e){var t=this._mainStage,i=null,a=null;"number"==typeof e?(i=e,t.movieStream.range(i),this.matEnabled&&t.matStream.range(i)):Array.isArray(e)&&(a=e,t.movieStream.range(i,a),this.matEnabled&&t.matStream.range(i,a))}},{key:"pump",value:function(){var e=this._ctx,t=this._mainStage,i=this.matEnabled,a={video:null,audio:null},n=t.playingStream,r=t.movieStream,s=(t.rollStream,t.matStream);t.patchStream;if(e.error||!n)return a;if(this.isRolling||this.isPatching){if(!n.eof){var o=n.read();a.video=o.video,a.audio=o.audio}}else if(i){if(!r.eof&&!this._stageSyncingAudioSegment){var d=r.read();d.video&&(a.video=d.video),d.audio&&(d.audio instanceof X.a?this._stageSyncingAudioIS=d.audio:d.audio instanceof Z.a&&(this._stageSyncingAudioSegment=d.audio))}if(!s.eof&&!this._matSynced){var u,c=[];!this.shouldSendMatInitSegment&&this._stageSyncingAudioSegment&&(c=[this._stageSyncingAudioSegment.startTime,this._stageSyncingAudioSegment.duration]),(u=s.read.apply(s,w()(c)))&&(u instanceof Z.a?(a.audio=u,this._matSynced=!0):u instanceof X.a&&(a.audio=u,this.shouldSendMatInitSegment=!1))}this._matSynced&&this.clearMatSyncState()}else if(!r.eof)if(this._stageSyncingAudioIS)a.video=null,a.audio=this._stageSyncingAudioIS,this._stageSyncingAudioIS=null;else if(this._stageSyncingAudioSegment)a.video=null,a.audio=this._stageSyncingAudioSegment,this._matSynced=!1,this._stageSyncingAudioSegment=null;else{var l=r.read();l&&(a.video=l.video,a.audio=l.audio)}return a}},{key:"bufferInfo",value:function(){return this.playingStream?this.playingStream.buffer:{len:0,start:0,end:0,buffered:null}}},{key:"recoverImmediately",value:function(e){var t=this._ctx,i=this._mainStage,a=this.playingStream,n=this.matEnabled;a&&(a.needInitSegment=!0,"p2p"===a.loaderMode&&t.p2pLoader.recover&&t.p2pLoader.recover(e),a.eof?a.seek(e):a.recoverImmediately(e)),n&&i.matStream.recoverImmediately(e)}},{key:"reset",value:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=this._mainStage.values()[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){a.value.destroy()}}catch(c){t=!0,i=c}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}this._mainStage.clear();var r=!0,s=!1,o=undefined;try{for(var d,u=this._subStage.values()[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){d.value.destroy()}}catch(c){s=!0,o=c}finally{try{r||null==u["return"]||u["return"]()}finally{if(s)throw o}}this._subStage.clear()}},{key:"destroy",value:function(){this._unbindEvents();var e=!0,t=!1,i=undefined;try{for(var a,n=this._mainStage.values()[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){a.value.destroy()}}catch(c){t=!0,i=c}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}this._mainStage.clear(),this._mainStage=null;var r=!0,s=!1,o=undefined;try{for(var d,u=this._subStage.values()[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){d.value.destroy()}}catch(c){s=!0,o=c}finally{try{r||null==u["return"]||u["return"]()}finally{if(s)throw o}}this._subStage.clear(),this._subStage=null}},{key:"getSegmentByPTS",value:function(e){var t=null;return this.playingStream&&(t=this.playingStream.getSegmentByPTS(e)),t}},{key:"openAdLoadStart",value:function(){var e=this.playingStream;e.openLoadStart&&e.openLoadStart()}},{key:"getCurrentADGas",value:function(){return this.isRolling?this.playingStream.getCurrentADGas():undefined}},{key:"getAdCurrentTime",value:function(){return this.isRolling&&this._mainStage?this.playingStream.currentTime:0}},{key:"abortCurrentADGas",value:function(){return!!this.isRolling&&this.playingStream.abortCurrentADGas()}},{key:"_onStageStreamChanged",value:function(){this.shouldSendMatInitSegment=!0,this.emit("stream_start")}},{key:"_onStageStreamProgress",value:function(){this.emit(ae.a.STATE_CHANGE,{state:"progress"})}},{key:"_onMovieEOD",value:function(){this.emit(ae.a.STATE_CHANGE,{state:"EOM"})}},{key:"_onRollEOD",value:function(){this.emit(ae.a.STATE_CHANGE,{state:"EOR"})}},{key:"_onStageBegin",value:function(){}},{key:"_onStageEnd",value:function(){this.preloaded&&this.switchStage()}},{key:"deleteEndPatch",value:function(){var e=this.mainStage;!this.isPatching&&e.patchStream&&(L.a.log("datasource removeRoll, patchStream"),e["delete"](e.patchStream))}},{key:"noticeActorPump",value:function(){this.playingStream&&this.playingStream.noticeActorPump()}},{key:"noticeP2PCheckData",value:function(){this.playingStream&&this.playingStream.noticeP2PCheckData()}},{key:"clearMatSyncState",value:function(){this._matSynced=!1,this._stageSyncingAudioIS=null,this._stageSyncingAudioSegment=null}}]),t}(ne.a),gi=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).ctx=e||h()(i),i._parser=null,i}return f()(t,e),s()(t,[{key:"manifestType",get:function(){var e,t=this._parser;return t&&(t instanceof Ot?e=O.a.HLS:t instanceof xt?e=t.manifestType:t instanceof qe&&(e=O.a.JDASH)),e}},{key:"parser",get:function(){return this._parser}},{key:"duration",get:function(){return this._parser?this._parser.duration:0}},{key:"segments",get:function(){return this._parser?this._parser.segments:[]}},{key:"tracks",get:function(){return this._parser?this._parser.tracks:null}},{key:"isAccurateTimeStamp",get:function(){return this._parser?this._parser.isAccurateTimeStamp:null}}]),s()(t,[{key:"push",value:function(e){switch(e.type){case O.a.HLS:this._parser=new Ot(this.ctx);break;case O.a.JDASH:this._parser=new qe;break;case O.a.DASH_VP9:case O.a.DASH_AV1:this._parser=new xt(this.ctx);break;case O.a.MP4:this._parser=new ni(this.ctx)}this._parser&&this._parser.push(e.chunk)}},{key:"end",value:function(){this._parser&&"function"==typeof this._parser.end&&this._parser.end()}},{key:"reset",value:function(){this._parser&&this._parser.reset()}}]),t}(H.a),mi=i(112),vi=i.n(mi),bi=function(e){function t(e){var i;n()(this,t),(i=d()(this,c()(t).call(this))).ctx=e.ctx,i.media=e;for(var a=arguments.length,r=new Array(a>1?a-1:0),s=1;s<a;s++)r[s-1]=arguments[s];return i.handledEvents=r,i.injectListeners(),i}return f()(t,e),s()(t,[{key:"destroy",value:function(){this.unInjectListeners()}},{key:"injectListeners",value:function(){var e=this;this.handledEvents.forEach((function(t){if(t===undefined)throw new Error("Event type ".concat(t," in this ").concat(e.constructor.name," class @super"));e.media.on(t,e._onEvent.bind(e))}),this)}},{key:"unInjectListeners",value:function(){var e=this;this.handledEvents.forEach((function(t){e.media.off(t,e._onEvent)}),this)}},{key:"_onEvent",value:function(e){var t=e.replace(/^qvs/gi,"on");if("function"!=typeof this[t])throw new Error("Event ".concat(e," has no generic handler in this ").concat(this.constructor.name," class (tried ").concat(t,")"));try{for(var i,a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];(i=this[t].bind(this)).call.apply(i,[this].concat(n))}catch(s){L.a.error(s.stack?s.stack:s)}}}]),t}(ne.a),yi=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.MSE_ATTACHING,ae.a.MSE_ATTACHED)))._eventManager=new M.a,a._video=i,a._playheadTime=a.currentTime,a._bind(),a}return f()(t,e),s()(t,[{key:"seeking",get:function(){return this._video.seeking}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.ctx;var t=this.readyState;Object(U.f)(e)&&(this._playheadTime=e,t>0&&(this._video.currentTime=e))}},{key:"playHeadTime",get:function(){return this._playheadTime}},{key:"duration",get:function(){return this._video.duration}},{key:"buffered",get:function(){return this._video.buffered}},{key:"error",get:function(){return this._video.error}},{key:"readyState",get:function(){return this._video.readyState}},{key:"paused",get:function(){return this._video.paused}},{key:"ended",get:function(){return this._video.ended}},{key:"playbackRate",get:function(){var e=this._video.playbackRate;return"number"!=typeof e&&(e=1),e}},{key:"playbackQuality",get:function(){var e=this._video,t=0,i=0,a=0;if("function"==typeof e.getVideoPlaybackQuality){var n=e.getVideoPlaybackQuality();i=n.totalVideoFrames,a=n.droppedVideoFrames,t=i}else{var r=e.webkitDecodedFrameCount,s=e.webkitDroppedFrameCount;void 0!==r&&void 0!==s&&(a=s,t=i=r)}return{totalVideoFrames:t,decodedVideoFrames:i,droppedVideoFrames:a}}}]),s()(t,[{key:"destroy",value:function(){this._unbind(),this.reset(),this._video=null}},{key:"reset",value:function(){this._playing=!1}},{key:"pause",value:function(){this._video.pause()}},{key:"onMSEAttaching",value:function(e){this._playheadTime=0,this._video.load(),this._video.src=URL.createObjectURL(e)}},{key:"onMSEAttached",value:function(){URL.revokeObjectURL(this._video.src)}},{key:"_bind",value:function(){var e=this._video;this._eventManager.on(e,"error",this._onError.bind(this)),this._eventManager.on(e,"encrypted",this._onEncrypted.bind(this)),this._eventManager.on(e,"canplay",this._onCanplay.bind(this)),this._eventManager.on(e,"loadstart",this._onLoadstart.bind(this)),this._eventManager.on(e,"loadedmetadata",this._onLoadedMetadata.bind(this)),this._eventManager.on(e,"playing",this._onPlaying.bind(this)),this._eventManager.on(e,"waiting",this._onWaiting.bind(this)),this._eventManager.on(e,"pause",this._onPause.bind(this)),this._eventManager.on(e,"ended",this._onEnded.bind(this)),this._eventManager.on(e,"timeupdate",this._onTimeUpdate.bind(this)),this._eventManager.on(e,"seeking",this._onSeeking.bind(this)),this._eventManager.on(e,"seeked",this._onSeeked.bind(this))}},{key:"_unbind",value:function(){this._eventManager.removeAll()}},{key:"_onError",value:function(){var e=this.ctx,t=this._video;if(t.error){var i=t.error.code,a=t.error.msExtendedCode,n=t.error.message;switch(i){case 1:break;case 2:case 3:case 4:a&&(a<0&&(a+=Math.pow(2,32)),a=a.toString(16)),L.a.error("video error, code(".concat(i,"), message(").concat(n,"), extended(").concat(a,")")),e._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.MEDIA,ee.a.code.MEDIA_VIDEO_ERROR,i,n,a))}}}},{key:"_onTimeUpdate",value:function(){var e=this.media,t=this.currentTime,i=this.duration,a=this._video,n=this.readyState;if(!(this.paused||n<=1||this._playheadTime===t)){var r=this,s=e.appendWindowEnd;this._playheadTime=t,t>0&&t>=s&&!this.seeking?(a.addEventListener("pause",(function o(){a.removeEventListener("pause",o,!1),r._noticeStreamStop("timer")}),!1),this.pause()):n>=3&&this._onPlaying({_isSimulating:!0}),t+.5>i&&e.emit(ae.a.STATE_CHANGE,{state:"willended"}),e.emit(ae.a.STATE_CHANGE,{state:"timeupdate"})}}},{key:"_onLoadstart",value:function(){this.media.emit(ae.a.STATE_CHANGE,{state:"loadstart"})}},{key:"_onLoadedMetadata",value:function(){this.media.emit(ae.a.STATE_CHANGE,{state:"loadedmetadata"})}},{key:"_onCanplay",value:function(){this.media.emit(ae.a.STATE_CHANGE,{state:"canplay"})}},{key:"_onSeeking",value:function(){var e=this.media;this._playing=!1,this._playheadTime=this._video.currentTime,e.emit(ae.a.STATE_CHANGE,{state:"seeking"})}},{key:"_onSeeked",value:function(){this.media.emit(ae.a.STATE_CHANGE,{state:"seeked"})}},{key:"_onPause",value:function(){var e=this.media;this._playing=!1,e.emit(ae.a.STATE_CHANGE,{state:"pause"})}},{key:"_onEnded",value:function(){var e=this.media;e.emit(ae.a.STATE_CHANGE,{state:"beforeended"}),e.emit(ae.a.STATE_CHANGE,{state:"ended"}),e.emit(ae.a.STATE_CHANGE,{state:"afterended"})}},{key:"_onPlaying",value:function(e){var t=this.media;!this._playing&&(!e._isSimulating&&this.readyState>1||e._isSimulating)&&(this._playing=!0,t.emit(ae.a.STATE_CHANGE,{state:"playing"}))}},{key:"_onWaiting",value:function(){var e=this.media;this._playing=!1,e.emit(ae.a.STATE_CHANGE,{state:"waiting"})}},{key:"_onEncrypted",value:function(e){this.media.emit(ae.a.STREAM_ENCRYPTED,e)}},{key:"_noticeStreamStop",value:function(e){L.a.log("stream stop, by the ".concat(e)),this._onEnded()}}]),t}(bi),ki=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.BUFFER_APPENDING)))._video=i,a._eventManager=new M.a,a._sourceBuffers={},a}return f()(t,e),s()(t,[{key:"readyState",get:function(){return this.mse?this.mse.readyState:""}},{key:"duration",get:function(){return this.mse?this.mse.duration:0},set:function(e){this.mse.duration=e}},{key:"sourceBuffers",get:function(){return this.mse?this.mse.sourceBuffers:null}}],[{key:"probeSupport",value:function(){var e={};if(MediaSource&&MediaSource.isTypeSupported){['video/webm; codecs="vp09.00.40.08"','video/webm; codecs="av01.0.08M.08"'].forEach((function(t){try{e[t]=MediaSource.isTypeSupported(t);var i=t.split(";")[0];e[i]=e[i]||e[t]}catch(a){}}))}return e}}]),s()(t,[{key:"reset",value:function(){this._removeSourceBuffers(),this.detachMediaElement(),this._unbind(),this._sourceOpenEventTrulyFired=!1,L.a.log("new MediaSource"),this.mse=new MediaSource,this._bind(),this.attachMediaElement()}},{key:"destroy",value:function(){this._unbind(),this._eventManager.destroy(),this._sourceOpenEventTrulyFired=!1,this._sourceBuffers=null,this._eventManager=null,this._video=null,this.mse=null}},{key:"endOfStream",value:function(){var e=this.media,t=this.mse,i="open"===t.readyState,a=e.readyState>=1;if(i&&a)return L.a.log("end of stream!"),t.endOfStream(),!0;var n="no reason";return i?a||(n="video readyState(".concat(e.readyState,") has no metadata")):n="mediaSource readyState is ".concat(t.readyState),L.a.log("end of stream, but ".concat(n)),!1}},{key:"attachMediaElement",value:function(){var e=this.media,t=this.mse;e.emit(ae.a.MSE_ATTACHING,t)}},{key:"detachMediaElement",value:function(){var e=this.media,t=this.mse;e.emit(ae.a.MSE_DETACHING,t)}},{key:"onBufferAppending",value:function(e){for(var t=this._sourceBuffers,i=!1,a=0;a<e.length;a++){var n=e[a],r=n.type;t[r]||(t[r]={created:!1,sourceBuffer:null,segment:n},i=!0)}i&&this._createSourceBuffers()}},{key:"_createSourceBuffers",value:function(){var e=this.ctx,t=this.media,i=this.mse,a=this._sourceBuffers,n=this._sourceOpenEventTrulyFired;if("open"===i.readyState){if(n&&!Object(U.c)(a)){var r={};for(var s in a){var o=a[s],d=o.segment,u=void 0;if(!o.created)try{var c="".concat(d.container,";codecs=").concat(d.codec);L.a.log("creating sourceBuffer(".concat(c,")")),u=i.addSourceBuffer("".concat(c)),o.created=!0,o.sourceBuffer=u}catch(l){return L.a.error("mse add source error ".concat(l.stack||l.message)),e._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.MEDIA,ee.a.code.MEDIA_SOURCE_OPERATION_FAILED))}"video"===s?r.videoSourceBuffer=u:"audio"===s&&(r.audioSourceBuffer=u)}t.emit(ae.a.BUFFER_CREATED,r)}}else L.a.error("mse create buffers failure, readyState: ".concat(i.readyState))}},{key:"_removeSourceBuffers",value:function(){this.ctx;var e=this.mse,t=this._sourceBuffers;for(var i in t){var a=t[i],n=a.sourceBuffer;a.sourceBuffer=null;try{a.created&&n&&e.removeSourceBuffer(n)}catch(r){}}this._sourceBuffers={}}},{key:"_bind",value:function(){var e=this.mse;this._eventManager.on(e,"error",this._onError.bind(this)),this._eventManager.on(e,"opened",this._onOpened.bind(this)),this._eventManager.on(e,"closed",this._onClosed.bind(this)),this._eventManager.on(e,"sourceopen",this._onSourceOpened.bind(this)),this._eventManager.on(e,"sourceended",this._onSourceEnded.bind(this))}},{key:"_unbind",value:function(){this._eventManager.removeAll()}},{key:"_onError",value:function(){}},{key:"_onOpened",value:function(){}},{key:"_onClosed",value:function(){this.media,this.mse}},{key:"_onSourceOpened",value:function(){var e=this.media,t=this.mse;t.sourceBuffers&&t.sourceBuffers.length>0?L.a.log("media source opened error , bufferlength = ".concat(t.sourceBuffers.length)):(this._sourceOpenEventTrulyFired=!0,L.a.log("media source opened"),e.emit(ae.a.MSE_ATTACHED,t),t.removeEventListener("sourceopen",this._onSourceOpened),this._createSourceBuffers())}},{key:"_onSourceEnded",value:function(){}}]),t}(bi),Ti=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.BUFFER_APPENDING,ae.a.BUFFER_FLUSHING,ae.a.BUFFER_CREATED,ae.a.MSE_DETACHING)))._video=i,a._eventManager=new M.a,a._sourceBuffersCreated=!1,a.videoSourceBuffer=null,a.audioSourceBuffer=null,a._videoAddBufs=[],a._audioAddBufs=[],a._videoDelBufs=[],a._audioDelBufs=[],a._appendWindowStart=0,a._appendWindowEnd=Number.POSITIVE_INFINITY,a._appendTimer=new re.a((function(){return a._checkAppend()})),a._audioAppendStarted=a.videoAppendStarted=!1,a}return f()(t,e),s()(t,[{key:"updating",get:function(){return this.audioBufferUpdating||this.videoBufferUpdating||this._videoAppendStarted||this._audioAppendStarted}},{key:"videoBufferUpdating",get:function(){var e=this.videoSourceBuffer;return!!e&&e.updating}},{key:"audioBufferUpdating",get:function(){var e=this.audioSourceBuffer;return!!e&&e.updating}},{key:"sourceBuffersCreated",get:function(){return this._sourceBuffersCreated}},{key:"hasVideoBuffer",get:function(){return!!this.videoSourceBuffer}},{key:"hasAudioBuffer",get:function(){return!!this.audioSourceBuffer}},{key:"audioAppendStart",get:function(){if(Array.isArray(this._audioAddBufs)){var e=this._audioAddBufs[0];if(e instanceof Z.a)return e.startTime}return null}},{key:"videoAppendStart",get:function(){if(Array.isArray(this._videoAddBufs)){var e=this._videoAddBufs[0];if(e instanceof Z.a)return e.startTime}return null}},{key:"hasOperateBufferData",get:function(){var e=!1;return(this._videoAddBufs&&this._videoAddBufs.length>0||this._audioAddBufs&&this._audioAddBufs.length>0||this._videoDelBufs&&this._videoDelBufs.length>0||this._audioDelBufs&&this._audioDelBufs.length>0)&&(e=!0),e}},{key:"empty",get:function(){var e=this.videoSourceBuffer,t=this.audioSourceBuffer;return(!e||e&&0===e.buffered.length)&&(!t||t&&0===t.buffered.length)}},{key:"appendWindowEnd",get:function(){return this._appendWindowEnd},set:function(e){this._appendWindowEnd=e}},{key:"appendWindowStart",get:function(){return this._appendWindowStart},set:function(e){this._appendWindowStart=e}}]),s()(t,[{key:"existInMSE",value:function(e){var t=this.media._m.sourceBuffers,i=!1;if(Object(U.b)(t))for(var a=0;a<t.length;a++)if(t[a]===e){i=!0;break}return i}},{key:"reset",value:function(){[this._videoAddBufs,this._videoDelBufs,this._audioAddBufs,this._audioDelBufs].forEach((function(e){e.length>0&&e.splice(0,e.length)})),this._unbind(),this._appendTimer.cancel(),this._sourceBuffersCreated=!1,this.videoSourceBuffer=null,this.audioSourceBuffer=null,this._videoAppendStarted=this._audioAppendStarted=!1,this._appendWindowStart=0,this._appendWindowEnd=Number.POSITIVE_INFINITY}},{key:"destroy",value:function(){this.reset(),this._video=null,this._appendTimer=null,this._videoAddBufs=this._audioAddBufs=this._videoDelBufs=this._audioDelBufs=null,this._onUpdate=this._onUpdateStart=this._onUpdateEnd=this._onError=this._onAbort=null}},{key:"abort",value:function(){var e=this.media,t=this.videoSourceBuffer,i=this.audioSourceBuffer,a=this.videoBufferUpdating,n=this.audioBufferUpdating,r=e._m.sourceBuffers;if("open"===e._m.readyState&&Object(U.b)(r)&&r.length>0){if(a&&this.existInMSE(t))try{t.abort()}catch(s){L.a.warn("video source buffer abort error, ".concat(s?s.message||s:""))}if(n&&this.existInMSE(i))try{i.abort()}catch(s){L.a.warn("audio source buffer abort error, ".concat(s?s.message||s:""))}}}},{key:"withinBuffer",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,a=this.audioSourceBuffer,n=this.videoSourceBuffer,r=[],s=[];return this.existInMSE(a)&&r.push(a),this.existInMSE(n)&&r.push(n),r.forEach((function(a){for(var n=a.buffered,r=0;r<n.length;r++)if(e>=n.start(r)+t&&e<n.end(r)-i){s.push(!0);break}})),s.length===r.length}},{key:"bufferInfo",value:function(e,t,i){var a,n,r=this.ctx,s=this.media,o=this.videoSourceBuffer,d=this.audioSourceBuffer,u=[];switch(i){case"video":a=this.existInMSE(o)?o.buffered:null;break;case"audio":a=this.existInMSE(d)?d.buffered:null;break;default:r.currentManifestType===O.a.DASH_VP9||r.currentManifestType===O.a.DASH_AV1?s.readyState>0&&s.buffered&&(a=s.buffered):this._video&&(a=this._video.buffered)}if(a)for(n=0;n<a.length;n++)u.push({start:a.start(n),end:a.end(n)});return this.bufferedInfo(u,e,t)}},{key:"bufferedInfo",value:function(e,t,i){var a,n,r,s,o,d=[];for(e.sort((function(e,t){var i=e.start-t.start;return i||t.end-e.end})),o=0;o<e.length;o++){var u=d.length;if(u){var c=d[u-1].end;e[o].start-c<i?e[o].end>c&&(d[u-1].end=e[o].end):d.push(e[o])}else d.push(e[o])}for(o=0,a=0,n=r=t;o<d.length;o++){var l=d[o].start,h=d[o].end;if(t+i>=l&&t<h)n=l,a=(r=h)-t;else if(t+i<l){s=l;break}}return{len:a,start:n,end:r,nextStart:s}}},{key:"intersectBuffer",value:function(e,t,i){var a=!1;if(e)for(var n,r,s=e.buffered,o=0;o<s.length;o++)if(n=s.start(o),r=s.end(o),!(i<=n||t>=r)){a=!0;break}return a}},{key:"onMSEDetaching",value:function(){this.abort()}},{key:"onBufferCreated",value:function(e){this._unbind(),this._sourceBuffersCreated=!0,this.existInMSE(e.videoSourceBuffer)&&(this.videoSourceBuffer=e.videoSourceBuffer),this.existInMSE(e.audioSourceBuffer)&&(this.audioSourceBuffer=e.audioSourceBuffer),this._bind(),this._checkAppend()}},{key:"onBufferAppending",value:function(e){for(var t=this,i=function(i){var a=e[i],n=a.type;a.bytesArray.forEach((function(e){switch(n){case"video":t._videoAddBufs.push(e);break;case"audio":t._audioAddBufs.push(e)}}))},a=0;a<e.length;a++)i(a);this.appending()}},{key:"onBufferFlushing",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"",a=this.media,n=this.empty,r=this.videoSourceBuffer,s=this.audioSourceBuffer;n||"closed"===a._m.readyState?setTimeout((function(){a.emit(ae.a.BUFFER_FLUSHED)}),10):(!r||""!==i&&"video"!==i||this._videoDelBufs.push({start:e,end:t}),!s||""!==i&&"audio"!==i||this._audioDelBufs.push({start:e,end:t}),this.flushing())}},{key:"appending",value:function(){var e=this,t=this.ctx,i=this.media,a=this.videoSourceBuffer,n=this.audioSourceBuffer;if(!i.error)if("closed"!==i._m.readyState)for(var r=[{contentType:"video",sb:a,adds:this._videoAddBufs},{contentType:"audio",sb:n,adds:this._audioAddBufs}],s=0;s<r.length;s++){var o=r[s],d=o.sb,u=!1;if(o.adds.length>0&&d&&!d.updating)if("break"===function(){var a=o.adds.shift(),n=a.byteLength,r=o.contentType;"video"===r?e._videoAppendStarted=!0:"audio"===r&&(e._audioAppendStarted=!0);try{d._bufferedLength=d.buffered.length,d._updateType="+",d.appendBuffer(a)}catch(s){L.a.warn("".concat(r," sourceBuffer, append/currentTime/readyState(").concat(n,"/").concat(e._video.currentTime,"/").concat(i.readyState,"): ").concat(s.stack||s.message)),u=!0,setTimeout((function(){22===s.code?t._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.MEDIA,ee.a.code.MEDIA_QUOTA_EXCEEDED,r)):t._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.MEDIA,ee.a.code.MEDIA_SOURCE_OPERATION_THREW,r,s))}),0)}if(u)return"break"}())break}else this._appendTimer.cancel(),this._appendTimer.schedule(.1)}},{key:"flushing",value:function(){var e=this,t=this.media,i=this.audioSourceBuffer,a=this.videoSourceBuffer,n=t._m.readyState,r=!1;return[i,a].forEach((function(t){if(e.existInMSE(t))if("closed"===n||t.updating)"open"!==n&&L.a.warn("flushing sb.updating: ".concat(t.updating,", mediaSource state: ").concat(n));else{for(var a,s=t===i?"audio":"video",o=t===i?e._audioDelBufs:e._videoDelBufs;o.length&&(a=o.shift(),!e.intersectBuffer(t,a.start,a.end));)a=null;a&&(a.end===Number.POSITIVE_INFINITY&&(a.end=t.buffered.end(t.buffered.length-1)),t._bufferedLength=t.buffered.length,t._updateType="-",r=!0,L.a.log("flushing ".concat(s," [").concat(a.start,",").concat(a.end,"] of ").concat(t.buffered.length," ranges, pos:").concat(e._video.currentTime)),t.remove(a.start,a.end))}})),r}},{key:"_bind",value:function(){var e=this,t=this.videoSourceBuffer,i=this.audioSourceBuffer,a=[];this.existInMSE(t)&&a.push({contentType:"video",sourceBuffer:t}),this.existInMSE(i)&&a.push({contentType:"audio",sourceBuffer:i}),a.forEach((function(t){var i=t.contentType,a=t.sourceBuffer;e._eventManager.on(a,"updatestart",e._onUpdateStart.bind(e)),e._eventManager.on(a,"update",e._onUpdate.bind(e)),e._eventManager.on(a,"updateend",e._onUpdateEnd.bind(e)),e._eventManager.on(a,"abort",e._onAbort.bind(e)),e._eventManager.on(a,"error",e._onError.bind(e,i))}))}},{key:"_unbind",value:function(){this._eventManager.removeAll()}},{key:"_onUpdateStart",value:function(e){var t=this.videoSourceBuffer,i=this.audioSourceBuffer,a=undefined,n=e.target;t&&n===t?a="video":i&&n===i&&(a="audio"),L.a.log("".concat(a," source buffer update start"))}},{key:"_onUpdate",value:function(e){var t=this.videoSourceBuffer,i=this.audioSourceBuffer,a=(undefined,e.target);t&&a===t?("video",this._videoAppendStarted=!1):i&&a===i&&("audio",this._audioAppendStarted=!1)}},{key:"_onUpdateEnd",value:function(e){var t=this.media,i=this.videoSourceBuffer,a=this.audioSourceBuffer,n=undefined,r=undefined,s=e.target,o=s._bufferedLength;if(i&&s===i?n="video":a&&s===a&&(n="audio"),"+"===s._updateType?r="append":"-"===s._updateType&&(r="remove"),t.emit(ae.a.BUFFER_UPDATED,{target:s,sourceBufferType:n,operateType:r,previousBufferedLength:o}),this._videoDelBufs.length>0||this._audioDelBufs.length>0){if(this.flushing())return}else"-"===s._updateType&&(s._updateType="",this.media.emit(ae.a.BUFFER_FLUSHED));this._videoAddBufs.length>0||this._audioAddBufs.length>0?this.appending():"+"===s._updateType&&(s._updateType="",t.emit(ae.a.BUFFER_APPENDED)),L.a.log("".concat(n," source buffer update end"))}},{key:"_onAbort",value:function(){this._audioAppendStarted=this._audioAppendStarted=!1,L.a.warn("source buffer met abort.'")}},{key:"_onError",value:function(e,t){var i=this.ctx,a=t.timeStamp,n=t.target,r=t.currentTarget,s=t.srcElement,o=r||n||s||{},d=this._video.error?this._video.error.code:0;this._appendTimer.cancel(),this._audioAppendStarted=this.videoAppendStarted=!1,L.a.error("".concat(e," source buffer met error, video code(").concat(d,"), timeStamp(").concat(a,"), mode(").concat(o.mode,")")),i._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.MEDIA,ee.a.code.MEDIA_SOURCE_OPERATION_FAILED,d))}},{key:"_checkAppend",value:function(){(this._videoAddBufs.length>0||this._audioAddBufs.length>0)&&(this.appending(),this._appendTimer.schedule(.1))}},{key:"clearOperateBuffers",value:function(e){var t=!0,i=!0;"video"===e?t=!1:"audio"===e&&(i=!1),t&&this._audioAddBufs.length>0&&(this._audioAddBufs=[]),i&&this._videoAddBufs.length>0&&(this._videoAddBufs=[])}}]),t}(bi),Si=(i(150),i(151),"com.widevine.alpha"),Pi="com.microsoft.playready",xi="com.chromecast.playready",Ii=!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration),Ei=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.STREAM_ENCRYPTED))).LOG_TAG="<<EME>>",a.sessions=[],a.licenseRequests=[],a.drmInfo={},a._video=i,a._eventManager=new M.a,a}return f()(t,e),s()(t,[{key:"error",get:function(){return null}}],[{key:"probeSupport",value:function(){var e={},t=[];if(Ii){var i=[{videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}]}];[Si,Pi].forEach((function(a){var n=new Promise((function(t){var n=setTimeout((function(){r()}),1e3),r=function(){clearTimeout(n),t()};try{navigator.requestMediaKeySystemAccess(a,i).then((function(t){var i=t.getConfiguration().sessionTypes,n=!!i&&i.indexOf("persistent-license")>=0;e[a]={persistentState:n},r()}))["catch"]((function(){e[a]=null,r()}))}catch(s){r()}}));t.push(n)}))}return Promise.all(t).then((function(){return e}))}}]),s()(t,[{key:"destroy",value:function(){this._unbind(),this.reset(),this._video=null,this.licenseRequests=null,this.sessions=null,this.drmInfo=null}},{key:"reset",value:function(){var e=this.sessions,t=this.licenseRequests;if(e.length>0){for(var i=0;i<e.length;i++){var a=e[i].session;this._eventManager.off(a,"message"),this._eventManager.off(a,"keystatuseschange")}e.splice(0,e.length)}if(t.length>0){for(var n=0;n<t.length;n++)t[n]._destroyed=!0;t.splice(0,t.length)}}},{key:"setDrmInfo",value:function(e){this.drmInfo=e?{keySystem:e.keySystem,licenseServerUri:e.keySystemServer,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]}:{}}},{key:"_unbind",value:function(){this._eventManager.removeAll()}},{key:"onStreamEncrypted",value:function(e){var t,i,a,n,r,s;return q.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.ctx,i=this.LOG_TAG,a=this._video,n=new Uint8Array(e.initData),r=e.initDataType,L.a.log("".concat(i," Encrypted initDataType/initData(").concat(r,"/").concat(n.length,")")),o.prev=5,o.next=8,q.a.awrap(this._queryMediaKeys());case 8:s=o.sent,o.next=24;break;case 11:if(o.prev=11,o.t0=o["catch"](5),this._queryMediaKeysPromise=null,0!==o.t0){o.next=18;break}return o.abrupt("return",t._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE)));case 18:if(1!==o.t0){o.next=22;break}return o.abrupt("return",t._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_FAILED_TO_CREATE_CDM)));case 22:return L.a.error("".concat(i," queryMediaKeys unknown error: ").concat(Object(U.g)(o.t0)?o.t0.message:o.t0||"unknown")),o.abrupt("return",t._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,ee.a.code.DRM_NO_RECOGNIZED_ERROR)));case 24:return o.prev=24,o.next=27,q.a.awrap(this._setMediaKeys(a,s));case 27:if(a.mediaKeys){o.next=30;break}throw this._setMediaKeysPromise=null,"video.mediaKeys can't access";case 30:o.next=36;break;case 32:return o.prev=32,o.t1=o["catch"](24),L.a.error("".concat(i," setMediaKeys error: ").concat(Object(U.g)(o.t1)?o.t1.message:o.t1||"unknown")),o.abrupt("return",t._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_FAILED_TO_ATTACH_TO_VIDEO)));case 36:return o.prev=36,o.next=39,q.a.awrap(this._setServerCertificate(s));case 39:o.next=45;break;case 41:return o.prev=41,o.t2=o["catch"](36),L.a.warn("".concat(i," setServerCertificate fail: ").concat(o.t2.message)),o.abrupt("return",t._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_INVALID_SERVER_CERTIFICATE)));case 45:return o.prev=45,o.next=48,q.a.awrap(this._createSession(a,r,n));case 48:o.next=54;break;case 50:o.prev=50,o.t3=o["catch"](45),L.a.error("".concat(i," createSession unknown fail: ").concat(Object(U.g)(o.t3)?o.t3.message:o.t3||"unknown")),t._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,ee.a.code.DRM_NO_RECOGNIZED_ERROR));case 54:case"end":return o.stop()}}),null,this,[[5,11],[24,32],[36,41],[45,50]])}},{key:"_setServerCertificate",value:function(e){var t,i,a,n;return q.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.LOG_TAG,(i=this.drmInfo).keySystem===Si&&(i.serverCertificate=new Uint8Array([10,178,2,8,3,18,16,153,75,133,49,202,175,120,35,184,85,5,60,251,56,41,180,24,229,132,139,214,5,34,142,2,48,130,1,10,2,130,1,1,0,173,188,172,242,201,171,92,176,7,198,96,157,222,119,76,120,208,81,120,242,46,147,239,190,102,21,104,43,121,143,181,56,91,166,179,185,0,138,222,127,154,201,112,251,199,108,202,125,228,135,188,121,44,55,129,188,241,126,7,90,62,216,149,122,126,232,110,19,251,191,22,226,176,108,175,48,185,240,170,148,33,36,225,222,52,104,28,221,88,239,200,49,155,234,19,145,193,19,98,116,67,72,49,81,190,53,255,164,75,74,167,161,89,105,104,50,95,220,200,174,74,181,115,30,192,243,65,185,252,142,121,46,140,174,68,112,140,49,84,28,135,128,110,67,38,124,124,194,110,179,55,38,19,157,83,28,107,90,30,210,73,121,247,112,12,62,217,231,167,5,178,203,137,211,8,41,166,110,167,215,242,176,236,185,105,4,25,126,221,164,251,240,192,186,97,41,102,71,179,187,181,8,10,122,216,138,154,82,128,218,191,190,240,32,167,166,250,197,176,31,85,129,128,135,254,132,143,11,188,118,55,120,184,133,167,96,84,37,32,232,218,215,244,216,83,199,86,68,153,167,87,250,185,192,143,5,2,3,1,0,1,58,5,105,113,105,121,105,18,128,3,108,85,242,237,185,42,124,70,211,70,134,94,29,126,167,210,209,177,68,127,56,85,77,151,232,211,106,176,194,114,231,35,138,254,226,24,103,180,63,213,255,88,78,161,119,227,11,232,63,81,58,217,15,10,248,108,248,9,224,110,34,66,36,242,70,85,25,202,189,138,14,172,160,0,225,62,55,122,142,182,214,253,43,147,147,172,193,45,41,185,82,136,1,108,126,93,154,60,131,2,115,138,221,67,238,227,92,138,215,173,249,188,229,18,241,188,29,154,33,119,37,124,152,48,13,139,88,101,233,120,14,106,200,154,192,69,245,11,234,109,144,181,128,189,62,127,37,163,117,190,137,153,101,44,51,198,56,56,241,141,166,196,99,89,247,121,28,93,172,201,215,51,241,219,174,29,213,241,48,23,46,83,167,192,43,87,89,12,65,41,112,220,202,12,81,32,254,158,20,39,242,219,178,209,60,199,40,41,253,166,234,0,49,130,127,231,122,26,210,230,238,26,166,206,219,252,89,107,158,29,26,220,58,93,94,87,252,97,37,66,128,184,119,48,176,82,32,96,26,4,144,167,56,8,99,44,129,38,4,251,10,80,13,212,186,8,249,178,81,164,255,10,183,199,177,181,141,126,254,100,119,73,224,216,201,222,242,154,32,224,182,205,245,104,142,137,142,103,93,162,83,65,239,129,35,70,120,115,163,162,49,132,80,43,96,189,121,132,177,206,43,162,19,129,194,34,25,51,148,131,63,139,91,109,98,55,45,182,139,28,53,232,226,68,232,251,89,36,230,82,228,65,33,135,221,199,47,45,97,230,2,4,169,22,186,228,190,216,95,132,241,171,220,132,144,233,72,186,244,205,60,38,90,246])),!i.serverCertificate||!i.serverCertificate.length){r.next=9;break}return a=!1,this._setServerCertificatePromise||(this._setServerCertificatePromise=e.setServerCertificate(i.serverCertificate),a=!0),r.next=7,q.a.awrap(this._setServerCertificatePromise);case 7:n=r.sent,a&&(n?L.a.log("".concat(t," The server certificate has been set by the key system(").concat(i.keySystem,").")):L.a.warn("".concat(t," The server certificate has been ignored because it's not supported by the key system(").concat(i.keySystem,").")));case 9:case"end":return r.stop()}}),null,this)}},{key:"_queryMediaKeys",value:function(){var e=this.LOG_TAG,t=this.drmInfo;return this._queryMediaKeysPromise||(this._queryMediaKeysPromise=new Promise((function(i,a){var n=[];"undefined"==typeof MediaKeySystemAccess.prototype.getConfiguration?(L.a.warn("Detected obsolete navigator.requestMediaKeySystem options style."),n=[{initDataType:"cenc",distinctiveIdentifier:"optional",persistentState:"optional",videoType:'video/mp4; codecs="avc1.64001f"',audioType:'audio/mp4; codecs="mp4a.40.5"'}]):n=[{initDataTypes:["cenc"],distinctiveIdentifier:"optional",persistentState:"optional",videoCapabilities:[{contentType:'video/mp4; codecs="avc1.64001f"'}],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"'}]}],navigator.requestMediaKeySystemAccess(t.keySystem,n).then((function(e){e.getConfiguration();return e.createMediaKeys()}),(function(t){L.a.error("".concat(e," requestMediaKeySystemAccess fail: ").concat(Object(U.g)(t)?t.message:t||"unknown")),a(0)})).then((function(e){i(e)}),(function(t){L.a.error("".concat(e," createMediaKeys fail: ").concat(Object(U.g)(t)?t.message:t||"unknown")),a(1)}))}))),this._queryMediaKeysPromise}},{key:"_setMediaKeys",value:function(e,t){return q.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return this._setMediaKeysPromise||(this._setMediaKeysPromise=e.setMediaKeys(t)),i.abrupt("return",this._setMediaKeysPromise);case 2:case"end":return i.stop()}}),null,this)}},{key:"_createSession",value:function(e,t,i){var a,n,r,s,o;return q.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:a=this.ctx,n=this.LOG_TAG,r=this.sessions,s=0;case 2:if(!(s<r.length)){d.next=8;break}if(!Ee.equal(i,r[s].initData)){d.next=5;break}return d.abrupt("return",L.a.log("".concat(n," Ignoring duplicate init data.")));case 5:++s,d.next=2;break;case 8:d.prev=8,o=e.mediaKeys.createSession(),d.next=16;break;case 12:return d.prev=12,d.t0=d["catch"](8),L.a.error("".concat(n," ").concat(d.t0.message)),d.abrupt("return",a._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_FAILED_TO_CREATE_SESSION)));case 16:return r.push({initData:i,session:o,loaded:!1,oldExpiration:Infinity}),this._eventManager.on(o,"message",this._onMediaKeySessionMessage.bind(this)),this._eventManager.on(o,"keystatuseschange",this._onMediaKeySessionStatusChange.bind(this)),d.next=21,q.a.awrap(o.generateRequest(t,i)["catch"]((function(t){L.a.error("".concat(n," Session.generateRequest fail: ").concat(Object(U.g)(t)?t.message:t||"unknown",", video.mediaKeys is ").concat(e?I()(e.mediaKeys):"placeholder")),a._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_FAILED_TO_GENERATE_LICENSE_REQUEST))})));case 21:case"end":return d.stop()}}),null,this,[[8,12]])}},{key:"_onMediaKeySessionMessage",value:function(e){var t=this.LOG_TAG,i=this.ctx,a=this.media,n=this.drmInfo,r=this.licenseRequests,s=this._video,o=a._config,d=e.target,u=e.message,c=e.messageType,l=n.licenseServerUri;if(!l)return i._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,ee.a.code.DRM_NO_LICENSE_SERVER_GIVEN));L.a.log("".concat(t," Sending license request for session ").concat(d.sessionId," of type ").concat(c,": ").concat(l));var h=i.netProxy.makeRequestContext([l],Object(V.a)(o.drm.retryParameters,i.netProxy.defaultRetryParameters));h.method="POST",h.body=u,h.licenseRequestType=c,h.callbacks=Object(V.a)(h.callbacks,{onSuccess:function(e){var a,n,r;return q.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=e.data,!(204!==(n=e.status)&&a&&a.byteLength>0)){o.next=15;break}return r=new Uint8Array(a),L.a.log("".concat(t," License got, updating session ").concat(d.sessionId)),o.prev=4,o.next=7,q.a.awrap(d.update(r));case 7:o.next=13;break;case 9:o.prev=9,o.t0=o["catch"](4),L.a.error("".concat(t," update() failed, ").concat(o.t0.message,", video.mediaKeys is ").concat(s?I()(s.mediaKeys):"placeholder",", ").concat(r,",")),i._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.DRM,ee.a.code.DRM_LICENSE_RESPONSE_REJECTED,o.t0.message));case 13:o.next=16;break;case 15:i._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,204===n?ee.a.code.DRM_SERVER_REJECT_BY_LICENSE_SDK:ee.a.code.DRM_NO_LICENSE_SERVER_RESPONSE));case 16:case"end":return o.stop()}}),null,null,[[4,9]])},onError:function(){i._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,ee.a.code.DRM_LICENSE_REQUEST_ERROR))},onTimeout:function(e,t){i._emitError(new ee.a(ee.a.severity.CRITICAL,ee.a.category.DRM,ee.a.code.DRM_LICENSE_REQUEST_TIMEOUT))},onAbort:function(){},onComplete:function(){}},!0),n.keySystem!==Pi&&n.keySystem!==xi||this.unpackPlayReadyRequest_(h);var _=i.netProxy.request(_e.a.LICENSE,h);r.push(_)}},{key:"unpackPlayReadyRequest_",value:function(e){var t=Ie.fromUTF16(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var i=(new DOMParser).parseFromString(t,"application/xml"),a=i.getElementsByTagName("HttpHeader"),n=0;n<a.length;++n){var r=a[n].querySelector("name"),s=a[n].querySelector("value");e.headers[r.textContent]=s.textContent}var o=i.querySelector("Challenge");e.body=Ee.fromBase64(o.textContent).buffer}else e.headers["Content-Type"]="text/xml; charset=utf-8"}},{key:"_onMediaKeySessionStatusChange",value:function(e){var t=e.target,i=t.keyStatuses;if(this.drmInfo.keySystem==Pi)this._onSessionStatusChangePlayready(i,t.sessionId);else{var a=!0,n=!1,r=undefined;try{for(var s,o=i.entries()[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var d=s.value,u=d[0],c=d[1],l=Ee.toBase64(new Uint8Array(u)),h=Ie.base64ToHex(l);L.a.log("".concat(this.LOG_TAG," SessionId=").concat(t.sessionId," keyId=").concat(h," status=").concat(c))}}catch(_){n=!0,r=_}finally{try{a||null==o["return"]||o["return"]()}finally{if(n)throw r}}}}},{key:"_onSessionStatusChangePlayready",value:function(e,t){e.forEach(function(e,i){if("string"==typeof i){var a=i;i=e,e=a}if(this.drmInfo.keySystem==Pi&&16==i.byteLength){var n=new DataView(i),r=n.getUint32(0,!0),s=n.getUint16(4,!0),o=n.getUint16(6,!0);n.setUint32(0,r,!1),n.setUint16(4,s,!1),n.setUint16(6,o,!1)}this.drmInfo.keySystem==Pi&&"status-pending"==e&&(e="usable");var d=Ee.toBase64(new Uint8Array(i)),u=Ie.base64ToHex(d);L.a.log("SessionId="+t+" keyId="+u+" status="+e)}.bind(this))}}]),t}(bi),Di=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.MEDIA_IDLE)))._video=i,a}return f()(t,e),s()(t,[{key:"destroy",value:function(){}},{key:"reset",value:function(){this.stalled=null,this.nudgeRetry=0}},{key:"onMediaIdle",value:function(){this.checkBuffer()}},{key:"checkBuffer",value:function(){var e=this.ctx,t=this.media,i=t._config,a=t.currentTime,n=t.playHeadTime,r=this._video;if(!e.error&&r&&!t.bufferOperating){var s=t.bufferInfo(a);if(!t.hasVideoBuffer&&!t.hasAudioBuffer)return t.emit(ae.a.BUFFER_EXPECTING,s);if(null===di.a.getGapIndex(t.buffered,a))s.len<i.bufferExpectLength*Math.max(1,t.playbackRate)&&t.emit(ae.a.BUFFER_EXPECTING,s);else[{type:"video",buffered:t.videoBuffered},{type:"audio",buffered:t.audioBuffered}].forEach((function(e,t,i){var n=e.type,r=e.buffered,s=di.a.getGapIndex(r,a);if(Object(U.f)(s)&&s>0){var o={start:r.start(s-1),end:r.end(s-1)},d={start:r.start(s),end:r.end(s)};L.a.warn("met ".concat(n," gap, currentTime: ").concat(a,", gapIndex: ").concat(s,", gapRange: ").concat(o.end,"-").concat(d.start,", buffered length: ").concat(r.length))}}));if(s.len>=0){var o=r.readyState,d=!(r.paused&&o>1||r.ended),u=performance.now();if(0===s.len&&t.seeking&&(this.stalled=null),t.readyState>=3&&this.resetStalledGap(),a!==n)this.stallReported&&(L.a.warn("video not stuck anymore @".concat(a,", after ").concat(Math.round((u-this.stalled)/1e3),"s")),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0;else if(d){var c=this.stalled?u-this.stalled:0,l=t.bufferInfo(a);if(!this.stalled)return void(this.stalled=u);c>=1e3&&(this.stallReported||(this.stallReported=!0,L.a.warn("video stalling at @".concat(a," due to low buffer")))),this._tryFixBufferStall(l,c)}}}}},{key:"_tryFixBufferStall",value:function(e,t){this.media;e.len>.5&&t>this._stalledGap&&(this.stalled=null,this._tryNudgeBuffer())}},{key:"_tryNudgeBuffer",value:function(){var e=this.ctx,t=this.media,i=t.currentTime,a=(this.nudgeRetry||0)+1;this.nudgeRetry=a;var n=t._config;if(a<n.nudgeMaxRetry){var r=i+a*n.nudgeOffset;L.a.log("adjust currentTime from ".concat(i," to ").concat(r)),t.currentTime=r}else L.a.error("still stuck in high buffer @".concat(i," after ").concat(n.nudgeMaxRetry,", raise fatal error")),e._emitError(new ee.a(ee.a.severity.RECOVERABLE,ee.a.category.MEDIA,ee.a.code.MEDIA_HIGH_BUFFER))}},{key:"resetStalledGap",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this._stalledGap=e?4e3:2e3}}]),t}(bi),wi=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,ae.a.MSE_ATTACHING)))._video=i,a._checkFPSTimer=new re.a((function(){return a._checkFPSInterval()})),a._shouldReport=!1,a._fpsFrequency=1,a._decodeFrameStuckCount=0,a}return f()(t,e),s()(t,[{key:"onMSEAttaching",value:function(){this._checkFPSTimer.scheduleRepeated(this._fpsFrequency)}},{key:"startReportFPS",value:function(){this._shouldReport=!0}},{key:"stopReportFPS",value:function(){this._shouldReport=!1}},{key:"_checkAndFixStuck",value:function(e){var t=this.ctx,i=this.media,a=document.hidden;"boolean"!=typeof a||a||i.paused||4!==i.readyState||(i.variantSwitching?this._decodeFrameStuckCount=0:this._decodeFrameStuckCount>t.dynamicStuckMonitorPeriod?(t.emit(ae.a.FPS_STUCK),this._decodeFrameStuckCount=0,t.recoverMedia()):0===e?this._decodeFrameStuckCount++:this._decodeFrameStuckCount=0)}},{key:"_checkFPS",value:function(e,t){var i=this.ctx,a=(this.media,performance.now());if(e){if(this._lastCheckFPSTime){this._lastCheckFPSTime;var n=t-this._lastDroppedFrames,r=e-this._lastDecodedFrames;this._shouldReport&&i.emit(ae.a.FPS_REPORT,{currentDropped:n,currentDecoded:r}),this._checkAndFixStuck(r)}this._lastCheckFPSTime=a,this._lastDroppedFrames=t,this._lastDecodedFrames=e}}},{key:"_checkFPSInterval",value:function(){var e=this.media;if(this._video){var t=e.playbackQuality;this._checkFPS(t.totalVideoFrames,t.droppedVideoFrames)}}},{key:"destroy",value:function(){this.reset(),this._video=null,this._shouldReport=!1}},{key:"reset",value:function(){this._checkFPSTimer&&this._checkFPSTimer.cancel(),this._lastCheckFPSTime=null,this._lastDroppedFrames=null,this._lastDecodedFrames=null}}]),t}(bi);function Ai(){var e=!1;try{if(window.DOMParser)e=!!new DOMParser}catch(t){}return e}var qi=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).ctx=e,a._config={},a._emit=a.emit,a.emit=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return this._emit.apply(this,[e,e].concat(i))},a._g=new Di(h()(a),i),a._e=new Ei(h()(a),i),a._b=new Ti(h()(a),i),a._v=new yi(h()(a),i),a._m=new ki(h()(a),i),a._f=new wi(h()(a),i),a._variantSwitching=!1,a._loop=!1,a._idleTimer=new re.a((function(){return a.checkIdle()})),a._switchVariantTimer=new re.a((function(){a.variantSwitching=!1})),a}return f()(t,e),s()(t,[{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e}},{key:"error",get:function(){return this._v.error}},{key:"paused",get:function(){return this._v.paused}},{key:"ended",get:function(){return this._v.ended}},{key:"updating",get:function(){return this._b.updating}},{key:"videoBufferUpdating",get:function(){return this._b.videoBufferUpdating}},{key:"audioBufferUpdating",get:function(){return this._b.audioBufferUpdating}},{key:"sourceBuffersCreated",get:function(){return this._b.sourceBuffersCreated}},{key:"hasVideoBuffer",get:function(){return this._b.hasVideoBuffer}},{key:"hasAudioBuffer",get:function(){return this._b.hasAudioBuffer}},{key:"hasOperateBufferData",get:function(){return this._b.hasOperateBufferData}},{key:"appendEnqueueStart",get:function(){return{video:this._b.videoAppendStart,audio:this._b.audioAppendStart}}},{key:"seeking",get:function(){return this._v.seeking}},{key:"playHeadTime",get:function(){return this._v.playHeadTime}},{key:"currentTime",get:function(){return this._v.currentTime},set:function(e){this._v.currentTime=parseFloat(e)}},{key:"duration",get:function(){return this._m.duration},set:function(e){e===this.duration||this.updating||"open"!==this.mseReadyState||(this._m.duration=e)}},{key:"dataDuration",get:function(){return this._duration||0},set:function(e){this._duration=e}},{key:"buffered",get:function(){return this._v.buffered}},{key:"videoBuffered",get:function(){var e=null,t=this._b.videoSourceBuffer;return t&&(e=t.buffered),e}},{key:"audioBuffered",get:function(){var e=null,t=this._b.audioSourceBuffer;return t&&(e=t.buffered),e}},{key:"currentTimeRange",get:function(){for(var e=null,t=this._v.buffered,i=this.currentTime,a=0;a<t.length;a++){var n=t.start(a),r=t.end(a);if(n<=i&&i<r){e={start:n,end:r};break}}return e}},{key:"variantSwitching",get:function(){return this._variantSwitching},set:function(e){if(e){var t=this.bufferInfo(this.playHeadTime);this._switchVariantTimer.schedule(t.len)}else this._switchVariantTimer.cancel();this._variantSwitching=e}},{key:"appendWindowStart",get:function(){return this._b.appendWindowStart},set:function(e){this._b.appendWindowStart=e}},{key:"appendWindowEnd",get:function(){return this._b.appendWindowEnd},set:function(e){this._b.appendWindowEnd=e}},{key:"drmInfo",set:function(e){this._e.setDrmInfo(e)}},{key:"isEndOfStream",get:function(){return"ended"===this.mseReadyState}},{key:"readyState",get:function(){return this._v.readyState}},{key:"mseReadyState",get:function(){return this._m.readyState}},{key:"playbackRate",get:function(){return this._v.playbackRate}},{key:"playbackQuality",get:function(){return this._v.playbackQuality}}],[{key:"probeSupport",value:function(){return Promise.all([Ei.probeSupport(),ki.probeSupport()]).then((function(e){var t=vi()(e,2),i=t[0],a=t[1];return{domParser:Ai(),media:a,drm:i}}))}}]),s()(t,[{key:"reset",value:function(){L.a.log("media reset"),this.abort(),this._idleTimer.schedule(0),this._f.reset(),this._g.reset(),this._e.reset(),this._b.reset(),this._v.reset(),this._m.reset()}},{key:"destroy",value:function(){this._idleTimer.cancel(),this._g.destroy(),this._e.destroy(),this._b.destroy(),this._v.destroy(),this._m.destroy(),this._f.destroy(),this._idleTimer=null}},{key:"configure",value:function(e){this._config=e}},{key:"pause",value:function(){this._v.pause()}},{key:"appendBuffer",value:function(e){this.emit(ae.a.BUFFER_APPENDING,e)}},{key:"flushBuffer",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Number.POSITIVE_INFINITY,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";this.emit(ae.a.BUFFER_FLUSHING,e,t,i)}},{key:"endOfStream",value:function(){return this.updating&&this.abort(),this._m.endOfStream()}},{key:"abort",value:function(){this._b.abort()}},{key:"withinBuffer",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;return this._b.withinBuffer(e,t,i)}},{key:"clearOperateBuffers",value:function(e){return this._b.clearOperateBuffers(e)}},{key:"bufferInfo",value:function(e,t){return this._b.bufferInfo(e,this.ctx.config.maxBufferHole,t)}},{key:"startReportFPS",value:function(){this._f.startReportFPS()}},{key:"stopReportFPS",value:function(){this._f.stopReportFPS()}},{key:"checkIdle",value:function(){this.ctx.error||(this.emit(ae.a.MEDIA_IDLE),this._idleTimer.schedule(.2))}},{key:"resetStalledGap",value:function(e){this._g.resetStalledGap(e)}},{key:"checkBuffer",value:function(){this._g.checkBuffer()}}]),t}(ne.a),Oi=i(122),Li=function(e){function t(){var e;return n()(this,t),(e=d()(this,c()(t).call(this)))._eventManager=new M.a,e._pumpTimer=new re.a((function(){return e._doPump("timer")})),e.hasReceivedVideoIS=!1,e.hasReceivedAudioIS=!1,e._seekTiming=null,e._onAbortCurrentADGas=e._onAbortCurrentADGas.bind(h()(e)),e}return f()(t,e),s()(t,[{key:"_bindEvents",value:function(){var e=this.datasource,t=this.media;this._eventManager.on(t,ae.a.STATE_CHANGE,this._onMediaStateChange.bind(this)),this._eventManager.on(t,ae.a.MSE_ATTACHED,this._onMSEAttached.bind(this)),this._eventManager.on(t,ae.a.BUFFER_EXPECTING,this._onMediaBufferExpect.bind(this)),this._eventManager.on(t,ae.a.BUFFER_UPDATED,this._onMediaBufferUpdated.bind(this)),this._eventManager.on(e,ae.a.STATE_CHANGE,this._onDSStateChange.bind(this)),this._eventManager.on(e,"stream_start",this._onDSStreamStart.bind(this)),this._eventManager.on(this,ae.a.DATA_STAGE_SWITCHING,this._onstageChanging.bind(this)),this._eventManager.on(this,ae.a.DATA_BMFF_ARRIVED,this._onMuxDataArrived.bind(this))}},{key:"_unbindEvents",value:function(){this._eventManager.removeAll()}},{key:"_emitError",value:function(e){L.a.assert(e instanceof ee.a,"Wrong error type!"),null==this.error&&e instanceof ee.a&&(this.error=e,this.recoverProcedure.progressing&&(this.recoverProcedure.status=this.recoverProcedure.levels.STOP),e.code!==ee.a.code.MEDIA_VIDEO_ERROR&&e.code!==ee.a.code.MEDIA_SOURCE_OPERATION_FAILED&&e.code!==ee.a.code.MEDIA_SOURCE_OPERATION_THREW||this.currentManifestType!==O.a.DASH_VP9&&this.currentManifestType!==O.a.DASH_AV1||this.datasource.noticeP2PCheckData(),this.emit(ae.a.ERROR,e))}},{key:"_onMediaStateChange",value:function(e,t){var i=this.config,a=this.datasource,n=this.media,r=this.recoverProcedure,s=!0;switch(t.state){case"loadstart":this.isRolling&&a.openAdLoadStart(),s=!1;break;case"loadedmetadata":this._loadedmetadata||(this._loadedmetadata=!0,this._seekToStartPos()),this.isRolling&&a.openAdLoadStart();break;case"afterended":n.loop||a.endOfPlayingStream();break;case"seeking":var o=n.currentTime,d=this.duration,u=this.bufferInfo;if(L.a.log("seeking(".concat(o,"), duration(").concat(d,")")),Oi.a.browser.SAFARI){if(o<i.safariMinStartTime)return this.seek(i.safariMinStartTime)}else if(o<1&&u.media.len>0){var c=u.media.start;if(c<1&&o<c)return this.seek(c)}if(a.currentTime=o,d>1&&o>d-1)return this.seek(d-1);r.progressing&&(r.status=r.levels.MEDIA_SEEKING),this._seekTiming=performance.now(),n.variantSwitching=!1,this._seekingMayIgnored||n.withinBuffer(o)||(n.hasOperateBufferData&&n.clearOperateBuffers(),n.flushBuffer(),a.seek(o),n.appendWindowStart=a.playRanges.start(0),n.appendWindowEnd=a.playRanges.end(a.playRanges.length-1),this._doPump("seeking")),this._seekingMayIgnored=!1;break;case"seeked":this._seekTiming&&L.a.log("seeked after ".concat((performance.now()-this._seekTiming).toFixed(3),"ms"));break;case"timeupdate":a.currentTime=n.currentTime;break;case"waiting":var l=n.bufferInfo(n.currentTime).len;(n.readyState>=3&&!Oi.a.browser.EDGE||!n.seeking&&n.updating||l>.1||l<=.1&&a.error||a.bufferInfo().len>0)&&(s=!1),a.openReBufTime=!0;break;case"playing":r.progressing&&(r.status=r.levels.STOP),this._startPlayed=!0,a.openReBufTime=!1,this._seekTiming&&(L.a.log("seeking->playing take ".concat((performance.now()-this._seekTiming).toFixed(3),"ms")),this._seekTiming=null)}s&&this.emit(ae.a.STATE_CHANGE,t)}},{key:"_onMSEAttached",value:function(){var e=this.datasource,t=this.media,i=this.config;t.duration=e.duration||i.mediaMaxDuration,this._loadedmetadata=!1,this._doPump("mse_attached"),this.emit(ae.a.BUFFER_CREATED)}},{key:"_isSafetyToEOS",value:function(){var e=this.media;return!e.hasOperateBufferData&&!e.updating&&!e.isEndOfStream}},{key:"_onMediaBufferExpect",value:function(e,t){var i=this.datasource,a=this.media,n=!1;if(i.error&&t.len<=1){var r=i.error.category,s=i.error.code;if([ee.a.category.MUX].indexOf(r)>-1||[].indexOf(s)>-1)n=!0;else i.bufferInfo().len<5&&(n=!0)}n&&i.playingStream.ignoreError?this._isSafetyToEOS()&&a.endOfStream():n?this._emitError(i.error):i.eof?this._isSafetyToEOS()&&a.endOfStream():this._doPump("buf_exp")}},{key:"_onMediaBufferUpdated",value:function(e,t){var i=this.config,a=this.datasource,n=this.media,r=(a.duration,n.duration,t.sourceBufferType),s=t.operateType,o=t.previousBufferedLength;if(i.alwaysSeekKeyframe&&"append"===s&&"video"===r&&0===o&&n.videoBuffered&&n.videoBuffered.length>0){var d=n.videoBuffered.start(0),u=n.videoBuffered.end(0),c=n.currentTime.toFixed(3);Oi.a.browser.EDGE&&(d+=.08),d=d.toFixed(3),u=u.toFixed(3),c!==d&&c!==u&&(L.a.log("Due to alwaysSeekKeyframe, seeking to video buffered start@".concat(d)),n.currentTime=parseFloat(d))}a.eof&&this._isSafetyToEOS()&&n.endOfStream()}},{key:"_onDSStateChange",value:function(e){this.emit(ae.a.STATE_CHANGE,e)}},{key:"_onDSStreamStart",value:function(){var e=this.datasource,t=this.media;t.off(ae.a.BUFFER_FLUSHED,this._onAbortCurrentADGas),t.reset(),t.appendWindowStart=e.playRanges.start(0),t.appendWindowEnd=e.playRanges.end(e.playRanges.length-1)}},{key:"_onAbortCurrentADGas",value:function(){var e=this.media;this.isRolling&&(e.currentTime=0)}},{key:"_seekToStartPos",value:function(){var e=this.config,t=this.datasource,i=this.media,a=this.recoverProcedure;if(t.playRanges.length>0)if(a.progressing){a.status=a.levels.MEDIA_METADATA;var n=a.targetTime;n>=0&&(L.a.log("media recover, seek media by recover point ".concat(n)),i.currentTime=n)}else{var r=t.playRanges.start(0);if(Oi.a.browser.SAFARI){var s=e.safariMinStartTime;r<s&&(r=s)}r>0&&(this._seekingMayIgnored=!0,L.a.log("seek to ".concat(r," by metadata~")),i.currentTime=r)}else L.a.warn("playRanges is empty, pls fix it.")}},{key:"_doPump",value:function(e){this.config;var t=this.datasource,i=this.media,a=null,n=null;if("open"===i.mseReadyState&&!this.bufferOperating)for(var r=i.bufferInfo(i.currentTime,"audio"),s=i.bufferInfo(i.currentTime,"video"),o=t.pump(),d=[a=o.video,n=o.audio],u=0;u<d.length;u++){var c=d[u];if(c instanceof X.a)switch(c.type){case X.a.TYPES.video:this.hasReceivedVideoIS=!0;break;case X.a.TYPES.audio:this.hasReceivedAudioIS=!0}else if(c instanceof Z.a)if(c.origin===Z.a.ORIGINS.DASH_VP9||c.origin===Z.a.ORIGINS.DASH_AV1||c.origin===Z.a.ORIGINS.JDASH);else{var l=c.type===Z.a.TYPES.video?s:r,h=l.start,_=l.end,f=c.startTime,p=f+c.duration,g="append seg start/end(".concat(f,"/").concat(p,"), buffer start/end(").concat(h,"/").concat(_,")");if(p+.1<l.end){switch(c.type){case Z.a.TYPES.video:a=null;break;case Z.a.TYPES.audio:n=null}L.a.log("ignore pumped ".concat(c.type," fmp4, ").concat(g))}}}if(null==a&&null==n)return this._pumpTimer.cancel(),void this._pumpTimer.schedule(.1);for(var m=[a,n],v=!1,b=[],y=0;y<m.length;y++){var k=m[y];if(k){if(!v){var T=i.currentTime,S=t.getSegmentByPTS(T);if(S){var P=S.startTime-1;P>0&&i.withinBuffer(P)&&i.flushBuffer(0,P)}v=!0}if(k instanceof Z.a){var x=k.startTime,I=k.duration,E=x+I;L.a.log("append ".concat(k.bytesArray.length," piece of ").concat(k.type," buffer, start/end/duration(").concat(x.toFixed(3),"/").concat(E.toFixed(3),"/").concat(I.toFixed(3),")"))}else k instanceof X.a&&L.a.log("append ".concat(k.type," initSegment"));b.push(k)}}i.appendBuffer(b),t.noticeActorPump()}},{key:"_onstageChanging",value:function(){this._startPlayed=!1}},{key:"_onMuxDataArrived",value:function(){this.media.checkBuffer()}}]),t}(ne.a),Ci=-1,Mi={STOP:Ci++,START:Ci++,MEDIA_METADATA:Ci++,MEDIA_SEEKING:Ci++,DATA_SEEKING:Ci++},Ri=function(){function e(){n()(this,e),this.levels=Mi,this._status=Mi.STOP,this.targetTime=null}return s()(e,[{key:"progressing",get:function(){return this.status>=Mi.START}},{key:"status",get:function(){return this._status},set:function(e){if(e===Mi.STOP)this.targetTime=null;else if(e!=this._status+1)return;L.a.log("recover status is ".concat(e)),this._status=e}}]),e}(),Bi=function(e){function t(e){var i,a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return n()(this,t),(i=d()(this,c()(t).call(this))).config=new E.a(a),i.runtime={bandwidth:0,downloadSpeed:0,cdnHost:null,netProtocol:null},i.p2pLoader=Object(U.g)(a.p2pLoader)?a.p2pLoader:{enabled:!1},i.netProxy=new ce.a(h()(i)),i.media=new qi(h()(i),e),i.datasource=new pi(h()(i),i.config.datasource),i.recoverProcedure=new Ri,i._startPlayed=!1,i._applyConfig(),i._bindEvents(),i}return f()(t,e),s()(t,[{key:"currentTime",get:function(){return this.isRolling?this.datasource.getAdCurrentTime():this.media.currentTime}},{key:"duration",get:function(){return this.media.dataDuration||this.datasource.duration}},{key:"isRolling",get:function(){return this.datasource.isRolling}},{key:"isPatching",get:function(){return this.datasource.isPatching}},{key:"isLast",get:function(){return this.datasource.isLast||this.media.loop}},{key:"bufferInfo",get:function(){return{media:this.mediaBufferInfo,data:this.dataBufferInfo}}},{key:"mediaBufferInfo",get:function(){var e=this.media.bufferInfo(this.media.playHeadTime);return e.buffered={video:this.media.bufferInfo(this.media.playHeadTime,"video"),audio:this.media.bufferInfo(this.media.playHeadTime,"audio")},e}},{key:"dataBufferInfo",get:function(){return this.datasource.bufferInfo()}},{key:"reBufTime",get:function(){return this.datasource.reBufTime}},{key:"playRanges",get:function(){return this.datasource.playRanges}},{key:"endOfDown",get:function(){return this.datasource.eod}},{key:"currentManifestType",get:function(){var e=null,t=this.datasource.playingStream;return t&&(e=t.manifestType),e}},{key:"currentFileType",get:function(){var e=this.currentManifestType,t="OTHER"+e;switch(e){case O.a.HLS:t="HLS";break;case O.a.f4v:t="F4V";break;case O.a.DASH_VP9:t="VP9";break;case O.a.DASH_AV1:t="AV1";break;case O.a.MP4:t="MP4"}return t}},{key:"currentLoaderMode",get:function(){var e="cdn",t=this.datasource.playingStream;return t&&(e=t.loaderMode),e.toUpperCase()}},{key:"timeRanges",set:function(e){if(Array.isArray(e)&&e.length>0){var t=this.datasource,i=this.media;i.appendWindowStart=t.playRanges.start(0),i.appendWindowEnd=t.playRanges.end(t.playRanges.length-1)}}},{key:"bufferOperating",get:function(){return this.media.hasOperateBufferData||this.media.updating}},{key:"variantSwitching",get:function(){return this.media.variantSwitching}},{key:"allowSwitchVariant",get:function(){return!this.datasource.eof||this.media.hasOperateBufferData}},{key:"startPlayed",get:function(){return this._startPlayed}},{key:"recovering",get:function(){return this.recoverProcedure.progressing}},{key:"playbackQuality",get:function(){return this.media.playbackQuality}},{key:"stats",get:function(){return{bandwidth:this.runtime.bandwidth,downloadSpeed:this.runtime.downloadSpeed,cdnHost:this.runtime.cdnHost,netProtocol:this.runtime.netProtocol}}},{key:"dynamicStuckMonitorPeriod",get:function(){this.currentManifestType;return this.config.fpsStuckMonitoringPeriod}}],[{key:"probeSupport",value:function(){return qi.probeSupport()}},{key:"DEBUG",set:function(e){"boolean"==typeof e&&(E.a.DEBUG=e)},get:function(){return E.a.DEBUG}},{key:"version",get:function(){return __VERSION__}},{key:"logger",set:function(e){Object(L.c)(e)},get:function(){return Object(L.b)()}}]),s()(t,[{key:"configure",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};Object(V.a)(this.config,e,!0),this._applyConfig()}},{key:"_applyConfig",value:function(){var e=this.datasource,t=this.media,i=this.config;e.configure(i.datasource),t.configure(i)}},{key:"loadRoll",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=arguments.length>2?arguments[2]:undefined,a=this.datasource,n=this.media;t.rollType!==oi.PRE_ROLL&&0!==t.offset||(n.variantSwitching=!1),a.loadRoll(e,t,i)}},{key:"preloadRoll",value:function(e,t,i){this.datasource.preloadRoll(e,t,i)}},{key:"loadVariant",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[[0,Number.POSITIVE_INFINITY]],n=this.datasource,r=this.media;Ni(e,t,i,a),n.load(e,t,i,a,!1),r.variantSwitching=!1,t.drm?r.drmInfo={keySystem:t.drm.keySystem,keySystemServer:t.drm.keySystemServer}:r.drmInfo=null}},{key:"preloadVariant",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[[0,Number.POSITIVE_INFINITY]];Ni(e,t,i,a),this.datasource.preload(e,t,i=null,a),t.drm&&(this.media.drmInfo={keySystem:t.drm.keySystem,keySystemServer:t.drm.keySystemServer})}},{key:"switchVariant",value:function(e,t){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2],a=this.config,n=this.datasource,r=this.media,s=this.currentManifestType,o="boolean"!=typeof t.isClearBuffer||t.isClearBuffer,d=e===O.a.JDASH,u=o?r.appendEnqueueStart:null,c=null!==s&&e!==this.currentManifestType;if(this.allowSwitchVariant){if(t.manifestType=e,c?i=!0:"boolean"!=typeof i&&(i=a.switchVariantImmediate),r.variantSwitching=!0,o&&r.clearOperateBuffers(n.matEnabled?"video":undefined),L.a.log("switching variant, immediate: ".concat(i,", paused: ").concat(r.paused,", currentTimeRange: ").concat(r.currentTimeRange,", isClearBuffer: ").concat(o)),c)r.variantSwitching=!1,n.load(e,t,r.currentTime,null,!1),r.reset();else if(i||!r.currentTimeRange)n.load(e,t,null,null,!0),o&&!d&&(r.once(ae.a.BUFFER_FLUSHED,(function(){n.seek(r.currentTime,!1,o)})),r.flushBuffer());else{var l=r.currentTime,h=r.bufferInfo(l),_=n.getSegmentByPTS(l);n.load(e,t,h.end,null,!0,u),o&&!d&&_&&_.startTime>1&&r.flushBuffer(0,_.startTime-1)}this.error&&(this.error=null,this.media.checkIdle())}}},{key:"switchAudioVariant",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=this.config,a=this.datasource,n=this.media,r=null;if(n.clearOperateBuffers("audio"),e){var s=n.currentTime;(t="boolean"==typeof t?t:i.switchVariantImmediate)?(r=s,n.flushBuffer(s)):r=n.bufferInfo(s).end,L.a.log("switching audio variant, immediate: ".concat(t))}else L.a.log("closing audio variant~");a.loadAltAudio(e,r)}},{key:"seek",value:function(e){this.media.currentTime=parseFloat(e),this.media.resetStalledGap(!0)}},{key:"updateMediaRanges",value:function(e){var t=this.datasource,i=this.media;t.range(e),i.appendWindowStart=t.playRanges.start(0),i.appendWindowEnd=t.playRanges.end(t.playRanges.length-1)}},{key:"getCurrentADGas",value:function(){return this.datasource.getCurrentADGas()}},{key:"abortCurrentADGas",value:function(){var e=this.datasource,t=this.media;this.isRolling&&(e.abortCurrentADGas()||(t.off(ae.a.BUFFER_FLUSHED,this._onAbortCurrentADGas),t.once(ae.a.BUFFER_FLUSHED,this._onAbortCurrentADGas)),t.clearOperateBuffers(),t.flushBuffer())}},{key:"abortRollingStream",value:function(e){var t=this.datasource;!this.isRolling||null!==e&&e!==t.rollingType||t.endOfPlayingStream()}},{key:"recoverMedia",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1,t=this.datasource,i=this.media,a=this.recoverProcedure,n=.5;(e=(e=parseFloat(e))>=0?e:i.currentTime)>=i.duration-n&&(e=i.duration-n),L.a.log("media will recovery from ".concat(e)),this.error=null,a.status=a.levels.START,a.targetTime=e,i.reset(),i.resetStalledGap(!0),t.recoverImmediately(e)}},{key:"changeEndPatch",value:function(e,t,i){var a=this.datasource;t?this.loadRoll(e,t,i):a.deleteEndPatch()}},{key:"reset",value:function(){this._unbindEvents(),this.error=null,this.media.reset(),this.datasource.reset(),this._bindEvents()}},{key:"destroy",value:function(){var e=this.datasource,t=this.media;this._startPlayed=!1,this.emit(ae.a.DESTROYING),this._unbindEvents(),this._pumpTimer.cancel(),this.error=null,e.destroy(),t.destroy(),this.emit(ae.a.DESTROYED)}}]),t}(Li);function Ni(e,t,i,a){function n(){throw new Error("[".concat(e,"] load/preload source manifest format is error!"))}if("HLS"===e&&"object"!==I()(t)&&n(),"DASH"===e&&"object"!==I()(t)&&n(),0===a.length)throw new Error("The source's timeRanges length should be gt 0");if(Object(U.f)(i)&&i<a[0][0])throw new Error("playHeadTime should be gt first time range!")}Bi.manifestParser=gi,Bi.datasource=pi,Bi.Mux=J,Bi.media=qi,Bi.Events=ae.a,Bi.Error=ee.a,Bi.ManifestTypes=O.a,Bi.RollTypes=oi,Bi.NetProxy=ce.a,Bi.Conf=E.a,Bi.externals=F;var Fi=Bi,Ui=(i(287),function(e){var t="",i="",a="",n="",r=e.match(/(\w+):\/\/([^\/:]+):?(\d*)((?:\/|$)[^?#]*)/);return r&&(t=r[1],i=r[2],a=r[3],n=r[4]),{protocol:t,host:i,port:a,path:n}}),Vi=Ui,Hi=function(e,t){1===arguments.length&&(t=e,e=window.location.href);var i=String(t).replace(new RegExp("([.*+?^=!:${}()|[\\]/\\\\])","g"),"\\$1"),a=new RegExp("(^|&|\\?|#)"+i+"=([^&#]*)(&|$|#)",""),n=e.match(a);return n?n[2]:""},Wi=function(e){for(var t,i,a,n=e.substr(e.lastIndexOf("?")+1).split("&"),r=n.length,s={},o=0;o<r;o++)n[o]&&(t=(a=n[o].split("=")).shift(),i=a.join("="),void 0===s[t]&&(s[t]=i));return s},ji=function(e){var t=Ui(e);return(t&&t.path||"").replace(/^.*[\\\/]/,"").split(".")[0]},Gi=i(38),zi=i(26),Ki=i(37),Yi={},Qi={get:function(e,t){var i=e.tvid,a=e.locale,n=i;if(Yi[n]=Yi[n]||[],Yi[n].push(t),i&&t){var r="//pcw-api.iqiyi.com/video/video/playervideoinfo?tvid="+i;r=a?r+"&locale="+a:r,Ki.a.jsonp({url:r,memory:!0,success:function(e){"A00000"===e.code&&e.data||t({});var i=(e=e.data).tvid,a=e.videoQipuId,n=[];Yi[i]?(n=(Yi[i]||[]).slice(0),delete Yi[i]):Yi[a]&&(n=(Yi[a]||[]).slice(0),delete Yi[a]);for(var r=0;r<n.length;r++)n[r]&&function(e,t){setTimeout((function(){e({tvid:t.videoQipuId,vid:t.vid,albumId:t.albumId,cid:t.cid,vi:t,sid:t.sid,cType:t.cType})}),0)}(n[r],e);n=null},failure:function(e){t(e||{})}})}},isUGC:function(e){return!!((e+="")&&e.length>2&&"9"==e.charAt(e.length-1)&&"0"==e.charAt(e.length-2)&&(e=parseInt(e,10))>0&&e>9e7)}},Ji={100:{nbid:100,value:"极速",qipu:"jisu",obid:96},200:{nbid:200,value:"流畅",qipu:"300",obid:1},300:{nbid:300,value:"高清",qipu:"600",obid:2},400:{nbid:400,value:"超清",qipu:"1000",obid:3},500:{nbid:500,value:"720P",qipu:"720P",obid:4},600:{nbid:600,value:"1080P",qipu:"1080P",obid:5},601:{nbid:601,value:"爱奇艺HDR",qipu:"HDR",obid:51},610:{nbid:610,value:"1080P50",qipu:"1080P50",obid:27},700:{nbid:700,value:"2K",qipu:"2K",obid:6},800:{nbid:800,value:"4K",qipu:"4K",obid:10},96:{nbid:100,value:"极速",qipu:"jisu",obid:96},1:{nbid:200,value:"流畅",qipu:"300",obid:1},2:{nbid:300,value:"高清",qipu:"600",obid:2},3:{nbid:400,value:"超清",qipu:"1000",obid:3},4:{nbid:500,value:"720P",qipu:"720P",obid:4},5:{nbid:600,value:"1080P",qipu:"1080P",obid:5},51:{nbid:601,value:"爱奇艺HDR",qipu:"HDR",obid:51},27:{nbid:610,value:"1080P50",qipu:"1080P50",obid:27},6:{nbid:700,value:"2K",qipu:"2K",obid:6},10:{nbid:800,value:"4K",qipu:"4K",obid:10}},Xi={getNewVd:function(e){return Ji[e]?Ji[e].nbid:""},getOldVd:function(e){return Ji[e]?Ji[e].obid:""}},Zi=i(43),$i=i(16),ea=i(121),ta=window.location.protocol,ia="420a8433732a6c99d1eae98fea69e55d/dash",aa={vipauthUrl:"https://api.vip.iqiyi.com/services/cknsp.action",h5tmtsUrl:ta+"//cache.m.iqiyi.com/jp/tmts/",vmsUrl:ta+"//cache.video.iqiyi.com/dash",vmsAccess:ta+"//103.44.59.54/3ea",vmsIPSuc:ta+"//{{IP}}/3ea/"+ia,vmsIPFail:ta+"//access.if.iqiyi.com/3ea/"+ia,pingbackUrl:ta+"//msg.qy.net/core",pingbackV6Url:ta+"//msg.qy.net/b",pingbackQosUrl:ta+"//msg.qy.net/qos",isfanUrl:ta+"//sns-api.iqiyi.com/apis/friend/follow.action",IVHistory:"".concat(ta,"//iface2.iqiyi.com/lazy_cat/1.0/last_point"),IVZip:"".concat(ta,"//iface2.iqiyi.com/lazy_cat/1.0/interact_info"),IVSevice:"".concat(ta,"//iface2.iqiyi.com/lazy_cat/1.0/interactive"),IVFullpoints:"".concat(ta,"//iface2.iqiyi.com/lazy_cat/1.0/full_points"),IVStoryLine:"".concat(ta,"//iface2.iqiyi.com/lazy_cat/2.0/linear_story_line")},na=i(82),ra={},sa=new v.a("authremote"),oa={getRequestURL:function(e){var t={version:"10.0",platform:"01010021010000000000",deviceId:T.a.getFluid()||T.a.getJsuid(),uid:Zi.a.getUid(),playType:"pcwh5",shareFlag:0,appname:"h5",dfp:ea.a.get(),messageId:"h5_"+T.a.createUUID().replace(/-/gi,"")};return na.a.isTWLocale()&&(t.platform=$i.a.getPtid(!0)),Object(zi.a)(e,t),aa.vipauthUrl+"?"+Ki.a.serializeParam(e)},getPreviewTime:function(e){var t=ra[e];if(t){var i=0;return t.data&&t.data.prv&&1==t.data.prv&&(1==t.previewType?i=60*t.previewTime*1e3:3==t.previewType&&(i=1e3*t.previewTime)),i}sa.error("the time to invoke getPreviewTime is wrong!")},getAuthUid:function(e){var t=ra[e];if(t){if(t.data&&t.data.u)return t.data.u}else sa.error("the u to invoke getAuthUid is wrong!")},analyzeAuthData:function(e,t,i,a){var n=1==e.shareFlag,r=e.tvid;t&&t.hasOwnProperty("code")?(sa.log("analyze authremote data,params: isShare = "+(n?"fgtw(分甘同味)":"")+",code = "+t.code),"A00000"===t.code?(t.bossKeyTime=+new Date,ra[r]=t,i(r,t)):a(t.code,"CKNSP_RECHARGE_"+t.code,t)):a(null,"CKNSP_DATA_Fail")},request:function(e,t,i){var a=this,n=0;!function r(){n++;var s=a.getRequestURL(e);2===n&&(s=s.replace(/^https/gi,"http")),Ki.a.json({url:s,timeout:5e3,beforeSend:function(e){return sa.log("check charge definition,params: url = "+e.url),e},success:function(n){a.analyzeAuthData(e,n,t,i)},failure:function(e,t){n<2?r():i(null,"CKNSP_HTTPFail")}})}()}},da="01080031010000000000",ua="01080031010010000000",ca="03020031010000000000",la="03020031010010000000",ha="03030031010000000000",_a="03030031010010000000",fa="02020031010000000000",pa="02020031010010000000",ga="",ma=function(){return ga=$i.a.browser.iPad?na.a.isTWLocale()?_a:ha:$i.a.os.mac?na.a.isTWLocale()?ua:da:$i.a.os.androidTablet?na.a.isTWLocale()?la:ca:na.a.isTWLocale()?pa:fa,na.a.isTWLocale()&&(ga=$i.a.getPtid(!0)),ga},va=window.location.protocol;function ba(e,t){var i=va+e.baseUrl+t,a=ji(i);if(e.isVIP){var n=e.boss.data.t||"",r=e.boss.data.u,s=k.a.cmd5x(n+a);i=i+"&t="+n+"&vid="+e.vid+"&ibt="+s+"&cid=afbe8fd3d73448c9&ib=4&ptime="+oa.getPreviewTime(e.tvid)+"&QY00001="+r}else i=i+"&cross-domain=1&qyid="+(T.a.getFluid()||T.a.getJsuid())+"&qypid="+e.tvid+"_"+ma();return i}var ya=function(e,t){var i={},a=[];i.types=[],i.audio={};for(var n=e.audio,r=0;r<n.length;r++){var s={};-1==a.indexOf(n[r].lid)&&(s.id=n[r].lid,s.ispre=1==n[r].ispre?1:0,1==n[r].ispre&&(e.currentLid=n[r].lid),a.push(n[r].lid),i.types.push(s)),n[r].fs&&(i.audio=n[r])}if(t&&i.audio&&i.types.length>1)for(var o=i.audio.fs,d=0;d<o.length;d++)o[d].dpl=ba(e,o[d].l);return i},ka=function Ff(e,t,i,a,r,s,o,d,u,c,l,h,_,f){n()(this,Ff),this.vd=e,this.bid=Xi.getNewVd(e),this.vid=t,this.duration=a,this.vsize=r,this.segments=s||[],this.realArea=o,this.isUsable=d,this.isLimit=u||!1,this.limitReason=c||[],this.fileFormat=i,this.m3u8=l,this.drmType=h||1,this.watermark=_,this.dr=f},Ta=window.location.protocol,Sa=new v.a("segment"),Pa=function(){function e(t,i,a,r,s,o,d,u,c,l,h,_,f,p,g,m){var v=arguments.length>16&&arguments[16]!==undefined?arguments[16]:"",b=arguments.length>17&&arguments[17]!==undefined&&arguments[17];n()(this,e);var y=this;y.ad=t,y.vip=i,y.index=t?0:r,y.tvId=s,y.vid=o,y.vidl=d,y.albumID=u,y.channelID=c,y.originID=l,y.du=h,y.size=_,y.showStartTime=f,y.showEndTime=p,y.startTime=g,y.endTime=m,y.__gas=r,v!==undefined&&""!==v?y.__url=Gi.a.protocolRevise(v)+a:y.__url=y.ad?a:Ta+"//pcw-data.video.iqiyi.com/videos"+a+"&cross-domain=1&qyid="+(T.a.getFluid()||T.a.getJsuid())+"&qypid="+y.tvId+"_"+ma(),y.__params=Wi(y.__url),y.__filename=ji(y.__url),y.getUrl=function(){var e,t=this;if(t.ad||b)e=t.__url;else if(t.vip){var i=arguments[0]||"",a=k.a.cmd5x(i+t.__filename);i||Sa.warn(t.vid+", segment index: "+t.index+", boss key is empty!"),e=t.__url+"&t="+i+"&vid="+t.vid+"&ibt="+a+"&cid=afbe8fd3d73448c9&ib=4&ptime="+oa.getPreviewTime(t.tvId)+"&qypid="+t.tvId+"_"+ma()+"&QY00001="+oa.getAuthUid(t.tvId)}else e=t.__url+"&qypid="+t.tvId+"_"+ma();return e},y.getBossUrl=function(){var e=null;return!this.ad&&this.vip&&(Object(zi.a)(this.__params,{filename:this.__filename,tvid:this.tvId,aid:this.albumID}),e=oa.getRequestURL(this.__params)),e}}return s()(e,[{key:"_setBoss",value:function(e){this.boss=e}}],[{key:"getIdentifier",value:function(e){return Object(b.a)(e.tvId+"_"+e.vid+"_"+e.startTime+"_"+e.endTime+"_"+e.__url)}}]),e}(),xa=new v.a("AnalyzeVidls");function Ia(e,t){var i,a=e.vsInfo,n=e.isVIP||!1,r=e.tvid||"",s=e.cid||"",o=e.sid||0,d=e.albumId||"",u=e.baseUrl,c=e.isReal;t||(i=[]);for(var l=[],h=0;h<a.length;h++){var _=0,f=a[h].fs,p=a[h].ff||"f4v",g=0,m=a[h].vid,v=Xi.getOldVd(a[h].bid),b=a[h].dr,y=a[h].s,k={},T=[],S=a[h].duration||0,P=a[h].vsize;if(f&&(g=f.length,a[h].scrsz)){var x=a[h].scrsz.split("x");k={width:x[0],height:x[1]}}l.push({vid:m,rate:v});for(var I=0;I<g;I++){var E=f[I],D=E.s,w=E.d,A=E.l,q=E.b,O=void 0,L=(O=D>-1?I>0&&0===D?_:D:_)+w,C=new Pa(!1,n,A,I,r,m,l,d,s,o,w,q,O,L,O,L,u,c);T.push(C),_+=w,I===g-1&&(S=D>-1?I>0&&0===D?_:D+w:_)}var M=!1,R=!0,B=[];void 0!==y&&(M=!0,R=0===parseInt(y,10),B=a[h].vut||[]);var N=0;a[h].drm&&(N=a[h].drm.watermark||0),a[h].watermark&&(N=a[h].watermark||0),5===v&&4===b&&(v=51);var F=new ka(v,m,p,S,P,T,k,R,M,B,undefined,undefined,N,b);if(t)v==t&&T.length>0&&(i=F);else{for(var U=!1,V=0;V<i.length;V++)i[V].vd==F.vd&&(U=!0,0===i[V].segments.length&&F.segments.length>0&&(i[V]=F));U||i.push(F)}}return i}function Ea(e,t){var i,a=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2],n=new Fi.manifestParser,r=e.vsInfo,s=null,o=null;t||(i=[]);for(var d=0;d<r.length;d++){var u=r[d],c=u.fs,l=u.ff,h=u.vid,_=Xi.getOldVd(u.bid),f=u.dr,p=u.s,g=u.drmType,m={},v=[],b=u.duration||0,y=u.vsize,k="";if(c){var T=u.scrsz.split("x");m={width:T[0],height:T[1]}}if("dash"===l)switch(u.code){case 4:l="dash_vp9";break;case 5:l="dash_av1"}switch(l){case"ts":"string"==typeof u.m3u8&&u.m3u8.length>0&&(k=u.m3u8,n.reset(),n.push({type:Fi.ManifestTypes.HLS,chunk:{data:k,bid:u.bid}}),n.end(),s=n.isAccurateTimeStamp,a&&(o=n.parser),v=n.segments.map((function(e){return e.__url=e.uri.toString(),e})));break;case"m4s":if("string"==typeof u.m3u8&&u.m3u8.length>0){var S=JSON.parse(u.m3u8);if(Array.isArray(S.watermark_group)&&S.watermark_group.length>0){(k=S.payload[S.watermark_group[0]]).duration=u.duration,u.drm&&"A00000"===u.drm.code&&(k.drm={keySystemServer:u.drm.license_host},7===g?k.drm.keySystem="com.widevine.alpha":8===g&&(k.drm.keySystem="com.microsoft.playready"),xa.log("analyze  drmType 7widevine/8 = "+g+",keySystem"+k.drm.keySystem+", server = "+k.drm.keySystemServer)),n.reset(),n.push({type:Fi.ManifestTypes.JDASH,chunk:k}),n.end();var P=[];n.tracks.video&&Array.isArray(n.tracks.video.segments)?P=n.tracks.video.segments:n.tracks.audio&&Array.isArray(n.tracks.audio.segments)&&(P=n.tracks.audio.segments),v=P.map((function(e){return e.__url=e.uri.toString(),e}))}}break;case"dash_vp9":case"dash_av1":if("string"==typeof u.m3u8&&u.m3u8.length>0){k=u.m3u8;var x="";"dash_vp9"===l?x=Fi.ManifestTypes.DASH_VP9:"dash_av1"===l?x=Fi.ManifestTypes.DASH_AV1:xa.error("DASH still not support unknown codec ".concat(l)),n.reset(),n.push({type:x,chunk:{manifestType:x,data:k,bid:u.bid}}),n.end(),a&&(o=n.parser),v=n.tracks.video.segments}break;case"mp4":"string"==typeof u.mp4Url&&u.mp4Url&&(k=u.mp4Url,n.reset(),n.push({type:Fi.ManifestTypes.MP4,chunk:{data:k,bid:u.bid,duration:u.duration,size:u.vsize}}),n.end(),s=n.isAccurateTimeStamp,a&&(o=n.parser),v=u.mp4Url)}var I=!1,E=!0,D=[];void 0!==p&&(I=!0,E=0===parseInt(p,10),D=u.vut||[]);var w=0;u.drm&&(w=u.drm.watermark||0),r[d].watermark&&(w=r[d].watermark||0),5===_&&4===f&&(_=51);var A=new ka(_,h,l,b,y,v,m,E,I,D,k,g,w,f);if(t)_==t&&(i=A);else{for(var q=!1,O=0;O<i.length;O++)i[O].vd==A.vd&&(q=!0,0===i[O].segments.length&&A.segments.length>0&&(i[O]=A));q||i.push(A)}}return null!=s&&(i.isAccurateTimeStamp=s),null!=o&&(i.manifestParser=o),i}var Da=function(){function e(t){n()(this,e),this.startPlayTime=0,this.endPlayTime=0,this.goodsPoints=[],this.current={},this.next={},this.engine=t,this.autoChangeVdinfo=!1,this.aresnoticedata={},this.logger=new v.a("MovieInfo[".concat(t.id,"]"))}return s()(e,[{key:"setStartPlayTime",value:function(e,t){e<0?this.logger.error("play start time set error!"):this.startPlayTime=this.current.isTryWatch&&!t?0:e}},{key:"getPlayHead",value:function(){var e=this.getPlayTimeRanges(),t=e[0][0],i=e[e.length-1][1],a=null,n=this.startPlayTime,r=t;return t<n&&n<i&&(r=a=n),{timeRanges:e,playHeadTime:a,playRealStartTime:r}}},{key:"initShareTime",value:function(e,t){var i=this.engine.params,a=function(e,t){var i=0,a=undefined;return e&&(i=parseInt(e,10)<0?0:parseInt(e)),t&&(a=parseInt(t,10)<0?0:parseInt(t)),{nsTime:i,neTime:a}};if(i.share_sTime||i.share_eTime){var n=a(i.share_sTime,i.share_eTime);this.current.share_start_time=n.nsTime,this.current.share_end_time=n.neTime,i.share_sTime=!1,i.share_eTime=!1}else if(e||t){var r=a(e,t);this.current.share_start_time=r.nsTime,this.current.share_end_time=r.neTime}}},{key:"getVDInfo",value:function(e,t){var i=e?this.next:this.current;t=t||i.vd;var a={};return i.vidl&&(a=i.vidl.filter((function(e){return e.vd===t}))[0]),a}},{key:"resetFLVDuration",value:function(){var e=this.current.vidl,t=e.length>0?e:null;if(t&&"f4v"==t[0].fileFormat)for(var i=0;i<t.length;i++)t[i].duration>0&&(t[i].duration=t[i].duration/1e3)}},{key:"setInfo",value:function(e){this.current=e}},{key:"clear",value:function(){this.startPlayTime=0,this.endPlayTime=0,this.current={},this.next={}}},{key:"switch",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.current=e||this.next,this.next={}}},{key:"preload",value:function(e){e.isPreload=!0,this.next=e}},{key:"getPlayTimeRanges",value:function(e){var t,i=e?this.next:this.current,a=0,n=i.isPreload?0:this.startPlayTime,r=i.prelude||{},s=this.engine.skip,o=s&&r.headTime>0?r.headTime:0,d=s&&r.tailTime>0?r.tailTime:Infinity;return t=d,n>0&&n+5<t&&(i.playStartFrom="history",a=n),o>0&&o>=a&&(i.playStartFrom="prelude",a=o),"number"==typeof i.share_start_time&&i.share_start_time>=0&&(a=parseInt(i.share_start_time),i.playStartFrom="share"),"number"==typeof i.share_start_time&&i.share_end_time&&i.share_end_time>=i.share_start_time&&(t=parseInt(i.share_end_time)),a>parseInt(i.share_end_time)&&(t=d),[[a,t]]}},{key:"tvid",get:function(){return this.current.tvid},set:function(e){this.current.tvid=e}},{key:"vid",get:function(){return this.current.vid},set:function(e){this.current.vid=e}},{key:"vd",get:function(){return this.current.vd},set:function(e){this.current.vd=e}},{key:"vidl",get:function(){var e=[];return Gi.a.isArray(this.current.vidl)&&(e=this.current.vidl),e}},{key:"adPlayerID",get:function(){return this.current.adPlayerID},set:function(e){this.current.adPlayerID=e}},{key:"isTryWatch",get:function(){return this.current.isTryWatch}},{key:"previewTime",get:function(){return this.current.previewTime}},{key:"previewType",get:function(){return this.current.previewType}},{key:"imageLoader",get:function(){return this.current.imageLoader},set:function(e){this.current.imageLoader=e}},{key:"currentLid",get:function(){return this.current.currentLid}},{key:"parts",get:function(){return this.current.parts},set:function(e){this.current.parts=e}},{key:"watermark",get:function(){return this.current.watermark},set:function(e){this.current.watermark=e}},{key:"rc_code",set:function(e){this.current.rc_code=e}}]),e}();function wa(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},a=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3],n=Object.prototype.hasOwnProperty.call(e,"program")?e.program.video:e,r={vsInfo:n,isVIP:t.isVIP||!1,tvid:t.tvid||"",cid:t.cid||"",sid:t.sid||"",albumId:t.albumId||""};t.baseUrl&&(r.baseUrl=t.baseUrl),t.isReal&&(r.isReal=t.isReal);var s=i.targetVd,o=i.fileFormat;return"f4v"==o?Ia(r,s):Ea(r,s,a)}var Aa=i(88),qa=i(90),Oa={1:{3:!0,37:!1,40:!0,42:!0,48:!0,50:!0},2:{},4:{3:!1,5:!1,27:!0,28:!1,41:!1,46:!0,51:!0},5:{1:!0}};var La={getFT1:function(){for(var e=[],t=1;t<=64;t++)e.push(Oa[1][t]?1:0);return parseInt(e.reverse().join(""),2)},getFT2:function(){for(var e=[],t=1;t<=64;t++)e.push(Oa[2][t]?1:0);return parseInt(e.reverse().join(""),2)},getFT4:function(){for(var e=[],t=1;t<=64;t++)e.push(Oa[4][t]?1:0);return parseInt(e.reverse().join(""),2)},getFT5:function(){for(var e=[],t=1;t<=64;t++)e.push(Oa[5][t]?1:0);return parseInt(e.reverse().join(""),2)},getM3U8FT1:function(){var e=[];Oa[1][37]=!0,Oa[1][38]=!0,Oa[1][50]=!0;for(var t=1;t<=64;t++)e.push(Oa[1][t]?1:0);return parseInt(e.reverse().join(""),2)},getMP4FT1:function(){var e=[];Oa[1][45]=!0,Oa[1][50]=!0;for(var t=1;t<=64;t++)e.push(Oa[1][t]?1:0);return parseInt(e.reverse().join(""),2)},hasBit:function(e,t){return Oa[e][t]},openBit:function(e,t){Oa[e][t]=!0},closeBit:function(e,t){Oa[e][t]=!1}};var Ca=function(){var e=(S.a.get("QC005",{memory:!0})||"").substr(0,1),t=parseInt(e,16),i=10<=t&&t<=15,a=i||!1,n=$i.a.browser.CHROME&&$i.a.browser.version>=78;return{canaryVP9_P2P:i,canaryVP9_CDN:!1,canaryVP9:a,canaryAV1_P2P:n,canaryAV1_CDN:!1,canaryAV1:n||!1}},Ma=new v.a("DashRemote"),Ra=0,Ba=!1;var Na=function(){function e(){n()(this,e),this.requestIsAbandoned=!1,this.vmsParams=null,this.vmsXhrRequest=null}return s()(e,[{key:"request",value:function(e,t,i){var a=e.params,n=!!e.hostUseIP,r=null,s=e.params.tryCount||0,o=e.ptr,d=e.sptr,u=e.pingback,c=this,l=Ca();return Promise.all([new Promise((function(e){var t;function i(){Fi.probeSupport().then((function(t){t.ver="0.0.5",qa.a.write("QiyiPlayerSupported",JSON.stringify(t)),e(t)}))}var a=qa.a.read("QiyiPlayerSupported");a&&"0.0.5"===(t=JSON.parse(a)).ver?e(t):i()})),new Promise((function(e){Zi.a.getVipTypes((function(t){e(t)}))}))]).then((function(e){var h=vi()(e,2),_=h[0],f=h[1];_&&(_.drm&&(_.drm["com.widevine.alpha"]?(La.openBit(1,42),Ba=!0,Ma.log("dashremote feature open widevine")):La.closeBit(1,42),_.drm["com.microsoft.playready"]?(La.openBit(4,5),Ba=!0,Ma.log("dashremote feature open playready")):La.closeBit(4,5),Ba?(La.openBit(4,20),La.openBit(4,21)):(La.closeBit(4,20),La.closeBit(4,21))),_.media&&(l.canaryVP9&&_.domParser&&_.media['video/webm; codecs="vp09.00.40.08"']&&!($i.a.browser.EDGE&&$i.a.browser.version<=18)?La.openBit(4,28):La.closeBit(4,28),l.canaryAV1&&_.domParser&&_.media['video/webm; codecs="av01.0.08M.08"']?La.openBit(4,41):La.closeBit(4,41)));var p=a.tvid,g=a.vid,m=601===a.vd?600:a.vd,y=a.ppt,P=a.ost,x=k.a.cmd5xdash(),I=Ra>0?Ra:x.tm;Ra=0;var E,D=a.ugcAuthKey||"",w=$i.a.getPtid(na.a.isTWLocale());o&&(o.sTime_vms=new Date-o.pgct),d&&(d.psdkietm=+new Date,d.vcistm=+new Date),E={tvid:p,bid:m,vid:g,src:w,vt:0,rs:1,uid:Zi.a.getUid(),ori:"pcw",ps:a.switchvd?1:0,k_uid:T.a.getFluid()||T.a.getJsuid(),pt:0,d:0,s:"",lid:"",cf:"",ct:"",authKey:Object(b.a)(Object(b.a)(D)+I+""+p),k_tag:1,ost:P,ppt:y,dfp:ea.a.get(),locale:na.a.isTraditionalChinese()?"zh_tw":"zh_cn",prio:a.prio||v.a.stringify({ff:"f4v",code:2}),pck:Zi.a.passportCookie(),k_err_retries:s,up:D},(E=Object(zi.a)(E,x)).tm=I,($i.a.os.ios||$i.a.os.android)&&(E.ori="h5"),a.src&&(E.src=a.src),a.preIdAll&&(E.preIdAll=a.preIdAll),a.lid&&(E.lid=a.lid,E.cf=2),-1!=E.prio.indexOf("m3u8")?E.k_ft1=La.getM3U8FT1():-1!=E.prio.indexOf("mp4")?E.k_ft1=La.getMP4FT1():(E.k_ft1=La.getFT1(),E.k_ft4=La.getFT4()),a.k_ft1&&(E.k_ft1=a.k_ft1),E.k_ft5=La.getFT5(),na.a.isTraditionalChinese()&&(E.locale="zh_tw"),"0"===S.a.get("QC004",{memory:!0})&&(E.vv="821d3c731e374feaa629dcdaab7c394b"),n&&(E.ecode="701"),E.bop=v.a.stringify({version:"10.0",dfp:ea.a.get()}),r=E,c.vmsParams=r,u&&u.sendVrsRequestPingback(r);var A=function(e){c.requestIsAbandoned?Ma.log("dashremote is abandoned!!!"):(Ma.log("load movieInfo from vrs"),c.vmsXhrRequest=Ki.a.json({url:e,params:r,memory:!0,timeout:5e3,beforeSend:function(e){var t=Vi(e.url).host;f.forEach((function(t){e.url+="&ut="+t,Gi.a.isArray(r.ut)||(r.ut=[]),r.ut.push(parseInt(t,10))}));var i="iloveiqiyi";try{var a=e.url.replace(new RegExp("^(http|https)://"+t,"ig"),"");n&&(a=a.replace("/3ea/420a8433732a6c99d1eae98fea69e55d","")),i=k.a.cmd5x(a)}catch(s){Ma.error("request, cmd5x error, catchinfo: "+(s.message?s.message:s))}return e.url+="&vf="+i,Ma.log("load movieInfo from vrs, url = "+e.url),e},success:function(e){if(c.requestIsAbandoned)Ma.log("start vms request success callback is abandoned!!!");else if(o&&(o.usedTime_vms=new Date-o.pgct-o.sTime_vms),d&&(d.vcietm=+new Date),u&&u.sendVrsReadyPingback(r,e),Ma.log("dashremote, success."),e&&Object.prototype.hasOwnProperty.call(e,"code"))"A00000"===e.code?t(e):("A00020"===e.code&&e.tm&&(Ra=e.tm),i(e));else{var a={};a.code=Aa.a.P00002,i(a)}},failure:function(e){if(c.requestIsAbandoned)Ma.log("start vms request failure callback is abandoned!!!");else{Ma.error("dash fail raw json data->"+e);var t={};t.code=Aa.a.P00001,i(t)}}}))};n?(Ma.info("dashremote, ip, url = "+aa.vmsAccess),Ki.a.ajax({url:aa.vmsAccess,timeout:2e3,withCredentials:!1,success:function(e){if(e&&"string"==typeof e){var t=e.split(";"),i=t[Math.floor(Math.random()*t.length)];Ma.info("dashremote, ip ok "),A(aa.vmsIPSuc.replace("{{IP}}",i))}else Ma.info("dashremote, ip fail , data = "+e),A(aa.vmsIPFail)},failure:function(e){Ma.info("dashremote, ip fail , data = "+e),A(aa.vmsIPFail)}})):A(aa.vmsUrl)})),this}},{key:"getReqParams",value:function(){return this.vmsParams}},{key:"getXhrRequest",value:function(){return this.vmsXhrRequest}},{key:"setReqAbandoned",value:function(){this.requestIsAbandoned=!0}}]),e}(),Fa=function(e){function t(e,i,a){var r;return n()(this,t),(r=d()(this,c()(t).call(this))).engine=a,r._movieinfo={},r._movieinfo.tvid=e,r._movieinfo.vid=i,r.tryCount=0,r.maxTryCount=2,r.usedIp=!1,r.vmsRequest=null,r._movieinfo.ugcAuthKey=a.movieinfo.ugcAuthKey,r.logger=new v.a("DataReq[".concat(a.id,"]")),r.DASH_RETRY_ARRAY=["A00001","A00003","A00004","A00020",Aa.a.P00001,Aa.a.P00002,Aa.a.P00003,Aa.a.P00004],r}return f()(t,e),s()(t,[{key:"startRequest",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==undefined&&arguments[0],i=this.engine,a=i.ptr,n=i.sptr,r=i.pingback,s=i.vd,o=i.ppt,d=i.ost;this.tryCount++,this.usedIp=t,s=Xi.getNewVd(s),this.vmsRequest=(new Na).request({params:{tvid:this._movieinfo.tvid||"",vid:this._movieinfo.vid||"",vd:s,ppt:o,ost:d,tryCount:this.tryCount-1,switchvd:!1,ugcAuthKey:this._movieinfo.ugcAuthKey||""},hostUseIP:t,ptr:a,sptr:n,pingback:r},(function(t){e.parse(t)}),(function(t){var i=t.data?t.data.st:"";e.reject(0,Aa.a.DASH,t.code,i)}))}},{key:"reject",value:function(e,t,i,a){if(this.logger.warn("load movieInfo, fail, level: "+e+",type:"+t+",code:"+i+",st:"+a+", retry = "+this.tryCount),this.DASH_RETRY_ARRAY.indexOf(i)>-1){if(this.tryCount<this.maxTryCount)return void this.startRequest();if(!this.usedIp)return void this.startRequest(!0)}this.emit("reject",{level:e,type:t,code:i,st:a,movieinfo:this._movieinfo})}},{key:"resolve",value:function(){this.emit("resolve",this._movieinfo)}},{key:"parse",value:function(e){var t=this,i=this._movieinfo,a=this.logger,n=this.engine.isEnjoy,r=Aa.a.DASH,s="";try{var o=e.data;if(!function(e){var i=e.code;return null!=e.data&&Object.prototype.hasOwnProperty.call(e.data,"st")?(s=parseInt(e.data.st,10),!n||505!==s&&506!==s?!!(100<s&&s<200)||(a.error("movieinfo error,params: st = "+s),t.reject(0,r,i,s),!1):(a.warn("站外禁播"),t.reject(0,r,i,s),!1)):(a.error("movieinfo error,params:type = data.data null or st is lose"),t.reject(0,r,Aa.a.P00004),!1)}(e))return;a.log("load movieinfo,dash.st checked"),i.isTryWatch=!1,i.previewTime=Infinity,i.originalData=e,i.baseUrl=Gi.a.protocolRevise(o.dd)||"//pcw-data.video.iqiyi.com/videos",i.tvid=o.tvid,i.albumId=o.aid||"",i.watermark=0,i.cid=o.cid,i.sid=0,i.vipTypes=o.content.vipTypes,i.ugc=Qi.isUGC(i.tvid),i.isVIP=o.content.bossStatus>0,i.vipBlock=0==o.content.nu,i.videoQipuId=o.tvid,i.prelude={headTime:o.p.bt,tailTime:o.p.et},i.qiyiProduced=1===o.content.isProduced,i.exclusive=1===o.content.exclusive,i.logoOpen=!0,i.topLogoOpen=!0,i.lowerLogoOpen=!0,o.p.lgh&&(i.lowerLogoOpen=-1==o.p.lgh.indexOf(2)&&-1==o.p.lgh.indexOf("2"),i.topLogoOpen=-1==o.p.lgh.indexOf(1)&&-1==o.p.lgh.indexOf("1"));var d=o.p.wmarkPos||0;if(i.logoOpen=-1!=d,i.vidl=[],o.program&&o.program.video){var u="",c="",l=o.program.video;if(Array.isArray(l)){var h=l.filter((function(e){return e.m3u8&&""!==e.m3u8&&e.m3u8,e._selected}));h.length>0&&h[0].ff&&(u=h[0].ff,c=h[0].code)}if("dash"===u)switch(c){case 4:u="dash_vp9";break;case 5:u="dash_av1"}i.vidl=wa(o,i,{fileFormat:u}),i.isAccurateTimeStamp=!!i.vidl.isAccurateTimeStamp,i.vidl.manifestParser&&(i.manifestParser=i.vidl.manifestParser),i.vidl.sort((function(e,t){return e.vd>t.vd})),i.vidl.unshift(i.vidl.pop())}if(o.parts&&o.parts.length>0){var _=o.parts[0];if(_.vs&&_.vs.length>0){var f=_.vs;f[0].ff="f4v",i.parts=wa(f,{baseUrl:_.dfs,isReal:!0},{targetVd:Xi.getOldVd(f[0].bid),fileFormat:"f4v"})}}i.audl={},o.program&&o.program.audio&&(i.audio=o.program.audio),i.duration=0,i.drmType=i.vidl.length>0?i.vidl[0].drmType:1;var p={};if(o.program&&o.program.stl&&o.program.stl.length>0)for(var g=o.program.stl,m=0;m<g.length;m++)1==parseInt(g[m].pre)&&(i.subtitlesUrl=Gi.a.protocolRevise(o.dstl)+g[m].xml),p[g[m].lid]=Gi.a.protocolRevise(o.dstl)+g[m].xml;i.subtitlesUrlMap=p,i.f4vInfo={};var v=e.data.p.pano;!v||2!=v.type&&3!=v.type&&4!=v.type?i.is3D=0:i.is3D=2;for(var b=i.vidl,y=0;y<b.length;y++)if(Object.prototype.hasOwnProperty.call(b[y],"segments")&&b[y].segments.length>0){i.vd=b[y].vd,i.watermark=b[y].watermark;break}if(o.svp&&o.svp.length>0){for(var k=o.svp,T=k.length,S={data:[],ids:""},P=0;P<T;P++){var x={id:P,stars:k[P].sl.split(","),points:[],totalTime:0};S.ids+=k[P].sl+",";for(var I=k[P].vl,E=I.length,D=0;D<E;D++){var w=Number(I[D].sp),A=Number(I[D].ep);x.points.push({startTime:w,endTime:A}),x.totalTime+=A-w}x.points.sort((function(e,t){return e.startTime-t.startTime})),S.data.push(x)}i.svpinfo=S}if(i.isVIP){var q={};if(i.vidl.length>0){var O=i.vidl.filter((function(e){return e.vd===i.vd}));if(O.length>0){var L=O[0].segments[0],C=L.__url;L.__url||(C=L.uri.toString()),q=Wi(C);var M=ji(C);Object(zi.a)(q,{filename:M,tvid:i.tvid,aid:i.albumId})}}var R=o.boss_ts?"boss_ts":"boss",B=this;Object.prototype.hasOwnProperty.call(o,R)&&Object.prototype.hasOwnProperty.call(o[R],"code")?oa.analyzeAuthData(q,o[R],(function(e,t){B.vipAuthSuccess(e,t)}),(function(e,t,i){B.vipAuthFail(e,t,i)})):this.vipAuth(q)}else this.resolve(),i.audio&&(i.audl=ya(i,!1))}catch(N){i=null,a.error(N.stack),this.reject(0,r,Aa.a.P00003,s)}}},{key:"getIsTennisContent",value:function(){var e=this._movieinfo;if(e.vipTypes&&e.vipTypes.length>0)for(var t=0;t<e.vipTypes.length;t++)if(1==e.vipTypes[t])return!0;return!1}},{key:"vipAuthSuccess",value:function(e,t){var i=this._movieinfo,a=this.logger,n=oa.getPreviewTime(e);i.isTryWatch=1===parseInt(t.data.prv,10),i.previewType=t.previewType,i.previewTime=0===n?Infinity:n,this.getIsTennisContent()?i.authTipType=10:2===parseInt(t.content.vipMode,10)?i.authTipType=6:i.authTipType=parseInt(t.data.tip_type,10),i.vipTheatre=2===parseInt(t.content.vipMode,10),1==i.previewType?i.authRTime=60*t.data.rtime*1e3:3==i.previewType&&(i.authRTime=1e3*t.data.rtime),a.log("check charge definition pass,params: isTryWatch = "+i.isTryWatch+", previewType = "+i.previewType+", previewTime = "+n),i.vidl.filter((function(e){return e.segments.map((function(e){return e._setBoss&&e._setBoss(t),e})),e.vd===i.vd})),i.audio&&(i.boss=t,i.audl=ya(i,!1)),this.resolve()}},{key:"vipAuthFail",value:function(e,t,i){var a=this._movieinfo,n=this.logger,r=Aa.a.CKNSP;a.isTryWatch=!1,i&&(a.previewType=i.previewType),n.log("check charge definition error,params: code = "+e+", msg = "+t),e?"Q00312"==e||"Q00311"==e||"Q00501"==e?this.reject(2,r,e):this.reject(1,r,e):this.reject(0,r,Aa.a.P00005)}},{key:"vipAuth",value:function(e){var t=this;oa.request(e,(function(e,i){t.vipAuthSuccess(e,i)}),(function(e,i,a){t.vipAuthFail(e,i,a)}))}},{key:"clear",value:function(){var e=this.vmsRequest;e&&(e.setReqAbandoned(),e.getXhrRequest()&&e.getXhrRequest().abort(),this.vmsRequest=null)}}]),t}(p.a),Ua=function(){function e(t){n()(this,e),this.logger=new v.a("DataProvider[".concat(t.id,"]")),this.engine=t,this.AllProviders={},this._retryMax=2}return s()(e,[{key:"getPid",value:function(e,t){return e+"_"+t}},{key:"hasPreload",value:function(e){return!(!this.AllProviders[e]||"fulfilled"!==this.AllProviders[e].st)}},{key:"getParams",value:function(e){return this.AllProviders[e]?this.AllProviders[e].params:null}},{key:"getData",value:function(e){return this.AllProviders[e].data}},{key:"clearAll",value:function(e){for(var t in this.AllProviders){if(e)new RegExp("^".concat(e,"_*")).test(t)&&(this.AllProviders[t].dq&&this.AllProviders[t].dq.clear(),delete this.AllProviders[t]);else this.AllProviders[t].dq&&this.AllProviders[t].dq.clear()}e||(this.AllProviders={}),this.logger.info("clear data provider & abandon vms request. tvid = "+e)}},{key:"getPromise",value:function(e,t){var i,a=this.getPid(e,t),n=this;return this.AllProviders[a]&&"pending"===this.AllProviders[a].st?i=this.AllProviders[a].pm:(i=new Promise((function(i,r){if(n.hasPreload(a))i(n.getData(a));else{n.AllProviders[a]={st:"pending",data:undefined,params:null,pm:null,dq:null,retryNum:0},n._retryNum=0;var s=new Fa(e,t,n.engine);s.on("resolve",(function(e){e.dataProviderPID=a,i(e),n.AllProviders[a]&&(n.AllProviders[a].st="fulfilled",n.AllProviders[a].params=s.vmsRequest.getReqParams(),n.AllProviders[a].data=e,n.AllProviders[a].dq=s)})),s.on("reject",(function(e){var t=s.DASH_RETRY_ARRAY.indexOf(e.code.toString())>-1;t&&(n.AllProviders[a].retryNum<n._retryMax?(n.AllProviders[a].retryNum++,s.tryCount=0,s.startRequest()):t=!1),t||(r(e),n.AllProviders[a]&&(n.AllProviders[a].st="rejected",n.AllProviders[a].data=e,n.AllProviders[a].dq=s))})),s.startRequest()}})),this.AllProviders[a].pm=i),i}},{key:"clearCache",value:function(e,t){var i=this.getPid(e,t);this.AllProviders[i]&&delete this.AllProviders[i]}}]),e}(),Va=i(2),Ha={Status_Idle:"idle",Status_Loadstart:"loadstart",Status_Loaddone:"loaddone",Status_LoadFailed:"error",Status_LoadedMetaData:"loadedmetadata",Status_Canplay:"canplay",Status_Waiting:"waiting",Status_Paused:"paused",Status_Play:"play",Status_Playing:"playing",Status_Will_Stoped:"willended",Status_Stoped:"ended",Status_Stalled:"stalled",Status_Playing_Fail:"muted",NTF_StatusChanged:"statusChanged",NTF_CanPlayThrough:"canplaythrough",NTF_VolumeChanged:"volumechanged",NTF_RateChanged:"ratechange",NTF_DurationChanged:"durationchange",NTF_Seeking:"seeking",NTF_Seeked:"seeked",NTF_TimeUpdate:"timeupdate",NTF_Progress:"progress",NTF_NeedUserGesture4Playback:"needUserGesture4Playback",Action_Type_Controls:"controls",Action_Type_Code:"code",Action_Type_Native:"native"},Wa={},ja=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._curStatus="",i.hasSeeking=!1,i.seekableFlag=!0,i.__beforeSeekTime=0,i._userGesturePlayed=!1,i._currentManualAction=null,i._currentCodeActionList=[],i.delogger=new v.a("Decode[".concat(e.id,"]")),i}return f()(t,e),s()(t,[{key:"init",value:function(e){var t=this,i=arguments;this._video=e;var a=function(i){if(""!==e.src){var a=i.status;t.emit(Ha.NTF_StatusChanged,i),t._curStatus=a,a===Ha.Status_Playing?t._playing=!0:t._playing=!1}},n=function(e){if(t._currentManualAction&&t._currentManualAction===e)return t._currentManualAction=null,Ha.Action_Type_Controls;if(-1!=t._currentCodeActionList.indexOf(e)){var i=t._currentCodeActionList.indexOf(e);return t._currentCodeActionList.splice(i,1),Ha.Action_Type_Code}return Ha.Action_Type_Native};this._setSrc=function(e){1===i.length&&(t.__beforeSeekTime=0,t._video.setAttribute("src",e),$i.a.os.ios||t._video.load())},Wa.loadstart=function(){t.__beforeSeekTime=0,a({status:Ha.Status_Loadstart,actionType:Ha.Action_Type_Native})},e.addEventListener("loadstart",Wa.loadstart),Wa.error=function(){t.__beforeSeekTime=0,a({status:Ha.Status_LoadFailed,actionType:Ha.Action_Type_Native})},e.addEventListener("error",Wa.error),Wa.stalled=function(){a({status:Ha.Status_Stalled,actionType:Ha.Action_Type_Native})},e.addEventListener("stalled",Wa.stalled),Wa.loadedmetadata=function(){a({status:Ha.Status_LoadedMetaData,actionType:Ha.Action_Type_Native})},e.addEventListener("loadedmetadata",Wa.loadedmetadata),Wa.canplay=function(){a({status:Ha.Status_Canplay,actionType:Ha.Action_Type_Native})},e.addEventListener("canplay",Wa.canplay),Wa.ended=function(){if(!1===t.seekableFlag&&Math.abs(t._getDecodeDuration()-t.__beforeSeekTime)>2)return t._seek(t.__beforeSeekTime)},e.addEventListener("ended",Wa.ended),Wa.canplaythrough=function(){t.emit({type:Ha.NTF_CanPlayThrough,data:{actionType:Ha.Action_Type_Native}})},e.addEventListener("canplaythrough",Wa.canplaythrough),Wa.volumechange=function(){t.emit(Ha.NTF_VolumeChanged,{data:t._video.volume,actionType:Ha.Action_Type_Native})},e.addEventListener("volumechange",Wa.volumechange),Wa.ratechange=function(){t.emit(Ha.NTF_RateChanged,{data:t._video.playbackRate,actionType:Ha.Action_Type_Native})},e.addEventListener("ratechange",Wa.ratechange);var r=(new Date).getTime(),s=0;Wa.timeupdate=function(){var i=t.getCurrenttime(),a=t.getDuration();if(!e.seeking&&Math.abs(i-t.__beforeSeekTime)<1.2)t.__beforeSeekTime=i;else if(!1===t.seekableFlag)return t._seek(t.__beforeSeekTime);if(!("number"==typeof e.readyState&&e.readyState<=1||t.isPaused())){var n=(new Date).getTime();n-r>500&&(clearTimeout(s),r=n,s=setTimeout((function(){t.emit(Ha.NTF_TimeUpdate,{current:i,duration:a,buffer:t.getBufferTime(),actionType:Ha.Action_Type_Native})}),0)),t._playing||(t.hasSeeking=!1)}},e.addEventListener("timeupdate",Wa.timeupdate),a({status:Ha.Status_Idle}),this._statusChanged=a,this._checkActionType=n}},{key:"video",value:function(){return this._video}},{key:"removeAllEventsListener",value:function(){this._video.removeEventListener("loadstart",Wa.loadstart),this._video.removeEventListener("error",Wa.error),this._video.removeEventListener("stalled",Wa.stalled),this._video.removeEventListener("loadedmetadata",Wa.loadedmetadata),this._video.removeEventListener("canplay",Wa.canplay),this._video.removeEventListener("pause",Wa.pause),this._video.removeEventListener("play",Wa.play),this._video.removeEventListener("playing",Wa.playing),this._video.removeEventListener("waiting",Wa.waiting),this._video.removeEventListener("ended",Wa.ended),this._video.removeEventListener("canplaythrough",Wa.canplaythrough),this._video.removeEventListener("volumechange",Wa.volumechange),this._video.removeEventListener("durationchange",Wa.durationchange),this._video.removeEventListener("timeupdate",Wa.timeupdate),this._video.removeEventListener("progress",Wa.progress)}},{key:"play",value:function(e){var t=this,i=t._video;if(0!==i.readyState){e?this._currentManualAction=Ha.Status_Play:this._currentCodeActionList.push(Ha.Status_Play);var a=function(){t.delogger.log("decode play really invoked!");var e=i.play();if(e!==undefined){var a=new Promise((function(t,i){e.then((function(){t()}))["catch"]((function(e){i(e)}))}));return a["catch"]((function(e){t.delogger.warn("decode play got: "+e.message)})),a}};if(!$i.a.os.ios&&!$i.a.os.android)return a();this._userGesturePlayed?a():this.emit(Ha.NTF_NeedUserGesture4Playback)}}},{key:"pause",value:function(e,t){var i=this._video.networkState;(t||0!==i&&3!==i)&&(this._video.readyState&&(e?this._currentManualAction=Ha.Status_Paused:this._currentCodeActionList.push(Ha.Status_Paused),this._video.pause()))}},{key:"isPaused",value:function(){return this._video.paused}},{key:"replay",value:function(){this._video.play(this._video.src)}},{key:"_seek",value:function(e,t){var i=this;if(!this._checkSeek||!1!==this._checkSeek(e)){this.hasSeeking=!0;var a=this._video.seekable;1===a.length&&a.end(0)>e?(t?this._currentManualAction=Ha.NTF_Seeking:this._currentCodeActionList.push(Ha.NTF_Seeking),e>=0&&e<=this.getDuration()&&(this._video.currentTime=e),this.isPaused()&&this.play()):setTimeout((function(){i._seek(e)}),10)}}},{key:"isSeeking",value:function(){return this.hasSeeking}},{key:"setDecodeSrc",value:function(e,t){var i=this;i._setSrc(e),this.delogger.debug("decode src current time :"+t);try{i._video.duration=0,i._video.buffered.length=0,t>0?i._video.addEventListener("loadedmetadata",(function e(){t<i.getDuration()&&i._seek(t),i._video.removeEventListener("loadedmetadata",e)}),!1):i._video.currentTime=0}catch(a){}}},{key:"getSrc",value:function(){return this._video.src}},{key:"getAudioTracks",value:function(){return this._video.audioTracks}},{key:"setAudioTracks",value:function(){}},{key:"getBuffered",value:function(){return this._video.buffered}},{key:"getDecodeCurrenttime",value:function(){var e=this.getDecodeDuration(),t=this._video.currentTime||0;return t<e?t:e}},{key:"getDecodeDuration",value:function(){return this._video.duration||0}},{key:"getVolume",value:function(){return this._video.volume}},{key:"setVolume",value:function(e){e>1&&(e=1),this._video.volume=e}},{key:"userGesturePlayed",value:function(){this._userGesturePlayed=!0}},{key:"getPlaybackRate",value:function(){return this._video.playbackRate}},{key:"setPlaybackRate",value:function(e){e>0&&(this._video.playbackRate=e)}}]),t}(p.a),Ga=function(e,t){for(var i={segments:[]},a=null,n=0;n<e.segments.length;n++){var r=e.segments[n].startTime;if(t.previewTime>0&&r>=t.previewTime)break;a={totalBytes:e.segments[n].size,startTime:r/1e3,duration:(e.segments[n].endTime-r)/1e3,dispatUrl:e.segments[n].__url,bossKey:""},e.segments[n].boss&&e.segments[n].boss.data&&"A00000"==e.segments[n].boss.code&&(a.bossKey=e.segments[n].boss.data.t),i.segments.push(a)}return i.dispatchParams={movieIsMember:t.isVIP,communicationlId:"afbe8fd3d73448c9",tvid:t.tvid,vid:t.vid,albumId:t.albumId,QY00001:"",mi:"tv_"+t.albumId+"_"+t.tvid+"_"+t.vid,auth_ptime:t.previewTime,pf:$i.a.getPtid(na.a.isTWLocale()),playerType:"main",currentDefinition:e.vd,key:""},e.segments.length>0&&e.segments[0].boss&&e.segments[0].boss.data&&"A00000"==e.segments[0].boss.code&&(i.dispatchParams.key=e.segments[0].boss.data.t,i.dispatchParams.QY00001=e.segments[0].boss.data.u),i},za=function(e){for(var t={segments:[]},i=null,a=0;a<e.length;a++)i={totalBytes:e[a].size,startTime:e[a].startTime/1e3,duration:(e[a].endTime-e[a].startTime)/1e3,dispatUrl:e[a].__url,bossKey:"",isAd:e[a].ad,gas:e[a].__gas},t.segments.push(i);return t.dispatchParams={},t},Ka={};var Ya={generate:function(e){e=parseInt(e,10);var t=Object(b.a)(e+"IQIYI"+(new Date).getTime());return Ka[e]=t,t},getEpisodeId:function(e){var t;for(var i in Ka)if(Ka[i]===e){t=i;break}return parseInt(t,10)},getEventId:function(e){return Ka[e]||""}},Qa=[],Ja=[],Xa=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"add",value:function(e,t){if(Gi.a.isArray(e))for(var i=0;i<e.length;i++)this.add(e[i],t);else{var a=!0===t?Ja:Qa;-1===a.indexOf(e)&&a.push(e)}}},{key:"remove",value:function(e){if(Gi.a.isArray(e))for(var t=0;t<e.length;t++)this.remove(e[t]);else{var i=Qa.indexOf(e);i>-1&&Qa.splice(i,1)}}},{key:"removeAll",value:function(){Qa.splice(0,Qa.length)}},{key:"has",value:function(e){return Qa.concat(Ja).indexOf(e)>-1}}]),t}(p.a),Za=window.location.protocol,$a=function(e,t){if(e)if(/[a-z]/i.test(e)){var i=function(i){var a,n;return q.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:a=Vi(e),n=i+"/3f0/hd.cloud.iqiyi.com/d?dn="+a.host+"&business=pcwPlayer&cross-domain=1",Ki.a.ajax({url:n,withCredentials:!1,success:function(e){t(e)},failure:function(e){t(e)}});case 3:case"end":return r.stop()}}))};Ki.a.ajax({url:aa.vmsAccess,timeout:2e3,withCredentials:!1,success:function(e){if(e&&"string"==typeof e){var t=e.split(";");i(Za+"//"+t[0])}else i(aa.dnsIPFail)},failure:function(e){i(aa.dnsIPFail)}})}else t(e)};var en="1",tn="10",an="101";$i.a.browser.iPad?(en="2",tn="20",an="202"):($i.a.os.ios||$i.a.os.android)&&(en="2",tn="20",an="201");var nn="window";$i.a.os.ios||$i.a.os.mac?nn="mac":$i.a.os.android&&(nn="android");var rn=new p.a,sn=new Promise((function(e){var t=setTimeout((function(){e()}),2e3);rn.once("ok",(function(){clearTimeout(t),e(),rn=null}))})),on=new(function(){function e(){n()(this,e)}return s()(e,[{key:"getDrmType",value:function(e){var t="";if(e.drmType)switch(e.drmType){case 7:t=1;break;case 8:t=2}return t}},{key:"getPingbackDfp",value:function(e){function t(){return ea.a.get()}return new Promise((function(i){sn.then((function(){var a=t();a?i(a):e&&parseInt(e.t,10)>0?"undefined"==typeof window.dfp?function(e,t){"object"!=I()(e)&&(e=[e]);var i=document.getElementsByTagName("head").item(0)||document.documentElement,a=[],n=e.length-1;!function r(s){a[s]=document.createElement("script"),a[s].setAttribute("type","text/javascript"),a[s].onload=a[s].onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),s!=n?r(s+1):"function"==typeof t&&t(!0))},a[s].onerror=a[s].onstalled=function(){"function"==typeof t&&t(!1)},a[s].setAttribute("src",e[s]),i.appendChild(a[s])}(0)}("//security.iqiyi.com/static/cook/v1/cooksdk.js",(function(e){e&&"undefined"!=typeof window.dfp?(ea.a.setSDK(window.dfp),i(t())):i("")})):(ea.a.setSDK(window.dfp),i(t())):i("")}))}))}},{key:"browserName",value:function(){return $i.a.browserName()}},{key:"noticeSenderFlush",value:function(){clearTimeout(this.__timer),this.__timer=setTimeout((function(){rn&&rn.emit("ok")}),50)}},{key:"os",get:function(){return nn}},{key:"pf",get:function(){return en}},{key:"p",get:function(){return tn}},{key:"p1",get:function(){return an}},{key:"p_code",get:function(){return this.pf+"_"+this.p+"_"+this.p1}}]),e}()),dn=function(){function e(t){n()(this,e),this.proxy=t.playproxy,this.engine=t,this.logger=new v.a("PlayProxyEvent[".concat(t.id,"]")),this.initFeatureDuration(),this.initDecode(),this.initQvsEvent(),this.initP2PEvent(),Zi.a.beforeunloadListener();var i=this;this.unloadEvent=function(){t.pingbackV6.sendEndPlayPingback(3),t.pingback.sendEndPlayPingback(3),i.sendStuckdetl(1)},window.addEventListener("beforeunload",this.unloadEvent),this._needPlay=!0,this._recoverMediaNum=0,this._recoverMediaPerNum=0,this._recoverMediaMax=3,this._dashAuthNum=0,this._dashAuthMax=2,this.waitingTimer=0,this._waitingStartTime=0,this.followUpNextLoadFlag=!1,this.statusPool=new Xa}return s()(e,[{key:"_statusChanged",value:function(e,t,i){var a=this.proxy,n=this.logger,r=this.getData();r.state=e,t&&(r.actionType=t.actionType||Ha.Action_Type_Native,t.gas&&(r.gas=t.gas),t.spend&&(r.spend=t.spend)),a.currStatus===e&&!0!==i||(this.updateStatusPool(e),a.currStatus=e,a.fire(Va.a.NTF_StatusChanged,r),n.debug("core status changed: "+e))}},{key:"initP2PEvent",value:function(){var e=this.engine,t=this.proxy,i=this.logger,a=e.p2p,n=e.movieinfo,r=e.pingbackV6,s=e.pingbackQOS;a.enabled&&(a.on("dashUpdated",(function(a){if(a.levelID!==undefined&&a.streamInfo!==undefined){var s=a.levelID,o=JSON.parse(a.streamInfo),d=o.data.program.video;if(o.data&&d.length>0&&!t.isAd()&&o.data.tvid==n.tvid){if(o.data.tvid!==n.tvid)return void i.info(">>>> p2p dashUpdated tvid is not current , current = "+n.tvid+", p2p = "+o.data.tvid);var u=t.getCurrentVD(),c=Xi.getNewVd(u),l=Xi.getOldVd(s);i.info(">>>> p2p dashUpdated , auto = "+e.autoVdUsing+",vd="+l+"("+s+"),pre="+u+"("+c+"), dashtvid = "+o.data.tvid);for(var h=null,_=0;_<d.length;_++){var f=d[_];if(f._selected){h=f;break}}var p=h.ff,g=h.code;if("dash"===p)switch(g){case 4:p="dash_vp9";break;case 5:p="dash_av1"}t.switchVdAction({vd:l,bid:s,fileFormat:p},o),e.autoVdUsing&&(parseInt(s)>parseInt(c)?r.sendAutoUpToVDPingback(l,u):parseInt(s)<parseInt(c)&&r.sendAutoDwnToVDPingback(l,u))}else i.info("p2p dashUpdated error , streamInfo error or ad = "+t.isAd())}else i.info("p2p dashUpdated error , levelID or streamInfo is undefined")})),a.on("sendPingBack",(function(e){i.info("sendPingBack, P2P = > "+JSON.stringify(e)),s.sendQOSReport(e)})))}},{key:"initDecode",value:function(){var e=this.proxy,t=this.engine,i=this;e.on(Ha.NTF_StatusChanged,(function(a){switch(a.status){case Ha.Status_Loadstart:e.isAd()||"ad"===a.eventOrigin?"ad"===a.eventOrigin?i._statusChanged(Va.a.Status_AdLoadstart,a,!0):i._statusChanged(Va.a.Status_AdLoadstart,a):Zi.a.tvid(t.getMovieInfo().tvid),Zi.a.stopHeartBeat();break;case Ha.Status_Canplay:e.isAd()&&i._statusChanged(Va.a.Status_Ready,a);break;case Ha.Status_Loaddone:i._statusChanged(Va.a.Status_Loaddone,a);break;case Ha.Status_Stalled:e.isAd()&&i._statusChanged(Va.a.Status_AdStalled,a);break;case Ha.Status_LoadFailed:e.isAd()?i._statusChanged(Va.a.Status_AdError,a):(e._timeMark=0,i._statusChanged(Va.a.Status_PlayError,a)),i.followUpNextLoadFlag||(i.followUpNextLoadFlag=!0,e.fire(Va.a.NTF_FollowUpNextLoad,"")),Zi.a.stopHeartBeat();break;case Ha.Status_Play:i._statusChanged(Va.a.Status_Play,a);break;case Ha.Status_Will_Stoped:e.isAd()&&i._statusChanged(Va.a.Status_AdWillPlayEnded,a)}})),[[Ha.NTF_CanPlayThrough,Va.a.NTF_CanPlayThrough,Va.a.NTF_AD_CanPlayThrough],[Ha.NTF_VolumeChanged,Va.a.NTF_VolumeChanged,Va.a.NTF_AD_VolumeChanged],[Ha.NTF_DurationChanged,Va.a.NTF_DurationChanged,Va.a.NTF_AD_DurationChanged],[Ha.NTF_TimeUpdate,Va.a.NTF_TimeUpdate,Va.a.NTF_AD_TimeUpdate],[Ha.NTF_Progress,Va.a.NTF_Progress,Va.a.NTF_AD_Progress],[Ha.NTF_RateChanged,Va.a.NTF_RateChanged,Va.a.NTF_AD_RateChanged]].forEach((function(t){t[0]==Ha.NTF_TimeUpdate?e.on(t[0],(function(i){var a=(new Date).getTime();0===e._timeMark&&(e._timeMark=a),e.isAd()||e.isPatch()||e.currStatus==Ha.Status_Stalled||e.currStatus==Ha.Status_Waiting||e.currStatus==Ha.Status_Paused||e.currStatus==Ha.Status_Stoped||e.currStatus==Ha.Status_LoadFailed||(e._playingDuration+=a-e._timeMark,e._playingSpend+=a-e._timeMark),e._timeMark=a,e.fire(e.isAd()?t[2]:t[1],i)})):e.on(t[0],(function(i){e.fire(e.isAd()?t[2]:t[1],i)}))}))}},{key:"initFeatureDuration",value:function(){var e=this,t=this.proxy;this.logger;this.lastCurrentTime=undefined,t.on(Ha.NTF_TimeUpdate,(function(){if(!t.isAd()&&!t.isPatch()){var i=t.getCurrenttime(),a=i-e.lastCurrentTime;e.lastCurrentTime&&a>0&&(e._currentFeaturePlayingDuration+=1e3*a),e.lastCurrentTime=i;var n=1e3*t.getCurrenttime();t.checkAuthTime(n)}}))}},{key:"updateStatusPool",value:function(e){var t=this.statusPool;switch(e){case Va.a.Status_StartPlay:t.add([Va.a.Status_StartPlay],!0);break;case Va.a.Status_EveryStartPlay:t.add([Va.a.Status_EveryStartPlay]),on.noticeSenderFlush();break;case Va.a.Status_AdStartPlay:t.add([Va.a.Status_AdStartPlay],!0);break;case Va.a.Status_ADEveryStartPlay:t.add([Va.a.Status_ADEveryStartPlay]),on.noticeSenderFlush();break;case Va.a.Status_Playing:t.add([Va.a.Status_Play,Va.a.Status_Playing]),t.remove([Va.a.Status_Idle,Va.a.Status_PlayError,Va.a.Status_Stoped,Va.a.Status_End_Play,Va.a.Status_Paused,Va.a.Status_Waiting]);break;case Va.a.Status_Paused:t.add(Va.a.Status_Paused),t.remove([Va.a.Status_Idle,Va.a.Status_Play,Va.a.Status_Playing,Va.a.Status_Waiting,Va.a.Status_PlayError,Va.a.Status_Stoped,Va.a.Status_End_Play]);break;case Va.a.Status_Waiting:t.add(Va.a.Status_Waiting),t.remove([Va.a.Status_Idle,Va.a.Status_Play,Va.a.Status_Playing,Va.a.Status_Paused,Va.a.Status_PlayError,Va.a.Status_Stoped,Va.a.Status_End_Play]);break;case Va.a.Status_PlayError:t.add(Va.a.Status_PlayError),t.remove([Va.a.Status_Idle,Va.a.Status_Play,Va.a.Status_Playing]),on.noticeSenderFlush();break;case Va.a.Status_Stoped:t.add(Va.a.Status_Stoped),t.remove([Va.a.Status_Idle,Va.a.Status_Play,Va.a.Status_Playing,Va.a.Status_Waiting]);break;case Va.a.Status_End_Play:t.add(Va.a.Status_End_Play),t.remove([Va.a.Status_Idle,Va.a.Status_Play,Va.a.Status_Playing,Va.a.Status_Waiting])}}},{key:"getData",value:function(){var e=this.engine,t=e.movieinfo,i=e.playerVersion,a={},n=t.current;return a.tvid=n.tvid,a.vid=n.vid,a.albumId=n.albumId||"",a.cid=n.cid||"",a.duration=n.duration||"",a.privateVideo="0",a.origin="",a.playerVersion=i,a}},{key:"destory",value:function(){var e=this.proxy.qvs;e.off(Fi.Events.ERROR,this.onQVSError),e.off(Fi.Events.STATE_CHANGE,this.onStatusChanged),e.off(Fi.Events.BUFFER_CREATED,this.onMediaBufferCreated),e.off(Fi.Events.DATA_STAGE_SWITCHING,this.onDataSourceStageSwitching),e.off(Fi.Events.DATA_STAGE_SWITCHED,this.onDataSourceStageSwitched),e.off(Fi.Events.DNS_PARSER_SUCCESS,this.onDNSParser),window.removeEventListener("beforeunload",this.unloadEvent),this.lastCurrentTime=undefined,this._currentFeaturePlayingDuration=0}},{key:"initQvsEvent",value:function(){var e=this,t=this.proxy.qvs;this.onQVSError=function(t){return e._onQVSError(t)},this.onStatusChanged=function(t){return e._onStatusChanged(t)},this.onMediaBufferCreated=function(t){return e._onMediaBufferCreated(t)},this.onDataSourceStageSwitching=function(t){return e._onDataSourceStageSwitching(t)},this.onDataSourceStageSwitched=function(t){return e._onDataSourceStageSwitched(t)},this.onDNSParser=function(t){return e._onDNSParser(t)},t.on(Fi.Events.ERROR,this.onQVSError),t.on(Fi.Events.STATE_CHANGE,this.onStatusChanged),t.on(Fi.Events.BUFFER_CREATED,this.onMediaBufferCreated),t.on(Fi.Events.DATA_STAGE_SWITCHING,this.onDataSourceStageSwitching),t.on(Fi.Events.DATA_STAGE_SWITCHED,this.onDataSourceStageSwitched),t.on(Fi.Events.DNS_PARSER_SUCCESS,this.onDNSParser)}},{key:"_onQVSError",value:function(e){var t=e.severity,i=e.category,a=e.code,n=e.data&&e.data.length>0&&e.data[0]?e.data[0].gas:null,r=this.proxy,s=this.logger,o=this.engine,d=o.pingback,u=o.pingbackV6,c=o.movieinfo;if(a==Fi.Error.code.DATA_AUTH_Error&&"CDN"==o.getCurrLoaderMode()&&this._dashAuthNum<this._dashAuthMax){var l=c.getVDInfo();this._dashAuthNum++,s.log("qvs autherror , num = "+this._dashAuthNum),r.switchVdAction({vd:l.vd,bid:l.bid,fileFormat:l.fileFormat})}else if(t===Fi.Error.severity.RECOVERABLE&&(a===Fi.Error.code.MEDIA_HIGH_BUFFER&&this._recoverMediaPerNum<this._recoverMediaMax||a!==Fi.Error.code.MEDIA_HIGH_BUFFER&&this._recoverMediaNum<this._recoverMediaMax)){var h=r.getCurrenttime(),_=this._recoverMediaNum;a==Fi.Error.code.MEDIA_HIGH_BUFFER?(this._recoverMediaPerNum>0&&h+1<r.getDuration()&&(h+=1),this._recoverMediaPerNum++,_=this._recoverMediaPerNum):(this._recoverMediaNum>0&&h+1<r.getDuration()&&(h+=1),this._recoverMediaNum++,_=this._recoverMediaNum),1==_&&d.sendLogToCompass("QVSR-"+i+"-"+a);var f=Aa.a.QVSR+"-"+a+"-"+_;d.sendErrorPlayPingback("",f),u.sendErrorPlayPingback("",f),s.log("qvs recovery , recovertime = "+h+" ,ec = "+f+", "+e.data.join("-")),r.hasSeeking=!0,r.qvs.recoverMedia()}else if(t===Fi.Error.severity.IGNORABLE){if(r.isAd()){var p=Aa.a.QVS+"-"+a;d.sendLogToCompass(Aa.a.AD+"-"+p),d.sendErrorPlayPingback("",p),u.sendErrorPlayPingback("",p)}r._statusChanged({status:Ha.Status_LoadFailed,actionType:!1,gas:n||o._getCurrentGas()})}else if(r._statusChanged({status:Ha.Status_LoadFailed,actionType:!1,gas:n||r.getCurrentGas()}),r.isAd()){var g=Aa.a.QVS+"-4703";d.sendLogToCompass(Aa.a.AD+"-"+g),d.sendErrorPlayPingback("",g),u.sendErrorPlayPingback("",g),s.warn("qvs state change -- ,params: type = error, (广告)QVS-"+a)}else s.log("qvs state change -- ,params: type = error, errorinfo = "+i+"-"+a+", "+e.data.join("-")+", recoveryNum = "+this._recoverMediaNum),this.brokedown(Aa.a.QVS,a)}},{key:"_onStatusChanged",value:function(e){var t=this,i=this.engine,a=this.proxy,n=this.logger,r=this.statusPool,s=i.sptr,o=i.ptr,d=i.pingback,u=i.pingbackV6,c=i.pingbackQOS,l=e.state;"playing"!==l&&"pause"!==l&&"stop"!==l&&"error"!==l||(a.hasSeeking=!1);var h=a.isPatch();if(!h||-1!==["loadedmetadata","playing","ended"].indexOf(l))switch(l){case"loadedmetadata":if(i.autoplay&&this._needPlay&&!a._videoSwitchPause){if(i.isPatch())return void a.play();if(i.errorcode&&"A00302"!==i.errorcode.code&&a.isAd())return;this._needPlay=!1,this._clearWaitingTimer();var _=a.play();_&&(a._duringPlay=!0,_.then((function(){a._duringPlay=!1,i.mutedstartplay=!1,n.log("Automatic playback started!")}),(function(e){e&&("NotAllowedError"===e.name||e.message&&/the user didn't interact with the document first/gi.test(e.message))?(n.warn("Automatic playback failed, muted video and then try to play!"),i.mutedstart=!0,i.setVolume(0,!0),a.fire(Va.a.NTF_PLAY_MUTED,{status:"playfailmuted"}),a.play().then((function(){n.warn("Play muted playback successful!"),a._duringPlay=!1,a.fire(Va.a.NTF_MutedStartPlay),i.mutedstartplay=!0}),(function(){a._duringPlay=!1,a._needPlay=!0,n.warn("Play muted playback failed, & Show a UI element to let the user manually start playback.!"),a._canGetVideoInfo(!0),a.fire(Va.a.NTF_NeedUserGesture4Playback)}))):(a._duringPlay=!1,a._needPlay=!0)})))}else a.pause(),n.warn("Pause video! cause params => autoplay=false or autoplay=0 "),a._canGetVideoInfo(!0),a.fire(Va.a.NTF_NeedUserGesture4Playback);a._videoSwitchPause=undefined,a._videoSwitching=undefined,a.isAd()||this._statusChanged(Va.a.Status_LoadedMetaData,e);break;case"playing":a._videoSwitchPause=undefined,a.tempStore.__sendFirstFrameShow||(a.tempStore.__sendFirstFrameShow=!0,s.plyaetm=+new Date,s.adUsedTime=s.adaetm-s.adastm,s.plyUsedTime=s.plyaetm-s.plyastm,o.usedTime_pageShowVideo=new Date-o.pgct,o.usedTime_showVideo=o.usedTime_pageShowVideo-o.usedTime_selfLoaded,this.getUserIpInfo()),a._paused=!1;var f={status:Ha.Status_Play,actionType:a._checkActionType(Ha.Status_Play)},p=a.currStatus,g=a.isDelayPlay(),m=!1;if(a._statusChanged(f),a.isAd())a._patchFirstPlay=!1,a._ADfirstPlay&&(a._ADfirstPlay=!1,a._canGetVideoInfo(!0),this._statusChanged(Va.a.Status_AdStartPlay,f),o.usedTime_adInit=new Date-o.pgct-o.sTime_adInit,n.log("ad start play,params: info = cur ad!")),r.has(Va.a.Status_ADEveryStartPlay)||this._statusChanged(Va.a.Status_ADEveryStartPlay,f),"play"===Hi("__pmobius__")&&d.sendLogToCompass("MOBIUS-AD"),this._statusChanged(Va.a.Status_AdPlaying,f);else{if(a._firstPlay&&(a._firstPlay=!1,m=!0,a._canGetVideoInfo(!0),this._statusChanged(Va.a.Status_StartPlay,f)),r.has(Va.a.Status_EveryStartPlay)||this._statusChanged(Va.a.Status_EveryStartPlay,f),h)return a._patchFirstPlay&&(a._patchFirstPlay=!1,this._statusChanged(Va.a.Status_PatchStartplay,f)),void this._statusChanged(Va.a.Status_Playing,f);a._patchFirstPlay=!0,this._statusChanged(Va.a.Status_Playing,f),m&&(d.sendTimingPingback(),u.sendTimingPingback()),p!==Va.a.Status_Waiting&&p!==Va.a.Status_Play||(d.sendPlayingPingback(),u.sendPlayingPingback()),a.tempStore.__sendMovieFirstFrameShow||(a.tempStore.__sendMovieFirstFrameShow=!0,d.sendStartPlayPingback(),u.sendStartPlayPingback(),c.sendProcessesPlayTimeRecord(),"play"===Hi("__pmobius__")&&d.sendLogToCompass("MOBIUS-MOVIE-".concat(a.qvs.currentLoaderMode.toUpperCase()))),Zi.a.openHeartBeat()}if(Zi.a.updateVipTypes(),!this.followUpNextLoadFlag){this.followUpNextLoadFlag=!0;var v={};i.isInteractVideo&&(v.uniqueId=i.iv_state.uniqueId,v.isInteractVideo=!0,v.tvid=i.getMovieInfo().tvid,v.vid=i.getMovieInfo().vid),a.fire(Va.a.NTF_FollowUpNextLoad,v)}g&&a.clearDelayPlayInfo(!1),a.tempStore.__nsta||(a.tempStore.__nsta=!0,i.notyfyADInfo({type:"video-play"})),a.tempStore.__sendADStartPPB||(a.tempStore.__sendADStartPPB=!0,d.sendADStartPlayPingback(),u.sendADStartPlayPingback()),this.sendStuckdetl(2),this._clearWaitingTimer(),this._dashAuthNum=0,this._recoverMediaPerNum=0;break;case"pause":a._paused=!0;var b={status:Ha.Status_Paused,actionType:a._checkActionType(Ha.Status_Paused)};a._statusChanged(b),a.isAd()?this._statusChanged(Va.a.Status_AdPaused,b):(a._timeMark=0,this._statusChanged(Va.a.Status_Paused,b),Zi.a.stopHeartBeat());break;case"waiting":a._paused=!0;var y={status:Ha.Status_Waiting,actionType:a._checkActionType(Ha.Status_Waiting)},k=a.isAd();a._statusChanged(y),k?this._statusChanged(Va.a.Status_AdWaiting,y):(a._timeMark=0,this._statusChanged(Va.a.Status_Waiting,y),Zi.a.stopHeartBeat()),a.hasSeeking||a.qvs.recovering||!a.tempStore.__nsta||(this._clearWaitingTimer(),this._waitingStartTime=+new Date,this.waitingTimer=setTimeout((function(){d.sendWaitingPingback(k),u.sendWaitingPingback(k),clearTimeout(t.waitingTimer)}),1500));break;case"seeking":a._videoSwitchPause=undefined;var T=a.getCurrenttime(),S=a.getDuration();a._paused=!0,a.fire(a.isAd()?Va.a.NTF_AD_Seeking:Va.a.NTF_Seeking,{current:T,duration:S,actionType:a._checkActionType(Ha.NTF_Seeking)}),this.lastCurrentTime=undefined;break;case"seeked":var P=a.getCurrenttime(),x=a.getDuration();this._clearWaitingTimer(),a.hasSeeking=!1,a.fire(a.isAd()?Va.a.NTF_AD_Seeked:Va.a.NTF_Seeked,{current:P,duration:x,actionType:Ha.Action_Type_Code});break;case"progress":a.fire(Ha.NTF_Progress,{buffer:a.getBufferTime()});break;case"EOR":i.episode.finishPres(i.getMovieInfo().tvid,!0);break;case"EOM":a._statusChanged({status:Ha.Status_Loaddone,actionType:!1});break;case"willended":a._statusChanged({status:Ha.Status_Will_Stoped,actionType:!1});break;case"beforeended":a.qvs.media.loop=i.cyclePlay;break;case"ended":a._paused=!0;var I=i.getMovieInfo(),E={status:Ha.Status_Stoped};if(a.isAd()||!a.isAd()&&a.checkAuthTime(I.isVIP&&I.previewTime<Infinity?I.previewTime+1:1e3*a.getCurrenttime())){if(a._statusChanged(E),this._clearWaitingTimer(),a.isAd())this._statusChanged(Va.a.Status_AdPlayEnded,E);else a._timeMark=0,a.isLast()&&this._statusChanged(Va.a.Status_Stoped,E);Zi.a.stopHeartBeat()}break;case"loadstart":(a.isAd()||e.gas)&&a._statusChanged({status:Ha.Status_Loadstart,eventOrigin:"ad",gas:e.gas})}}},{key:"_onMediaBufferCreated",value:function(){this._needPlay=!0}},{key:"_onDataSourceStageSwitching",value:function(){var e=this.proxy,t=this.engine,i=t.p2p,a=t.movieinfo;if(clearTimeout(e._switchDelayTimer),e._switchDelayTimer=null,e.switchVmsRequest&&e.switchVmsRequest){var n=e.switchVmsRequest.getXhrRequest();n&&n.abort&&n.abort()}i.enabled&&(t.autoVdUsing&&i.setBitrate(a.tvid,t.autoVdValue),i.__switchToNextTvid(),i.seek(-1))}},{key:"_onDataSourceStageSwitched",value:function(){var e=this.engine,t=e.movieinfo,i=e.skip;if(this._recoverMediaNum=0,this.engine.getCurrManifestType()===Fi.ManifestTypes.F4V&&!this.engine.isAd()){var a=this.engine.p2p;a.enabled&&!a.isClosed()&&a.close()}i&&this.proxy._skipTT>0||!t.parts||this.qvs.changeEndPatch(t.parts.type,t.parts.data,!0)}},{key:"_onDNSParser",value:function(e){this.logger.info("DNSParser, qvs = > "+JSON.stringify(e)),this.engine.pingbackQOS.sendQOSReport({type:"DNSParser",para:e})}},{key:"brokedown",value:function(e,t,i){var a=this.proxy,n=this.engine,r=this.logger,s=n.pingback,o=n.pingbackV6;a.pause();var d=this.getData();d.type=e,d.code=t,d.st=i||"";var u=e+"-"+t;if(i&&(u+="-"+i),512==i&&Ba)a.fire(Va.a.NTF_BuyPlay,d);else{r.info("playproxy brokedown, pingback, ec = ".concat(u)),t&&t!==Aa.a.P07001&&(s.sendErrorPlayPingback("",u,i),o.sendErrorPlayPingback("",u,i)),n.errorcode=d,a.fire(Va.a.NTF_Error,d),this.followUpNextLoadFlag||(this.followUpNextLoadFlag=!0,a.fire(Va.a.NTF_FollowUpNextLoad,""));var c=aa.vmsUrl,l=this;$a(c,(function(e){l.logger.info("request, dnsparser, info = "+e+",url = "+c),l.getUserIpInfo((function(){s.sendLogToCompass(u)}))}))}}},{key:"getUserIpInfo",value:function(e){var t=this;Zi.a.getUserIPInfo((function(i){var a=Zi.a.getUid(),n="";a||(n=S.a.get("P00002")),t.logger.info("user info, uid = "+a+", P00002 = "+n+", P00003 = "+S.a.get("P00003")+",v.f4v = "+JSON.stringify(i)),e&&e()}))}},{key:"_clearWaitingTimer",value:function(){clearTimeout(this.waitingTimer),this.waitingTimer=0,this._waitingStartTime=0}},{key:"sendStuckdetl",value:function(e){this.waitingTimer>0&&(this.engine.pingbackQOS.sendStuckdetl(e,this._waitingStartTime,this.proxy.isAd()),this._clearWaitingTimer())}}]),e}();function un(e){var t=parseInt(e,10);return t<9e7&&(t=100*(t+9e5)),t}var cn=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,e))).logger=new v.a("PlayProxy[".concat(e.id,"]")),i.engine=e,i.currStatus="",i._firstPlay=!0,i._ADfirstPlay=!0,i._patchFirstPlay=!0,i._timeMark=0,i._vdsSwitch=!1,i._playingDuration=0,i._playingSpend=0,i._skipHT=0,i._skipTT=0,i.__canGetVideoInfo=!1,i._autoVdEnable=!1,i._autoVdUsing=!1,i.autoVdValue=-1,i.tempStore={},i.failProgramKey=undefined,i.isP2PProcedureDone=!1,i._isAllowSeek=!0,i._isDelayPlay=!1,i._delayPlayTime=0,i._delayTimer=null,i}return f()(t,e),s()(t,[{key:"init",value:function(e,i){m()(c()(t.prototype),"init",this).call(this,e);var a=this,n=this.engine,r=n.pack,s=n.p2p,o=n.i18n,d=Ca();this.useVP9P2P=d.canaryVP9_P2P,this.useAV1P2P=d.canaryAV1_P2P,this.useCDNLoader=function(e,t,i){if(!e)return!0;var a=Hi("__ploader__");if(a){if("cdn"===a)return!0;if("p2p"===a)return!1}return!1}(s.enabled),this.provider=new Ua(this.engine),r.ad||(this.adDisable=!0),this.logger.enabledFor(v.a.levels.DEBUG)&&(Fi.Conf.DEBUG=!0),Fi.logger.enable=!0,Fi.logger=this.logger,Fi.externals.md5=b.a,Fi.externals.cmd5x=k.a.cmd5x,Fi.externals.UUID=T.a,Fi.externals.filesize=P.a;var u=new Fi(e,{enableWorker:!0,switchVariantImmediate:!1,useP2P:!this.useCDNLoader,p2pLoader:s.enabled?s:null});window.qvs=this.qvs=u,u.config.useVP9P2P=this.useVP9P2P,u.config.useAV1P2P=this.useAV1P2P,u.on(Fi.Events.FPS_REPORT,(function(e){a.fire(Va.a.NTF_FPS_REPORT,e)})),s.enabled&&s.__setQVS(u),this._eventer=new dn(this.engine);var l=!!this.engine.params.sourcePage&&"home"==this.engine.params.sourcePage;o.isTWLocale()||l||this.useCDNLoader||0!=this.engine.userSetBid||(this._autoVdEnable=!0,this._autoVdUsing=!0,1===parseInt(S.a.get("QP0025"),10)&&(this._autoVdUsing=!1))}},{key:"load",value:function(e){var t=this,i=this.qvs,a=this.engine,n=this.logger,r=this.provider,s=this.engine,o=s.episode,d=s.movieinfo,u=e.tvid,c=e.vid,l=e.ugcAuthKey,h=e.imageLoader,_=e.startPlayTime,f=e.isSupportAI,p=e.share_sTime,g=e.share_eTime,m=this.hasPreload(u);if(a.preVideoParam||(a.preVideoParam=e),d.tvid!=u||d.vid!==c||l||a.isInteractVideo){var v="check failProgramKey, tvid = ".concat(u," , key = ").concat(this.failProgramKey);if(this.failProgramKey&&this.failProgramKey.tvid&&(v+=",key.tvid = ".concat(this.failProgramKey.tvid,", num = ").concat(this.failProgramKey.num),this.failProgramKey.tvid==u&&this.failProgramKey.num>=3))n.info(v);else{n.info(v),parseInt(u,10)<9e7&&n.error("Core Player load movie info error,params: msg = "+u+"is not invalid qipu id"),this._firstPlay=!0,this._ADfirstPlay=!0,this._patchFirstPlay=!0,d.setStartPlayTime(_>0?_:0),d.tvid&&o.clear(d.tvid),l&&(d.ugcAuthKey=l||"",r.clearCache(u,c)),a.adWholeCorner=!1;var b=d.current;d.current={tvid:u,vid:c,albumId:e.albumId,adPlayerID:e.cid,imageLoader:h,isPreload:m},n.info("load movieInfo,info,params: tvid = ".concat(u,",vid = ").concat(c,", adPlayer = ").concat(e.ares,", pretvid = ").concat(b.tvid,", isSupportAI = ").concat(f)),b.tvid&&this.fire(Va.a.NTF_VideoChange,{preMovieInfo:b,curMovieInfo:d.current}),o.valid(u,!0),clearTimeout(this._switchDelayTimer),this.tempStore={},this.fire(Va.a.NTF_VRSStart,{data:this._eventer.getData(),movieinfo:d.current}),this.clearDelayPlayInfo(!1),r.getPromise(u,c).then((function(i){if(i.originalData.data.p.bt&&(t._skipHT=i.originalData.data.p.bt,t._skipTT=i.originalData.data.p.et),i.parts instanceof ka){var r=t.getPatchData(i.parts,i);i.parts=r,n.info("load movieInfo ok, has parts, type = ".concat(r.type))}i.imageLoader=h||"",i.isSupportAI=Boolean(f),e.cid&&(i.adPlayerID=e.cid),d["switch"](i),d.initShareTime(p,g),d.resetFLVDuration();var s=d.current;o.setInfo(u,s);var c=d.getVDInfo();t.isAssembled(c).then((function(){t.fire(Va.a.NTF_VRSReady,{data:t._eventer.getData(),movieinfo:s}),a.eventlog.vrsready=!0,b.tvid&&t.fireChanged(),(t.adDisable||o.finishPres(u))&&t.concatCurFeature(u),s.isPreload=!1}))}),(function(e){var a="check failProgramKey ++, tvid = ".concat(u," , key = ").concat(t.failProgramKey);t.failProgramKey?t.failProgramKey.tvid==u&&t.failProgramKey.num++:t.failProgramKey={tvid:u,num:1},a+=",key.tvid = ".concat(t.failProgramKey.tvid,", num = ").concat(t.failProgramKey.num),n.info(a),d.setInfo(e.movieinfo);var r=e.level,s=e.type,o=e.code,c=e.st;switch(r){case 0:i.reset(),t._eventer.brokedown(s,o,c);break;case 1:i.reset(),t.noticeRecharge(o);break;case 2:i.reset(),t._eventer.brokedown(s,o,c);break;default:n.error(e&&e.stack?e.stack:e)}t.fire(Va.a.NTF_VRSDone),b.tvid&&t.fireChanged()}))}}else n.error("tvid vid should not the same")}},{key:"isAssembled",value:function(e){var t=this,i=this.engine,a=i.p2p;return new Promise((function(e){function n(){t.isP2PProcedureDone=!0,e()}a.enabled?a.isReady()?n():(a.on("ready",(function(){n()})),i.initP2P()):n()}))}},{key:"preload",value:function(e,t){var i=this,a=this.engine,n=a.episode,r=a.movieinfo;a.eventlog;n.valid(e,!0),this.provider.getPromise(e,t).then((function(t){i.checkVipPay(t.vipBlock,t.vipTheatre,t.albumId,t.authTipType,(function(a){if(i.logger.info("preload movieInfo ok,checkVipPay = ".concat(a," ")),!a){if(t.parts instanceof ka){var s=i.getPatchData(t.parts,t);t.parts=s,i.logger.info("preload movieInfo ok, has parts, type = ".concat(s.type))}r.preload(t),n.setInfo(e,t);var o=r.getVDInfo(!0);i.isAssembled(o).then((function(){i.fire(Va.a.NTF_VRSPreloaded,{movieinfo:t})}))}}))}),(function(e){i.logger.warn("preload movie which requires auth: "+v.a.stringify(e))}))}},{key:"fire",value:function(e,t){this.engine.emit(e,t)}},{key:"getCurrentGas",value:function(){var e=this.qvs,t=this.engine;return this.isAd()?e.getCurrentADGas():{videoEventId:Ya.getEventId(t.movieinfo.tvid)}}},{key:"isAd",value:function(){return this.qvs.isRolling}},{key:"isPatch",value:function(){return!!this.engine.movieinfo.parts&&this.qvs.isPatching}},{key:"isLast",value:function(){return this.qvs.isLast}},{key:"getManifest",value:function(e,t){var i,a,n=t.manifestParser;switch(e.fileFormat){case"ts":i=Fi.ManifestTypes.HLS,a={data:e.m3u8,bid:e.bid};try{n.fragments.length>0&&(a.parser=n)}catch(r){}break;case"f4v":i=Fi.ManifestTypes.F4V,a=Ga(e,t);break;case"m4s":i=Fi.ManifestTypes.JDASH,a=e.m3u8;break;case"mp4":i=Fi.ManifestTypes.MP4,a={data:e.m3u8,bid:e.bid,duration:e.duration,size:e.vsize};break;case"dash_vp9":case"dash_av1":"dash_vp9"===e.fileFormat?i=Fi.ManifestTypes.DASH_VP9:"dash_av1"===e.fileFormat?i=Fi.ManifestTypes.DASH_AV1:this.logger.error("DASH unknown codec ".concat(e.code)),a={data:e.m3u8,bid:e.bid};try{n.tracks.video.fragments.length>0&&n.tracks.audio.fragments.length>0&&(a.parser=n)}catch(r){}}return{manifestType:i,manifestContent:a}}},{key:"getManifestTypes",value:function(){return Fi.ManifestTypes}},{key:"clear",value:function(){var e=this.engine,t=e.adproxy,i=e.episode;this.adDisable||t.clear(),this._vdsSwitch=!1,this.currStatus="",clearTimeout(this._switchDelayTimer),this.qvs.reset(),i.clearAll(),this.engine.errorcode=undefined}},{key:"destory",value:function(){this.clear(),this.provider.clearAll(),this._eventer.destory(),this.qvs.destroy(),this.removeAllEventsListener()}},{key:"_getDataFlow",value:function(e){var t=undefined,i="getDataFlow, ..";if(e&&(t={},e.segments&&(t.stream=e.segments,i="getDataFlow, segments length = ".concat(t.stream.length)),e.tracks)){var a=e.tracks,n=a.video,r=a.audio;t.audio={duration:r.duration,init:r.initSegment,segments:r.segments},t.video={duration:n.duration,init:n.initSegment,segments:n.segments},i="getDataFlow, audio.length = ".concat(r.segments.length,"， video.length=").concat(n.segments.length)}return this.logger.info(i),t}},{key:"concatCurFeature",value:function(e){var t=this.engine,i=this.provider,a=this.autoVdValue,n=this.isP2PProcedureDone,r=t.movieinfo,s=t.episode,o=t.p2p,d=t.autoVdUsing,u=t.skip,c=r.getVDInfo(),l=r.current,h=r.startPlayTime,_=l.manifestParser,f=i.getPid(l.tvid,l.vid),p=i.getParams(f),g=i.getData(f),m=this.getManifest(c,l),v=m.manifestType,b=m.manifestContent,y=this._shouldP2PAssembled(v);if(s.finishFeatures(e)&&y&&o.enabled&&d&&o.setBitrate(e,a),!g||!n||y&&!o.isReady()||s.finishFeatures(e))this.logger.info("".concat(f," still not ready"));else{this.logger.info("concat cur episode: ".concat(e)),c.duration>0&&(l.duration=c.duration,h>=l.duration&&(r.startPlayTime=0));var k=r.getPlayHead(),T=k.timeRanges,S=k.playHeadTime,P=parseInt(c.bid,10);if(c.requestParam=p,c.responseData=g.originalData,o.enabled){var x=performance.now();if(y){var I=o.__getPlayId(!0),E=o.__getPlayId(!1),D=!!I&&I===e+"",w=o.isClosed()||!I||D;if(E!==e+""){var A=this.adjustTimeRange(T),q=this._getDataFlow(_);o.feed(p,g.originalData,A,w,P,q),d&&o.setBitrate(p.tvid,a)}else d&&o.setBitrate(e,a);D&&o.seek(T[0][0]),w||o.__switchToNextTvid(),this.logger.log("p2p feed & seek by player cost ".concat((performance.now()-x).toFixed(3),"ms"))}else o.isClosed()||o.close()}this._eventer._recoverMediaNum=0,b&&(s.finishFeatures(e,!0),this.qvs.loadVariant(v,b,S,T)),u&&this._skipTT>0||!g.parts||this.qvs.changeEndPatch(g.parts.type,g.parts.data,!0)}}},{key:"concatPreloadFeature",value:function(e){var t=this.engine,i=t.movieinfo,a=t.episode,n=t.p2p,r=this.qvs,s=this.provider,o=a.getInfo(e),d=i.getPlayTimeRanges(!0),u=i.getVDInfo(!0),c=this.getManifest(u,o),l=c.manifestType,h=c.manifestContent,_=s.getPid(o.tvid,o.vid),f=s.getParams(_),p=s.getData(_);if(this.logger.log("concat preload episode: ".concat(e)),n.enabled&&this._shouldP2PAssembled(l)){var g=this.adjustTimeRange(d,!0),m=n.isClosed(),v=this._getDataFlow(o.manifestParser),b=u.bid;n.feed(f,p.originalData,g,m,b,v)}a.finishFeatures(e,!0),r.preloadVariant(l,h,null,d)}},{key:"checkPreload",value:function(){var e=!0,t=this.engine.getMovieInfo(),i=this.getCurrenttime(),a=this.getDuration();return e=(e=(e=(e=e&&!this.isAd())&&this.qvs.endOfDown)&&t.previewTime===Infinity)&&a-i>=5}},{key:"getCurrenttime",value:function(){var e=0,t=this.getDuration();return(e=this.isAd()?this.qvs.currentTime:this.getDecodeCurrenttime())<t||isNaN(t)?e:t}},{key:"getDuration",value:function(){var e=0,t=this.engine.movieinfo,i=t.current,a=t.getVDInfo();return this.isAd()?e=this.qvs.datasource.duration:i.isVIP&&i.isTryWatch&&a?e=a.duration:this.qvs&&this.qvs.datasource&&(e=this.qvs.datasource.duration),e}},{key:"refresh",value:function(e){var t=this.engine.movieinfo,i=t.current,a=i.tvid,n=i.vid,r=i.adPlayerID;a&&(t.next.isPreload=!1,t.clear(),this.clear(),this._eventer.statusPool.removeAll(),this._eventer.statusPool.add(Va.a.Status_Idle),this.provider.clearAll(a),this.logger.log("Core Player refresh， type = "+e),this.fire(Va.a.NTF_VideoRefresh),this.load({tvid:a,vid:n,cid:r}))}},{key:"abortAres",value:function(){this.isAd()&&this.qvs.abortCurrentADGas()}},{key:"abortAllAres",value:function(e){var t=this;setTimeout((function(){t.logger.info("abort all ".concat(e," roll;"));var i=null;switch(e){case"preroll":i=Fi.RollTypes.PRE_ROLL;break;case"midroll":i=Fi.RollTypes.MID_ROLL;break;case"briefRoll":i=Fi.RollTypes.BRIEF_ROLL}t.qvs.abortRollingStream(i)}),0)}},{key:"lockSeek",value:function(){this._isAllowSeek=!1}},{key:"unlockSeek",value:function(){this._isAllowSeek=!0}},{key:"pause",value:function(e,i){this._duringPlay&&!i||(this._videoSwitching&&i&&(this._videoSwitchPause=!0),m()(c()(t.prototype),"pause",this).call(this,e,i))}},{key:"seek",value:function(e,t,i){var a=this.getDuration();e>a&&(e=Math.floor(a)),this.logger.log("Engine:seek(".concat(e,"), duration (").concat(a,"),isManualAction=").concat(t)),this.fire(Va.a.NTF_Before_Seeking,{currentTime:this.getCurrenttime(),isAd:this.isAd()}),e=parseFloat(e),this.hasSeeking=!0,this.checkAuthTime(1e3*e)&&(t?this._currentManualAction=Ha.NTF_Seeking:this._currentCodeActionList.push(Ha.NTF_Seeking),this._isAllowSeek&&(this.checkchangerange(e),this.qvs.seek(e)),this.isPaused()&&!i&&this.play())}},{key:"checkchangerange",value:function(e){var t=this.engine,i=t.movieinfo,a=t.p2p;if(t.skip&&this._skipTT>0&&e>this._skipTT){var n=[[0,this.getDuration()]];this.qvs.updateMediaRanges(n),a.enabled&&a.refreshLoadRange(i.tvid,this.adjustTimeRange(n))}}},{key:"checkAuthTime",value:function(e){var t=!0,i=this.engine.getMovieInfo();return i.isVIP&&e>=i.previewTime&&(this.noticeRecharge("Q00304"),t=!1),t}},{key:"noticeVidChanged",value:function(e,t){var i=this.engine.movieinfo;e?(i.vd=t,this.engine.vd=t,this.__isManualAction&&(this.engine.vd=t),this.logger.log("definition changed: ".concat(t))):this.logger.log("definition changeFail: ".concat(t)),this._vdsSwitch=!1,this.fire(Va.a.NTF_DefinitionSwitched,{curVD:t,success:e,isManualAction:this.__isManualAction}),i.autoChangeVdinfo=!1,this.__isManualAction=!1}},{key:"switchData",value:function(e,t){var i=this,a=this.qvs,n=this.engine,r=this.logger,s=n.p2p,o=n.movieinfo,d=n.autoVdUsing,u=!1,c=e.vd,l=e.bid;if(s.enabled&&!t&&c===this.autoVdValue)d&&s.setBitrate(o.tvid,c);else{if(this.switchVmsRequest&&this.switchVmsResponse&&(e.requestParam=this.switchVmsRequest.getReqParams(),e.responseData=this.switchVmsResponse),-1!==c){var h=this.getManifest(e,o.current),_=h.manifestType,f=h.manifestContent;if(s.enabled&&t&&(f.isClearBuffer=!1),!a.allowSwitchVariant)return void r.warn("this stream will end, can't switch variant!");var p=a.currentManifestType;if(null!==p&&_!==p&&(u=!0),s.enabled&&!t&&this._shouldP2PAssembled(_)){var g=o.getPlayTimeRanges(),m=this.adjustTimeRange(g);s.feed(e.requestParam,e.responseData,m,!0,l)}if(a.switchVariant(_,f,u),t!==undefined&&(o.vd=c,n.vd=c,r.log("definition changed: "+c)),u||this.video().readyState<3)this.once(Ha.NTF_TimeUpdate,(function(){i.noticeVidChanged(!0,c)}));else if(!t){var v=parseInt(1e3*a.bufferInfo.media.len/this.getPlaybackRate()+"",10);this.logger.log("will switch Variant after: "+v/1e3+"s"),this._switchDelayTimer=setTimeout((function(){i.noticeVidChanged(!0,c)}),v)}}this.switchVmsRequest=this.switchVmsResponse=null}}},{key:"switchDefinition",value:function(e,t){var i=this.logger,a=this.engine,n=a.movieinfo;e===this.getCurrentVD()&&!a.autoVdUsing||e===this.autoVdValue&&(a.autoVdUsing||!a.autoVdEnabled)||(e===this.autoVdValue?(this.switchVD(e),i.log("definition changed: "+e),this.fire(Va.a.NTF_DefinitionSwitching,{vd:e,isManualAction:t}),this.fire(Va.a.NTF_DefinitionSwitched,{curVD:e,success:!0,isManualAction:!0})):(this.__isManualAction=t,this._vdsSwitch=!0,this.fire(Va.a.NTF_DefinitionSwitching,{vd:e,isManualAction:t}),n.autoChangeVdinfo=!t,this.switchVD(e)))}},{key:"switchAudioTrack",value:function(e){var t=this,i=this.engine,a=i.movieinfo,n=i.vd,r=i.pingback,s=i.ptr,o=i.sptr,d=a.current,u=d.audl.types;if(!(u.length<=1)){d.oldLid=d.currentLid||"",this.logger.log("will switch audio: ".concat(d.oldLid," to ").concat(e));for(var c=a.vidl,l=d.vid,h=0;h<c.length;h++)if(c[h].vd==n){l=c[h].vid;break}n=Xi.getNewVd(n);for(var _=0;_<u.length;_++)u[_].id===e&&(1!==u[_].ispre?(new Na).request({params:{tvid:d.tvid,vid:l,vd:n,lid:e,tryCount:0,switchvd:!0},pingback:r,ptr:s,sptr:o,hostUseIP:!1},(function(i){if(i.data&&i.data.st){var a=parseInt(i.data.st,10),n=i.data,r=n.boss_ts?"boss_ts":"boss";if(100<a&&a<200)if(n.program&&n.program.audio){n[r]&&n[r].code&&d.boss&&d.boss.data&&(d.boss=n[r]),d.audio=n.program.audio;var s=ya(d,!0);d.audl=s,s&&s.audio?t.switchAudio(s.audio,e):t.getAdFail()}else t.getAdFail();else t.getAdFail()}else t.getAdFail()}),(function(){t.getAdFail()})):this.switchAudio(null,e))}}},{key:"switchVD",value:function(e){if(e==this.autoVdValue)this._autoVdUsing=!0,this.switchVdAction({vd:e}),S.a.set("QP0025","0",{expires:2592e5,path:"/",domain:"iqiyi.com"});else{var t=this.engine.movieinfo.getVDInfo(!1,e);this._autoVdUsing=!1,this.switchVdAction(t),S.a.set("QP0025","1",{expires:2592e5,path:"/",domain:"iqiyi.com"})}}},{key:"switchVdAction",value:function(e,t){var i=this,a=this.engine,n=this.logger,r=a.movieinfo,s=a.ptr,o=a.sptr,d=a.pingback;if(n.log("definition changing: "+e.vd),t!==undefined)n.info("switchVD, from p2p, vd = "+e.vd),this.getVdComplete(t,e,!0);else if(e.m3u8&&e.responseData||-1===e.vd)n.info("switchVD, vd = "+e.vd),this.switchData(e);else{var u=Xi.getNewVd(e.vd),c=r.current,l=c.tvid,h=c.vid;n.info("switchVD, load movieInfo from vrs,params: tvid = ".concat(l,'", vid = "').concat(h,'", ')+'islogin = "'.concat(Zi.a.isLogin(),'", vd = "').concat(u,'"|"').concat(e.vd)),this.switchVmsRequest=(new Na).request({params:{tvid:l,vid:e.vid,vd:u,tryCount:0,switchvd:!0},pingback:d,ptr:s,sptr:o,hostUseIP:!1},(function(t){i.getVdComplete(t,e)}),(function(){i.noticeVidChanged(!1,e.vd)}))}}},{key:"getVdComplete",value:function(e,t,i){var a=this.engine.movieinfo,n=a.current,r=t.vd;if(this.switchVmsResponse=e,e.data&&e.data.st){e=e.data;var s=parseInt(e.st,10);if(100<s&&s<200){var o=wa(e,n,{targetVd:r,fileFormat:t.fileFormat},!1);if(o&&n.vidl){if(n.isVIP){var d=e.boss_ts?"boss_ts":"boss";o.segments.map((function(t){return t.boss||(t.boss=e[d],t.boss.bossKeyTime=+new Date),t}))}for(var u=0;u<n.vidl.length;u++)if(n.vidl[u].vd==o.vd){n.vidl[u]=o,o.isAccurateTimeStamp!==undefined&&(n.isAccurateTimeStamp=o.isAccurateTimeStamp),n.manifestParser=o.manifestParser;break}a.resetFLVDuration(),this.switchData(o,i)}else this.noticeVidChanged(!1,r),this.logger.info("switchVD, vidl failed, ".concat(!!o,", ").concat(!!n.vidl))}else this.noticeVidChanged(!1,r)}else this.noticeVidChanged(!1,r)}},{key:"getAdFail",value:function(){var e=this.engine.getMovieInfo();e.currentLid=e.oldLid,this.fire(Va.a.NTF_AudioSwitched,{success:!1}),this.logger.info("switch audio Fail!")}},{key:"switchAudio",value:function(e,t){var i=this,a=this.logger,n=this.engine.getMovieInfo();if(this.qvs.switchAudioVariant(e,!1),this.video().readyState<3)this.once(Ha.NTF_TimeUpdate,(function(){n.currentLid=t,i.fire(Va.a.NTF_AudioSwitched,{success:!0})}));else{var r=parseInt(1e3*this.qvs.bufferInfo.media.len/this.getPlaybackRate()+"",10);a.log("will switch audio after: "+r/1e3+"s"),this._switchDelayTimer=setTimeout((function(){n.currentLid=t,i.fire(Va.a.NTF_AudioSwitched,{success:!0})}),r)}}},{key:"getBufferTime",value:function(){var e=0;return this.isAd()||(e=this.qvs.bufferInfo.data.end),e}},{key:"setSkipPrelude",value:function(){var e=this.engine,t=e.movieinfo,i=e.p2p,a=e.skip,n=t.getPlayTimeRanges();this._skipTailTipped=!1,this.qvs.updateMediaRanges(n),t.parts&&(a?this.qvs.changeEndPatch():this.qvs.changeEndPatch(t.parts.type,t.parts.data,!0)),i.enabled&&i.refreshLoadRange(t.tvid,this.adjustTimeRange(n))}},{key:"adjustTimeRange",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=this.engine.movieinfo,a=i.current,n=i.next,r=a;if(t&&(r=n),e.length>0){var s=r.duration,o=e[0][0],d=e[0][e[0].length-1],u=1;if(s>0&&d<s&&d+u>=s?d=s:d+=u,e[0][e[0].length-1]=d,"boolean"==typeof r.isAccurateTimeStamp&&!r.isAccurateTimeStamp){var c=this.qvs.config.hlsRangeTSTolerance;e=[[o=o-c>=0?o-c:0,d=d+c<=r.duration?d+c:d]];try{this.logger.info("=== top2p reset timerange = "+e[0][0]+"-"+e[0][e[0].length-1])}catch(l){}}}return e}},{key:"getCurrentVD",value:function(){return parseInt(this.engine.movieinfo.vd,10)}},{key:"_canGetVideoInfo",value:function(e){var t=this;this.__canGetVideoInfo=e,e&&this.getVideoInfo((function(e){if(e){var i=t.engine.getMovieInfo();e.sid&&(i.sid=e.sid,i.albumId=e.sid),i.cType=e.cType}}))}},{key:"getVideoInfo",value:function(e){var t=this,i=t.engine,a=i.movieinfo,n=i.local,r=a.current,s=a.next;if(t.__canGetVideoInfo){var o=r;o.tvid||(o=s),Qi.get({tvid:o.tvid,vid:o.vid,locale:n},(function(i){i.vi&&(t.engine.isInteractVideo&&t.engine.iv_state.isI5Custom?(i.vi.isI5Custom=t.engine.iv_state.isI5Custom,i.vi.IPARTMENT5_DANMUSWITCH=t.engine.iv_state.others.IPARTMENT5_DANMUSWITCH):(i.vi.isI5Custom=!1,i.vi.IPARTMENT5_DANMUSWITCH="0")),e(i)}))}else setTimeout((function(){var i={tvid:r.tvid,vid:r.vid,albumId:r.albumId,cid:r.cid,vi:{vid:r.vid,videoQipuId:r.tvid}};t.engine.isInteractVideo&&t.engine.iv_state.isI5Custom&&(i.vi.isI5Custom=t.engine.iv_state.isI5Custom,i.vi.IPARTMENT5_DANMUSWITCH=t.engine.iv_state.others.IPARTMENT5_DANMUSWITCH),e(i)}),0)}},{key:"getVideoInfoByTvid",value:function(e,t){Qi.get({tvid:e,vid:"",locale:this.engine.local},(function(e){t(e)}))}},{key:"hasPreload",value:function(e){var t=this.engine.episode;return e+="",t.finishPres(e)&&t.finishFeatures(e)}},{key:"switchVideo",value:function(e){var t=this.logger,i=this.engine,a=i.movieinfo,n=i.pingback,r=i.pingbackV6,s=e.tvid,o=e.vid,d=e.cid,u=e.imageLoader,c=e.vfrm,l=e.vfrmblk,h=e.vfrmrst,_=e.startPlayTime,f=e.isSupportAI,p=e.share_sTime,g=e.share_eTime,m=e.innerIV,b=e.interactionType,y=e.isEnabledInteraction,k=a.current,T=a.next,S=!0===e.autoSwitch&&!!this.hasPreload(s,o);if(this.failProgramKey=undefined,this._videoSwitchPause=undefined,this._videoSwitching=!0,i.preVideoParam=e,s=un(s),parseInt(s)===parseInt(k.tvid)&&!i.isInteractVideo)t.info("switch video,params: data = "+v.a.stringify(e)+"    switch fail : Tvid is same");else{var P={vfrm:c||"",vfrmblk:l||"",vfrmrst:h||"",vfrmtp:e.autoSwitch?3:0,vvauto:e.autoSwitch?4:2};n.setvvfrom(e.vvfrom),r.setvvfrom(e.vvfrom),n.setPlayPingbackInfo(P),r.setPlayPingbackInfo(P),n.sendEndPlayPingback(S?1:2),r.sendEndPlayPingback(S?1:2,k.tvid);this.provider.clearAll(k.tvid),S||(T.isPreload=!1,this.pause(),this.clear(S),this._eventer.statusPool.removeAll(),this._eventer.statusPool.add(Va.a.Status_Idle)),this._preplaying_spend=this._playingSpend,this._playingSpend=0,function(){e.autoSwitch=S;var a="\nswitch video:"+v.a.stringify(e)+", ivosRuning="+i.ivosRuning,n="\n"+new Array(a.length).join("-");t.log(n+a+n)}();var x,I=1==Number(y)&&(1==Number(b)||0==Number(b))&&!$i.a.browser.EDGE;if(this.engine.isIVSubSwitch=!1,I)x=!0,i.isInteractVideo=!0,i.adPlaySource=0,i.others={},i.isIVMain=x,i.interactionMode=b+"",i.initInteractVideo({tvid:s,vid:o||i.params.vid,cid:d,imageLoader:u,resetHistory:!0});else{m?(x=s===i.iv_state.uniqueId,i.interactionMode=i.iv_state.interactionMode,i.isInteractVideo=!0,i.isIVMain=x,i.adPlaySource=61,i.isIVSubSwitch=!0):(i.isInteractVideo=!1,i.adPlaySource=0,i.others={});var E={tvid:s,vid:o||i.params.vid,cid:d,startPlayTime:_,imageLoader:u,isSupportAI:f};p!==undefined&&(E.share_sTime=p),g!==undefined&&(E.share_eTime=g),this.load(E)}}}},{key:"hasStatus",value:function(e){return this._eventer.statusPool.has(e)}},{key:"setEndPlay",value:function(e){this._eventer._statusChanged(Va.a.Status_End_Play,e)}},{key:"fireChanged",value:function(){var e=this;e.getVideoInfo((function(t){var i=e._eventer.getData();i.vi=t.vi||{},i.vi.vid=i.vid,e.engine.isInteractVideo?Qi.get({tvid:e.engine.iv_state.uniqueId,vid:i.vid},(function(t){i.vi.unique_vu=t.vi.vu,e.engine.iv_state.isI5Custom&&(i.vi.isI5Custom=!0,i.vi.IPARTMENT5_DANMUSWITCH=e.engine.iv_state.others.IPARTMENT5_DANMUSWITCH||"0"),e.fire(Va.a.NTF_VideoChanged,i)})):e.fire(Va.a.NTF_VideoChanged,i),e.logger.info("core videoChanged")}))}},{key:"noticeRecharge",value:function(e,t){var i=this.engine,a=i.movieinfo,n=i.params;a.rc_code=e;var r=!1;if(a.vipTypes&&a.vipTypes.length>0)for(var s=0;s<a.vipTypes.length;s++)1==a.vipTypes[s]&&(r=!0);var o=a.vipTypes||[],d=-1!=o.indexOf(1)||-1!=o.indexOf(6);this.pause(!1,!0);var u={tvid:a.tvid,vid:a.vid,code:e,isTennisContent:r,from:t||0,origin:n.origin||n.parentId,vipTypes:a.vipTypes,s3:d?this.hasSeeking?"S109":"S110":"",s4:d?"SHIKAN":"",s2:d?window.location.href:""};this.engine.isInteractVideo&&(u.isInteractVideo=!0,u.uniqueId=this.engine.iv_state.uniqueId),this.fire(Va.a.NTF_Recharge,u)}},{key:"getPatchData",value:function(e,t){var i=null;if(e&&t){var a=this.getManifest(e,t);a.manifestType===Fi.ManifestTypes.F4V&&(a.manifestContent.isAD=!1,a.manifestContent.done=!0,a.manifestContent.rollType=Fi.RollTypes.POST_ROLL,i={type:a.manifestType,data:a.manifestContent})}return i}},{key:"setDelayPlayInfo",value:function(e){this._isDelayPlay=!0,this._delayPlayTime=e}},{key:"clearDelayPlayInfo",value:function(e){this.fire(Va.a.NTF_DelayToPlay_End),clearTimeout(this._delayTimer),this._isDelayPlay=!1,this._delayPlayTime=0,this._delayTimer=null,e&&this.play()}},{key:"play",value:function(e){var i=this,a=this;if(!a._isDelayPlay)return m()(c()(t.prototype),"play",this).call(this,e);a.fire(Va.a.NTF_DelayToPlay,a._delayPlayTime),a._delayTimer||(this.logger.log("playproxy delay play, timeout start!"),a._delayTimer=setTimeout((function(){i.logger.debug("playproxy delay play, timeout end!"),a.fire(Va.a.NTF_DelayToPlay_End),a._delayTimer=null,a._isDelayPlay=!1,a._delayPlayTime=0,m()(c()(t.prototype),"play",i).call(i,e)}),a._delayPlayTime))}},{key:"isDelayPlay",value:function(){return this.isDelayPlay}},{key:"_shouldP2PAssembled",value:function(e){return e===Fi.ManifestTypes.JDASH||"m4s"===e||!this.useCDNLoader&&(e===Fi.ManifestTypes.DASH_VP9&&this.useVP9P2P||"dash_vp9"===e&&this.useVP9P2P||e===Fi.ManifestTypes.DASH_AV1&&this.useAV1P2P||"dash_av1"===e&&this.useAV1P2P||e===Fi.ManifestTypes.HLS||"ts"===e)}},{key:"checkVipPay",value:function(e,t,i,a,n){var r=Zi.a.getUid()||"",s=this;e||t?(e&&function(e,t,i,a){if(r&&e&&t&&!s.engine.isMini){var n=qa.a.read("vipLayer")||"",o=parseInt(i||-1,10);-1==n.indexOf(r+"+"+t)&&5==o?Zi.a.reqVipTypes((function(e){var t=e.join(","),i="0"!==t&&""!==t;s.logger.log("vippay, request types callback, tt ".concat(t,", isvip ").concat(i)),-1!==e.indexOf(4)?a(!0,1):a(!1,i)}),!0):a(!1)}else a(!1)}(e,i,a,n),t&&function(e,t,i,a){if(r&&e&&t&&!s.engine.isMini){var n=qa.a.read("vipLayer")||"",o=parseInt(i||-1,10);-1==n.indexOf(r+"+"+t)&&6==o?Zi.a.reqVipTypes((function(e){var t=e.join(","),i="0"!==t&&""!==t;s.logger.log("vippay, request types callback, tt ".concat(t,", isvip ").concat(i)),-1!==e.indexOf(4)?a(!0,2):a(!1,i)}),!0):a(!1)}else a(!1)}(t,i,a,n)):n(!1)}},{key:"playFromVipPay",value:function(){var e=this.engine.movieinfo.current,t=e.albumId,i=Zi.a.getUid()||"",a=qa.a.read("vipLayer")||"",n=i+"+"+t;if(""!==a){var r=a.split("||");if(r.length>=5)for(var s=0;s<4;s++)n+="||"+r[s];else n=n+"||"+a}qa.a.write("vipLayer",n),this.engine.adproxy.initSDK({data:this._eventer.getData(),movieinfo:e})}},{key:"getMP4URLByTvid",value:function(e,t){(new Na).request({params:{tvid:e,vid:"",k_ft1:"721829383634948"},hostUseIP:!1},(function(e){var i="";if(e.data&&e.data.st){var a=e.data,n=a.program,r=a.st,s=parseInt(r,10);if(100<s&&s<200&&n&&n.video)for(var o=0;o<n.video.length;o++)n.video[o].mp4Url&&(i=n.video[o].mp4Url)}t(i)}),(function(){t("")}))}}]),t}(ja),ln={},hn=["loadstart","ready","error","ended"];function _n(){var e=new Date;return e.getFullYear()+""+(e.getMonth()+1)+e.getDate()}function fn(){var e=qa.a.read("QiyiPlayerTimePlayedInDay"),t=_n(),i=0;return e&&(t=(e=e.split("|"))[0],i=parseFloat(e[1])),{day:t,totalTime:i}}var pn=function(e){function t(e){var i;return n()(this,t),i=d()(this,c()(t).call(this)),e.on(Va.a.NTF_AD_NotifyManager,(function(e){i.emit(e)})),i}return f()(t,e),t}(p.a),gn=function(e){function t(e,i){var a,r;n()(this,t),a=d()(this,c()(t).call(this));var s=h()(a);a._isVip=!1,a._disableVideoOP=!1,a._user=Zi.a,a.bussiness=new pn(e,i),a._container=i.adContainer,a.engine=e,a.view=i,a.beforeIsAD=!1,a.beforeSeek=0,a.logger=new v.a("AdApi[".concat(e.id,"]"));var o=function(e,t){var i={type:e,gas:a.getCurrentGas()};t&&(i.data=t,t.gas&&(i.gas=t.gas)),function(e){var t=e.type,i=e.gas,a=i?i.id:undefined;if(!i||-1==hn.indexOf(t))return!0;var n=ln[a];if(n){if(n[t])return!1;n[t]=!0}else ln[a]={},ln[a][t]=!0;return!0}(i)&&a.emit(e,i)};e.on(Va.a.NTF_StatusChanged,(function(e){switch(e.state){case Va.a.Status_AdLoadstart:o("loadstart",e);break;case Va.a.Status_Ready:break;case Va.a.Status_Play:o("play",e);break;case Va.a.Status_AdPlaying:o("playing",e);break;case Va.a.Status_Playing:ln={},o("playing",e);break;case Va.a.Status_AdPaused:case Va.a.Status_Paused:o("pause",e);break;case Va.a.Status_AdWaiting:case Va.a.Status_Waiting:o("waiting",e);break;case Va.a.Status_AdError:o("error",e);break;case Va.a.Status_PlayError:ln={},o("error",e);break;case Va.a.Status_AdStalled:o("stalled",e);break;case Va.a.Status_AdWillPlayEnded:o("willended",e);break;case Va.a.Status_AdPlayEnded:case Va.a.Status_End_Play:o("ended",e)}})),e.on(Va.a.NTF_Before_Seeking,(function(e){s.beforeIsAD=e.isAd,s.beforeSeek=e.currentTime}));var u=0;e.on(Va.a.NTF_AD_TimeUpdate,(function(e){clearTimeout(u),u=setTimeout((function(){o("timeupdate",e)}),0)})),e.on(Va.a.NTF_AD_Seeking,(function(t){t.isAD=e.isAd(),t.beforeIsAD=s.beforeIsAD,t.beforeSeek=s.beforeSeek,o("seeked",t)})),e.on(Va.a.NTF_Seeking,(function(t){t.isAD=e.isAd(),t.beforeIsAD=s.beforeIsAD,t.beforeSeek=s.beforeSeek,o("seeked",t)})),e.on(Va.a.NTF_AD_Seeked,(function(t){t.isAD=e.isAd(),t.beforeIsAD=s.beforeIsAD,t.beforeSeek=s.beforeSeek,t.actionType="controls",o("afterSeeked",t)})),e.on(Va.a.NTF_Seeked,(function(t){t.isAD=e.isAd(),t.beforeIsAD=s.beforeIsAD,t.beforeSeek=s.beforeSeek,t.actionType="controls",o("afterSeeked",t)})),e.on(Va.a.NTF_TimeUpdate,(function(t){o("timeupdate",t);var i=e.getCurrenttime(),a=i-r;r&&a>0&&a<1&&function(e){var t=fn(),i=_n();t.day===i?t.totalTime+=e:t.totalTime=e,qa.a.write("QiyiPlayerTimePlayedInDay",i+"|"+t.totalTime)}(a),r=i})),e.on(Va.a.NTF_PLAY_MUTED,(function(e){o("muted",e)}));var l=i.fullscreen;return l&&l.on("change",(function(e){o("exit"===e?"exitfullscreen":"fullscreen")})),e.on(Va.a.NTF_DelayToPlay,(function(){o("pausetoplay")})),Zi.a.on("infoset",(function(){Zi.a.isVip((function(e){s._isVip=e}))})),a}return f()(t,e),s()(t,[{key:"load",value:function(e){(e=e||{}).file&&!isNaN(e.offset)&&e.offset>=0?this.bussiness.emit("_playdata_",e):this.logger.warn("load error data parameter: "+v.a.stringify(e))}},{key:"getEngineType",value:function(){return"data"}},{key:"getCurrentGas",value:function(){return this.engine.getCurrentGas()}},{key:"abort",value:function(){this.engine.abortAres()}},{key:"isVIP",value:function(){return this._isVip}},{key:"getUserInfo",value:function(){var e=!1;return this._user.isVip((function(t){e=t})),{isVIP:e,passportCookie:this._user.passportCookie(),passportId:this._user.getUid(),isLogin:this._user.isLogin(),uaaUserId:T.a.getFluid()||T.a.getJsuid()}}},{key:"adcontainer",value:function(){return this._container}},{key:"video",value:function(){return this.engine.video()}},{key:"isPaused",value:function(){return this.engine.isPaused()}},{key:"play",value:function(e){this._disableVideoOP||this.engine.play(e)}},{key:"pause",value:function(e){this._disableVideoOP||this.engine.pause(e)}},{key:"addEventListener",value:function(e,t){this.on(e,t)}},{key:"removeEventListener",value:function(e,t){this.off(e,t)}},{key:"src",value:function(){if(1!==arguments.length)return this.engine.getSrc()||"";this.logger.error("mw is not support set src!")}},{key:"volume",value:function(e){if(!e)return this.engine.getVolume();this.engine.setVolume(e)}},{key:"muted",value:function(e){if("boolean"!=typeof e)return this.engine.getMuted();this.engine.setMuted(e)}},{key:"height",value:function(){return this.view.getWrapperArea().height}},{key:"width",value:function(){return this.view.getWrapperArea().width}},{key:"currentTime",value:function(){return this.engine.getCurrenttime()}},{key:"duration",value:function(){return this.engine.getDuration()}},{key:"buffered",value:function(){return this.engine.getBufferTime()}},{key:"sendUserActionPingback",value:function(e){this.view.pingback.sendUserActionPingback(e)}},{key:"fullscreentoggle",value:function(){this.view.fullToggle()}},{key:"isFullScreen",value:function(){var e=this.view,t=e.fullscreen;return e.setting.expandScreen?!!this.engine.isFullScreen:t?t.isFullScreen():void 0}},{key:"webfullscreentoggle",value:function(){var e=this.view.webfullscreen;e&&e.toggle()}},{key:"isWebFullScreen",value:function(){var e=this.view.webfullscreen;if(e)return e.isWebFullScreen()}},{key:"videoPlayedDurationInDay",value:function(){return fn().totalTime}}]),t}(p.a),mn=function(){function e(t){n()(this,e),this.engine=t,this.logger=new v.a("AdProxy[".concat(t.id,"]")),this.adInfo={},this.seekableMidAd={},this.delayBriefAds={}}return s()(e,[{key:"init",value:function(){var e=this,t=this.engine.pack;this.sdk=t.ad,this.initMiddle(t),this.initAdSdkEvent(),this.initEpisode();var i=!1,a=!1,n=null;this.engine.recorder?this.once(Va.a.NTF_Get_Record,(function(){a=!0,i&&(e.logger.log("ares vrsready, isPreload = ".concat(n.movieinfo.isPreload,", tvid = ").concat(n.movieinfo.tvid,", vid = ").concat(n.movieinfo.vid)),n.movieinfo.isPreload?e.sdk.playPreload():e.engine.playproxy.checkVipPay(n.movieinfo.vipBlock,n.movieinfo.vipTheatre,n.movieinfo.albumId,n.movieinfo.authTipType,(function(t,i){t?e.fire(Va.a.NTF_Show_VIPPay,i):e.initSDK(n,i)})))})):a=!0,this.on(Va.a.NTF_VRSReady,(function(t){i=!0,a?(e.logger.log("ares vrsready, isPreload = ".concat(t.movieinfo.isPreload,", tvid = ").concat(t.movieinfo.tvid,", vid = ").concat(t.movieinfo.vid)),t.movieinfo.isPreload?e.sdk.playPreload():e.engine.playproxy.checkVipPay(t.movieinfo.vipBlock,t.movieinfo.vipTheatre,t.movieinfo.albumId,t.movieinfo.authTipType,(function(i,a){i?e.fire(Va.a.NTF_Show_VIPPay,a):e.initSDK(t,a)}))):n=t})),this.on(Va.a.NTF_VRSPreloaded,(function(t){e.initSDK(t)})),this.on(Va.a.NTF_VideoChange,(function(){e.middleware._disableVideoOP=!0})),this.on(Va.a.NTF_VideoChanged,(function(){e.middleware._disableVideoOP=!1,e.delayFireBriefAD()}))}},{key:"initMiddle",value:function(e){var t=this,i=e.engine,a=e.view,n=i.playproxy,r=i.episode,s=this.logger,o=this.delayBriefAds;this.middleware=new gn(i,a),this.middleware.bussiness.on("_playdata_",(function(e){var a=e.videoEventId,d=Ya.getEpisodeId(a),u=r.valid(d),c=i.movieinfo,l=!!c.current&&c.current.tvid===d;if(s.debug("ares notice-info, _playdata_, ares mw load"+(u?"":" invalid")+":"+v.a.stringify(e)),u){var h=new Pa(!0,!1,e.file,e,d,Object(b.a)(e.id),[],"AD","AD","AD","AD",-1,0,-1,0,1e3*e.duration),_=0;switch(e.type){case"preroll":r.finishPres(d)?s.warn(d+": ignore ares gas, "+v.a.stringify(e)):(r.addPres(d,[h]),t.aresQvsVariant(d,h,!1,0,"preroll"));break;case"briefRoll":e.seekable?t.seekableMidAd["".concat(e.type,"_").concat(e.videoEventId)]=e:delete t.seekableMidAd["".concat(e.type,"_").concat(e.videoEventId)],_=e.offset;var f=!0;if(l){var p=c.getPlayHead().playRealStartTime;f=!i.hasStatus(Va.a.Status_EveryStartPlay)&&_<=p}f?(_=0,r.addBriefs(d,[h]),t.aresQvsVariant(d,h,!1,_,"briefRoll")):(o[d]||(o[d]=[]),o[d].push({videoId:d,adSegment:h,offset:_}));break;case"midroll":n.getCurrenttime()<e.offset?(e.seekable?t.seekableMidAd["".concat(e.type,"_").concat(e.videoEventId)]=e:delete t.seekableMidAd["".concat(e.type,"_").concat(e.videoEventId)],r.addMids(d,[h]),t.aresQvsVariant(d,h,!1,e.offset,"midroll")):s.warn(d+":drop ares gas, "+v.a.stringify(e))}}}))}},{key:"initSDK",value:function(e){var t=this,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined,a=this.engine,n=a.params,r=a.local,s=a.playerVersion,o=a.movieinfo,d=a.adPlaySource,u=a.episode,c=o.startPlayTime,l=o.getVDInfo(),h=e.movieinfo,_=!!h.isPreload,f=n.cid||"";h.adPlayerID&&(f=h.adPlayerID),n.isCid||!$i.a.os.android&&!$i.a.os.ios||(f=navigator.userAgent.indexOf("MicroMessenger")>-1?"qc_105092_300416":"qc_100001_100103");var p=n.isSupportViewpoint||!1,g=n.site||"iqiyiw",m=0;c>=l.duration&&(c=0);var v=o.getPlayTimeRanges(),b=_?o.next:o.current;if("history"===b.playStartFrom){var y=v[0][0],k=v[v.length-1][1];m=y<c&&c<k?c:y}var T=function(e){t.middleware._isVip=e;var i=t.middleware.video(),a=h.tvid+"",o=Gi.a.isNumber(h.vd)?h.vd:parseInt(t.engine.vd,10);51===o&&(o=5);var c={autoLoad:!0,autoRender:!0,isMacH5:!0,isPreload:_,adPlayerId:f,episodeId:a,videoEventId:Ya.generate(a),videoDefinition:o,showVoiceIcon:!($i.a.os.android||$i.a.os.ios),videoMidware:t.middleware,isVIP:e,isSupportViewpoint:p,site:g,locale:r,passportId:Zi.a.getUid(),passportCookie:Zi.a.passportCookie(),clientVersion:s,videoContainer:i,couponCode:n.cpnc||"",couponVer:n.cpnv||"",ptid:$i.a.getPtid(na.a.isTWLocale()),timePoint:m,playSource:d||0};"home"===n.sourcePage?u.finishPres(a,!0):setTimeout((function(){t.logger.log("ares init, {episodeId:".concat(a,", timePoint:").concat(m,"}, cupid:").concat(f)),t.sdk.init(c)}),0)};i!==undefined?T(i):Zi.a.isVip((function(e){T(e)}))}},{key:"initAdSdkEvent",value:function(){var e=this,t=this.sdk,i=this.engine,a=this.logger,n=this.delayBriefAds,r=i.playproxy,s=i.episode,o=i.movieinfo,d=i.skip,u=i.autoplay,c=i.pingbackQOS;t.on("roll-play",(function(t){var i=t.rollType,n=t.videoEventId,r=Ya.getEpisodeId(n),o=s.valid(r);a.log("ares notice-info,  roll-play:"+(o?"":" invalid")+v.a.stringify(t));var d=!1,u=e.seekableMidAd["".concat(i,"_").concat(n)];u&&(d=!0),o&&(e.adInfo={rollType:i,videoId:r,seekable:d,adData:u},e.fire(Va.a.Status_AresPlay,e.adInfo))})),t.on("roll-ended",(function(t){var i=t.rollType,n=t.videoEventId,l=Ya.getEpisodeId(n),h=o.tvid==l,_=s.valid(l)&&h;if(a.log("ares notice-info, roll-ended: "+(_?"":" invalid")+v.a.stringify(t)+", videoId: "+l+", tvid: "+o.tvid),_){switch(i){case"preroll":r.tempStore.__sendFinishPres||(r.tempStore.__sendFinishPres=!0,c.sendFinishPresPingback()),s.finishPres(l,!0);break;case"midroll":s.finishMids(l,!0);break;case"briefRoll":s.finishBriefs(l,!0)}r.abortAllAres(i),(d&&u||!d||$i.a.os.ios||$i.a.os.android)&&r.isPaused()&&(a.log("manual play"),r.play()),e.fire(Va.a.Status_AresEnded,{agent:"ares",data:{rollType:i,videoId:l}})}})),t.on("roll-load-finish",(function(t){var r=t.rollType,d=t.videoEventId,u=Ya.getEpisodeId(d),c=s.valid(u),l=o.tvid==u;a.log("ares notice-info, roll-load-finish"+(c?"":" invalid")+":"+v.a.stringify(t));var h,_=i.sptr;if(_.asdkistm=t.initStartTime||0,_.asdkietm=t.initEndTime||0,_.adlstm=t.loadStartTime||0,_.adletm=t.loadEndTime||0,_.adirqstm=t.requestStartTime||0,_.adirqetm=t.requestEndTime||0,_.adsrqstm=t.showStartTime||0,_.adsrqetm=t.showEndTime||0,_.adaetm=+new Date,c)switch(r){case"preroll":0!==s.getPres(u).length&&l||"boolean"!=typeof(h=s.finishPres(u))||h||s.finishPres(u,!0);break;case"briefRoll":"boolean"!=typeof(h=s.finishBriefs(u))||h||s.finishBriefs(u,!0),n[u]&&n[u].length&&e.delayFireBriefAD();break;case"midroll":"boolean"!=typeof(h=s.finishMids(u))||h||s.finishMids(u,!0)}})),t.on("error",(function(e){r.brokedown(Aa.a.AD,Aa.a.P07001),a.log("ares notice-info, error"+v.a.stringify(e))})),t.on("adplayer_showtip",(function(t){a.log("ares notice-info, adplayer_showtip"),e.fire(Va.a.NTF_AD_Showtips,t)})),t.on("adplayer_ad_info",(function(t){var i=(t=t||{}).data,n=i.videoEventId,r=Ya.getEpisodeId(n),d=s.valid(r);a.log("ares notice-info, adplayer_ad_info "+(d?"":" invalid")+":"+v.a.stringify(t)),d&&(i&&(Gi.a.isObject(i.definitionSwitchingAd)?(s.setDefinitionAd(r,t),o.aresnoticedata.definition=i):Gi.a.isArray(i.viewPoints)&&(o.aresnoticedata.viewPoints=i.viewPoints)),e.fire(Va.a.Status_AresNoticeInfo,t))})),t.off("adplayer_ad_start"),t.on("adplayer_ad_start",(function(t){a.log("ares notice-info, adplayer_ad_start"),t&&"13"==t.ctp&&(e.engine.adWholeCorner=!0),e.fire(Va.a.NTF_AD_Start,t)})),t.off("adplayer_ad_end"),t.on("adplayer_ad_end",(function(t){a.log("ares notice-info, adplayer_ad_end"),e.fire(Va.a.NTF_AD_End,t)})),t.off("pause_start"),t.on("pause_start",(function(t){"audio"===t.type&&(e.logger.debug("adproxy delay play, get audio ad info! delayTime = ".concat(t.duration)),r.setDelayPlayInfo(1e3*t.duration||2500))})),t.off("pause_end"),t.on("pause_end",(function(t){"audio"===t.type&&(e.logger.debug("adproxy clear delay play, get audio ad info! status = ".concat(t.status)),"common"===t.status?r.clearDelayPlayInfo(!0):r.clearDelayPlayInfo(!1))})),t.off("adplayer_ad_block"),t.on("adplayer_ad_block",(function(t){e.logger.info("ares notice-info, adplayer_ad_block, ".concat(JSON.stringify(t)," ")),t.videoEventId===r.getCurrentGas().videoEventId&&e.fire(Va.a.NTF_AD_BLOCK)}))}},{key:"fire",value:function(e,t){this.engine.emit(e,t)}},{key:"on",value:function(e,t){this.engine.on(e,t)}},{key:"once",value:function(e,t){this.engine.once(e,t)}},{key:"clear",value:function(){}},{key:"resize",value:function(){this.sdk.resize()}},{key:"initEpisode",value:function(){var e=this,t=this.engine,i=t.playproxy,a=t.episode;a.on("finishAddPres",(function(t){var a=t.videoId,n=t.length,r=i.getCurrentGas(),s=Ya.getEpisodeId(r.videoEventId);e.aresQvsVariant(a,null,!0,0,"preroll"),a===s||0===n&&(s===undefined||isNaN(s))?i.concatCurFeature(a):i.concatPreloadFeature(a)})),a.on("finishAddMids",(function(t){var a=t.videoId,n=t.length,r=i.getCurrentGas(),s=Ya.getEpisodeId(r.videoEventId);(a===s||0===n&&(s===undefined||isNaN(s)))&&e.aresQvsVariant(a,null,!0,null,"midroll")})),a.on("finishAddBriefs",(function(t){var a=t.videoId,n=t.length,r=i.getCurrentGas(),s=Ya.getEpisodeId(r.videoEventId);(a===s||0===n&&(s===undefined||isNaN(s)))&&e.aresQvsVariant(a,null,!0,null,"briefRoll")}))}},{key:"aresQvsVariant",value:function(e,t,i,a,n){var r=this.engine,s=this.logger,o=r.movieinfo,d=r.playproxy,u=Fi.ManifestTypes.F4V,c={};switch(u==Fi.ManifestTypes.F4V&&t&&(c=za([t])),n){case"preroll":c.rollType=Fi.RollTypes.PRE_ROLL;break;case"midroll":c.rollType=Fi.RollTypes.MID_ROLL;break;case"briefRoll":c.rollType=Fi.RollTypes.BRIEF_ROLL}c.offset=a,c.done=i,c.isAD=!0;var l="";try{l=c.segments[0].gas.videoEventId||""}catch(h){}this.seekableMidAd["".concat(n,"_").concat(l)]?c.seekable=!0:c.seekable=!1,s.debug("ares qvs, ".concat(e==o.tvid?"loadRoll":"preloadRoll",", type=").concat(n,", done=").concat(c.done,", offset=").concat(c.offset,", seekable=").concat(c.seekable,", videoId=").concat(e,", tvid=").concat(o.tvid)),e==o.tvid?d.qvs.loadRoll(u,c,i):d.qvs.preloadRoll(u,c,i)}},{key:"delayFireBriefAD",value:function(){var e=this,t=this.delayBriefAds,i=this.engine,a=i.episode,n=i.movieinfo;this.engine.once(Va.a.NTF_TimeUpdate,(function(){if(t[n.tvid]){for(var i,r,s,o,d=t[n.tvid].splice(0,1)[0];d;)o=!0,i=d.videoId,r=d.adSegment,s=d.offset,a.addBriefs(i,[r]),e.aresQvsVariant(i,r,!1,s,"briefRoll"),d=t[n.tvid].splice(0,1)[0];o&&e.aresQvsVariant(i,null,!0,null,"briefRoll")}}))}},{key:"getAdInfo",value:function(){return this.adInfo}},{key:"destroy",value:function(){var e=this.engine.getMovieInfo();this.clear(),this.sdk.destroy(),this.logger.log("call ares: destory -> "+e.tvid)}}]),e}(),vn=function(){function e(t){n()(this,e);var i=this,a=!1;i._core=t,i._isSwitchingDefinition=!1;var r=function(){a||(a=!0,i._record())};this.logger=new v.a("recorder".concat(t.id)),t.on(Va.a.NTF_StatusChanged,(function(e){var a=e.state;if(a===Va.a.Status_Playing&&i.startTimer(),a===Va.a.Status_Paused||a===Va.a.Status_Waiting||a===Va.a.Status_Stoped){if(a===Va.a.Status_Waiting){if(t.isSeeking())return;if(t.getCurrenttime()<=1)return}if(Math.abs(t.getDuration()-t.getCurrenttime())<=1&&a!==Va.a.Status_Stoped)return;i.stopTimer(),i._record(a===Va.a.Status_Stoped)}})),t.on(Va.a.NTF_Seeked,(function(){t.isAd()||i._record()})),t.on(Va.a.NTF_DefinitionSwitching,(function(){i._isSwitchingDefinition=!0})),t.on(Va.a.NTF_DefinitionSwitched,(function(){i._isSwitchingDefinition=!1})).on(Va.a.NTF_VideoChanged,(function(){i._isSwitchingDefinition=!1})),t.once(Va.a.NTF_VRSStart,(function(e){t.isInteractVideo||i._getCurrent(e.data.tvid)})),window.addEventListener("unload",r),window.addEventListener("beforeunload",r),window.addEventListener("pagehide",r)}return s()(e,[{key:"stopTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}},{key:"startTimer",value:function(){var e=this;e._timer||(e._timer=setInterval((function(){return e._record()}),12e4))}},{key:"getCKUid",value:function(){return $i.a.os.ios||$i.a.os.android?T.a.getJsuid():T.a.getFluid()}},{key:"_getCurrent",value:function(e){var t=this,i=this._core.ptr;function a(){var a=Zi.a.isLogin()?"//l-rcd.iqiyi.com/apis/qiyirc/getvplay":"//nl-rcd.iqiyi.com/apis/urc/getvplay",n={};n.tvId=e,n.agent_type=1,Zi.a.isLogin()||(n.ckuid=t.getCKUid()),i.sTime_history=new Date-i.pgct,Ki.a.json({url:a,params:n,timeout:5e3,success:function(e){i.usedTime_history=new Date-i.sTime_history-i.pgct;var a=function(e){t._core.getMovieInfo().tvid==e.tvId&&(t.logger.log("Movie History,params: isLogin = "+Zi.a.isLogin()+", time ="+e.videoPlayTime),t._setStartPlayTime(e.videoPlayTime))};e.data&&e.data.videoPlayTime>10?t._core.eventlog.vrsready?(a(e.data),t._core.emit(Va.a.NTF_Get_Record)):t._core.once(Va.a.NTF_VRSReady,(function(){a(e.data),t._core.emit(Va.a.NTF_Get_Record)})):t._core.emit(Va.a.NTF_Get_Record),t.startTimer()},failure:function(){t._core.emit(Va.a.NTF_Get_Record)}})}t._isSwitchingDefinition||(e?a():t._core.getVideoInfo((function(e){a(e.tvid)})))}},{key:"_setStartPlayTime",value:function(e){this.logger.log("play time point from record："+e),this._core.movieinfo.setStartPlayTime(e)}},{key:"_record",value:function(e){var t=this;t._core.isInteractVideo&&!t._core.isIVMain||t._core.ivosRuning||t._core.getVideoInfo((function(i){var a=Zi.a.isLogin()?"//l-rcd.iqiyi.com/apis/qiyirc/setrc.php":"//nl-rcd.iqiyi.com/apis/urc/setrc",n=$i.a.browser.ipad||$i.a.browser.ipod?21:11,r={tvId:i.tvid,terminalId:n,agent_type:1};Zi.a.isLogin()||(r.ckuid=t.getCKUid()),r.videoPlayTime=e?0:parseInt(t._core.getCurrenttime(),10)||0,(r.videoPlayTime>0&&r.videoPlayTime<t._core.getDuration()&&!t._core.isAd()&&!t._core.isPatch()||e)&&(t.logger.log("record history："+r.videoPlayTime+", duration: "+t._core.getDuration()+", tvid: "+r.tvId),Ki.a.json({url:a,params:r}))}))}}]),e}(),bn=(i(69),i(256),i(125)),yn=i(304),kn=function(){function e(t,i){n()(this,e),this.logger=new v.a("IVRecorder[".concat(t.id,"]")),this.engine=t,this.params=i,this.engine.on(Va.a.NTF_IVPACKAGEPARSE_Finished,this._IVPackageParseSuccess.bind(this)),this.engine.on(Va.a.NTF_IVPACKAGEPARSE_Failed,this._IVPackageParseFailed.bind(this))}return s()(e,[{key:"init",value:function(e){this._initIVState(e),this._initXFactor(e.globle||{}),this._initBlockList(e),this.processHistory()}},{key:"_IVPackageParseSuccess",value:function(e){this.logger.info("interaction package parse successed"),this.init(e)}},{key:"_IVPackageParseFailed",value:function(){var e=this.engine;this.logger.warn("interaction package parse failed"),e.playproxy._eventer.brokedown(Aa.a.IVG,Aa.a.IV0001)}},{key:"_initIVState",value:function(e){var t={};t.uniqueId=this.params.tvid,t.fileName=e.base.filename,t.version=e.base.fileVersion,t.interactionMode=e.base.interactMode,t.protocolVersion=e.base.protocolVersion,t.privateCustom=e.base.privateCustom,t.isI5Custom="IPARTMENT5_LANDSCAPE"===t.privateCustom,t.storylineType=e.base.storylineType,t.isVertical="1"==e.base.playerType,t.index=0,this._setState(t)}},{key:"_setState",value:function(e){this.engine.iv_state=Object.assign(this.engine.iv_state,e)}},{key:"_initBlockList",value:function(e){this.playBlockList=e.playBlockList||[],this.interactBlockList=e.interactBlockList||[]}},{key:"_getBlockByTvid",value:function(e){return this.playBlockList.find((function(t){return t.filename==e}))}},{key:"_getInteractBlockIdByTvid",value:function(e){var t=this.playBlockList,i=this.interactBlockList,a=t.find((function(t){return t.filename==e})).blockid;return i.find((function(e){return e.inPlayBlockid==a})).blockid}},{key:"request",value:function(){var e=this,t=e.engine.iv_state;return new Promise((function(i,a){var n={uniqueId:e.params.tvid,qyid:T.a.getFluid()||T.a.getJsuid(),app_v:bn.a,platform_id:1079,app_Im:na.a.isTWLocale()?"tw":"cn",lang:na.a.isTWLocale()?"zh_TW":"zh_CN",dev_os:navigator.platform||"",dev_ua:navigator.userAgent||"",src:"pcw",version:t.version};Ki.a.json({url:aa.IVHistory,timeout:3e3,params:n,success:function(t){t&&"A00000"===t.code?(e.logger.info("interaction record, last points request successed"),i(t)):a(t)},failure:function(){a()}})}))}},{key:"_initXFactor",value:function(e){this.engine.XFactorManager?this.engine.XFactorManager.reset(e||{}):this.engine.XFactorManager=new yn.a(e||{})}},{key:"processHistory",value:function(){var e=this,t=e.engine,i=t.iv_state,a=function(){e.engine.isIVMain=!0,i.storyLine="0";var a=e.params.tvid,n=e._getBlockByTvid(a);e.engine.iv_state.isI5Custom&&(e.engine.iv_state.others=n?n.others:{}),e.sendAction({status:0}),e.engine.load(e.params),e.engine.emit(Va.a.NTF_Get_Record),t.IVRecorder.sendAction({status:6,currentTime:0,blockId:n.blockid,playBlockId:n.blockid,tvId:a,albumId:a,switch_type:1,switch_time:0})};e.params.resetHistory?a():e.request().then((function(a){!function(a){var n={};if(n.index=parseInt(a.index||0,10),n.storyLine=a.storyLine||1,n.isFromHistory=!0,a.pathData&&0!==a.pathData.tvId){var r=a.pathData,s=r.tvId,o=r.currentTime,d=r.globleValues;e.params.tvid=s,e.params.startPlayTime=o,t.isIVMain=i.uniqueId===s,t.isIVMain?t.adPlaySource=0:t.adPlaySource=61,e._initXFactor(d)}else e.engine.isIVMain=!0;if(e.engine.iv_state.isI5Custom){var u=e._getBlockByTvid(e.params.tvid);e.engine.iv_state.others=u?u.others:{}}e.logger.info("interaction record ok, start load"),e._setState(n),t.load(e.params),t.emit(Va.a.NTF_Get_Record)}(a)}),a)}},{key:"sendAction",value:function(e){var t=this.engine.iv_state;if(e.tvId){var i=this._getBlockByTvid(e.tvId);if(i.others&&"1"==i.others.IPARTMENT5_ABANDONHISTORY)return}var a={qyid:T.a.getFluid()||T.a.getJsuid(),app_v:bn.a||"",platform_id:1079,app_Im:na.a.isTWLocale()?"tw":"cn",lang:na.a.isTWLocale()?"zh_TW":"zh_CN",dev_os:navigator.platform||"",dev_ua:navigator.userAgent||"",src:"pcw",uniqueId:t.uniqueId,fileName:t.fileName,version:t.version,protocolVersion:t.protocolVersion,interactionMode:t.interactionMode};Object(zi.a)(a,e,!0),this.logger.info("interaction upload to service"),Ki.a.json({url:aa.IVSevice,params:a,success:function(){},failure:function(){}})}},{key:"getStoryLine",value:function(){var e=this,t=e.engine.iv_state;return e.logger.info("interaction request storyline"),new Promise((function(i,a){var n={qyid:T.a.getFluid()||T.a.getJsuid(),app_v:bn.a,platform_id:1079,app_Im:na.a.isTWLocale()?"tw":"cn",lang:na.a.isTWLocale()?"zh_TW":"zh_CN",dev_os:navigator.platform||"",dev_ua:navigator.userAgent||"",src:"pcw",uniqueId:t.uniqueId,fileName:t.fileName,version:t.version,protocolVersion:t.protocolVersion,language:""};Ki.a.json({url:aa.IVStoryLine,timeout:3e3,params:n,success:function(t){t&&"A00000"===t.code?(e.logger.info("interaction request storyline successed"),i(t)):(e.logger.info("interaction request storyline code error"),a(t))},failure:function(){e.logger.info("interaction request storyline failed"),a()}})}))}},{key:"backToStoryLine",value:function(){var e=this,t=e.engine;e.getStoryLine().then((function(i){if(i&&i.graph){var a=i.graph.nodes;a.pop();var n=a.slice().reverse().find((function(e){return 1!==e.mark}));if(!n)return;var r={innerIV:!0};switch(r.tvid=n.tvid,r.blockid=n.id,r.playBlockId=n.playBlockId,r.startPlayTime=n.currentTime,n.type){case"VIDEO":r.switchType=5;break;case"BLOCK":default:r.switchType=2}e.sendAction({status:0,blockId:r.blockid,tvId:r.tvid,switch_type:r.switchType}),t.switchVideo(r)}}),(function(){console.log("restart storyline error")}))}},{key:"updateParams",value:function(e){this.params=e}}]),e}(),Tn=null;function Sn(){var e;return q.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q.a.awrap(i.e(5).then(i.t.bind(null,582,7)));case 2:return(e=t.sent["default"]).enc.u8array={stringify:function(e){for(var t=e.words,i=e.sigBytes,a=new Uint8Array(i),n=0;n<i;n++){var r=t[n>>>2]>>>24-n%4*8&255;a[n]=r}return a},parse:function(t){for(var i=t.length,a=[],n=0;n<i;n++)a[n>>>2]|=(255&t[n])<<24-n%4*8;return e.lib.WordArray.create(a,i)}},t.abrupt("return",e);case 5:case"end":return t.stop()}}))}var Pn={decryptByDES:function(e,t){var i;return q.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(Tn){a.next=4;break}return a.next=3,q.a.awrap(Sn());case 3:Tn=a.sent;case 4:return i=function(){var i=Tn.enc.Utf8.parse(t),a=Tn.enc.u8array.parse(e);return Tn.DES.decrypt(a.toString(Tn.enc.Base64),i,{mode:Tn.mode.ECB,padding:Tn.pad.Pkcs7}).toString(Tn.enc.Utf8)},a.abrupt("return",i());case 6:case"end":return a.stop()}}))},encryptByDES:function(e,t){var i;return q.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(Tn){a.next=4;break}return a.next=3,q.a.awrap(Sn());case 3:Tn=a.sent;case 4:return i=function(){var i=Tn.enc.Utf8.parse(t);return Tn.DES.encrypt(e,i,{mode:Tn.mode.ECB,padding:Tn.pad.Pkcs7}).toString()},a.abrupt("return",i());case 6:case"end":return a.stop()}}))}},xn="URLSearchParams"in self,In="Symbol"in self&&"iterator"in Symbol,En="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),Dn="FormData"in self,wn="ArrayBuffer"in self;if(wn)var An=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],qn=ArrayBuffer.isView||function(e){return e&&An.indexOf(Object.prototype.toString.call(e))>-1};function On(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function Ln(e){return"string"!=typeof e&&(e=String(e)),e}function Cn(e){var t={next:function(){var t=e.shift();return{done:t===undefined,value:t}}};return In&&(t[Symbol.iterator]=function(){return t}),t}function Mn(e){this.map={},e instanceof Mn?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function Rn(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function Bn(e){return new Promise((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function Nn(e){var t=new FileReader,i=Bn(t);return t.readAsArrayBuffer(e),i}function Fn(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Un(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:En&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:Dn&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:xn&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():wn&&En&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=Fn(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):wn&&(ArrayBuffer.prototype.isPrototypeOf(e)||qn(e))?this._bodyArrayBuffer=Fn(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):xn&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},En&&(this.blob=function(){var e=Rn(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Rn(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Nn)}),this.text=function(){var e,t,i,a=Rn(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,i=Bn(t),t.readAsText(e),i;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),a=0;a<t.length;a++)i[a]=String.fromCharCode(t[a]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Dn&&(this.formData=function(){return this.text().then(Wn)}),this.json=function(){return this.text().then(JSON.parse)},this}Mn.prototype.append=function(e,t){e=On(e),t=Ln(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},Mn.prototype["delete"]=function(e){delete this.map[On(e)]},Mn.prototype.get=function(e){return e=On(e),this.has(e)?this.map[e]:null},Mn.prototype.has=function(e){return this.map.hasOwnProperty(On(e))},Mn.prototype.set=function(e,t){this.map[On(e)]=Ln(t)},Mn.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},Mn.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),Cn(e)},Mn.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),Cn(e)},Mn.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),Cn(e)},In&&(Mn.prototype[Symbol.iterator]=Mn.prototype.entries);var Vn=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Hn(e,t){var i,a,n=(t=t||{}).body;if(e instanceof Hn){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Mn(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Mn(t.headers)),this.method=(i=t.method||this.method||"GET",a=i.toUpperCase(),Vn.indexOf(a)>-1?a:i),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function Wn(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),a=i.shift().replace(/\+/g," "),n=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(n))}})),t}function jn(e,t){t||(t={}),this.type="default",this.status=t.status===undefined?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new Mn(t.headers),this.url=t.url||"",this._initBody(e)}Hn.prototype.clone=function(){return new Hn(this,{body:this._bodyInit})},Un.call(Hn.prototype),Un.call(jn.prototype),jn.prototype.clone=function(){return new jn(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Mn(this.headers),url:this.url})},jn.error=function(){var e=new jn(null,{status:0,statusText:""});return e.type="error",e};var Gn=[301,302,303,307,308];jn.redirect=function(e,t){if(-1===Gn.indexOf(t))throw new RangeError("Invalid status code");return new jn(null,{status:t,headers:{location:e}})};var zn=self.DOMException;try{new zn}catch(Rf){(zn=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack}).prototype=Object.create(Error.prototype),zn.prototype.constructor=zn}function Kn(e,t){return new Promise((function(i,a){var n=new Hn(e,t);if(n.signal&&n.signal.aborted)return a(new zn("Aborted","AbortError"));var r=new XMLHttpRequest;function s(){r.abort()}r.onload=function(){var e,t,a={status:r.status,statusText:r.statusText,headers:(e=r.getAllResponseHeaders()||"",t=new Mn,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var i=e.split(":"),a=i.shift().trim();if(a){var n=i.join(":").trim();t.append(a,n)}})),t)};a.url="responseURL"in r?r.responseURL:a.headers.get("X-Request-URL");var n="response"in r?r.response:r.responseText;i(new jn(n,a))},r.onerror=function(){a(new TypeError("Network request failed"))},r.ontimeout=function(){a(new TypeError("Network request failed"))},r.onabort=function(){a(new zn("Aborted","AbortError"))},r.open(n.method,n.url,!0),"include"===n.credentials?r.withCredentials=!0:"omit"===n.credentials&&(r.withCredentials=!1),"responseType"in r&&En&&(r.responseType="blob"),n.headers.forEach((function(e,t){r.setRequestHeader(t,e)})),n.signal&&(n.signal.addEventListener("abort",s),r.onreadystatechange=function(){4===r.readyState&&n.signal.removeEventListener("abort",s)}),r.send("undefined"==typeof n._bodyInit?null:n._bodyInit)}))}Kn.polyfill=!0,self.fetch||(self.fetch=Kn,self.Headers=Mn,self.Request=Hn,self.Response=jn);var Yn=function(){function e(t,i){n()(this,e),this.logger=new v.a("IVPackageManager[".concat(t.id,"]")),this.engine=t,this.paraFileList=[],this.globleVarList=[],this.indexFileObject=null,this.init(i)}return s()(e,[{key:"getIndexFile",value:function(){return this.indexFileObject||{}}},{key:"init",value:function(e){var t=this;t.params=e,t._getZipScriptURL(e).then((function(i){i?t._parseZip(i):t._retry(e)}))}},{key:"_parseZip",value:function(e){var t=this;t.logger.info("interaction zipUrl ".concat(e)),Promise.all([i.e(6),i.e(0)]).then(i.t.bind(null,581,7)).then((function(i){var a=i["default"],n=function(e){e&&(e.file(/^(?!__MACOSX).*index.*json$/)[0].async("uint8array").then(t._parseIndexFile.bind(t)),t.paraFileList=e.file(/^((?!__MACOSX).*Para.json)*$/))};t._downloadZIP(e).then(a.loadAsync,(function(){t._downloadZIP(e).then(a.loadAsync,(function(){t.engine.isInteractVideo=!1,t.engine.load(t.params)})).then(n)})).then(n)}))}},{key:"_retry",value:function(e){var t=this;t._getZipScriptURL(e).then((function(i){i?t._parseZip(i):(t.engine.isInteractVideo=!1,t.engine.load(e))}))}},{key:"_parseIndexFile",value:function(e){var t=this;t.__parseFile(e).then((function(e){t.logger.info("interaction parseFile ok"),t.indexFileObject=e,t.indexFileObject&&t.indexFileObject.globle&&t.indexFileObject.globle.varList&&(t.globleVarList=t.indexFileObject.globle.varList),t.indexFileObject&&t.engine.emit(Va.a.NTF_IVPACKAGEPARSE_Finished,t.indexFileObject)}))}},{key:"__parseFile",value:function(e){var t=this.engine;return new Promise((function(i){try{Pn.decryptByDES(e,"$X&#ADvF").then((function(e){i(JSON.parse(e))}))}catch(a){t.emit(Va.a.NTF_IVPACKAGEPARSE_Failed,a)}}))}},{key:"parseParaFile",value:function(e){var t=this;return t.logger.info("interaction parse ParaFile"),new Promise((function(i){t.paraFileList.find((function(t){return t.name.indexOf(e)>0})).async("uint8array").then(t.__parseFile.bind(t)).then((function(e){i(e)}))}))}},{key:"_getZipScriptURL",value:function(e){var t=this,i={uniqueId:e.tvid,protocolVersion:"1.5",app_v:bn.a,platform_id:1079,lang:na.a.isTWLocale()?"zh_TW":"zh_CN",src:"pcw",qyid:T.a.getFluid()||T.a.getJsuid()};return t.logger.info("interaction getzipUrl ".concat(aa.IVZip)),new Promise((function(e){Ki.a.json({url:aa.IVZip,timeout:3e3,withCredentials:!0,params:i,success:function(i){if(i&&"A00000"===i.code)if(i.interactInfo&&i.interactInfo.operationVideoInfo&&i.interactInfo.operationVideoInfo.scriptUrl){var a=i.interactInfo.operationVideoInfo.scriptUrl;t.logger.info("interaction getzipUrl  ok ".concat(a)),e(a.replace("http:",window.location.protocol))}else t.logger.info("interaction getzipUrl fail, data error"),e(null);else t.logger.info("interaction getzipUrl  fail, code error"),e(null)},failure:function(){t.logger.info("interaction getzipUrl  fail, code error"),e(null)}})}))}},{key:"_downloadZIP",value:function(e){return fetch(e).then((function(e){return e.arrayBuffer()}))}},{key:"reset",value:function(){this.paraFileList=[],this.globleVarList=[],this.indexFileObject=null}}]),e}(),Qn=new v.a("pingback"),Jn={1:"303",2:"302",6:"304",11:"405",12:"401",13:"401",21:"302"},Xn=function(){function e(t){n()(this,e),this._timer=0,this._core=t,this._lastFirePlayTime=0,this._lastFireData={},this._sentWaitingBeacon=!1,this._pbInfo={},this._pbisdm=0,this._isfan="",this._outerParams={};var i=t.params;this.setPbInfo({vfm:i.vfm,vfrm:i.vfrm,vvfrom:i.vvfrom||i.videoIsFromQidan})}return s()(e,[{key:"sendVrsRequestPingback",value:function(e){var t={t:"init",r:e.tvid,ra:e.bid,c1:"",aid:"",ht:0,ispre:0,videotp:""};this._send(t,!0)}},{key:"sendVrsReadyPingback",value:function(e,t){var i=(t=t.data||{}).content||{},a={t:"ready",r:e.tvid,ra:e.bid,c1:t.cid||"",aid:t.aid||"",ht:i.bossStatus&&i.bossStatus>0?1:0,ispre:0,videotp:""};this._send(a,!0)}},{key:"sendADStartPlayPingback",value:function(){this._send({t:15})}},{key:"sendStartPlayPingback",value:function(){this._lastFirePlayTime=this._core.getCurrenttime(),this._send({t:1,lct:this._lastFirePlayTime}),-1===this._timer&&this.sendTimingPingback(),this.sendProcessesTimePingback()}},{key:"sendTimingPingback",value:function(){this._timer=0;var e=this,t=0;clearTimeout(this._timer);!function i(){if(e._core.hasStatus(Va.a.Status_Playing)){var a=0;(t+=1e3)%15e3==0&&(a=e._lastFirePlayTime,e._lastFirePlayTime=e._core.getCurrenttime(),e._send({t:2,tm:15,lct:a+","+e._lastFirePlayTime}));if(t%6e4==0){var n=Zi.a.isLogin()?"QP008":"QP007",r=S.a.get(n);r=""===r?0:parseInt(r,10),r+=60,S.a.set(n,r,{expires:31536e6,path:"/",domain:"iqiyi.com"})}}clearTimeout(e._timer),e._timer=setTimeout(i,1e3)}()}},{key:"sendEndPlayPingback",value:function(e){var t=this._core.getMovieInfo();this._lastFirePlayTime=this._core.getCurrenttime();var i=this._core.params,a={t:13,endtp:e,lct:this._lastFirePlayTime},n=51===(t.vd||"")?59:t.vd||"";this._lastFireData.t?Object(zi.a)(a,this._lastFireData):(Object(zi.a)(a,{r:t.tvid,ra:n,vfrmtp:!0===i.autoplay?1:0}),i.vvauto&&(a.vvauto=!0===i.autoplay?4:2),Object(zi.a)(a,this._outerParams,!0),i.vvauto||delete a.vvauto),this._send(a,!0)}},{key:"sendWaitingPingback",value:function(e){var t=0,i=0,a=-1,n=this._core.getCDNInfo().host;if(navigator.connection){var r=navigator.connection.downlink,s=(navigator.connection.effectiveType||"").toLowerCase(),o=(navigator.connection.type||"").toLowerCase();switch(s){case"4g":i=18;break;case"3g":i=17;break;case"2g":i=16;break;case"slow-2g":i=14}switch(o){case"cellular":i=15;break;case"wifi":i=1;break;case"ethernet":i=13;break;case"bluetooth":i=21;break;case"wimax":i=22}var d=this._core.getDataBufferInfo();d&&(a=d.len),t=r}if(e)this._sentWaitingBeacon||(this._sentWaitingBeacon=!0,this._send({t:8,rd:"ad",jamtp:1,bw:t,dl:a,ntwk:i,stu_sc:1,isquit:0,cdnadr:n})),this.sendErrorPlayPingback("","4016"),this.sendErrorPlayPingback("","QVS-4016");else{this._sentWaitingBeacon||(this._sentWaitingBeacon=!0,this._send({t:8,rd:"video",jamtp:1,bw:t,dl:a,ntwk:i,stu_sc:1,isquit:0,cdnadr:n})),Qn.info("send pingback QVS-4015"),this.sendErrorPlayPingback("","4015"),this.sendErrorPlayPingback("","QVS-4015");var u=new Date,c=u.getHours(),l=u.getMinutes();5==c&&l>=30&&this.sendLogToCompass("QVS-4015")}}},{key:"sendPlayingPingback",value:function(){this._sentWaitingBeacon&&(this._sentWaitingBeacon=!1)}},{key:"sendErrorPlayPingback",value:function(e,t,i){var a=t||Jn[e];this._send({t:0,ec:a,psrc:i||""})}},{key:"sendProcessesTimePingback",value:function(){var e=this._core.ptr;if(e.needRecord){e.needRecord=!1;var t={t:10};e.usedTime_userInfo>0&&(t.tm1=e.usedTime_userInfo+","+e.sTime_userInfo),e.usedTime_P2PCore>0&&(t.tm2=e.usedTime_P2PCore+","+e.sTime_P2PCore),e.usedTime_history>0&&(t.tm7=e.usedTime_history+","+e.sTime_history),e.usedTime_pageShowVideo>0&&e.usedTime_pageShowVideo<12e4&&(t.tm8=e.usedTime_pageShowVideo+",0"),e.usedTime_showVideo>0&&e.usedTime_showVideo<6e4&&(t.tm9=e.usedTime_showVideo+","+e.sTime_showVideo),e.usedTime_vms>0&&(t.tm10=e.usedTime_vms+","+e.sTime_vms),e.usedTime_adInit>0&&(t.tm11=e.usedTime_adInit+","+e.sTime_adInit),e.usedTime_selfLoaded>0&&e.usedTime_selfLoaded<6e4&&(t.tm12=e.usedTime_selfLoaded+",0"),t.br=e.browserType||"",t.tmplt=e.pageTmpltType,t.re=window.screen.width+"*"+window.screen.height,this._send(t)}}},{key:"setPbInfo",value:function(e){this._pbInfo=e}},{key:"setPbisdm",value:function(e){this._pbisdm=e}},{key:"sendLogToCompass",value:function(e){var t,a,n,r,s,o,d,u,c,l;return q.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,q.a.awrap(i.e(1).then(i.bind(null,583)));case 2:t=h.sent["default"],a=this._core,n=v.a.getLog(),r=t.gzip(n),s=new XMLHttpRequest,o=a.getManifestTypes(),d=a.getCurrManifestType(),u="OTHER"+d,c=(e||"").replace(/-/gi,"_"),h.t0=d,h.next=h.t0===o.HLS?14:h.t0===o.F4V||h.t0===o.FLV?16:h.t0===o.DASH_VP9?18:h.t0===o.DASH_AV1?20:h.t0===o.JDASH?22:24;break;case 14:return u="HLS",h.abrupt("break",24);case 16:return u="F4V",h.abrupt("break",24);case 18:return u="VP9",h.abrupt("break",24);case 20:return u="AV1",h.abrupt("break",24);case 22:return u="JDASH",h.abrupt("break",24);case 24:(l=[]).push(on.browserName()),l.push(na.a.isTWLocale()?"TW":"CN"),l.push(u),l.push(c),l.push(Ya.getEventId(a.getMovieInfo().tvid)),s.open("POST","//qosp.iqiyi.com/crashlog?source=pcwplayer"),s.setRequestHeader("Content-Encoding","gzip"),s.setRequestHeader("Content-Type","application/octet-stream"),s.setRequestHeader("File-Name",l.join("_")),s.send(r);case 35:case"end":return h.stop()}}),null,this)}},{key:"_send",value:function(e,t){}},{key:"_getParams",value:function(e){var t=this._core,i=t.getMovieInfo(),a=t.getCurrLoaderMode(),n=-1,r=JSON.parse(S.a.get("QYABEX")||"{}"),s=51===(i.vd||"")?59:i.vd||"";switch(r&&r.pcw_home_movie&&r.pcw_home_movie,a){case"CDN":n=0;break;case"P2P":n=1}var o,d,u={bstp:6,ptid:$i.a.getPtid(na.a.isTWLocale()),pf:on.pf,p:on.p,p1:on.p1,c1:i.cid||"",aid:i.albumId||"",u:T.a.getFluid()||"",u2:T.a.getJsuid()||"",pu:Zi.a.getUid()||"",os:on.os,v:t.playerVersion,ra:s,nu:T.a.getIsNewUser()?1:0,ve:T.a.getEid(),ce:T.a.getWeid(),ht:i.isVIP?1:0,ispre:i.isTryWatch?1:0,mod:na.a.local()||"",purl:window.location.href,rfr:window.document.referrer,lrfr:S.a.get("QC007")||"",vfm:this._pbInfo.vfm||S.a.get("QP005")||"",vvfrom:this._pbInfo.vvfrom||"",vfrm:this._pbInfo.vfrm||"",vfrmtp:!0===t.params.autoplay?1:0,plyrtp:0,coop:"",isdm:this._pbisdm,videotp:"undefined"!=typeof i.is3D?i.is3D:"",tmplt:t.ptr.pageTmpltType,drm:on.getDrmType(i),stauto:t.autoVdUsing?"1":"0",algot:t.autoVdAlgot,pagev:t.params.pagev||"",ldt:n,krv:"4.0.0",wtmk:i.watermark||0,islocal:0,mdlm:0,ra1:this._getra1(),ra2:-1,ra3:Xi.getNewVd(s)||"",vdurt:t.getDuration()};return t.picInPic?u.vfrmrst="80720_playerctrl_picinpic":u.vfrmrst=t.params.vfrmrst||"",t.params.vvauto&&(u.vvauto=!0===t.params.autoplay?4:2,this._outerParams&&this._outerParams.vvauto&&(u.vvauto=this._outerParams.vvauto)),e&&e.t&&(Object(zi.a)(u,{vfrmblk:t.params.vfrmblk||""}),2==e.t&&Object(zi.a)(u,{vbr:this._getVBR()})),t.isFullScreen?(d="901111_pcwh5_browerfull",o=4):t.isWebFullScreen?(d="901111_pcwh5_pagefull",o=7):t.isSmallWindowMode||t.picInPic?(o=2,d=""):(o=3,d=""),Object(zi.a)(u,{wint:o,s2:d}),Object(zi.a)(u,{manifesttp:t.playproxy.qvs.currentManifestType}),Object(zi.a)(u,{enginetp:2}),t.isInteractVideo&&"0"==t.interactionMode&&!t.isIVMain&&(u.iamvid=t.iv_state&&t.iv_state.uniqueId||""),"{}"!=JSON.stringify(this._outerParams)&&Object(zi.a)(u,this._outerParams,!0),u}},{key:"_getVBR",value:function(){var e=this._core,t=e.getDuration(),i=0;if(e.movieinfo&&0!==t&&!e.isAd()){var a=e.movieinfo.getVDInfo().vsize;i=parseInt(a/t)}return i}},{key:"_getra1",value:function(){var e=this._core,t=e.getManifestTypes(),i="";switch(e.getCurrManifestType()){case t.HLS:i=2;break;case t.F4V:case t.FLV:i=0;break;case t.DASH_AV1:case t.DASH_VP9:i="";break;case t.JDASH:i=7}return i}},{key:"_checkIsfan",value:function(e){var t=this;Zi.a.getUid()&&e&&(t._isfan="",Ki.a.jsonp({url:"//sns-api.iqiyi.com/apis/friend/follow.action",params:{myuid:Zi.a.getUid(),uids:e},timeout:2e3,memory:!0,success:function(i){"A00000"===i.code&&i.data&&(t._isfan=i.data[e])}}))}},{key:"setPlayPingbackInfo",value:function(e){this._core.params.vvauto||(e.vvauto=null,delete e.vvauto),this._outerParams=Object(zi.a)(this._outerParams,e,!0)}},{key:"destory",value:function(){clearTimeout(this._timer),this._timer=-1}},{key:"setvvfrom",value:function(e){e&&(this._pbInfo.vvfrom=e)}}]),e}(),Zn={1:"303",2:"302",6:"304",11:"405",12:"401",13:"401",21:"302"},$n=function(){function e(t){n()(this,e),this._timer=0,this._core=t,this._sentWaitingBeacon=!1,this._lastFireData={},this._isfan="",this._outerParams={},this._vvfrom=t.params.vvfrom,this.__endpingback=undefined,this.__pingbackList={start:0,vvauto:undefined}}return s()(e,[{key:"sendADStartPlayPingback",value:function(){this.__endpingback=undefined,this._send({t:15,pt:""},!0)}},{key:"sendStartPlayPingback",value:function(){this.__endpingback=undefined,this._send({t:1}),-1===this._timer&&this.sendTimingPingback()}},{key:"sendTimingPingback",value:function(){this._timer=0;var e=this,t=0;clearTimeout(this._timer);var i=!0;!function a(){e._core.hasStatus(Va.a.Status_Playing)&&((t+=1e3)%15e3==0&&i?(i=!1,e._send({t:2,tm:15})):t%3e4==0&&e._send({t:2,tm:30})),clearTimeout(e._timer),e._timer=setTimeout(a,1e3)}()}},{key:"sendEndPlayPingback",value:function(e,t){if(this.__endpingback===undefined){this.__endpingback=!0;var i,a=this._core.getMovieInfo(),n=this._core.playproxy._playingSpend||0,r=this._core.params,s=51===(a.vd||"")?59:a.vd||"";switch(t=t||a.tvid,e){case 1:i=4;break;case 2:i=6;break;case 3:i=7;break;case 4:i=11;break;case 5:i=9;break;default:i=0}var o={t:13,tm:n,endtp:i};this._lastFireData.t?Object(zi.a)(o,this._lastFireData):(Object(zi.a)(o,{r:t,ra:s,vfrmtp:!0===r.autoplay?1:0}),r.vvauto&&(o.vvauto=!0===r.autoplay?4:2),Object(zi.a)(o,this._outerParams,!0),r.vvauto||delete o.vvauto,Object(zi.a)(o,this._outerParams,!0),r.vvauto||delete o.vvauto),this._send(o,!0)}}},{key:"sendWaitingPingback",value:function(e){var t=this._core.getCDNInfo().host;e?(this._sentWaitingBeacon||(this._sentWaitingBeacon=!0,this._send({t:8,jampt:"ad",stu_sc:1,isquit:0,cdnadr:t})),this.sendErrorPlayPingback("","4016"),this.sendErrorPlayPingback("","QVS-4016")):(this._sentWaitingBeacon||(this._sentWaitingBeacon=!0,this._send({t:8,jampt:"video",stu_sc:1,isquit:0,cdnadr:t})),this.sendErrorPlayPingback("","4015"),this.sendErrorPlayPingback("","QVS-4015"))}},{key:"sendAutoUpToVDPingback",value:function(e,t){this._send({t:12,fa:5,ra:t,upto:e},!0)}},{key:"sendAutoDwnToVDPingback",value:function(e,t){this._send({t:12,fa:4,ra:t,dwnto:e},!0)}},{key:"sendPlayingPingback",value:function(){this._sentWaitingBeacon&&(this._sentWaitingBeacon=!1)}},{key:"sendErrorPlayPingback",value:function(e,t,i){var a=t||Zn[e];this._send({t:0,ec:a,psrc:i||""})}},{key:"_send",value:function(e,t){var i=this,a=this._core,n=a.logger,r=a.pingback,s=i._getParams(e);on.getPingbackDfp(e).then((function(o){a.getVideoInfo((function(a){Zi.a.isVip((function(d){Object(zi.a)(s,{rn:Math.random(),dfp:o,stime:(new Date).getTime(),r:a.tvid||"",hu:d?1:-1}),Object(zi.a)(s,e,t),i._lastFireData=s;var u=aa.pingbackV6Url;0==e.t&&(u=aa.pingbackQosUrl),Ki.a.beacon(s,u),-1!==window.location.href.indexOf("www.iqiyi.com/home2020")&&(1==e.t?(n.info("send pingback, t=1, vvauto=".concat(s.vvauto,",  pms=").concat(JSON.stringify(s))),i.__pingbackList.start++,i.__pingbackList.vvauto=s.vvauto):13==e.t&&(n.info("send pingback, t=13, vvauto=".concat(s.vvauto,",  pms=").concat(JSON.stringify(s))),(0==i.__pingbackList.start||4==i.__pingbackList.vvauto&&4!==s.vvauto)&&(n.info("send pingback, t=1|13, checkerror"),r.sendLogToCompass("pingback")),i.__pingbackList={start:0,vvauto:undefined}))}))}))}))}},{key:"_getParams",value:function(e){var t=this._core,i=t.getMovieInfo(),a=t.getCurrLoaderMode(),n=-1,r=JSON.parse(S.a.get("QYABEX")||"{}"),s=51===(i.vd||"")?59:i.vd||"";switch(r&&r.pcw_home_movie&&r.pcw_home_movie,a){case"CDN":n=0;break;case"P2P":n=1}var o={u:T.a.getFluid()||"",pu:Zi.a.getUid()||"",p1:on.p_code,v:t.playerVersion,ce:T.a.getWeid(),de:T.a.getQtsid()||"",c1:i.cid||"",ve:T.a.getEid(),ht:i.isVIP?1:0,pt:t.getCurrenttime(),isdm:0,duby:0,ra:s,clt:"",ps2:S.a.get("QC007")||"",ps3:t.params.ps3||"",ps4:"",stype:"",br:$i.a.browser.userAgent,mod:na.a.local()||"",purl:window.location.href,tmplt:t.ptr.pageTmpltType,ptid:$i.a.getPtid(na.a.isTWLocale()),os:on.os,nu:T.a.getIsNewUser()?1:0,vfm:S.a.get("QP005")||"",coop:"",ispre:t.isTryWatch()?1:0,videotp:"undefined"!=typeof i.is3D?i.is3D:"",drm:on.getDrmType(i),plyrv:"",rfr:window.document.referrer,fatherid:i.albumId||"",stauto:t.autoVdUsing?1:0,algot:t.autoVdAlgot,vvfrom:this._vvfrom||"",vfrmtp:!0===t.params.autoplay?1:0,pagev:t.params.pagev||"",engt:2,ldt:n,krv:"4.0.0",wtmk:i.watermark||0,duration:1e3*t.getDuration()};t.picInPic?o.s4="80720_playerctrl_picinpic":o.s4=t.params.vfrmrst||"",t.params.abtest&&(o.abtest=t.params.abtest),t.params.vvauto&&(o.vvauto=!0===t.params.autoplay?4:2,this._outerParams&&this._outerParams.vvauto&&(o.vvauto=this._outerParams.vvauto)),e&&e.t&&(Object(zi.a)(o,{s3:t.params.vfrmblk||""}),2==e.t&&Object(zi.a)(o,{vbr:this.getVBR()}),!t.ivosRuning||1!=e.t&&2!=e.t&&13!=e.t&&15!=e.t&&8!=e.t||(o.aid=i.albumId,o.r=i.tvid,o.biz=t.currentBlockid,o.s3="006191_ivos_videoshow"));var d,u,c=t.getCurrManifestType();if(null!==c&&Object(zi.a)(o,{mft:c}),null!==c){switch(c){case 0:d=2;break;case 1:d=7;break;case 2:d=0;break;case 3:d=5;break;case 5:d=110;break;case 6:d=101}Object(zi.a)(o,{ra1:d})}var l=t.params.vfrm||"";t.isFullScreen?(l="901111_pcwh5_browerfull",u=4):t.isWebFullScreen?(l="901111_pcwh5_pagefull",u=7):u=t.isSmallWindowMode||t.picInPic?2:3,Object(zi.a)(o,{wint:u,s2:l});var h=0,_=0,f=-1;if(navigator.connection){var p=navigator.connection.downlink,g=(navigator.connection.effectiveType||"").toLowerCase(),m=(navigator.connection.type||"").toLowerCase();switch(g){case"4g":_=18;break;case"3g":_=17;break;case"2g":_=16;break;case"slow-2g":_=14}switch(m){case"cellular":_=15;break;case"wifi":_=1;break;case"ethernet":_=13;break;case"bluetooth":_=21;break;case"wimax":_=22}var v=t.getDataBufferInfo();v&&(f=v.len),h=p,Object(zi.a)(o,{bw:h,ntwk:_,dl:f})}return"{}"==JSON.stringify(this._outerParams)||t.ivosRuning||Object(zi.a)(o,this._outerParams,!0),t.isInteractVideo&&"0"==t.interactionMode&&!t.isIVMain&&(o.iamvid=t.iv_state&&t.iv_state.uniqueId||""),o}},{key:"getVBR",value:function(){var e=this._core,t=e.getDuration(),i=0;if(e.movieinfo&&0!==t&&!e.isAd()){var a=e.movieinfo.getVDInfo().vsize;i=parseInt(a/t)}return i}},{key:"setPlayPingbackInfo",value:function(e){var t={},i=this._core;e&&(t.s2=e.vfrm,t.s3=e.vfrmblk,t.s4=e.vfrmrst,t.vfrmtp=e.vfrmtp),i.params.vvauto&&(t.vvauto=e.vvauto),this._outerParams=Object(zi.a)(this._outerParams,t,!0)}},{key:"destory",value:function(){clearTimeout(this._timer),this._timer=-1}},{key:"setvvfrom",value:function(e){e&&(this._vvfrom=e)}}]),e}(),er="",tr=function(){function e(t){n()(this,e),this._core=t,er=t.playerVersion,this._vvfrom=t.params.vvfrom}return s()(e,[{key:"sendVrsRequestPingback",value:function(){this._send({t:"init"})}},{key:"sendVrsReadyPingback",value:function(){this._send({t:"ready"})}},{key:"sendFinishPresPingback",value:function(){this._send({t:11})}},{key:"sendProcessesPlayTimeRecord",value:function(){var e=this._core.sptr,t=e.plyastm;e.plyUsedTime>7e3||this._send({t:10,psdklstm:0,psdkletm:e.psdkletm-e.psdklstm,psdkistm:e.psdkistm-t,psdkietm:e.psdkietm-t,vcistm:e.vcistm-t,vcietm:e.vcietm-t,asdklstm:e.asdklstm-t,asdkletm:e.asdkletm-t,asdkistm:e.asdkistm-t,asdkietm:e.asdkietm-t,adirqstm:e.adirqstm-t,adirqetm:e.adirqetm-t,adsrqstm:e.adsrqstm-t,adsrqetm:e.adsrqetm-t,adlstm:e.adlstm-t,adletm:e.adletm-t,adastm:e.adastm-t,adaetm:e.adaetm-t,plyastm:e.plyastm-t,plyaetm:e.plyaetm-t})}},{key:"sendQOSReport",value:function(e){var t={t:11};switch(Object(zi.a)(t,e.para),e.type){case"chunkCheck":t.ct="vcut";break;case"DNSParser":t.ct="dlscherr";break;case"BWReport":t.ct="dlbw"}this._send(t)}},{key:"sendStuckdetl",value:function(e,t,i){var a=+new Date-t,n=i?"ad":"video";this._send({t:11,ct:"stuckdetl",jampt:n,isquit:e,replayt:a})}},{key:"_send",value:function(e){var t=this._core,i=t.getMovieInfo(),a=51===(i.vd||"")?59:i.vd||"",n={u:T.a.getFluid()||"",pu:Zi.a.getUid()||"",p1:on.p_code,v:er,ce:T.a.getWeid(),c1:i.cid||"",r:i.tvid||"",ve:T.a.getEid(),de:T.a.getQtsid()||"",ht:i.isVIP?1:0,pt:t.getCurrenttime(),isdm:0,ra:a,mod:na.a.local()||"",purl:window.location.href,tmplt:t.ptr.pageTmpltType,ptid:$i.a.getPtid(na.a.isTWLocale()),os:on.os,re:window.screen.width+"x"+window.screen.height,nu:T.a.getIsNewUser()?1:0,vfm:S.a.get("QP005")||"",ispre:t.isTryWatch()?1:0,videotp:"undefined"!=typeof i.is3D?i.is3D:"",drm:on.getDrmType(i),plyrv:"",rfr:window.document.referrer,fatherid:i.albumId||"",stauto:t.autoVdUsing?1:0,vvfrom:this._vvfrom||"",wtmk:i.watermark||0,algot:t.autoVdAlgot,br:$i.a.browser.userAgent,krv:"4.0.0",duby:0},r=t.getCurrManifestType();null!==r&&Object(zi.a)(n,{mft:r});var s=-1;switch(t.getCurrLoaderMode()){case"CDN":s=0;break;case"P2P":s=1}var o,d=0,u=0,c=-1;if(navigator.connection){var l=navigator.connection.downlink,h=(navigator.connection.effectiveType||"").toLowerCase(),_=(navigator.connection.type||"").toLowerCase();switch(h){case"4g":u=18;break;case"3g":u=17;break;case"2g":u=16;break;case"slow-2g":u=14}switch(_){case"cellular":u=15;break;case"wifi":u=1;break;case"ethernet":u=13;break;case"bluetooth":u=21;break;case"wimax":u=22}var f=t.getDataBufferInfo();f&&(c=f.len),d=l,Object(zi.a)(n,{bw:d,ntwk:u,dl:c,ldt:s})}Object(zi.a)(e,n),o=e,on.getPingbackDfp(o).then((function(e){t.getVideoInfo((function(t){Zi.a.isVip((function(t){var i={rn:Math.random(),dfp:e,stime:(new Date).getTime(),hu:t?1:-1};Object(zi.a)(i,o),Ki.a.beacon(i,aa.pingbackQosUrl)}))}))}))}},{key:"setvvfrom",value:function(e){e&&(this._vvfrom=e)}}]),e}(),ir=function(){function e(t){n()(this,e),this.needRecord=!0,this.browserType=t.browserType,this.pageTmpltType=t.pageTmpltType,this.pgct=t.pgct||new Date,this.sTime_userInfo=0,this.sTime_P2PCore=0,this.sTime_history=0,this.sTime_showVideo=0,this.sTime_adInit=0,this.sTime_vms=0,this.usedTime_selfLoaded=new Date-t.pgct,this.usedTime_userInfo=0,this.usedTime_P2PCore=0,this.usedTime_history=0,this.usedTime_showVideo=0,this.usedTime_pageShowVideo=0,this.usedTime_adInit=0,this.usedTime_vms=0,this.bindEvent()}return s()(e,[{key:"bindEvent",value:function(){var e=this;Zi.a.on("httpStart",(function(){e.sTime_userInfo=new Date-e.pgct})),Zi.a.on("httpComplete",(function(){e.usedTime_userInfo=new Date-e.sTime_userInfo-e.pgct}))}}]),e}(),ar=function Uf(e){n()(this,Uf);var t=+new Date;this.psdklstm=e.pgct||t,this.psdkletm=t,this.psdkistm=t,this.psdkietm=t,this.vcistm=0,this.vcietm=0,this.ffstm=0,this.ffetm=0,this.vclstm=0,this.vcletm=0,this.asdklstm=t,this.asdkletm=t,this.asdkistm=0,this.asdkietm=0,this.adirqstm=0,this.adirqetm=0,this.adsrqstm=0,this.adsrqetm=0,this.adlstm=0,this.adletm=0,this.adastm=t,this.adaetm=0,this.plyastm=t,this.plyaetm=0,this.adUsedTime=0,this.plyUsedTime=0},nr=function(e){return parseInt(e,10)},rr=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).logger=new v.a("EpisodeManager[".concat(e,"]")),i.EpisodeStore={},i}return f()(t,e),s()(t,[{key:"_ensureDataStructure",value:function(e){var t=this.EpisodeStore[e]||{};Gi.a.isObject(t.pres)?(t.pres.finish=!!t.pres.finish,t.pres.queue=Gi.a.isArray(t.pres.queue)?t.pres.queue:[]):t.pres={finish:!1,queue:[]},Gi.a.isObject(t.mids)?(t.mids.finish=!!t.mids.finish,t.mids.queue=Gi.a.isArray(t.mids.queue)?t.mids.queue:[]):t.mids={finish:!1,queue:[]},Gi.a.isObject(t.briefs)?(t.briefs.finish=!!t.briefs.finish,t.briefs.queue=Gi.a.isArray(t.briefs.queue)?t.briefs.queue:[]):t.briefs={finish:!1,queue:[]},Gi.a.isObject(t.features)?(t.features.finish=!!t.features.finish,t.features.queue=Gi.a.isArray(t.features.queue)?t.features.queue:[]):t.features={finish:!1,queue:[]},this.EpisodeStore[e]=t}},{key:"clear",value:function(e){e=nr(e),delete this.EpisodeStore[e]}},{key:"clearAll",value:function(){this.EpisodeStore={}}},{key:"getPres",value:function(e){var t=[];return e=nr(e),this.valid(e)&&(t=this.EpisodeStore[e].pres.queue),t}},{key:"addPres",value:function(e,t){e=nr(e),this.valid(e)&&Gi.a.isArray(t)&&(this.EpisodeStore[e].pres.queue=this.EpisodeStore[e].pres.queue.concat(t))}},{key:"finishPres",value:function(e,t){if(e=nr(e),this.valid(e)){if("boolean"!=typeof t)return this.EpisodeStore[e].pres.finish;var i=this.EpisodeStore[e].pres;t&&!1===i.finish&&(i.finish=t,this.emit("finishAddPres",{videoId:e,length:i.queue.length}),this.logger.info("finishPres: episode id  = "+e))}else{if("boolean"!=typeof t)return!1;this.logger.warn("finishPres: episode id not valid, "+e)}}},{key:"addMids",value:function(e,t){e=nr(e),this.valid(e)&&Gi.a.isArray(t)&&(this.EpisodeStore[e].mids.queue=this.EpisodeStore[e].mids.queue.concat(t))}},{key:"finishMids",value:function(e,t){if(e=nr(e),this.valid(e)){if("boolean"!=typeof t)return this.EpisodeStore[e].mids.finish;var i=this.EpisodeStore[e].mids;t&&!1===i.finish&&(i.finish=t,this.emit("finishAddMids",{videoId:e,length:i.queue.length}))}else{if("boolean"!=typeof t)return!1;this.logger.warn("finishMids: episode id not valid, "+e)}}},{key:"addBriefs",value:function(e,t){e=nr(e),this.valid(e)&&Gi.a.isArray(t)&&(this.EpisodeStore[e].briefs.queue=this.EpisodeStore[e].briefs.queue.concat(t))}},{key:"finishBriefs",value:function(e,t){if(e=nr(e),this.valid(e)){if("boolean"!=typeof t)return this.EpisodeStore[e].briefs.finish;var i=this.EpisodeStore[e].briefs;t&&!1===i.finish&&(i.finish=t,this.emit("finishAddBriefs",{videoId:e,length:i.queue.length}))}else{if("boolean"!=typeof t)return!1;this.logger.warn("finishBriefs: episode id not valid, "+e)}}},{key:"finishFeatures",value:function(e,t){if(e=nr(e),this.valid(e)){if("boolean"!=typeof t)return this.EpisodeStore[e].features.finish;this.EpisodeStore[e].features.finish=t}}},{key:"setInfo",value:function(e,t){e=nr(e),this.valid(e)&&(this.EpisodeStore[e].movieInfo=t)}},{key:"getInfo",value:function(e){var t;return this.valid(e)&&this.EpisodeStore[e]&&(t=this.EpisodeStore[e].movieInfo),t}},{key:"setDefinitionAd",value:function(e,t){e=nr(e),this.valid(e)&&(this.EpisodeStore[e].definitionAdInfo=t)}},{key:"valid",value:function(e,t){if(e=nr(e),"boolean"!=typeof t)return this.EpisodeStore[e]&&!0===this.EpisodeStore[e].valid?(this._ensureDataStructure(e),t=!0):t=!1,t;this._ensureDataStructure(e),this.EpisodeStore[e].valid=t}},{key:"destroy",value:function(){this.EpisodeStore={},this.removeAllListeners("finishAddPres"),this.removeAllListeners("finishAddMids"),this.removeAllListeners("finishAddBriefs")}}]),t}(p.a),sr="p2p abs proxy ";var or=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).enabled=!$i.a.browser.WECHAT&&window.Map,i._p_=null,i._currPlayId=undefined,i._nextPlayId=undefined,i._feeded=!1,i._seeked=!1,i._closed=!0,Zi.a.isLogin()?i._limitBidList=[]:i._limitBidList=[500],i.logger=new v.a("P2PProxy[".concat(e,"]")),i.isMobiusTest="performance"===Hi("__pmobius__")&&"true"==Hi("debug"),i}return f()(t,e),s()(t,[{key:"__setSDK",value:function(e){this._p_=new e,this.init(),this.emit("ready")}},{key:"__setQVS",value:function(e){this._q_=e}},{key:"__setPlayId",value:function(e,t){e+="",t?this._currPlayId=e:this._nextPlayId=e}},{key:"__getPlayId",value:function(e){return e?this._currPlayId:this._nextPlayId}},{key:"__switchToNextTvid",value:function(){this.enabled&&this._feeded&&this._nextPlayId&&(this._currPlayId=this._nextPlayId,this._nextPlayId=undefined,this._p_.seek(this._currPlayId))}},{key:"isReady",value:function(){return!!this._p_}},{key:"isClosed",value:function(){return this._closed}},{key:"init",value:function(){var e=this;function t(){return e._q_.media.updating}function i(){return!e._q_.isRolling&&e._q_.datasource.playingStream&&e._q_.startPlayed&&!t()}var a=T.a.getFluid()||"",n=T.a.getWeid(),r={logger:this.logger,uid:a+"-"+n.slice(0,8),getBufferFunc:function(){var t={};if(e._q_){Object(zi.a)(t,e._q_.mediaBufferInfo);var i=e._q_.dataBufferInfo;i&&null!==i.buffered&&i.buffered!==undefined&&(t.buffered.audio.end=i.buffered.audio.preEnd,t.buffered.video.end=i.buffered.video.preEnd)}return t},encryptFunc:k.a.cmd5x,reBufTimeFunc:function(){return e._q_.reBufTime},isMediaUpdatingFunc:t,canSwitchVd:i,startPlayed:function(){return e._q_.startPlayed},getVrsParams:function(e){Zi.a.getVipTypes((function(t){var i={ut:[],dfp:ea.a.get(),bop:JSON.stringify({version:"10.0",dfp:ea.a.get()})};t.forEach((function(e){i.ut.push(parseInt(e,10))})),e(i)}))},sendPingBack:function(t){e.emit("sendPingBack",t)},getIsVip:function(e){Zi.a.isVip((function(t){e(t)}))},dashUpdatedFunc:function(a){e.logger.log(sr+" dashUpdated , canSwitchVd = "+i()+", mediaUpdating = "+t()),e.emit("dashUpdated",a)},noticeDataArrived:function(){e.emit("dataArrived")},checkIsMobius:function(){return e.isMobiusTest}};e.logger.log(sr+"init"),e._p_.init(r)}},{key:"close",value:function(){if(!this.enabled||!this._feeded)return null;this._p_&&(this._p_.close(),this.logger.log(sr+"close"),this._closed=!0,this._currPlayId=undefined,this._nextPlayId=undefined,this._feeded=!1,this._seeked=!1)}},{key:"getBuffTime",value:function(){var e={start:0,length:0};if(this._p_){var t=this._p_.getBuffTime();e.start=t.start,e.length=t.length}return e}},{key:"setBitrate",value:function(e,t){this.enabled&&(this.logger.log(sr+" setBitrate ,  tvid= "+e+", bitrate = "+t),this._p_.setBitrate(e.toString(),parseInt(t,10)))}},{key:"feed",value:function(e,t,i,a,n,r){this.enabled&&(this._closed=!1,e=function(e){if(e.tvid+="",La.hasBit(4,3)){var t=La.getFT4().toString(2).split("");if(t[t.length-3]=0,e.k_ft4=parseInt(t.join(""),2),!La.hasBit(1,37)){var i=La.getFT1().toString(2).split("");i[i.length-37]=1,e.k_ft1=parseInt(i.join(""),2)}}return e}(e),this.__setPlayId(e.tvid,a),this.logger.log(sr+"feed "+e.tvid+", isCurrent: "+a),this._p_.feed(e,JSON.stringify(t),i,a,r,this._limitBidList),this.setBitrate(e.tvid,n),this._feeded=!0)}},{key:"seek",value:function(e){var t=this._currPlayId;this.enabled&&this._feeded&&(this.logger.log(sr+"seek, tvid("+t+"), time("+e+")"),t&&("string"!=typeof t&&(t+=""),"number"==typeof e&&(e=parseFloat(e),this._p_.seek(t,e),this._seeked=!0)))}},{key:"read",value:function(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(!this.enabled||!this._feeded)return null;this.logger.log(sr+"read, isinit = "+e);var t=this._p_?this._p_.read(e):null;return t}},{key:"refreshLoadRange",value:function(e,t){this.enabled&&this._feeded&&this._p_&&this._p_.refreshLoadRange(e+"",t)}},{key:"error",value:function(){return this._p_?this._p_.error:null}},{key:"stats",value:function(){return this._p_?this._p_.stats:{bandwidth:0,bps:0,cdnHost:"",netProtocol:""}}},{key:"algot",value:function(){return this._p_&&this.enabled&&this._feeded?this._p_.algorithmDes:""}},{key:"checkData",value:function(e,t,i,a){var n=this._p_;if(n)try{n.checkData(e,t,i,a)}catch(r){}}},{key:"recover",value:function(e){var t=this._p_;t&&t.recover&&t.recover(e)}}]),t}(p.a),dr=i(14),ur=i(13),cr=i(15),lr=i(83),hr=1,_r=2,fr="http://static.iqiyi.com/ext/common/h5Voddpcfg.json";lr.a.isHTTPS&&(fr=fr.replace(/^http:/gi,"https:"));var pr=null,gr=0,mr=null;function vr(){null!==pr&&pr.abort(),(pr=new XMLHttpRequest).responseType="json",pr.onreadystatechange=function(){if(0===pr.readyState);else if(1===pr.readyState);else if(2===pr.readyState);else if(3===pr.readyState);else if(200===pr.status)if(pr.response)try{mr=JSON.parse(JSON.stringify(pr.response)),yr(),kr()}catch(e){br("dataError")}else br("responseIsNull");else br("statusErr-"+pr.status)};try{pr.open("GET",fr+"?rn="+Date.now(),!0),pr.send()}catch(e){br("tryCatchError")}}function br(e){yr(),gr<5&&(gr++,vr())}function yr(){null!==pr&&pr.abort(),pr=null}function kr(){if(null!==mr){dr.a.dispatchCfg=mr.cdn.dispatcher.timeout,dr.i.tracker=mr.tracker,mr.aidList&&(dr.i.aidList=mr.aidList),mr.defaultTracker&&(dr.i.defaultTracker=mr.defaultTracker),mr.config&&(ur.a.platform===_r||ur.a.checkIsMobius()||(dr.c.videoMaxSize=parseInt(mr.config.videoMaxSize)),dr.i.getPeerIDStep=parseInt(mr.config.getPeerIDStep),dr.i.weedOutPeerStep=parseInt(mr.config.weedOutPeerStep),dr.i.connectPeerStep=parseInt(mr.config.connectPeerStep),dr.i.NATTimeoutStep=parseInt(mr.config.NATTimeoutStep),dr.i.connectMax=parseInt(mr.config.connectMax),dr.i.passiveMax=parseInt(mr.config.passiveMax),dr.i.RTCMax=parseInt(mr.config.RTCMax),dr.i.RTCPoolSize=parseInt(mr.config.RTCPoolSize),dr.i.coolDownTime=parseInt(mr.config.coolDownTime));var e=cr.a.getUserInfoFromCookie();if(e.userInfo){var t,i,a=e.userNetType,n=e.userArea;mr.closep2p&&(dr.i.closeP2PTvidList=mr.closep2p.tvidList,dr.i.closeP2PNetList=mr.closep2p.netList,dr.i.closeP2PFileTypeList=mr.closep2p.fileTypeList);var r=mr.stun?mr.stun:mr.tracker;dr.i.stun=[];for(var s=!1,o=0;o<r.length&&!s;o++){if(a===r[o].key||"*"===r[o].key){s=!0;for(var d=0;d<r[o].value.length;d++){var u=r[o].value[d];switch(lr.a.browser.name){case"mozilla":case"msedge":case"safari":default:dr.i.stun.push({url:"stun:"+u.split("|")[0]+":"+u.split("|")[4],urls:"stun:"+u.split("|")[0]+":"+u.split("|")[4]})}}}if(cr.a.shuffle(dr.i.stun),"mozilla"===lr.a.browser.name)for(;dr.i.stun.length>2;)dr.i.stun.shift()}for(var c=0;c<mr.cdn.cache.TTFB.length;){var l=mr.cdn.cache.TTFB[c];if(t=l.ai.split("|")[0],i=l.ai.split("|")[1],!("*"!==t&&t!==a||"*"!==i&&0!==n.indexOf(i))){dr.a.TTFBCfg=l.timeout;break}c++}for(c=0;c<mr.cdn.cache.load.length;){var h=mr.cdn.cache.load[c];if(t=h.ai.split("|")[0],i=h.ai.split("|")[1],!("*"!==t&&t!==a||"*"!==i&&0!==n.indexOf(i))){dr.a.rcvCfg=h.timeout;break}c++}c=0,dr.i.limitP2P="off";var _=!1;if(dr.i.closeP2PNetList.length>0)for(var f=0;f<dr.i.closeP2PNetList.length;f++)if(dr.i.closeP2PNetList[f]===a){_=!0;break}if(dr.i.closeP2PTvidList.length>0)for(var p=0;p<dr.i.closeP2PTvidList.length;p++)if(dr.i.closeP2PTvidList[p]===ur.a.tvId){_=!0;break}if(dr.i.closeP2PFileTypeList.length>0)for(var g=0;g<dr.i.closeP2PFileTypeList.length;g++)if(dr.i.closeP2PFileTypeList[g]===ur.a.fileType){_=!0;break}if(!_)for(;c<mr.cdn.cache.p2p.length;){var m=mr.cdn.cache.p2p[c];if(t=m.ai.split("|")[0],i=m.ai.split("|")[1],!("*"!==t&&t!==a||"*"!==i&&0!==n.indexOf(i))){for(var v=0;v<m.time.length;){if(Tr(m.time[v])){dr.i.limitP2P="on";break}v++}break}c++}if(c=0,mr.cdn.cache.reLoad)for(;c<mr.cdn.cache.reLoad.length;){var b=mr.cdn.cache.reLoad[c];if(t=b.ai.split("|")[0],i=b.ai.split("|")[1],!("*"!==t&&t!==a||"*"!==i&&0!==n.indexOf(i))){dr.a.reLoadCfg=b.timeout;break}c++}var y=0;for(ur.a.absOpen=!1;y<mr.abs.open.length;){var k=mr.abs.open[y];if(t=k.ai.split("|")[0],i=k.ai.split("|")[1],!("*"!==t&&t!==a||"*"!==i&&0!==n.indexOf(i))){for(var T=k.time.length,S=0;S<T;){if(Tr(k.time[S])){ur.a.absOpen=!0;break}S++}break}y++}}}}function Tr(e){if("*"===e)return!0;var t=e.split("-")[0],i=e.split("-")[1],a=e.split("-")[2],n=60*parseInt(i.split(":")[0])+parseInt(i.split(":")[1]),r=60*parseInt(a.split(":")[0])+parseInt(a.split(":")[1]);if(n>=0&&r>n){var s=new Date,o=s.getDay().toString(),d=60*s.getHours()+s.getMinutes();if(("*"===t||o===t)&&d>=n&&d<r)return!0}return!1}var Sr,Pr,xr={load:function(){yr(),gr=0,vr()},loadBGPIP:function(){var e=new XMLHttpRequest;e.responseType="text",e.onreadystatechange=function(){if(0===e.readyState);else if(1===e.readyState);else if(2===e.readyState);else if(3===e.readyState);else if(200===e.status&&e.response)try{if(""===ur.a.bgpIP_1){var t=e.response.split(";");ur.a.bgpIP_1=t[0],t.length>1&&(ur.a.bgpIP_2=t[1])}}catch(i){}};try{e.open("GET","https://103.44.59.54/3e8?rn="+Date.now(),!0),e.send()}catch(t){}},checkConfig:kr},Ir=i(8),Er=i(101),Dr=i(305),wr=function(){function e(){n()(this,e),this._size=0,this._dicMap=new Map}return s()(e,[{key:"has",value:function(e){return this._dicMap.has(e)}},{key:"get",value:function(e){var t=this._dicMap.get(e);return t||null}},{key:"set",value:function(e,t){this._dicMap.has(e)||this._size++,this._dicMap.set(e,t)}},{key:"remove",value:function(e){var t=this._dicMap.get(e);return t&&(this._dicMap["delete"](e),this._size--),t}},{key:"clear",value:function(){this._size=0,this._dicMap.clear()}},{key:"values",get:function(){return this._dicMap}},{key:"size",get:function(){return this._size}}]),e}(),Ar=i(34),qr=/[^0-9a-eA-E]+/g,Or=16777216,Lr=0,Cr=0,Mr=null,Rr=!1;function Br(e){if(e<=0&&(Mr=null),Mr){if(e>Mr.byteLength){var t=new Uint8Array(e);t.set(Mr,0),Mr=t}}else Mr=new Uint8Array(e)}var Nr=Object.defineProperties({resetData:function(){Cr=0,Lr=0,Rr=!1},setStr:function(e){var t=Math.ceil(e.length/2);if(Mr||Br(Lr+t),null!==qr.exec(e))throw"EncodeBuffer setStr string need baseEnCode!";var i=e.length%2;Lr+t>Cr&&(Br(Lr+t),Cr=Lr+t);for(var a=0;a<e.length;a+=2){var n=void 0,r=void 0;1===i&&a===e.length-1?(n=parseInt("0x"+e[a]),r=0):(n=parseInt("0x"+e[a]),r=parseInt("0x"+e[a+1])),Mr[Lr+Math.ceil(a/2)]=r+15*n}Lr+=t},setCharStr:function(e){var t=Math.ceil(e.length);Mr||Br(Lr+t),Lr+t>Cr&&(Br(Lr+t),Cr=Lr+t);for(var i=0;i<e.length;i++)Mr[Lr+i]=parseInt("0x"+e[i]);Lr+=t},setUTF8Str:function(e){var t=Math.ceil(e.length);Mr||Br(Lr+t),Lr+t>Cr&&(Br(Lr+t),Cr=Lr+t);for(var i=0;i<e.length;i++)Mr[Lr+i]=e[i].charCodeAt();Lr+=t},set8:function(e){Mr||Br(Lr+1),Lr+1>Cr&&(Br(Lr+1),Cr=Lr+1),Mr[Lr]=e,Lr+=1},set16:function(e){Mr||Br(Lr+2),Lr+2>Cr&&(Br(Lr+2),Cr=Lr+2);var t=e;t>=256?(Mr[Lr]=Math.floor(t/256),t%=256):Mr[Lr]=0,Mr[Lr+1]=t,Lr+=2},set32:function(e){Mr||Br(Lr+4),Lr+4>Cr&&(Br(Lr+4),Cr=Lr+4);var t=e;t>=Or?(Mr[Lr]=Math.floor(t/Or),t%=Or):Mr[Lr]=0,t>=65536?(Mr[Lr+1]=Math.floor(t/65536),t%=65536):Mr[Lr+1]=0,t>=256?(Mr[Lr+2]=Math.floor(t/256),t%=256):Mr[Lr+2]=0,Mr[Lr+3]=t,Lr+=4},setBytes:function(e,t,i){Mr||Br(Lr+i),Lr+i>Cr&&(Br(Lr+i),Cr=Lr+i),Mr.set(e.subarray(t,t+i),Lr),Lr+=i},clear:function(){Mr=null},toString:function(){for(var e="",t=Cr<=64?Cr:64,i=0;i<t;i++){var a=Mr[i];e+=a<16?"0"+a.toString(16):a.toString(16),i<t-1&&(e+="-")}return e},crc:function(){for(Lr=Cr,Rr?Lr-=4:(Mr||Br(Lr+4),Lr+4>Cr&&(Br(Lr+4),Cr=Lr+4)),Sr=Math.floor(Cr/4),Pr=0;Pr<4;)Mr[Lr+Pr]=Mr[Pr*Sr],Pr++;Lr+=4,Rr=!0},getData:function(){return new Uint8Array(Mr.buffer.slice(0,Cr))},getReferData:function(){return new Uint8Array(Mr.buffer.slice(0,Cr))}},{position:{set:function(e){Lr=e},get:function(){return Lr},configurable:!0,enumerable:!0},length:{get:function(){return Cr},configurable:!0,enumerable:!0}}),Fr=i(10),Ur=new wr,Vr=null,Hr=0,Wr=!1;function jr(e){var t=Ur.remove(e);t&&(Vr===t&&(Vr=null),t.destroy())}function Gr(e){var t=Ur.get(e);t&&t.destroyChunk(e)}function zr(){Hr=0;var e=Kr();if(ur.a.platform===hr){for(var t=!1,i=!1,a=0;a<e.length;a++){var n=e[a].index.slice(0,1),r=e[a].index.slice(1);"a"===n&&(e[a].fileType!==Fr.a.DASH||r>0)&&Gr(e[a].alias),e[a]&&(Hr=e[a].memory+Hr),-1!==e[a].peerCnt&&e[a].peerCnt>1e3&&(t=!0),-1!==e[a].peerCnt&&e[a].peerCnt<=1e3&&(i=!0),e[a].fileType===Fr.a.DASH&&0===r&&(e[a].status=0),e[a].tvid!==ur.a.tvId&&e[a].tvid!==ur.a.lastReadTvID&&0===e[a].status&&(e[a].status=1)}if(Ir.a.info("memorySize : "+Hr+", "+Math.floor(Hr/1024/1024)+"M"),Hr>=dr.c.videoMaxSize){if(t&&i){e.sort((function(e,t){return t.peerCnt-e.peerCnt}));for(var s=0;s<e.length;s++)if(Hr>dr.c.videoMaxSize&&e[s]&&1===e[s].status&&e[s].peerCnt>1e3){Hr-=e[s].memory,jr(e[s].alias);break}}if(Hr>=dr.c.videoMaxSize){(e=Kr()).sort((function(e,t){return e.shareDataNum-t.shareDataNum}));for(var o=0;o<e.length;o++)e[o].shareDataNum=0,Hr>=dr.c.videoMaxSize&&e[o]&&1===e[o].status&&(Hr-=e[o].memory,jr(e[o].alias));if(Hr>=dr.c.videoMaxSize){(e=Kr()).sort((function(e,t){return parseInt(e.index.slice(1))-parseInt(t.index.slice(1))}));for(var d=0;d<e.length;d++)if(e[d]&&Hr>=dr.c.videoMaxSize){var u=e[d].index.slice(0,1),c=e[d].index.slice(1);if(e[d].tvid===ur.a.tvId||e[d].tvid===ur.a.lastReadTvID)continue;"e"===u&&c<ur.a.lastReadSegIndex&&e[d].shareDataNum<10&&(Hr-=e[d].memory,jr(e[d].alias))}}}}}else if(ur.a.platform===_r)for(var l=0;l<e.length;l++)e[l]&&(e[l].tvid!==ur.a.tvId&&e[l].tvid!==ur.a.lastReadTvID&&0===e[l].status&&(e[l].status=1),1===e[l].status?(Hr-=e[l].memory,jr(e[l].alias)):Gr(e[l].alias));setTimeout(zr,6e4)}function Kr(){var e=[],t=!0,i=!1,a=undefined;try{for(var n,r=Ur.values[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=vi()(n.value,2)[1];e.push(s)}}catch(Rf){i=!0,a=Rf}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return e}var Yr=Object.defineProperties({getSegment:function(e){return Ur.get(e)},hasSegment:function(e){return Ur.has(e)},setSegment:function(e,t){t&&(Ur.set(e,t),Wr||(Wr=!0,zr()))},removeSegment:jr,setLoadSegment:function(e){if(!Vr||Vr.alias!==e)if(e){var t=Ur.get(e);t?(Vr&&Vr.clearTask(),Vr&&Vr.alias===t.alias||(Vr=t)):Vr=null}else Vr&&Vr.clearTask(),Vr=null},getSourceDescribe:function(e){Nr.resetData();var t=Kr(),i=0;Nr.set16(e.length),Nr.setCharStr(e);for(var a=0;a<t.length;a++)t[a].vid===e&&i++;Nr.set16(i);for(var n=0;n<t.length;n++)if(t[n].vid===e){var r=t[n].bitmap;Nr.set16(r.data.byteLength+8),Nr.set32(r.alias),Nr.set32(r.size),Nr.setBytes(r.data,0,r.data.byteLength)}return Nr.getData()},destroy:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=Ur.values[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){jr(vi()(a.value,1)[0])}}catch(Rf){t=!0,i=Rf}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}}},{segmentList:{get:function(){return Kr()},configurable:!0,enumerable:!0},loadSegment:{get:function(){return Vr},configurable:!0,enumerable:!0},memorySize:{get:function(){return Hr},configurable:!0,enumerable:!0},size:{get:function(){return Ur.size},configurable:!0,enumerable:!0}}),Qr=null,Jr=new Array(5),Xr=new Array(5),Zr=0,$r=new Map,es=0,ts=0,is=0,as=null,ns=0,rs=0,ss="",os=function(){function e(){n()(this,e),this.levelID=-1,this.nextReqThreshold=0,$r.clear(),ss=ur.a.absDoMain?(lr.a.isHTTPS?"https":"http")+"://"+ur.a.absDoMain+"/ABSRequest":(lr.a.isHTTPS?"https":"http")+"://abs.video.iqiyi.com/ABSRequest",this.connectWebscoket(),this.lastLevel=-1,this.receiveCount=0,this.algorithm_des="defal"}return s()(e,[{key:"connectWebscoket",value:function(){this.loader=new XMLHttpRequest;var e=this;this.loader.onloadend=function(t){var i=t.currentTarget,a=i.status,n=JSON.parse(i.response);a>=200&&a<300?"0"===n.errorcode?(e.levelID=parseInt(n.bitrate),e.algorithm_des=n.algorithm_des,e.receiveCount++,Ir.a.info(" receive Message  ~~~~~~~~~~~~~~~~~~~~quality: "+e.levelID+" levelID "+$r.get(e.levelID)+", msg_seq "+n.msg_seq+" ,algorithm "+e.algorithm_des)):Ir.a.error("ABS proxy return errCode "+n.errorcode):(e.algorithm_des="connectFailed",Ir.a.error(" receive Message  ~~~~~~~~~~~~~~~~~~~~status err "+a))},this.loader.onerror=function(t){e.algorithm_des="connectFailed",Ir.a.error(" receive Message  ~~~~~~~~~~~~~~~~~~~~error "+t)},this.loader.onabort=function(){e.algorithm_des="connectFailed",Ir.a.warn(" receive Message  ~~~~~~~~~~~~~~~~~~~~onabort")}}},{key:"close",value:function(){this.levelID=-1,this.lastLevel=-1,this.nextReqThreshold=0,this.receiveCount=0,this.algorithm_des="defal",$r.clear(),this.loader&&(this.loader.abort(),Ir.a.warn("abs close,close connnection ")),as=null}},{key:"reportData",value:function(e){var t=this.makeReportJsonData(e);if(t&&this.loader)try{this.loader.open("POST",ss,!1),this.loader.withCredentials=!1,this.loader.setRequestHeader("Content-Type","application/json"),Ir.a.info(" send Message  ~~~~~~~~~~~~~~~~~~~~ num "+t.msg_seq+","+JSON.stringify(t)),this.loader.send(JSON.stringify(t))}catch(i){Ir.a.error("ABSStrategy send resquest tryCatchError"+i)}}},{key:"makeReportJsonData",value:function(e){this.lastLevel=e.bid;for(var t=[],i=0;i<e.bidList.length;i++){var a=8*Math.round(e.totalSizeList[i]/e.duration);$r.get(a)!==e.bidList[i]&&$r.set(a,e.bidList[i]),0!==e.chunkSizeList[i]&&(Qr={rate:a.toString(),size:e.chunkSizeList[i].toString(),chunkcnt:e.chunk_count.toString()},t.push(Qr))}if(0!==t.length){ur.a.getIsVipFunc(ds),(isNaN(e.rebuffTime)||!e.rebuffTime||e.rebuffTime<0)&&(e.rebuffTime=0);var n=0;e.index===es?n+=e.rebuffTime:(es=e.index,n=e.rebuffTime);var r=Math.round(1e3*e.buffer_level),s=0,o=0,d=0,u=0;e.loadTime>=50&&(Jr[Zr%Jr.length]=e.loadSize,Xr[Zr%Jr.length]=e.loadTime,Zr++),e.loadSize>0&&e.loadTime>0&&(u=Math.round(e.loadSize/(e.loadTime/1e3)));for(var c=0;c<Jr.length&&Jr[c];c++)s+=Jr[c],o+=Xr[c];s>0&&o>0&&(d=Math.round(s/(o/1e3)));var l=8*Math.min(d,u),h=8*Math.round(e.size/e.duration);return as||(as=cr.a.getUserInfoFromCookie()),{clientid:ur.a.uuid,version:"0.5.1",client_version:"111",msg_seq:(rs++).toString(),msgid:"3",device_type:"pc",isp:as.userNetType,city:as.userArea,isvip:ns.toString(),isp2p:(Yr.loadSegment?1:0).toString(),channel_type:"movie",report:{last_chunk_id:e.index.toString(),last_chunk_size:e.lastChunkSize.toString(),last_chunk_quality:h.toString(),chunk_count:e.chunk_count.toString(),buffer_level:r.toString(),rebuff_time:Math.round(n).toString(),bandwidthEst:l.toString(),next_chunk_info:t}}}}},{key:"bitrate",get:function(){var e=ur.a.bid;if(e)return parseInt(e);if(-1!==this.levelID&&$r.has(this.levelID)){var t=$r.get(this.levelID);return t>this.lastLevel?(is!==this.receiveCount&&(is=this.receiveCount,ts++),ts>1?t:this.lastLevel):t<this.lastLevel?(ts=0,t):t}return-1}},{key:"algorithmDes",get:function(){return this.algorithm_des}}],[{key:"clearRaiseLevelCount",value:function(){ts=0}}]),e}();function ds(e){ns=e?1:0}var us,cs,ls=i(169),hs=i.n(ls),_s=function(){function e(t){n()(this,e),this.name=t,this._count=0}return s()(e,[{key:"toString",value:function(){return this._count.toString()}},{key:"add",value:function(e){this._count+=e}},{key:"reset",value:function(){this._count=0}}]),e}(),fs={stratus_connectCnt:new _s("scnt"),stratus_connectSuccess:new _s("sscu"),stratus_duration:new _s("sdur"),stratus_break:new _s("sbrk"),cdn_taskCnt:new _s("ctct"),cdn_progressCnt:new _s("cpct"),cdn_progressTime:new _s("cptm"),cdn_loadTime:new _s("cltm"),dispatchKey_Cnt:new _s("dkcnt"),dispatchKey_Done:new _s("dkdon"),dispatch_Cnt:new _s("dict"),dispatch_doneCount:new _s("ddct"),dispatch_duration:new _s("ddur"),change_definition:new _s("cdef"),init:function(){us||(us=[this.stratus_connectCnt,this.stratus_connectSuccess,this.stratus_duration,this.stratus_break,this.cdn_taskCnt,this.cdn_progressCnt,this.cdn_progressTime,this.cdn_loadTime,this.dispatchKey_Cnt,this.dispatchKey_Done,this.dispatch_Cnt,this.dispatch_doneCount,this.dispatch_duration,this.change_definition])},reset:function(){for(var e=0;e<us.length;e++)us[e].reset()},tail:function(e){for(var t=0;t<us.length;t++)e[us[t].name]=us[t].toString()}},ps=0,gs=0,ms=0,vs=0,bs=0,ys=0,ks=0,Ts=0,Ss=0,Ps=!1;function xs(){var e;fs.init(),Ps=!0,(++Is>=4||ps-bs+(gs-ys)+(ms-ks)>12582912)&&((e={t:"h5timing"}).lp2p=gs-ys,e.up2p=ms-ks,e.lcdn=ps-bs,e.used=vs-Ts,fs.tail(e),e.dats=dr.c.videoDataSize,e.srcn=Yr.size,e.plydu=ur.a.playDuration-Ss,e.lmax=ur.a.downMax,Es(e),fs.reset(),bs=ps,ys=gs,ks=ms,Ts=vs,Ss=ur.a.playDuration,Is=0),cs=setTimeout(xs,1e4)}var Is=0;function Es(e){if(Ps){var t=cr.a.getUserInfoFromCookie();e.uid=ur.a.uuid,e.uif=t.userInfo,e.tvid=ur.a.tvId,e.tkip=ur.a.trackerIP,e.lstws=t.ws,e.lstidc=t.idc,e.ver=dr.k.version,e.cal=ps,e.pal=gs,cr.a.fireUrl(e,"//msg.qy.net/vodpb.gif")}}var Ds,ws,As=Object.defineProperties({start:function(){Ps||xs()},stop:function(){Ps=!1,clearTimeout(cs)},check:function(e){Ps&&(e.t="h5check",Es(e))},addPBItem:function(e,t){t?e.add(t):e.add(1)}},{cdnSize:{get:function(){return ps},set:function(e){ps=e},configurable:!0,enumerable:!0},p2pSize:{get:function(){return gs},set:function(e){gs=e},configurable:!0,enumerable:!0},upSize:{get:function(){return ms},set:function(e){ms=e},configurable:!0,enumerable:!0},usedSize:{get:function(){return vs},set:function(e){vs=e},configurable:!0,enumerable:!0}}),qs=0,Os=0,Ls=null;var Cs=Object.defineProperties({resetData:function(e){if(e){if(e instanceof ArrayBuffer)Os=e.byteLength,Ls=new Uint8Array(e);else{if(!(e instanceof Uint8Array))return;Os=e.byteLength,Ls=e}qs=0}},getStr:function(e){if(!Ls)return"";var t=Math.ceil(e/2),i=e%2;if(qs+t>Os&&(t=Os-qs),t<=0)return"";for(var a="",n=0;n<t;n++){var r=Ls[qs+n],s=void 0;1===i&&n===t-1?a+=Math.floor(r/15).toString(16):(s=r%15,a+=Math.floor(r/15).toString(16)+s.toString(16))}return qs+=t,a},getCharStr:function(e){if(!Ls)return"";var t=Math.ceil(e);if(qs+t>Os&&(t=Os-qs),t<=0)return"";for(var i="",a=0;a<t;a++){i+=Ls[qs+a].toString(16)}return qs+=t,i},getUTF8Str:function(e){if(!Ls)return"";var t=Math.ceil(e);if(qs+t>Os&&(t=Os-qs),t<=0)return"";for(var i="",a=0;a<t;a++){var n=Ls[qs+a];i+=String.fromCharCode(n)}return qs+=t,i},get8:function(){if(!Ls||qs+1>Os)return 0;var e=Ls[qs];return qs+=1,e},get16:function(){if(!Ls||qs+2>Os)return 0;var e=256*Ls[qs]+Ls[qs+1];return qs+=2,e},get32:function(){if(!Ls||qs+4>Os)return 0;var e=16777216*Ls[qs]+65536*Ls[qs+1]+256*Ls[qs+2]+Ls[qs+3];return qs+=4,e},getBytes:function(e){if(!Ls||qs+e>Os)return null;var t=Ls.subarray(qs,qs+e);return qs+=e,t},clear:function(){Ls=null},crc:function(){for(qs=Os-4,Ds=Math.floor(Os/4),ws=0;ws<4;){if(Ls[qs+ws]!==Ls[ws*Ds])return!1;ws++}return!0},toString:function(){for(var e="",t=Os<=64?Os:64,i=0;i<t;i++){var a=Ls[i];e+=a<16?"0"+a.toString(16):a.toString(16),i<t-1&&(e+="-")}return e}},{position:{set:function(e){qs=e},get:function(){return qs},configurable:!0,enumerable:!0},length:{get:function(){return Os},configurable:!0,enumerable:!0}}),Ms=function(){function e(t,i,a){n()(this,e),this.socket=null,this.trackerStateFun=a,this.uid="",this.startTime=0,this.watcherStep=0,this.retryStep=0,this.pbTimer=0,this.reconnectCnt=0,this.id=t,this.firstIPInfo=i,this.running=!0,this.open=!1,this.cdnSize=0,this.p2pSize=0,this.upSize=0,this.usedSize=0,this.connectCnt=0,this.connectDoneCnt=0,this.last_cdnSize=0,this.last_p2pSize=0,this.last_upSize=0,this.last_usedSize=0,this.lastConnectCnt=0,this.lastConnectDoneCnt=0,this.trackerIPBase=0,this.connect()}return s()(e,[{key:"connect",value:function(){if("off"!==ur.a.limitP2P){if(clearTimeout(this.retryStep),this.retryStep=0,this.reconnectCnt++,this.reconnectCnt%6==3&&this.trackerIPBase++,this.reconnectCnt%6>=3||ur.a.trackerStatus){var e=cr.a.getUserInfoFromCookie(),t=cr.a.getTrackerIP(e.userNetType,dr.i.tracker,this.id,this.trackerIPBase);""!==t&&(this.firstIPInfo=t)}var i=this.firstIPInfo.split("|");this.ip=i[0],this.trackerPort=i[1],this.SDomain=i[2],this.StrackerPort=i[3],this.runWSS="wss"===i[5],ur.a.trackerIP=this.ip,As.addPBItem(fs.stratus_connectCnt);var a=this;try{lr.a.isHTTPS||this.runWSS&&ur.a.platform!==_r?this.socket=new WebSocket("wss://"+this.SDomain+":"+this.StrackerPort+"/ws",["binary"]):this.socket=new WebSocket("ws://"+this.ip+":"+this.trackerPort+"/ws",["binary"]),this.socket.binaryType="arraybuffer",this.socket.onopen=function(e){a.onOpen.call(a,e)},this.socket.onmessage=function(e){a.onData.call(a,e)},this.socket.onerror=function(e){a.onError.call(a,e)},this.socket.onclose=function(e){a.onClose.call(a,e)},Ir.a.info("tracker [START] IP : "+this.ip+":"+this.trackerPort)}catch(n){}this.startTime=Date.now(),clearTimeout(this.watcherStep),this.watcherStep=setTimeout((function(){a.heartBeat.call(a)}),6e3),clearTimeout(this.pbTimer),this.pbTimer=setTimeout((function(){a.firePB.call(a)}),2e4)}}},{key:"onOpen",value:function(e){Ir.a.info("tracker [SUCCESS] IP : "+this.ip+":"+this.trackerPort),As.addPBItem(fs.stratus_connectSuccess),As.addPBItem(fs.stratus_duration,Date.now()-this.startTime),this.open=!0,this.register()}},{key:"onTimeout",value:function(){this.running&&(Ir.a.warn("tracker [ERROR] to : "+this.ip+":"+this.trackerPort+" , msg : connect timeout"),this.error())}},{key:"onClose",value:function(e){this.running&&(As.addPBItem(fs.stratus_break),Ir.a.warn("tracker [ERROR] to : "+this.ip+":"+this.trackerPort+" , msg : onClose-"+e.data),this.error())}},{key:"onError",value:function(e){this.running&&(Ir.a.warn("tracker [ERROR] to : "+this.ip+":"+this.trackerPort+" , msg : onError-"+e.data),this.error())}},{key:"error",value:function(){if(this.running&&this.socket&&this.socket.readyState===WebSocket.CLOSED&&Date.now()-this.startTime>6e4){this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null;var e=this;e.retryStep=setTimeout((function(){e.connect.call(e)}),2e3)}}},{key:"onData",value:function(e){try{if("off"===ur.a.limitP2P)return void this.error();if(Cs.resetData(e.data),Rs=Cs.get16(),this.running&&this.socket)switch(Rs){case 1:0===(Us=Cs.get16())?(Ns=Cs.get16(),Fs=Cs.getCharStr(Ns),this.uid=Fs,ur.a.trackerStatus=Cs.get8(),ur.a.trackerStatus&&(this.trackerIPBase++,this.socket.close()),Ir.a.info("[P2P load], onRegister uid : "+this.uid),this.onMsg(Qs.State_register,this.uid)):(Ir.a.warn("tracker [ERROR] register error"),this.error());break;case 3:if(0===(Us=Cs.get16())){Ws=Cs.get16();for(var t=0;t<Ws;t++){js=Cs.get16(),Gs=Cs.getCharStr(js),zs=Cs.get16();for(var i=0;i<zs;i++){Ks=Cs.get16(),Ys=Cs.getCharStr(Ks),Bs=Cs.get32();for(var a=0;a<Yr.segmentList.length;a++)Yr.segmentList[a].p2pID===this.id&&Yr.segmentList[a].vid===Gs&&Yr.segmentList[a].index===Ys&&(Yr.segmentList[a].peerCnt=Bs)}}}else 400===Us?(As.addPBItem(fs.stratus_break),this.error()):Ir.a.warn("tracker [ERROR] update error");break;case 4:if(0===(Us=Cs.get16())){if(this.trackerStateFun){var n=Cs.get32();Bs=Cs.get16(),"[ ";for(var r=[],s=0;s<Bs;s++)Ns=Cs.get16(),(Fs=Cs.getCharStr(Ns))+"-",r.push(Fs);if(this.peerSegment){" ]";var o=Cs.get16(),d=[];" , vidList : [ ";for(var u=0;u<o;u++)js=Cs.get16(),Gs=Cs.getCharStr(js),n=Cs.get32(),d.push({vid:Gs,count:n}),"("+Gs+":"+n+")-";" ]",this.peerSegment.checkDefinition(d),this.peerSegment=null}this.onMsg(Qs.State_upDatePeers,this.uid,r)}}else 400===Us?(As.addPBItem(fs.stratus_break),this.error()):Ir.a.warn("tracker [ERROR] query error");break;case 5:Ns=Cs.get16(),Fs=Cs.getCharStr(Ns),Vs=Cs.get16(),(Hs=Cs.getUTF8Str(Vs))&&Fs&&this.trackerStateFun&&this.onMsg(Qs.State_candidate,Fs,JSON.parse(Hs));break;case 6:Ns=Cs.get16(),Fs=Cs.getCharStr(Ns),Vs=Cs.get16(),(Hs=Cs.getUTF8Str(Vs))&&Fs&&this.trackerStateFun&&this.onMsg(Qs.State_offer,Fs,JSON.parse(Hs));break;case 7:Ns=Cs.get16(),Fs=Cs.getCharStr(Ns),Vs=Cs.get16(),(Hs=Cs.getUTF8Str(Vs))&&Fs&&this.trackerStateFun&&this.onMsg(Qs.State_answer,Fs,JSON.parse(Hs));break;case 2:break;default:Ir.a.warn("[P2P load],tracker [ERROR] not Support token : "+Rs)}}catch(c){}}},{key:"onMsg",value:function(e,t,i){throw"virtual method"}},{key:"register",value:function(){if(this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Nr.resetData(),Nr.set16(1),Nr.set16(dr.i.trackerVersion),Nr.set16(this.uid.length),Nr.setCharStr(this.uid),Nr.set16(ur.a.platform);var e=Nr.getReferData();this.socket.send(e)}catch(t){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"unRegister",value:function(){}},{key:"heartBeat",value:function(){var e=this;if(clearTimeout(this.watcherStep),this.running&&this.open&&this.socket&&this.socket.readyState===WebSocket.OPEN){try{if(Nr.resetData(),Nr.set16(3),ur.a.platform!==_r){for(var t=[],i=0;i<Yr.segmentList.length;i++)Yr.segmentList[i].p2pID===this.id&&!0===dr.i.upLoad&&(t.push(Yr.segmentList[i].index),t.push(Yr.segmentList[i].vid));Nr.set16(t.length/2);for(var a=0;a<t.length;a+=2)Nr.set16(t[a].length),Nr.setCharStr(t[a]),Nr.set16(t[a+1].length),Nr.setCharStr(t[a+1])}var n=Nr.getReferData();this.socket.send(n)}catch(r){}this.pbTimer=setTimeout((function(){e.firePB.call(e)}),100)}else As.addPBItem(fs.stratus_break),this.error();this.watcherStep=setTimeout((function(){e.heartBeat.call(e)}),2e4)}},{key:"getPeer",value:function(e){if(this.peerSegment=e,this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{var t=e.vid,i=e.vids,a=e.index;if(Nr.resetData(),Nr.set16(4),Nr.set16(t.length),Nr.setCharStr(t),Nr.set16(a.length),Nr.setCharStr(a),i&&i.length>0){Nr.set16(i.length);for(var n=0;n<i.length;n++)Nr.set16(i[n].vid.length),Nr.setCharStr(i[n].vid)}else Nr.set16(1),Nr.set16(t.length),Nr.setCharStr(t);var r=Nr.getReferData();this.socket.send(r)}catch(s){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"candidate",value:function(e,t){if(this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Hs=JSON.stringify(t),Nr.resetData(),Nr.set16(5),Nr.set16(e.length),Nr.setCharStr(e),Nr.set16(Hs.length),Nr.setUTF8Str(Hs);var i=Nr.getReferData();this.socket.send(i)}catch(a){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"offer",value:function(e,t){if(this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Hs=JSON.stringify(t),Nr.resetData(),Nr.set16(6),Nr.set16(e.length),Nr.setCharStr(e),Nr.set16(Hs.length),Nr.setUTF8Str(Hs);var i=Nr.getReferData();this.socket.send(i)}catch(a){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"answer",value:function(e,t){if(this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Hs=JSON.stringify(t),Nr.resetData(),Nr.set16(7),Nr.set16(e.length),Nr.setCharStr(e),Nr.set16(Hs.length),Nr.setUTF8Str(Hs);var i=Nr.getReferData();this.socket.send(i)}catch(a){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"firePB",value:function(){if(clearTimeout(this.pbTimer),this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Nr.resetData(),Nr.set16(256),Nr.set32(this.cdnSize-this.last_cdnSize),Nr.set32(this.p2pSize-this.last_p2pSize),Nr.set32(this.usedSize-this.last_usedSize),Nr.set32(this.upSize-this.last_upSize),Nr.set32(dr.c.videoDataSize),Nr.set32(0),Nr.set32(this.connectCnt-this.lastConnectCnt),Nr.set32(this.connectDoneCnt-this.lastConnectDoneCnt),ur.a.MixWaterMark&&ur.a.sendPingBack({type:"BWReport",para:{cdnsize:this.cdnSize-this.last_cdnSize,p2psize:this.p2pSize-this.last_p2pSize,usesize:this.upSize-this.last_upSize}}),Nr.set16(ur.a.platform);var e=Nr.getReferData();this.socket.send(e),this.last_cdnSize=this.cdnSize,this.last_p2pSize=this.p2pSize,this.last_upSize=this.upSize,this.last_usedSize=this.usedSize,this.lastConnectCnt=this.connectCnt,this.lastConnectDoneCnt=this.connectDoneCnt}catch(t){}else As.addPBItem(fs.stratus_break),this.error()}},{key:"fireConnectOK",value:function(e,t){if(this.running&&this.socket&&this.socket.readyState===WebSocket.OPEN)try{Nr.resetData(),Nr.set16(260),Nr.set16(e.length),Nr.setCharStr(e),Nr.set16(t);var i=Nr.getReferData();this.socket.send(i)}catch(a){}}},{key:"clear",value:function(){try{this.running=!1,this.open=!1,this.socket&&(this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close(),this.socket=null),clearTimeout(this.retryStep),clearTimeout(this.watcherStep),clearTimeout(this.pbTimer)}catch(e){}}}]),e}(),Rs=null,Bs=0,Ns=0,Fs="",Us=0,Vs=0,Hs="",Ws=0,js=0,Gs="",zs=0,Ks=0,Ys="",Qs={State_upDatePeers:"State_upDatePeers",State_register:"State_register",State_candidate:"State_candidate",State_offer:"State_offer",State_answer:"State_answer",State_Error:"State_error"},Js=Ms,Xs={bundlePolicy:"max-compat",iceServers:[],iceTransportPolicy:"all",rtcpMuxPolicy:"require",candidateNetworkPolicy:"ALL"},Zs=[],$s=[],eo=[],to=0;function io(e){return Zs&&Zs.length>0&&-1!==Zs.indexOf(e)}var ao={has:io,get:function(e){var t=Zs.indexOf(e);return-1!==t?$s[t]:null},use:function(e){if(Xs.iceServers=dr.i.stun,Xs.iceServers.length<=0)return!1;if(io(e))return!0;for(var t=0;t<eo.length;t++)Date.now()-eo[t]>3e5&&eo.splice(t,1);if(Zs.length+eo.length>dr.i.RTCPoolSize||to>dr.i.RTCMax)return!1;++to>=2*dr.i.RTCMax/3&&(dr.i.switchPage=!0);try{$s.push({rtc:new RTCPeerConnection(Xs),channel:null})}catch(i){return!1}return Zs.push(e),!0},shut:function(e){var t=Zs.indexOf(e);if(-1!==t){if(delete Zs[t],Zs[t]=null,Zs.splice(t,1),null!==$s[t].channel){delete $s[t].channel.onopen,$s[t].channel.onopen=null,delete $s[t].channel.onclose,$s[t].channel.onclose=null,delete $s[t].channel.onerror,$s[t].channel.onerror=null,delete $s[t].channel.onmessage,$s[t].channel.onmessage=null;try{$s[t].channel.close()}catch(i){}delete $s[t].channel,$s[t].channel=null}if(null!==$s[t].rtc){delete $s[t].rtc.oniceconnectionstatechange,$s[t].rtc.oniceconnectionstatechange=null,delete $s[t].rtc.onicecandidate,$s[t].rtc.onicecandidate=null,delete $s[t].rtc.ondatachannel,$s[t].rtc.ondatachannel=null;try{$s[t].rtc.close()}catch(i){}delete $s[t].rtc,$s[t].rtc=null}eo.push(Date.now()),delete $s[t],$s[t]=null,$s.splice(t,1)}}},no=512,ro=[],so=0,oo=.024,uo=0,co=0,lo=0,ho=-1,_o=1536,fo=1536,po=0;var go=Object.defineProperties({check:function(){if(!((ho=Date.now())<=co)){if((po=ho-co)>=1e3){_o=fo,function(){var e=0;for(var t in ro)if(!t||ro[t].time+ro[t].rto+500<ho){var i=ro.splice(e,1)[0];so-=i.cont}else e++}(),co=ho;var e=uo/po;uo=0,oo+=.25*(e-oo)}ho<=lo||(po=ho-lo)>0&&(lo=ho,function(e){for(;so>0&&e>1;){var t=ro.shift();if(so-=t.cont,e-=t.cont,t)try{if(ao.has(t.id)&&null!==ao.get(t.id).channel&&"open"===ao.get(t.id).channel.readyState)try{ao.get(t.id).channel.send(t.args)}catch(i){}}catch(i){}}}(Math.min(oo+so/1e3,no/1e3)*po))}},pushTsk:function(e,t,i,a){return!(so>=no)&&(ro.push({args:t,id:e,rto:i,time:ho,cont:a}),so+=a,uo+=a,!0)},removeTsk:function(e){var t=0;for(var i in ro)if(ro[i].id===e){var a=ro.splice(t,1)[0];so-=a.cont}else t++}},{sendMax:{set:function(e){no=e},configurable:!0,enumerable:!0},loadQuota:{get:function(){return _o},set:function(e){_o=e},configurable:!0,enumerable:!0},loadQuotaMax:{set:function(e){fo=e},configurable:!0,enumerable:!0}}),mo=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:undefined,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;n()(this,e),this.alias=i,this.gpID=-1,t&&(this.size=t,this.data=new Uint8Array(Math.ceil(this.size/8)))}return s()(e,[{key:"getBit",value:function(e){if(e>=0&&e<this.size){var t=e%8,i=Math.floor(e/8);return 0!=(this.data[i]&1<<t)}return!1}},{key:"setBit",value:function(e,t){if(e>=0&&e<this.size){var i=e%8,a=Math.floor(e/8);this.data[a]=!0===t?this.data[a]|1<<i:this.data[a]&~(1<<i)}}},{key:"getByte",value:function(e){return e>=0&&e+8<=this.size&&e%8==0&&255===this.data[Math.floor(e/8)]}},{key:"setByte",value:function(e,t){e>=0&&e<this.size&&e%8==0&&(this.data[Math.floor(e/8)]=t?255:0)}},{key:"checkRange",value:function(e,t){for(t>this.size&&(t=this.size);e<t;)if(e%8==0&&e+8<=t){if(255!==this.data[Math.floor(e/8)])return!1;e+=8}else{if(!this.getBit(e))return!1;e++}return!0}},{key:"toData",value:function(){return Nr.resetData(),Nr.set32(this.alias),Nr.set32(this.size),Nr.setBytes(this.data,0,this.data.byteLength),Nr.getData()}},{key:"fromData",value:function(e){Cs.resetData(e),this.alias=Cs.get32(),this.size=Cs.get32(),this.data=Cs.getBytes(e.byteLength-8)}},{key:"resetGap",value:function(e){if((0===e||e)&&-1!==e)for(this.gpID=e;this.gpID<this.size&&!this.getBit(this.gpID);)this.gpID++}},{key:"toString",value:function(){for(var e="",t=0,i=this.size;t<i;)e+=this.getBit(t)?"*":"_",++t%128==0&&(e+="\r\n");return e+="|"}},{key:"reset",value:function(e){for(var t=0;t<Math.ceil(this.size/8);t++)this.data[t]=e?255:0}},{key:"clear",value:function(){delete this.data,this.head&&delete this.head}}]),e}(),vo=0,bo=0,yo=1,ko=2,To=3,So=4,Po=5,xo=6,Io="0",Eo="3",Do="5",wo="7",Ao="11",qo="15",Oo="19",Lo={ordered:!1},Co=function(){function e(t,i,a,r){n()(this,e);var s=this;if(this.peerMgr=t,this.active=a,this.peerID=i,this.ready=!1,this.timeStep=-1,this.lastEventTime=-1,this.connectionState="new",this.workTime=0,this.natUseTime=0,this.natStartTime=-1,this.rtc.oniceconnectionstatechange=function(e){s.connectionState=e.currentTarget.iceConnectionState},this.rtc.onicecandidate=function(e){e.candidate&&s.peerMgr&&s.peerMgr.candidate(s.peerID,e.candidate)},this.active){try{this.getDataChannel(this.rtc.createDataChannel(null,Lo))}catch(o){}this.peerMgr.connectCnt++,this.rtc.createOffer().then((function(e){s.rtc.setLocalDescription(e)["catch"]((function(e){Ir.a.error("RTC set local SDP error:"+e)})),s.peerMgr&&s.peerMgr.offer(s.peerID,e)}))["catch"]((function(e){Ir.a.error("RTC create offer SDP error:"+e),s.peerMgr&&s.peerMgr.removePeerNode(s.peerID,Eo)})),s.natStartTime=Date.now(),s.timeStep=setTimeout((function(){s.onNATTimeout.call(s)}),dr.i.NATTimeoutStep)}else this.rtc.setRemoteDescription(new RTCSessionDescription(r))["catch"]((function(e){Ir.a.error("RTC set remote SDP error:"+e)})),this.rtc.ondatachannel=function(e){s.getDataChannel(e.channel)},this.rtc.createAnswer().then((function(e){s.rtc.setLocalDescription(e).then((function(){s.peerMgr&&s.peerMgr.answer(s.peerID,e)}))["catch"]((function(e){Ir.a.error("RTC set local SDP error:"+e),s.peerMgr&&s.peerMgr.removePeerNode(s.peerID,Eo)}))}))["catch"]((function(e){Ir.a.error("RTC create answer error:"+e),s.peerMgr&&s.peerMgr.removePeerNode(s.peerID,Eo)})),s.natStartTime=Date.now(),s.timeStep=setTimeout((function(){s.onNATTimeout.call(s)}),dr.i.NATTimeoutStep-1e3)}return s()(e,[{key:"baseCheck",value:function(){return!(-1!==this.lastEventTime&&Date.now()-this.lastEventTime>=dr.i.NATTimeoutStep)||(this.peerMgr.removePeerNode(this.peerID,Do),!1)}},{key:"fireData",value:function(t,i){if(this.ready&&null!==this.rtc&&null!==this.dataChannel){var a=null;switch(t){case bo:if((a=e.pkgQuit())&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}break;case yo:if((a=e.pkgHeartBeat(i))&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}break;case ko:if((a=e.pkgRequest(i))&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}break;case So:if((a=e.pkgClear())&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}break;case Po:if((a=e.pkgRefuse())&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}break;case xo:if((a=e.pkgDescribe(i))&&this.dataChannel&&"open"===this.dataChannel.readyState)try{this.dataChannel.send(a.buffer)}catch(n){Ir.a.error("[P2P load],dataChannel.send ,type "+t+", err "+n.message)}}}}},{key:"onData",value:function(t){if(t&&null!==this.rtc&&null!==this.dataChannel)if(t[0]!==vo)this.peerMgr.removePeerNode(this.peerID,wo);else switch(this.lastEventTime=Date.now(),t[1]){case bo:this.onQuit&&this.onQuit(e.unPkgQuit(t));break;case yo:this.onHeartbeat&&this.onHeartbeat(e.unPkgHeartBeat(t));break;case ko:this.onRequest&&this.onRequest(e.unPkgRequest(t));break;case To:this.onReceive&&this.onReceive(e.unPkgReceive(t));break;case So:this.onClear&&this.onClear(e.unPkgClear(t));break;case Po:this.onRefuse&&this.onRefuse(e.unPkgRefuse(t));break;case xo:this.onDescribe&&this.onDescribe(e.unPkgDescribe(t))}}},{key:"onQuit",value:function(){throw"virtual method"}},{key:"onHeartbeat",value:function(){throw"virtual method"}},{key:"onRequest",value:function(){throw"virtual method"}},{key:"onReceive",value:function(){throw"virtual method"}},{key:"onClear",value:function(){throw"virtual method"}},{key:"onRefuse",value:function(){throw"virtual method"}},{key:"onDescribe",value:function(){throw"virtual method"}},{key:"getDataChannel",value:function(e){var t=this;this.dataChannel=e,this.dataChannel.onopen=function(){t.ready=!0,clearTimeout(t.timeStep),0===t.workTime&&(t.workTime=Date.now()),0===t.natUseTime&&(t.natUseTime=Date.now()-t.natStartTime),t.active&&(t.peerMgr.connectDoneCnt++,t.peerMgr.fireConnectOK(t.peerID,t.natUseTime)),t.lastEventTime=Date.now()},this.dataChannel.onclose=function(e){t.ready=!1,t.peerMgr&&t.peerMgr.removePeerNode(t.peerID,Eo)},this.dataChannel.onerror=function(e){t.ready=!1,t.peerMgr&&t.peerMgr.removePeerNode(t.peerID,Eo)},this.dataChannel.onmessage=function(e){t.onData(new Uint8Array(e.data))}}},{key:"close",value:function(){clearTimeout(this.timeStep),delete this.peerMgr,this.peerMgr=null,this.ready=!1}},{key:"offer",value:function(e){}},{key:"answer",value:function(e){this.rtc.setRemoteDescription(new RTCSessionDescription(e))["catch"]((function(e){console.log("RTC answer be reject:"+e)}))}},{key:"candidate",value:function(e){this.rtc.addIceCandidate(new RTCIceCandidate(e))["catch"]((function(e){console.log("RTC candidate fail:"+e)}))}},{key:"onNATTimeout",value:function(){this.peerMgr.removePeerNode(this.peerID,Do)}},{key:"rtc",get:function(){return ao.get(this.peerID).rtc}},{key:"dataChannel",get:function(){return ao.get(this.peerID).channel},set:function(e){return ao.get(this.peerID).channel=e}}],[{key:"pkgQuit",value:function(){return Nr.resetData(),Nr.set8(vo),Nr.set8(bo),Nr.crc(),Nr.getReferData()}},{key:"unPkgQuit",value:function(e){return Cs.resetData(e),this.QuitParam||(this.QuitParam={}),this.QuitParam.version=Cs.get8(),this.QuitParam.type=Cs.get8(),this.QuitParam.crc=Cs.crc(),this.QuitParam}},{key:"pkgHeartBeat",value:function(e){Nr.resetData(),Nr.set8(vo),Nr.set8(yo),Nr.set32(e.localID);var t=0;return null!==e.bitmap&&(t+=1),Nr.set8(t),Nr.set8(e.lostR),Nr.set8(e.vid.length),Nr.setCharStr(e.vid),Nr.set8(e.sourceID.length),Nr.setCharStr(e.sourceID),Nr.set32(e.alias),null!==e.bitmap&&(Nr.set8(e.bitmap.byteLength),Nr.setBytes(e.bitmap,0,e.bitmap.byteLength)),Nr.crc(),Nr.getReferData()}},{key:"unPkgHeartBeat",value:function(e){Cs.resetData(e),this.heartbeatParam||(this.heartbeatParam={preInfo:{}}),this.heartbeatParam.version=Cs.get8(),this.heartbeatParam.type=Cs.get8(),this.heartbeatParam.localID=Cs.get32();var t=Cs.get8();this.heartbeatParam.lostR=Cs.get8();var i=Cs.get8();return this.heartbeatParam.vid=Cs.getCharStr(i),i=Cs.get8(),this.heartbeatParam.sourceID=Cs.getCharStr(i),this.heartbeatParam.alias=Cs.get32(),1&t?(i=Cs.get8(),this.heartbeatParam.bitmap=Cs.getBytes(i)):this.heartbeatParam.bitmap=null,this.heartbeatParam.crc=Cs.crc(),this.heartbeatParam}},{key:"pkgRequest",value:function(e){if(e.length>0){for(Nr.resetData(),Nr.set8(vo),Nr.set8(ko),Nr.set32(e[0].alias),Nr.set8(e.length);e.length>0;){var t=e.shift();Nr.set32(t.subPieceID)}return Nr.crc(),Nr.getReferData()}return null}},{key:"unPkgRequest",value:function(e){Cs.resetData(e),this.requestParam||(this.requestParam={}),this.requestParam.version=Cs.get8(),this.requestParam.type=Cs.get8(),this.requestParam.alias=Cs.get32(),this.requestParam.taskLen=Cs.get8(),this.requestParam.requireTaskList||(this.requestParam.requireTaskList=[]),this.requestParam.requireTaskList.length=0;for(var t=0;t<this.requestParam.taskLen;)this.requestParam.requireTaskList.push(Cs.get32()),t++;return this.requestParam.crc=Cs.crc(),this.requestParam}},{key:"unPkgReceive",value:function(e){Cs.resetData(e),this.receiveParam||(this.receiveParam={}),this.receiveParam.version=Cs.get8(),this.receiveParam.type=Cs.get8(),this.receiveParam.alias=Cs.get32(),this.receiveParam.sIDList?this.receiveParam.sIDList.length=0:this.receiveParam.sIDList=[],this.receiveParam.dataList?this.receiveParam.dataList.length=0:this.receiveParam.dataList=[];for(var t=Cs.get8(),i=0;i<t;)this.receiveParam.sIDList[i]=Cs.get32(),this.receiveParam.dataList[i]=Cs.getBytes(dr.c.subPieceSize),i++;return this.receiveParam.crc=Cs.crc(),this.receiveParam}},{key:"pkgClear",value:function(){return Nr.resetData(),Nr.set8(vo),Nr.set8(So),Nr.crc(),Nr.getReferData()}},{key:"unPkgClear",value:function(e){return Cs.resetData(e),this.clearParam||(this.clearParam={}),this.clearParam.version=Cs.get8(),this.clearParam.type=Cs.get8(),this.clearParam.crc=Cs.crc(),this.clearParam}},{key:"pkgRefuse",value:function(){return Nr.resetData(),Nr.set8(vo),Nr.set8(Po),Nr.crc(),Nr.getReferData()}},{key:"unPkgRefuse",value:function(e){return Cs.resetData(e),this.refuseParam||(this.refuseParam={}),this.refuseParam.version=Cs.get8(),this.refuseParam.type=Cs.get8(),this.refuseParam.crc=Cs.crc(),this.refuseParam}},{key:"pkgDescribe",value:function(e){return Nr.resetData(),Nr.set8(vo),Nr.set8(xo),Nr.set16(e.byteLength),Nr.setBytes(e,0,e.byteLength),Nr.crc(),Nr.getReferData()}},{key:"unPkgDescribe",value:function(e){Cs.resetData(e),this.describeParam||(this.describeParam={}),this.describeParam.version=Cs.get8(),this.describeParam.type=Cs.get8();var t=Cs.get16();return this.describeParam.describe=Cs.getBytes(t),this.describeParam.crc=Cs.crc(),this.describeParam}}]),e}(),Mo=Math.floor(4294967295*Math.random()),Ro=new wr,Bo=function(e){function t(e,i,a,r){var s;return n()(this,t),(s=d()(this,c()(t).call(this,e,i,a,r))).checked=!1,s.srtt=0,s.sdev=0,s.quota=32,s.mtu=1,s.lostR=0,s.lostHB=0,s.loadHB=0,s.rcvHB=0,s.upHB=0,s.lostCnt=0,s.loadCnt=0,s.rcvCnt=0,s.upCnt=0,s.peerInfo={loadBitmap:undefined,hasBitmap:!1,sourceID:"",alias:"",vid:"",peerLocalID:"",lostR:0},s.runTaskList=new wr,s.srcDscr=new wr,s.checkRTOLastTime=-1,s.heartbeatLastTime=-1,s.heartbeatCnt=6,s.createdTime=Date.now(),s}return f()(t,e),s()(t,[{key:"check",value:function(){this.baseCheck()&&this.ready&&(this.checkHeartbeat()||this.loadTask(),this.checkRTO())}},{key:"checkHeartbeat",value:function(){if(Date.now()-this.heartbeatLastTime>3e3&&Yr.loadSegment){if(this.heartbeatParam||(this.heartbeatParam={preInfo:{}}),this.heartbeatParam.localID=Mo,this.heartbeatParam.vid=Yr.loadSegment.vid,this.heartbeatParam.alias=Yr.loadSegment.alias,this.heartbeatParam.sourceID=Yr.loadSegment.sourceID,Yr.preLoadSegment?(this.heartbeatParam.preInfo.alias=Yr.preLoadSegment.alias,this.heartbeatParam.preInfo.sourceID=Yr.preLoadSegment.sourceID):(this.heartbeatParam.preInfo.alias="",this.heartbeatParam.preInfo.sourceID=""),""!==this.peerInfo.alias&&Yr.hasSegment(this.peerInfo.alias)&&!0===dr.i.upLoad){var e=Yr.getSegment(this.peerInfo.alias);this.heartbeatParam.bitmap=e.bitmap.toData()}else this.heartbeatParam.bitmap=null;return 0===this.loadHB?this.heartbeatParam.lostR=255:this.heartbeatParam.lostR=this.lostR,this.fireData(yo,this.heartbeatParam),this.lostHB=0,this.loadHB=0,this.lostR>5?this.lostR-=5:this.lostR=0,this.heartbeatCnt++,this.heartbeatCnt>10&&(this.heartbeatCnt=0,this.fireSourceDescribe()),this.heartbeatLastTime=Date.now(),!0}return!1}},{key:"loadTask",value:function(){if(go.loadQuota>0&&this.peerInfo.hasBitmap&&Yr.loadSegment&&this.peerInfo.loadBitmap.alias===Yr.loadSegment.alias){if(this.quota<this.runTaskList.size)return;var e=Math.max(this.srtt<200?this.quota/2:this.quota/3,1),t=Math.min(this.quota-this.runTaskList.size,e);if(this.taskList||(this.taskList=[]),this.taskList.length=0,Yr.loadSegment.getTasks(this.peerInfo.loadBitmap,this.taskList,t,this.timeout),t-=this.taskList.length,this.taskList.length>0){this.loadHB=this.loadHB+this.taskList.length,this.loadCnt=this.loadCnt+this.taskList.length;for(var i=0;i<this.taskList.length;i++)this.runTaskList.set(this.taskList[i].key,this.taskList[i]);this.fireData(ko,this.taskList),go.loadQuota=go.loadQuota-i}}}},{key:"checkRTO",value:function(){if(!(Date.now()-this.checkRTOLastTime<=500)){this.checkRTOLastTime=Date.now();var e=0,t=!0,i=!1,a=undefined;try{for(var n,r=this.runTaskList.values[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=vi()(n.value,2)[1];if(Date.now()-s.beginTime>s.rto){e++;var o=Yr.getSegment(s.alias);o&&o.recycleP2PTask(s),this.runTaskList.remove(s.key)}}}catch(Rf){i=!0,a=Rf}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}this.updateQuota(e),this.lostCnt=this.lostCnt+e,this.lostHB=this.lostHB+e,this.lostR=this.lostR+e}}},{key:"update_SRTT_SDEV",value:function(e){var t;0===this.srtt?(this.srtt=e,this.sdev=e/2):(t=Math.abs(e-this.srtt),this.srtt=.875*this.srtt+.125*e,this.sdev=this.sdev+.25*(t-this.sdev))}},{key:"updateQuota",value:function(e){e?(this.quota-=Math.sqrt(e/2),this.quota<2&&(this.quota=2)):this.quota<128&&0!==this.srtt&&this.srtt>1&&this.srtt<3e3&&(this.quota+=Math.log(this.srtt+500)/50)}},{key:"onHeartbeat",value:function(e){if(e.crc){if(this.peerInfo.sourceID=e.sourceID,this.peerInfo.alias=e.alias,this.peerInfo.vid=e.vid,this.peerInfo.peerLocalID=e.localID,!1===this.checked){if(Ro.has(e.localID))return void this.peerMgr.removePeerNode(this.peerID,Oo);Ro.set(e.localID,!0),this.checked=!0}var t=Yr.getSegment(e.alias);t&&e.sourceID!==t.sourceID?this.peerMgr.removePeerNode(this.peerID,qo):(e.bitmap?(this.peerInfo.hasBitmap=!0,this.peerInfo.loadBitmap===undefined&&(this.peerInfo.loadBitmap=new mo),this.peerInfo.loadBitmap.fromData(e.bitmap),Yr.hasSegment(this.peerInfo.loadBitmap.alias)&&this.peerInfo.loadBitmap.resetGap(Yr.getSegment(this.peerInfo.loadBitmap.alias).gpID)):this.peerInfo.hasBitmap=!1,255!==e.lostR&&(this.peerInfo.lostR=e.lostR,0===this.peerInfo.lostR?this.mtu=Math.min(this.mtu+1,16):this.mtu=Math.max(this.mtu-Math.ceil(this.peerInfo.lostR/2),1)))}else this.peerMgr.removePeerNode(this.peerID,qo)}},{key:"onRequest",value:function(e){if(e.crc){var i=e.alias;if(this.requestParam||(this.requestParam={}),this.requestParam.alias=i,this.requestParam.sIDList?this.requestParam.sIDList.length=0:this.requestParam.sIDList=[],this.requestParam.dataList?this.requestParam.dataList.length=0:this.requestParam.dataList=[],Yr.getSegment(i)){for(var a=Yr.getSegment(i),n=0;e.requireTaskList.length>0;){var r=e.requireTaskList.shift(),s=a.requestTask(r);s&&(n<this.mtu?(this.requestParam.dataList[n]=s,this.requestParam.sIDList[n]=r,this.upHB+=s.byteLength,n++):(go.pushTsk(this.peerID,t.pkgReceive(this.requestParam),this.timeout,n)&&(this.upCnt+=n+1),this.requestParam.dataList.length=0,this.requestParam.sIDList.length=0,n=0,this.requestParam.dataList[n]=s,this.requestParam.sIDList[n]=r,n++))}this.requestParam.dataList.length>0&&this.requestParam.sIDList.length>0&&this.requestParam.sIDList.length===this.requestParam.dataList.length&&go.pushTsk(this.peerID,t.pkgReceive(this.requestParam),this.timeout,n)&&(this.upHB+=this.requestParam.dataList.length,this.upCnt+=n+1)}}else this.peerMgr.removePeerNode(this.peerID,qo)}},{key:"onReceive",value:function(e){if(e.crc){var t=Yr.getSegment(e.alias);if(t)for(var i,a;e.sIDList.length>0;){i=e.sIDList.shift(),a=e.alias.toString()+"_"+i.toString();var n=e.dataList.shift();t.addSubPiece(i,n),this.rcvHB+=n.byteLength,this.rcvCnt++,this.runTaskList.has(a)?(this.update_SRTT_SDEV(Date.now()-this.runTaskList.get(a).beginTime),this.runTaskList.remove(a)):this.update_SRTT_SDEV(this.timeout)}}else this.peerMgr.removePeerNode(this.peerID,qo)}},{key:"clearTask",value:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=this.runTaskList.values[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var r=vi()(a.value,1)[0],s=this.runTaskList.remove(r);if(s){var o=Yr.getSegment(s.alias);o&&o.recycleP2PTask(s)}}}catch(Rf){t=!0,i=Rf}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}}},{key:"onClear",value:function(e){e.crc?go.removeTsk(this.peerID):this.peerMgr.removePeerNode(this,qo)}},{key:"onRefuse",value:function(e){if(e.crc){var t=!0,i=!1,a=undefined;try{for(var n,r=this.runTaskList.values[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=vi()(n.value,1)[0],o=this.runTaskList.remove(s);if(o){var d=Yr.getSegment(o.alias);d&&d.recycleP2PTask(o)}}}catch(Rf){i=!0,a=Rf}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}this.fireData(So,null)}else this.peerMgr.removePeerNode(this,qo)}},{key:"onQuit",value:function(e){e.crc?this.peerMgr.removePeerNode(this.peerID,Io):this.peerMgr.removePeerNode(this.peerID,qo)}},{key:"fireSourceDescribe",value:function(){if(this.peerInfo.vid){var e=Yr.getSourceDescribe(this.peerInfo.vid);e&&e.byteLength>0&&this.fireData(xo,e)}}},{key:"onDescribe",value:function(e){if(e.crc){if(e.describe){Cs.resetData(e.describe);var t=Cs.get16(),i=Cs.getCharStr(t);if(!Yr.loadSegment||i!==Yr.loadSegment.vid)return;this.srcDscr.clear();for(var a=Cs.get16(),n=0;n<a;n++){t=Cs.get16();var r=new mo;r.alias=Cs.get32(),r.size=Cs.get32(),r.data=Cs.getBytes(t-8),this.srcDscr.set(r.alias,r)}}}else this.peerMgr.removePeerNode(this.peerID,qo)}},{key:"checkHealth",value:function(e){if(this.rcvCnt<=0||this.srcDscr.size<=0)return!1;if(this.peerInfo&&this.peerInfo.hasBitmap&&this.peerInfo.alias===e)return this.peerInfo.loadBitmap.checkRange(Yr.getSegment(e).gpID,Yr.getSegment(e).gpID+8);if(this.srcDscr.has(e)){var t=this.srcDscr.get(e);if(t)return t.checkRange(Yr.getSegment(e).gpID,Yr.getSegment(e).gpID+8)}return!1}},{key:"peerClose",value:function(e){""!==this.peerInfo.peerLocalID&&Ro.has(this.peerInfo.peerLocalID)&&e!==Oo&&Ro.remove(this.peerInfo.peerLocalID),this.clearTask(),this.close(),delete this.peerMgr,this.peerMgr=null}},{key:"reset",value:function(){this.rcvHB=0,this.upHB=0}},{key:"timeout",get:function(){if(0===this.srtt)return 3e3;var e=Math.min(1e3+500*this.lostR,3e3),t=this.srtt+4*this.sdev+350;return Math.min(t+e,8e3)}},{key:"protected",get:function(){return Date.now()-this.createdTime<=3e4}},{key:"log",get:function(){return" [ "+(this.active?this.ready?"open ":"idle ":"passv")+" ] , nat : "+cr.a.trimNumber(this.natUseTime/1e3,10)+" s , rcvHB : "+cr.a.trimNumber(this.rcvHB/1024,1e3)+" K , rcvCnt : "+cr.a.trimNumber(this.rcvCnt,1e6)+", upHB : "+cr.a.trimNumber(this.upHB/1024,1e3)+" K , upCnt : "+cr.a.trimNumber(this.upCnt,1e6)+", lostHB : "+cr.a.trimNumber(this.lostHB/1024,1e3)+" K , lostCnt : "+cr.a.trimNumber(this.lostCnt,1e5)+"\r\n"}}],[{key:"pkgReceive",value:function(e){for(Nr.resetData(),Nr.set8(vo),Nr.set8(To),Nr.set32(e.alias),Nr.set8(e.sIDList.length);e.sIDList.length>0;)Nr.set32(e.sIDList.shift()),Nr.setBytes(e.dataList.shift(),0,dr.c.subPieceSize);return Nr.crc(),Nr.getReferData()}}]),t}(Co),No=0,Fo=new wr,Uo="",Vo=-1,Ho=!1,Wo="",jo=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,i,(function(e,t,i){this.onMsg(e,t,i)})))).localID="",a.workPeers=new wr,a.trackerPeers=[],a.upTaskSum=0,a.downTaskSum=0,a.upSpeed=0,a.downSpeed=0,a}return f()(t,e),s()(t,[{key:"onMsg",value:function(e,t,i){switch(e){case Qs.State_register:this.localID=t;break;case Qs.State_upDatePeers:this.localID=t,this.updatePeers(i);break;case Qs.State_candidate:this.workPeers.has(t)&&this.workPeers.get(t).candidate(i);break;case Qs.State_offer:this.workPeers.has(t)||this.acceptPeer(t,i);break;case Qs.State_answer:this.workPeers.has(t)&&this.workPeers.get(t).answer(i);break;case Qs.State_Error:}}},{key:"onTimer",value:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=this.workPeers.values[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){vi()(a.value,2)[1].check()}}catch(Rf){t=!0,i=Rf}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}}},{key:"check",value:function(e){Yr.loadSegment&&Yr.loadSegment.alias!==Wo&&(Ho=!0),this.addPeer(),this.weedOutPeer(),this.connectPeer(),this.upSpeed=0,this.downSpeed=0,Uo="",e&&(Uo+=" ---- tracker ID : "+this.id+" , IP : "+this.ip+" , localD : "+this.localID+"\r\n");var t=!0,i=!1,a=undefined;try{for(var n,r=this.workPeers.values[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=vi()(n.value,2)[1];e&&(Uo+=s.log),this.upSpeed+=s.upHB,this.downSpeed+=s.rcvHB,this.upTaskSum+=s.upHB,this.downTaskSum+=s.rcvHB,s.reset()}}catch(Rf){i=!0,a=Rf}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}return Uo}},{key:"addPeer",value:function(){(!this.getPeerMark||Ho||this.getPeerMark+dr.i.getPeerIDStep<Date.now())&&Yr.loadSegment&&!Yr.loadSegment.done&&Yr.loadSegment.p2pID===this.id&&(Wo=Yr.loadSegment.alias,Ho=!1,this.getPeerMark=Date.now(),this.getPeer(Yr.loadSegment))}},{key:"weedOutPeer",value:function(){if(!this.weedOutPeerMark||this.weedOutPeerMark+dr.i.weedOutPeerStep<Date.now()){this.weedOutPeerMark=Date.now();var e="",t=0,i=!0,a=!1,n=undefined;try{for(var r,s=this.workPeers.values[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var o=vi()(r.value,1)[0],d=this.workPeers.get(o);if(d&&!d["protected"]){var u=d.rcvCnt-(d.rcvCntLT?d.rcvCntLT:0);d.rcvCntLT=d.rcvCnt;var c=d.upCnt-(d.upCntLT?d.upCntLT:0);d.upCntLT=d.upCnt,(c+u<t||0===t)&&(t=c+u,e=d.peerID)}}}catch(Rf){a=!0,n=Rf}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw n}}this.workPeers.size>6&&""!==e&&this.removePeerNode(e,Ao)}}},{key:"connectPeer",value:function(){if(-1===Vo||Date.now()-Vo>dr.i.connectPeerStep)for(var e=0;e<this.trackerPeers.length&&No<dr.i.connectMax;){e++;var t=this.trackerPeers.shift();if(t&&!this.checkErrPeerID(t)){if(!ao.use(t)){this.trackerPeers.push(t);continue}this.workPeers.set(t,new Bo(this,t,!0)),No<dr.i.connectMax&&No++,Vo=Date.now();break}}}},{key:"acceptPeer",value:function(e,t){if(No<dr.i.passiveMax&&!this.workPeers.has(e)&&Date.now()-Vo>dr.i.connectPeerStep){if(!ao.use(e))return void this.trackerPeers.push(e);this.workPeers.set(e,new Bo(this,e,!1,t)),No<dr.i.passiveMax&&No++,Vo=Date.now()}}},{key:"checkErrPeerID",value:function(e){if(null===e||""===e||e===this.localID)return!0;if(this.workPeers.has(e))return!0;var t=Fo.get(e);return t&&Date.now()-t.time<t.duration}},{key:"updatePeers",value:function(e){if(e){this.trackerPeers.length=0;for(var t=0;t<e.length;t++){var i=e[t];this.workPeers.has(i)||null===i||""===i||i===this.localID||this.trackerPeers.push(i)}this.connectPeer()}}},{key:"clearTask",value:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=this.workPeers.values[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){vi()(a.value,2)[1].clearTask()}}catch(Rf){t=!0,i=Rf}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}}},{key:"checkP2PHealth",value:function(e){var t=0,i=!0,a=!1,n=undefined;try{for(var r,s=this.workPeers.values[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var o=vi()(r.value,2)[1];o.checkHealth(e)?t++:this.workPeers.size>6&&this.removePeerNode(o.peerID,Io)}}catch(Rf){a=!0,n=Rf}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw n}}return t}},{key:"removePeerNode",value:function(e,t){if(this.workPeers.has(e)){this.workPeers.get(e).peerClose(t),this.workPeers.remove(e),ao.shut(e),No>0&&No--;var i={};switch(i.time=Date.now(),t){case Do:i.duration=12e4;break;default:i.duration=6e4}var a=Fo.get(e);a?Fo.set(e,{time:i.time,duration:a.duration+i.duration}):Fo.set(e,i)}}},{key:"destroy",value:function(){var e=!0,t=!1,i=undefined;try{for(var a,n=this.workPeers.values[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var r=vi()(a.value,1)[0];this.removePeerNode(r,Io),No>0&&No--}}catch(Rf){t=!0,i=Rf}finally{try{e||null==n["return"]||n["return"]()}finally{if(t)throw i}}this.workPeers.clear(),this.trackerPeers.length=0,this.clear()}}]),t}(Js),Go=null,zo=null,Ko=0,Yo=!1,Qo=30;function Jo(){if(Qo>=30){Qo=0;var e=0,t=0;ur.a.p2pLog="",Go&&(ur.a.p2pLog+=Go.check(ur.a.onLog),e+=Go.upSpeed,t+=Go.downSpeed),zo&&(ur.a.p2pLog+=zo.check(ur.a.onLog),e+=zo.upSpeed,t+=zo.downSpeed),ur.a.downSpeed=t,ur.a.upSpeed=e;var i=Math.min(Math.max(ur.a.upMax,32),768);Math.ceil(Date.now()/1e3%100)<=20?go.sendMax=1.2*i:go.sendMax=.6*i,Yr.loadSegment&&(go.loadQuotaMax=2.5*Yr.loadSegment.rate)}Qo%2==0?(go.check(),Qo++):(Qo++,Go&&Go.onTimer(),zo&&zo.onTimer()),Ko=setTimeout(Jo,33)}var Xo,Zo,$o,ed,td,id,ad={startProxy:function(e,t){Yo||(Jo(),Yo=!0),null===Go?Go=new jo(e,t):null===zo?zo=new jo(e,t):Go.upTaskSum>zo.upTaskSum?(zo.destroy(),zo=new jo(e,t)):(Go.destroy(),Go=new jo(e,t))},getProxyByID:function(e){return Go&&e===Go.id?Go:zo&&e===zo.id?zo:null},hasProxyByID:function(e){return!(!Go||e!==Go.id)||zo&&e===zo.id},getProxyByIPInfo:function(e){return Go&&e===Go.firstIPInfo?Go:zo&&e===zo.firstIPInfo?zo:null},hasProxyByIPInfo:function(e){return!(!Go||e!==Go.firstIPInfo)||zo&&e===zo.firstIPInfo},destroy:function(){Go&&Go.destroy(),zo&&zo.destroy(),Yo&&(clearTimeout(Ko),Ko=0,Yo=!1)}},nd=function(){function e(t,i,a){n()(this,e),this.index=i,this.base=a,this.size=t,this.u8a=null}return s()(e,[{key:"setData",value:function(e,t){if(!this.u8a){dr.c.videoDataSize+=this.size,this.u8a=null;for(var i=0;null===this.u8a;)try{i++,this.u8a=new Uint8Array(this.size)}catch(Rf){if(i>dr.h)return Ir.a.error("setData Uint8Array tryCatchError"),!1}}return this.u8a.set(e,t-this.base),!0}},{key:"getData",value:function(e,t){return this.u8a?this.u8a.subarray(e-this.base,e-this.base+t):null}},{key:"clear",value:function(){this.u8a&&(dr.c.videoDataSize-=this.size,delete this.u8a)}},{key:"memory",get:function(){return this.u8a?this.size:0}}]),e}(),rd=0,sd=dr.c.chunkSize,od=dr.c.subPieceSize,dd=function(){function e(t){n()(this,e),this.readSize=Math.ceil(t/od)*od,this.chunkNum=Math.ceil(this.readSize/sd),this.dataArr=[],this.readLastIndex=0;for(var i=0;i<this.chunkNum;)this.dataArr.push(new nd(sd,i,i*sd)),i++}return s()(e,[{key:"readBytes",value:function(e,t){if(Zo=(Xo=e)+t-1,Xo>=this.readSize||t<=0||Zo>=this.readSize)throw Ir.a.warn("readBytes param Error,this.readSize: "+this.readSize+" _bRGPos: "+Xo+" _eRGPos : "+Zo+" dataLen: "+t),"readBytes param Error!";$o=Math.floor(Xo/sd),ed=Math.floor(Zo/sd);for(var i=0,a=null,n=0;null===a;)try{n++,a=new Uint8Array(t)}catch(s){if(n>dr.h)return Ir.a.error("readBytes Uint8Array tryCatchError"),++rd>dr.h&&(Er.a.errorStage="memoryAllocErr",Er.a.errorFragment=this),null}for(;$o<=ed;){Xo>=(td=$o*sd)&&(td=Xo),(id=$o*sd+sd-1)>=Zo&&(id=Zo);var r=this.dataArr[$o].getData(td,id-td+1);r&&a.set(r,i),i+=id-td+1,$o++}return this.readLastIndex=Math.floor((e+t)/sd),a}},{key:"writeBytes",value:function(e,t,i){if(Zo=(Xo=t)+i-1,Xo>=this.readSize||i<=0||Zo>this.readSize||!e)throw Ir.a.warn("writeBytes param Error,this.readSize: "+this.readSize+" _bRGPos: "+Xo+" _eRGPos : "+Zo+" dataLen: "+i),"writeBytes param Error!";$o=Math.floor(Xo/sd),ed=Math.floor(Zo/sd);for(var a=0;$o<=ed;){if(Xo>=(td=$o*sd)&&(td=Xo),(id=$o*sd+sd-1)>=Zo&&(id=Zo),!this.dataArr[$o].setData(e.subarray(a,a+(id-td+1)),td)){++rd>dr.h&&(Er.a.errorStage="memoryAllocErr",Er.a.errorFragment=this);break}a+=id-td+1,$o++}return a}},{key:"clear",value:function(){for(var e=0;e<this.chunkNum;)this.dataArr[e]&&this.dataArr[e].clear(),e++;delete this.dataArr}},{key:"remove",value:function(){for(var e=0;e<this.readLastIndex;)this.dataArr[e]&&this.dataArr[e].clear(),e++}},{key:"resetReadLastIndex",value:function(){this.readLastIndex=0}},{key:"memory",get:function(){if(!this.dataArr)return 0;for(var e=0,t=0;e<this.chunkNum;)this.dataArr[e]&&(t+=this.dataArr[e].memory),e++;return t}}]),e}(),ud=new wr;var cd={create:function(e,t){ud.has(e)||ud.set(e,new dd(t))},get:function(e){return ud.get(e)},remove:function(e){ud.has(e)&&(ud.get(e).clear(),ud.remove(e))},removeChunk:function(e){ud.has(e)&&ud.get(e).remove()}},ld=function(){function e(t,i){n()(this,e),this.rto=3e3,this.alias=t,this.subPieceID=i,this.beginTime=Date.now()}return s()(e,[{key:"key",get:function(){return this.alias.toString()+"_"+this.subPieceID.toString()}},{key:"timeOut",get:function(){return this.beginTime+this.rto}}]),e}(),hd=dr.c.subPieceSize,_d=[31,67,182,117],fd=[105,115,111,109],pd=function(){function e(t,i,a,r,s,o,d,u,c,l,h,_){n()(this,e),this.tvid=i,this.sourceID=a,this.vid=d,this.p2pID=u,this.alias=o,this.peerCnt=-1,this.vids=l,this.size=t,this.index=s,this.refreshFun=null,this._dataLen=0,this.shareDataNum=0,this.status=0,this.ceSID=0,this.gpSID=0,this.pieceNum=Math.ceil(this.size/262144),this.subPcNum=Math.ceil(this.size/hd),this.bitmap=new mo(this.pieceNum,this.alias),this.subBitmap=new mo(this.subPcNum,this.alias),this.runSubBitmap=new mo(this.subPcNum,this.alias),this.bsID=-1,this.esID=this.subPcNum,this.fragmentName="",this.fileType=h,this.seekable=_,this.rate=c,this._checkDataStep=0,this._p2pCheckDataStep=0,this._TMPKeyList=[],this._TMPDataList=[],this._TMPRcvCnt=0,this._tsLoadDone=!1,this.dataErrCount=0,this.endPos=0,cd.create(this.alias,this.size)}return s()(e,[{key:"setPosList",value:function(e){this.seekable=e}},{key:"setRange",value:function(e,t){var i=Math.floor(this.bsID/256);this.bitmap.getBit(i)&&!this.subBitmap.checkRange(256*i,256*(i+1))&&this.bitmap.setBit(i,!1);var a=Math.ceil(this.esID/256);this.bitmap.getBit(a)&&!this.subBitmap.checkRange(256*a,256*(a+1))&&this.bitmap.setBit(a,!1),this.ePos=t,this.bsID=Math.floor(e/hd),this.esID=Math.ceil(t/hd),this.checkGpSID(this.bsID),this.checkCEPos(this.bsID),Ir.a.info("segment.setRange , index = "+this.index+",range "+e+"-"+t+" ,cePos "+this.cePos),this.refreshFun&&this.refreshFun.call(null);var n=cd.get(this.alias);n&&n.resetReadLastIndex()}},{key:"addData",value:function(e,t,i){var a=cd.get(this.alias);if(a){i=a.writeBytes(t,e,i);for(var n=Math.ceil(e/hd),r=e+i>=this.size?this.subPcNum:Math.floor((e+i)/hd);n<r;)this.subBitmap.setBit(n,!0),this.runSubBitmap.setBit(n,!0),n++;this._dataLen+=i;var s=this;ur.a.pcwBuffer<2||0===e&&8192===i?this.checkData():0===this._checkDataStep&&(this._checkDataStep=setTimeout((function(){s&&s.checkData.call(s)}),500))}else Ir.a.error("segment is null when addData ,index "+this.index+", rate "+this.rate)}},{key:"checkData",value:function(){clearTimeout(this._checkDataStep),this._checkDataStep=0,this.checkGpSID(this.gpSID);for(var e=Math.floor(this.bsID/256),t=Math.ceil(this.size/262144);e<t;){var i=256*e,a=256*(e+1);this.bsID>=i&&this.bsID<=a&&(i=this.bsID),this.esID>=i&&this.esID<=a&&(a=this.esID),this.subBitmap.checkRange(i,a)&&this.bitmap.setBit(e,!0),e++}var n=this.ceSID;this.checkCEPos(this.ceSID),this.refreshFun&&this.refreshFun(),n<this.ceSID&&ur.a.noticeDataArrived&&ur.a.noticeDataArrived()}},{key:"getData",value:function(e,t){return cd.get(this.alias).readBytes(e,t)}},{key:"hasData",value:function(e,t){for(var i=Math.floor(e/hd),a=Math.ceil(Math.min(e+t,this.size)/hd);i<a;){if(!this.subBitmap.getBit(i))return!1;i++}return!0}},{key:"checkCEPos",value:function(e){for(var t=e!==undefined?e:this.ceSID;t<this.subPcNum&&this.subBitmap.getBit(t);)t++;this.ceSID=Math.min(t,this.subPcNum)}},{key:"deleteRange",value:function(e,t,i){for(var a=Math.min(e+t,this.size),n=Math.floor(e/hd),r=Math.ceil(a/hd);n<r;)this.subBitmap.setBit(n,!1),this.runSubBitmap.setBit(n,!1),n++;for(var s=Math.floor(e/262144),o=Math.ceil(a/262144);s<o;)this.bitmap.setBit(s,!1),s++;i||(this.checkGpSID(this.bsID),this.checkCEPos(this.bsID))}},{key:"checkTask",value:function(e,t){for(var i=Math.floor(e/hd),a=Math.min(this.subPcNum,Math.ceil(t/hd)),n=[],r=0,s=-1,o=-1;i<a;)this.subBitmap.getBit(i)?(-1!==s&&r++,r>=32&&(n.push({begin:s*hd,end:Math.min((o+1)*hd,this.size)}),s=-1,o=-1,r=0)):(r=0,-1===s&&(s=i),o=i,this.runSubBitmap.setBit(i,!0)),i++;return-1!==s&&n.push({begin:s*hd,end:Math.min((o+1)*hd,this.size)}),this.checkGpSID(this.gpSID),n}},{key:"recycleCDNTask",value:function(e){for(var t,i,a,n=0;n<e.length;n++)for(t=e[n],i=Math.floor(t.begin/hd),a=Math.min(this.subPcNum,Math.ceil(t.end/hd));i<a;)this.subBitmap.getBit(i)||this.runSubBitmap.setBit(i,!1),i++;this.checkGpSID(this.bsID),this.checkCEPos(this.bsID)}},{key:"recycleP2PTask",value:function(e){!this.subBitmap.getBit(e.subPieceID)&&this.runSubBitmap.getBit(e.subPieceID)&&(this.runSubBitmap.setBit(e.subPieceID,!1),e.subPieceID<this.gpSID&&this.checkGpSID(e.subPieceID))}},{key:"checkGpSID",value:function(e){for(this.gpSID=e;this.gpSID<this.subPcNum&&!(!this.runSubBitmap.getBit(this.gpSID)&&!this.subBitmap.getBit(this.gpSID)&&this.gpSID>=this.bsID&&this.gpSID<=this.esID);)this.gpSID++}},{key:"addSubPiece",value:function(e,t){if(this.fileType===Fr.a.TS){var i=0,a=e*hd;for(0!==e&&(i=188-a%188);i<t.byteLength&&a+i<this.ePos;){if(71!==t[i])return this.dataErrCount++,void Ir.a.error("Segment reveive p2p load data err ,pos "+(a+i)+" ,dataErrCount "+this.dataErrCount);i+=188}}else if(this.fileType===Fr.a.DASH){var n=e*hd,r=n+t.byteLength,s=cr.a.searchPosIndex(n,this.seekable);if((s=s>=0?s+1:0)<this.seekable.length-1&&this.seekable[s]>=n&&this.seekable[s]+4<=r)for(var o=this.seekable[s]-n,d=0;d<_d.length;){if(t[o+d]!==_d[d])return this.dataErrCount++,void Ir.a.error("Segment reveive p2p load webm data err ,pos "+o+" ,dataErrCount "+this.dataErrCount);d++}}else if(this.fileType.indexOf(Fr.a.M4S)>=0){var u=e*hd,c=u+t.byteLength,l=cr.a.searchPosIndex(u,this.seekable);if((l=l>=0?l+1:0)<this.seekable.length-1&&this.seekable[l]>=u&&this.seekable[l]+12<=c)for(var h=this.seekable[l]-u+8,_=0;_<fd.length;){if(t[h+_]!==fd[_])return this.dataErrCount++,void Ir.a.error("Segment reveive p2p load webm data err ,pos "+h+" ,dataErrCount "+this.dataErrCount);_++}}if(this._TMPRcvCnt++,hd===t.byteLength&&-1===this._TMPKeyList.indexOf(e)){for(var f=!1,p=0;p<this._TMPKeyList.length;p++)if(this._TMPKeyList[p]*hd+this._TMPDataList[p].byteLength===e*hd){f=!0;var g=new Uint8Array(this._TMPDataList[p].byteLength+t.byteLength);g.set(this._TMPDataList[p],0),g.set(t,this._TMPDataList[p].byteLength),this._TMPDataList[p]=g;break}if(f||(this._TMPKeyList.push(e),this._TMPDataList.push(t)),this._TMPRcvCnt>=50)this.mergeData();else if(0===this._p2pCheckDataStep){var m=this;this._p2pCheckDataStep=setTimeout((function(){m&&m.mergeData.call(m)}),100)}As.p2pSize=hd+As.p2pSize,this.peerMgr&&(this.peerMgr.p2pSize=hd+this.peerMgr.p2pSize)}}},{key:"mergeData",value:function(){for(clearTimeout(this._p2pCheckDataStep),this._p2pCheckDataStep=0;this._TMPKeyList.length>0;){var e=this._TMPDataList.shift();this.addData(this._TMPKeyList.shift()*hd,e,e.byteLength)}this._TMPRcvCnt=0}},{key:"pieceNeed",value:function(e){return e>=this.bID&&e<=this.eID&&!this.bitmap.getBit(e)}},{key:"subPieceNeed",value:function(e){return e>=this.bsID&&e<=this.esID&&!this.subBitmap.getBit(e)}},{key:"getTasks",value:function(e,t,i,a){if(e&&e.alias===this.alias&&!(this.gpSID>=this.esID)){for(var n=e,r=Math.max(this.gpID,n.gpID),s=Math.min(Math.ceil(this.esID/256),r+16),o=this.gpSID;r<s&&t.length<i;){if(n.getBit(r)&&this.pieceNeed(r)){o=256*r;var d=Math.min(256*(r+1),this.subPcNum);for(this.gpSID>o&&this.gpSID<d&&(o=this.gpSID);o<d&&t.length<i;){if(this.subPieceNeed(o)){var u=new ld(this.alias,o);u.rto=a,t.push(u),this.runSubBitmap.setBit(o,!0)}o++}}r++}t.length>0&&this.checkGpSID(this.gpSID)}}},{key:"clearTask",value:function(){this.peerMgr&&this.peerMgr.clearTask()}},{key:"checkP2PHealth",value:function(){return this.peerMgr?this.peerMgr.checkP2PHealth(this.alias):0}},{key:"requestTask",value:function(e){return this.subBitmap.getBit(e)?(this.shareDataNum++,As.upSize=As.upSize+hd,this.peerMgr&&(this.peerMgr.upSize=hd+this.peerMgr.upSize),this.getData(e*hd,hd)):null}},{key:"checkDefinition",value:function(e){if(this.vidsDesc=" [ ",this.vids&&this.vids.length>0&&e.length>0)for(var t=0;t<this.vids.length;t++){for(var i=0;i<e.length;i++)if(this.vids[t].vid===e[i].vid){this.vids[t].count=e[i].count;break}this.vidsDesc+=this.vids[t].rate+":"+(this.vids[t].count===undefined?0:this.vids[t].count)+(t<this.vids.length-1?" , ":"")}this.vidsDesc+=" ]"}},{key:"toDataString",value:function(e,t,i){for(var a="",n=Math.floor((-1!==e?e:t)/262144),r=0,s=Math.floor(t/262144),o=Math.floor(i/262144),d=Math.ceil(this.size/262144),u=this.gpID,c=Math.floor(this.ceSID/256),l="";r<d;)this.bitmap.getBit(r)?(l="*",c===r&&u===r?l="(EG)":c===r?l="E":u===r&&(l="G")):(l="_",c===r&&u===r?l="(eg)":c===r?l="e":u===r&&(l="g")),n!==undefined&&n===r&&(l="R"),s===r&&(l="‹"+l),o===r&&(l+="›"),a+=l,++r%128==0&&(a+="\r");return a+="┛"}},{key:"destroy",value:function(){Ir.a.info("Segment be destroy : "+this.index+" bidRdate :"+this.rate+" tvid : "+this.tvid),this.bitmap.clear(),this.subBitmap.clear(),this.runSubBitmap.clear(),cd.remove(this.alias)}},{key:"destroyChunk",value:function(e){var t=cd.get(e);if(t){var i=t.readLastIndex*dr.c.chunkSize;i>0&&(Ir.a.info("Segment ready to clear data ,pos "+i+" , segment "+this.index),this.deleteRange(0,i,!0),cd.removeChunk(e))}}},{key:"tsLoadDone",set:function(e){this._tsLoadDone=e},get:function(){return this._tsLoadDone}},{key:"dataLen",set:function(e){this._dataLen=e},get:function(){return this._dataLen}},{key:"state",set:function(e){this.status=e},get:function(){return this.status}},{key:"peerMgr",get:function(){return ad.getProxyByID(this.p2pID)}},{key:"cePos",get:function(){return Math.min(this.ceSID*hd,this.size)}},{key:"done",get:function(){return this.ceSID>0&&this.ceSID>=this.esID}},{key:"gpID",get:function(){return Math.floor(this.gpSID/256)}},{key:"eID",get:function(){return Math.ceil(this.esID/256)}},{key:"bID",get:function(){return Math.floor(this.bsID/256)}},{key:"approachEnd",get:function(){return this.cePos>=this.size-5242880}},{key:"memory",get:function(){return cd.get(this.alias).memory}},{key:"dataUrl",get:function(){return this._dataUrl},set:function(e){this._dataUrl=e}}]),e}(),gd=i(41),md=i(86),vd=i(71),bd=function(){function e(t,i,a){n()(this,e);var r=t;this.sourceID=i,this.type=a,this.loader=new XMLHttpRequest,this.loader.responseType="json";var s=this,o="";s.loader.onreadystatechange=function(){if(o+=s.loader.readyState+",",0===s.loader.readyState);else if(1===s.loader.readyState);else if(2===s.loader.readyState);else if(3===s.loader.readyState);else if(200===s.loader.status)if(s.loader.response)if(s.loader.response.hasOwnProperty("uri")){var e=JSON.parse(JSON.stringify(s.loader.response));if(cr.a.getFileNameFromUrl(e.uri)!==s.sourceID)return;s.destroy(),vd.a.getEvent().emit(md.a.DisLoadStatus+s.type,"done",e)}else d("responseHas`tProperty-l");else d("responseIsNull");else{var t="";if(s.loader.response||405===s.loader.status){var i=0;s.loader.response&&(t=JSON.stringify(s.loader.response),i=s.loader.response.code),i.indexOf("D20")>=0&&405===s.loader.status&&ur.a.authorFailedStatus===gd.a.AuthorState_authorOK&&(ur.a.authorFailedStatus=gd.a.AuthorState_authorFailed,Ir.a.error(" Authentication failure,message "+t))}d("statusErr-"+s.loader.status+"-"+o+"-"+t)}};try{s.loader.open("GET",r,!0),s.loader.withCredentials=!1,Ir.a.info("DispatchByXhr url "+r),s.loader.send()}catch(u){d("tryCatchError")}function d(e){s.loader&&(s.destroy(),vd.a.getEvent().emit(md.a.DisLoadStatus+s.type,"error",e))}}return s()(e,[{key:"destroy",value:function(){this.loader&&(this.loader.abort(),delete this.loader)}}]),e}(),yd=i(251),kd=function(){function e(t,i,a){n()(this,e),this.running=!0,this.sourceID=i,this.type=a,this.load(t)}return s()(e,[{key:"load",value:function(e){var t=this;Ir.a.info("DispatchByFetch url "+e),fetch(e,{method:"GET",mode:"cors",credentials:"omit",cache:"no-store",headers:{}}).then((function(e){if(e.status>=400||e.status<200){if(!t.running)return;t.onError("statusErr-"+e.status)}else{if(!t.running)return;e.json().then((function(e){cr.a.getFileNameFromUrl(e.uri)===t.sourceID&&(t.running=!1,vd.a.getEvent().emit(md.a.DisLoadStatus+t.type,"done",e))}))}}))["catch"]((function(e){t.onError(e.message)}))}},{key:"onError",value:function(e){"statusErr-405"===e&&ur.a.authorFailedStatus===gd.a.AuthorState_authorOK&&(ur.a.authorFailedStatus=gd.a.AuthorState_authorFailed,Ir.a.error("Authentication failure,message "+e)),this.running&&(this.running=!1,vd.a.getEvent().emit(md.a.DisLoadStatus+this.type,"error",e))}},{key:"destroy",value:function(){this.running=!1}}]),e}(),Td=null,Sd=null,Pd=function(){function e(){n()(this,e)}return s()(e,[{key:"start",value:function(e,t){this.segment=e;try{var i=this.segment.dispatchUrl;if(-1===i.indexOf("?")?i+="?pv=0.1":i+="&pv=0.1",i+="&cross-domain=1",i+="&mss=1",i+="&stauto="+ur.a.absStatus,t>0&&this.segment.errIDCList.length<3&&this.segment.errIDCList.length>0&&(i+="&retry="+this.segment.errIDCList.length.toString(),i+="&z="+this.segment.errIDCList.toLocaleString().replace(/,/g,"|")),this.segment.dispatchOnError)if(this.segment.dispatchOnError%3==1){var a=cr.a.parseURL(i);i=lr.a.isHTTPS?i.replace(a[2]+a[4],ur.a.bgpIP+hs()(a[2])+yd.Base64.encode(a[4]))+"&ssl=1":i.replace(a[2]+a[4],ur.a.bgpIP+hs()(a[2])+yd.Base64.encode(a[4]))}else if(this.segment.dispatchOnError%3==2&&""!==ur.a.bgpIP2){var n=cr.a.parseURL(i);i=lr.a.isHTTPS?i.replace(n[2]+n[4],ur.a.bgpIP2+hs()(n[2])+yd.Base64.encode(n[4]))+"&ssl=1":i.replace(n[2]+n[4],ur.a.bgpIP2+hs()(n[2])+yd.Base64.encode(n[4]))}Td=Date.now(),As.addPBItem(fs.dispatch_Cnt),vd.a.getEvent().off(md.a.DisLoadStatus+this.segment.type),vd.a.getEvent().once(md.a.DisLoadStatus+this.segment.type,this.disLoadStatus.bind(this)),!lr.a.supportFetch||this.segment.dispatchOnError&&this.segment.dispatchOnError%1!=0?this.loader=new bd(i,this.segment.sourceID,this.segment.type):this.loader=new kd(i,this.segment.sourceID,this.segment.type)}catch(r){this.disError("tryCatchError")}}},{key:"disLoadStatus",value:function(e,t){"done"===e?this.disDone(t):this.disError(t)}},{key:"disDone",value:function(e){As.addPBItem(fs.dispatch_doneCount),As.addPBItem(fs.dispatch_duration,Date.now()-Td),Ir.a.info("Dispatch [NORMAL / VIP DONE] data : "+JSON.stringify(e)+", isHttps : "+lr.a.isHTTPS+", sourceID : "+this.segment.sourceID),cr.a.setCookie("QP0022",e.re+"|"+e.d[0].z);var t=e.d[0].URL;if(lr.a.isHTTPS&&t.indexOf("https:")<0)return Ir.a.error("Dispatch match check err,https Dispatch return http"),void this.disError("notIsHttps");Sd&&Sd===this.segment.tvid||(dr.g.clear(),Sd=this.segment.tvid);for(var i=e.re.split("|"),a=i[1].split("-")[0],n=0;n<e.d.length;n++)cr.a.isPoint80443(e.d[n].URL)||(e.d[n].URL=cr.a.getNewUrl(this.segment.dispatchUrl,i[0],a),e.d[n].URL+="&qd=b");if(cr.a.getFileNameFromUrl(e.uri)===this.segment.sourceID){if(dr.g.set(this.segment.sourceID,e.d),xr.checkConfig(),lr.a.canP2P&&"off"!==dr.i.limitP2P&&!0===dr.i.onP2P&&!this.segment.onTracker){var r=cr.a.getUserInfoFromCookie(),s=cr.a.getTrackerIP(r.userNetType,dr.i.tracker,this.segment.p2pID);""!==s&&(Ir.a.info("AND tracker Dispatch [DONE] IP : "+s),this.segment.setTrackerIP(s))}this.clearIn(),vd.a.getEvent().emit(md.a.DisPatchStatus+this.segment.type)}}},{key:"disError",value:function(e){this.clearIn(),vd.a.getEvent().emit(md.a.DisPatchStatus+this.segment.type,e)}},{key:"clearIn",value:function(e){this.loader&&(this.loader.destroy(),this.loader=null),e&&vd.a.getEvent().off(md.a.DisLoadStatus+this.segment.type)}},{key:"clear",value:function(){this.clearIn(!0)}}]),e}(),xd=function(){function e(t,i){n()(this,e),this.type=e.type,this.videoType=t,this.eventID=i}return s()(e,[{key:"load",value:function(e){this.AllTask=e;var t=0;for(this.cache=null;null===this.cache;)try{t++,this.cache=new Uint8Array(1048576)}catch(n){if(t>dr.h)return Ir.a.error("FetchLoader catch Uint8Array err : "+n.message),void this.onError("tryCatchError")}if(this.AllTask&&this.AllTask.url){this.running=!0,this.reader=null,this.readPos=0,this.dataPos=0,this.base=0,this.dataLen=0,this.readLength=0;var i=this.AllTask.url;if(-1!==i.indexOf("start")&&-1!==i.indexOf("end")||(-1===i.indexOf("?")?-1!==this.AllTask.end&&(i+="?start="+this.AllTask.begin+"&end="+this.AllTask.end):-1!==this.AllTask.end&&(i+="&start="+this.AllTask.begin+"&end="+this.AllTask.end),Ir.a.debug("load start: "+this.AllTask.begin+" end: "+this.AllTask.end)),-1===i.indexOf("stauto")&&(i+="&stauto="+ur.a.absStatus),-1===i.indexOf("ori")&&(i+="&ori=pcw"+ur.a.platform),-1===i.indexOf("num"))i+="&num="+Date.now().toString();Ir.a.info("[Fetch start load url] "+i);var a=this;fetch(i,{method:"GET",mode:"cors",credentials:"omit",cache:"no-store",headers:{}}).then((function(e){if(e.status>=400||e.status<200){if(!a.running)return;a.onError("statusErr-"+e.status)}else if(cr.a.isPoint80443(e.url)){if(a.reader=e.body.getReader(),!a.running){if(a.reader)try{a.reader.cancel(),a.reader=null}catch(t){}return}a.pump()}else a.onError("isPointNot80|443")}))["catch"]((function(e){if(a.running)"Failed to fetch"===e.message?a.onError("accessErr"):(Ir.a.warn("fetch failed ,err message "+e.message),a.onError("tryCatchError"));else if(a.reader)try{a.reader.cancel(),a.reader=null}catch(t){}}))}else this.onError("taskError")}},{key:"pump",value:function(){var e=this;return e.reader.read().then((function(t){if(e.running){var i=t.value;if(i){e.dataLen+=i.byteLength;try{if(e.dataPos+i.byteLength>e.cache.byteLength){for(var a=null,n=0;null===a;)try{n++,a=new Uint8Array(e.dataPos+i.byteLength)}catch(d){if(n>dr.h)return Ir.a.error("FetchLoader catch newUint8Array err : "+d.message),void e.onError("tryCatchError")}var r=e.cache.subarray(e.readPos);a.set(r,0),delete e.cache,e.dataPos=e.dataPos-e.readPos,e.base+=e.readPos,e.readPos=0,e.cache=a}e.cache.set(i,e.dataPos),e.dataPos+=i.byteLength}catch(d){return Ir.a.error("FetchLoader catch err : "+d.message),void e.onError("dataError")}}if(e.dataPos-e.readPos>=8192){var s=8192*Math.floor((e.dataPos-e.readPos)/8192);if(e.AllTask.data=e.cache.subarray(e.readPos,e.readPos+s),e.AllTask.range={begin:e.AllTask.begin+e.base+e.readPos,end:e.AllTask.begin+e.base+e.readPos+s},e.videoType!==Fr.a.FTS){if(e.videoType===Fr.a.TS){var o=188-e.AllTask.range.begin%188;if(71!==e.AllTask.data[o])return Ir.a.error("ts data check err , start pos !== 71 "),void e.onError("dataError")}if(e.AllTask.range.end>e.AllTask.end)return Ir.a.error("data range err , need range "+e.AllTask.begin+"-"+e.AllTask.end+" currentEnd: "+e.AllTask.range.end+" base: "+e.base),void e.onError(gd.a.LoaderState_dataRangeError)}e.readLength+=s,vd.a.getEvent().emit(md.a.LoadStatus+e.eventID,"progress"),e.readPos+=s}if(e.running){if(-1===e.AllTask.end&&-1!==e.AllTask.segment.size&&(e.AllTask.end=e.AllTask.segment.size),t.done||-1!==e.AllTask.end&&e.AllTask.begin+e.base+e.dataPos>=e.AllTask.end){if(e.readPos<e.dataPos){if(e.AllTask.data=e.cache.subarray(e.readPos,e.dataPos),e.AllTask.range={begin:e.AllTask.begin+e.base+e.readPos,end:e.AllTask.begin+e.base+e.dataPos},"fts"!==e.videoType&&e.AllTask&&e.AllTask.range.end>e.AllTask.end)return Ir.a.error("~~ data range err , need range "+e.AllTask.begin+"-"+e.AllTask.end+" currentEnd: "+e.AllTask.range.end+" base: "+e.base+",needLen "+(e.AllTask.end-e.AllTask.begin)+",receiveLen "+e.dataLen),void e.onError("dataError");e.readLength+=e.dataPos-e.readPos,vd.a.getEvent().emit(md.a.LoadStatus+e.eventID,"progress"),e.readPos=e.dataPos}if(e.dataLen!==e.readLength)Ir.a.error("~~chunkLen: "+e.dataLen+" readLen: "+e.readLength);else if(e.AllTask&&e.dataLen!==e.AllTask.end-e.AllTask.begin)return Ir.a.error("need dataLen is not match receive dataLen,needLen "+(e.AllTask.end-e.AllTask.begin)+",receiveLen "+e.dataLen),void e.onError(gd.a.LoaderState_dataRangeError);return e.close(),void vd.a.getEvent().emit(md.a.LoadStatus+e.eventID,"done")}return e.pump()}}else if(e.reader)try{e.reader.cancel(),e.reader=null}catch(u){}}))}},{key:"onError",value:function(e){if(this.running){if(this.running=!1,this.AllTask=null,this.reader)try{this.reader.cancel(),this.reader=null}catch(t){}"accessErr"===e||"statusErr-405"===e||"dataError"===e||e===gd.a.LoaderState_dataRangeError||"isPointNot80|443"===e?vd.a.getEvent().emit(md.a.LoadStatus+this.eventID,"error",e):vd.a.getEvent().emit(md.a.LoadStatus+this.eventID,"error","netError")}}},{key:"close",value:function(){if(this.running&&(this.running=!1,this.AllTask=null,this.reader))try{this.reader.cancel(),this.reader=null}catch(e){}this.cache&&delete this.cache}}],[{key:"type",get:function(){return"fetch"}}]),e}(),Id=i(308),Ed=1,Dd=2,wd=3,Ad=new Map,qd=setTimeout(Od,12e4);function Od(e){clearTimeout(qd);var t=!0,i=!1,a=undefined;try{for(var n,r=Ad[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=vi()(n.value,2),o=s[0],d=s[1],u=o.split("|"),c={dmnm:u[0],idc:u[1],type:wd,total:d.total,failcnt:d.failcnt};ur.a.sendPingBack({type:"DNSParser",para:c}),Ad["delete"](o)}}catch(Rf){i=!0,a=Rf}finally{try{t||null==r["return"]||r["return"]()}finally{if(i)throw a}}e||(qd=setTimeout(Od,12e4))}var Ld=function(){function e(){n()(this,e),this.tskList=null,this.curLoadTskIndex=0,this.tsk=null,this.retryCnt=0,this.stateChange=null,this.segment=null,this.startTime=-1,this.loader=null,this._loadStage="",this.dispatcher=null,this.domain="",this.idc=""}return s()(e,[{key:"load",value:function(e,t,i,a,n){this.segment&&this.close(!1),this.segment=e,this.retryCnt=i,this.urlIndex=a,this.CDNStateChangeEventID=n,this.tskList=t,this.tsk=null,this.url="",dr.g.has(this.segment.sourceID)&&0!==Kd(this.segment.sourceID)?(this._loadStage="CDN",this.createLoader(),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_ready),this.checkConTracker(),this.checkTask()):(this._loadStage="dispatch",this.startDisPatch())}},{key:"createLoader",value:function(){"mozilla"===lr.a.browser.name||"firefox"===lr.a.browser.name&&lr.a.browser.version.major<65||"chrome"===lr.a.browser.name&&lr.a.browser.version.major<43||"msedge"===lr.a.browser.name&&lr.a.browser.version.major<14||"safari"===lr.a.browser.name&&(lr.a.browser.version.major<10||10===lr.a.browser.version.major&&lr.a.browser.version.minor<1)||this.retryCnt%2==1?this.loader=new Id.a(this.segment.fileType,this.CDNStateChangeEventID):this.loader=new xd(this.segment.fileType,this.CDNStateChangeEventID)}},{key:"checkConTracker",value:function(){if(lr.a.canP2P&&"off"!==dr.i.limitP2P&&!0===dr.i.onP2P&&!this.segment.onTracker){xr.checkConfig();var e=cr.a.getUserInfoFromCookie(),t=cr.a.getTrackerIP(e.userNetType,dr.i.tracker,this.segment.p2pID);""!==t&&(Ir.a.info("AND tracker Dispatch [DONE] IP : "+t),this.segment.setTrackerIP(t))}}},{key:"disPatchDone",value:function(){this.segment&&(this.createLoader(),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_ready),this._loadStage="CDN",this.checkConTracker(),this.checkTask())}},{key:"disPatchErr",value:function(e){this.segment&&(this.close(!0),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_error,gd.a.LoaderState_error_dispatch,e,""))}},{key:"startDisPatch",value:function(){this.dispatcher||(this.dispatcher=new Pd),vd.a.getEvent().once(md.a.DisPatchStatus+this.segment.type,this.disPatchStatus.bind(this)),this.dispatcher.start(this.segment,this.retryCnt)}},{key:"disPatchStatus",value:function(e){e?this.disPatchErr(e):this.disPatchDone()}},{key:"checkTask",value:function(){if(this.segment&&this.tskList)if(this.curLoadTskIndex>this.tskList.length-1&&!this.tsk)this._loadStage="",this.close(!1),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_done);else if(dr.g.has(this.segment.sourceID)){var e="",t=null;if(dr.g.has(this.segment.sourceID))if(this.urlIndex)e=(t=dr.g.get(this.segment.sourceID)[this.urlIndex]).URL;else{var i=zd(this.segment.sourceID);0===i.length&&(Ir.a.info("select no vaild urlIndex,default index 0 "),i.push(0)),e=(t=dr.g.get(this.segment.sourceID)[i[0]]).URL}else e=this.segment.dataUrl;if(t&&(this.segment.idc=this.idc=t.z),lr.a.isHTTPS&&(e=e.replace(/^http:/gi,"https:")),this.segment.fileType.indexOf(Fr.a.TS)>=0||this.segment.fileType===Fr.a.DASH){var a=null;a=this.segment.fileType===Fr.a.TS||this.segment.fileType===Fr.a.DASH?{startPos:this.tskList[this.curLoadTskIndex].begin,endPos:this.tskList[this.curLoadTskIndex].end,contentlength:this.tskList[this.curLoadTskIndex].end-this.tskList[this.curLoadTskIndex].begin}:this.segment.loadInfo,this.segment.dataUrl=function(e,t,i){if(!t)return"";t.indexOf("&start=")>0?t=(t=t.replace(/\&start=[0-9.]+&/g,"&start="+i.startPos+"&")).replace(/\&start=[0-9.]+$/g,"&start="+i.startPos):t.indexOf("?start=")>0&&(t=(t=t.replace(/\?start=[0-9.]+&/g,"?start="+i.startPos+"&")).replace(/\?start=[0-9.]+$/g,"?start="+i.startPos));t.indexOf("&end=")>0?t=(t=t.replace(/\&end=[0-9.]+&/g,"&end="+i.endPos+"&")).replace(/\&end=[0-9.]+$/g,"&end="+i.endPos):t.indexOf("?end=")>0&&(t=(t=t.replace(/\?end=[0-9.]+&/g,"?end="+i.endPos+"&")).replace(/\?end=[0-9.]+$/g,"?end="+i.endPos));t.indexOf("&contentlength=")>0?t=(t=t.replace(/\&contentlength=[0-9.]+&/g,"&contentlength="+i.contentlength+"&")).replace(/\&contentlength=[0-9.]+$/g,"&contentlength="+i.contentlength):t.indexOf("?contentlength=")>0&&(t=(t=t.replace(/\?contentlength=[0-9.]+&/g,"?contentlength="+i.contentlength+"&")).replace(/\?contentlength=[0-9.]+$/g,"?contentlength="+i.contentlength));e===Fr.a.FTS&&(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\?hsize=[0-9.]+&/g,"?hsize="+i.hsize+"&")).replace(/\&hsize=[0-9.]+&/g,"&hsize="+i.hsize+"&")).replace(/\?hsize=[0-9.]+$/g,"?hsize="+i.hsize)).replace(/\&hsize=[0-9.]+$/g,"&hsize="+i.hsize)).replace(/\?tag=[0-9.]*&/g,"?tag="+i.tag+"&")).replace(/\&tag=[0-9.]*&/g,"&tag="+i.tag+"&")).replace(/\?tag=[0-9.]*$/g,"?tag="+i.tag)).replace(/\&tag=[0-9.]*$/g,"&tag="+i.tag)).replace(/\?v=[0-9.]*&/g,"?v="+i.v+"&")).replace(/\&v=[0-9.]*&/g,"&v="+i.v+"&")).replace(/\?v=[0-9.]*$/g,"?v="+i.v)).replace(/\&v=[0-9.]*$/g,"&v="+i.v));return t}(this.segment.fileType,e,a)}else this.segment.fileType.indexOf(Fr.a.M4S)>=0&&(this.segment.dataUrl=e);this.url=this.segment.dataUrl,this.tsk=this.tskList[this.curLoadTskIndex++];var n=cr.a.getPureIP(this.url);this.segment.ip=this.domain=ur.a.cdnLoadDoMain=n;var r=this.url.indexOf(n),s=this.segment.fileType;this.segment.fileType.indexOf(Fr.a.TS)>=0&&(s=Fr.a.TS);var o=this.url.indexOf("."+s);this.tsk.path=this.url.slice(r+n.length,o+4),this.tsk.url=this.url,this.tsk.rate=this.segment.rate,this.tsk.ip=n+":80",this.tsk.segment=this.segment,this.tsk.data=null,this.tsk.range=null,vd.a.getEvent().on(md.a.LoadStatus+this.CDNStateChangeEventID,this.loaderStateChange.bind(this));try{this.startTime=Date.now(),function(e,t){var i=e+"|"+t,a=Ad.get(i);a?Ad.set(i,{total:a.total+1,failcnt:a.failcnt}):Ad.set(i,{total:1,failcnt:0})}(this.domain,this.idc),this.loader.load(this.tsk)}catch(d){this.segment&&(this.close(!0),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_error,gd.a.LoaderState_error_load,"trycatchError",""))}}else this.startDisPatch()}},{key:"loaderStateChange",value:function(e,t){if(this.segment)switch(e){case"progress":this.tsk&&this.tsk.data&&this.tsk.range&&(this.tsk.range.end-this.tsk.range.begin!==this.tsk.data.byteLength&&Ir.a.error("data len is not right ,url = "+this.segment.dataUrl+"range "+this.tsk.range.begin+"-"+this.tsk.range.end),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_progress,this.tsk.data,this.tsk.range.begin,this.tsk.range.end-this.tsk.range.begin));break;case"done":Ir.a.info("load [DONE] ~~range : "+this.tsk.begin+"-"+this.tsk.end+" , index : "+this.segment.index),this.tsk=null,this.checkTask();break;case"error":Ir.a.info("load [error] ~~range : "+this.tsk.begin+"-"+this.tsk.end+" , index-"+this.segment.index+" errDetail-"+t),vd.a.getEvent().emit(this.CDNStateChangeEventID,gd.a.LoaderState_error,gd.a.LoaderState_error_load,t,"")}}},{key:"close",value:function(e){this.tskList=null,this.tsk=null,vd.a.getEvent().off(md.a.DisPatchStatus+this.segment.type),this.dispatcher&&this.dispatcher.clear(),this.dispatcher=null,this.segment=null,this.loader&&(e||this.loader.type===xd.type)&&this.loader.running&&this.loader.close(),this.loader=null,vd.a.getEvent().off(md.a.LoadStatus+this.CDNStateChangeEventID)}},{key:"running",get:function(){return null!==this.segment}},{key:"loadStage",get:function(){return this._loadStage},set:function(e){this._loadStage=e}},{key:"curLoadTskIdx",get:function(){return this.curLoadTskIndex},set:function(e){this.curLoadTskIndex=e}},{key:"doMainName",get:function(){return this.domain}},{key:"dataUrl",get:function(){return this.url}},{key:"curIDC",get:function(){return this.idc}}]),e}(),Cd="",Md=null,Rd="",Bd=/[a-z]/i;var Nd=function(e,t,i){if(e){if(!Bd.test(e)){var a=cr.a.getUserInfoFromCookie(),n={dmnm:e,ips:e,userinfo:a.userInfo,idc:i||a.idc,type:t};return Ir.a.debug("fetch DNSParser"+JSON.stringify(n)),void ur.a.sendPingBack({type:"DNSParser",para:n})}if(Rd=e,Cd="http://"+ur.a.bgpIP.replace("3eb/","")+"3f0/hd.cloud.iqiyi.com/d?dn="+Rd+"&business=pcwPlayer&cross-domain=1",lr.a.isHTTPS&&(Cd=Cd.replace(/^http:/gi,"https:")),lr.a.supportFetch)fetch(Cd).then((function(e){e.status>=400||e.status<200?Ir.a.error("fetch err ,status "+e.status):e.text().then((function(e){var a=cr.a.getUserInfoFromCookie(),n={dmnm:Rd,ips:e,userinfo:a.userInfo,idc:i||a.idc,type:t};Ir.a.debug("fetch DNSParser"+JSON.stringify(n)),ur.a.sendPingBack({type:"DNSParser",para:n})}))}))["catch"]((function(e){"Failed to fetch"===e.message?Ir.a.warn("DNSParser Failed to fetch "):Ir.a.warn("DNSParser fetch err-"+e.message)}));else{(Md=new XMLHttpRequest).responseType="text",Md.onreadystatechange=function(){if(4===Md.readyState){if(200===Md.status&&Md.response){var e=cr.a.getUserInfoFromCookie(),a="";Md.response&&(a=Md.response);var n={dmnm:Rd,ips:a,userinfo:e.userInfo,idc:i||e.idc,type:t};Ir.a.debug("xhr DNSParser"+JSON.stringify(n)),ur.a.sendPingBack({type:"DNSParser",para:n})}Md&&(Md.abort(),Md=null)}};try{Md.open("GET",Cd,!0),Ir.a.info("Xhr DNSParser Xhr url "+Cd),Md.send()}catch(r){Ir.a.error("xhr dns err-"+r.message),Md&&Md.abort()}}}},Fd=i(27),Ud=!1,Vd=!1,Hd=0;function Wd(e){return e<dr.a.dispatchCfg.length?dr.a.dispatchCfg[e]:dr.a.dispatchCfg[dr.a.dispatchCfg.length-1]}function jd(e,t,i){if(dr.g&&dr.g.has(e)&&t)for(var a=dr.g.get(e),n=0;n<a.length;n++)if(t===a[n].URL.split("/")[2]){a[n].errCnt=a[n].errCnt?a[n].errCnt+1:1,a[n].errCnt>=4-a.length&&(a[n].status=i),Ir.a.info("updateCDNUrlStatus ,cdnName : "+t+", errCnt : "+a[n].errCnt+", status : "+i),dr.g.set(e,a);break}}var Gd=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.videoSegment=null,this.loadTaskList=null,this.retryCnt=0,this.speed=0,this.speedLowCnt=0,this.loadTimeForSpeed=-1,this.loadSizeForSpeed=0,this.startTime=0,this.fireError=!1,this.dispatchTimeoutCnt=0,this.cdnTaskLoader=null,this.hitProgress=!1,this.TTFBTimeoutCnt=0,this.rcvTimeoutCnt=0,clearTimeout(this.retryStep),this.retryStep=0,clearTimeout(this.timerStep),this.timerStep=0}},{key:"load",value:function(e,t,i,a){this.fireError||0===t.length||(this.videoSegment=e,this.loadTaskList=t,this.loaderIndex=i,this.urlIndex=a||0,Ud=!1,this.CDNStateChangeEventID=++Hd,this.startTime=Date.now(),clearTimeout(this.retryStep),this.retryStep=0,clearTimeout(this.timerStep),this.timerStep=setTimeout(this.onDispatchTimeOut.bind(this),Wd(this.dispatchTimeoutCnt)),this.cdnTaskLoader=new Ld,vd.a.getEvent().on(this.CDNStateChangeEventID,this.stateChange.bind(this)),this.cdnTaskLoader.load(this.videoSegment,this.loadTaskList,0,this.urlIndex,this.CDNStateChangeEventID),As.addPBItem(fs.cdn_taskCnt))}},{key:"onDispatchTimeOut",value:function(){!this.loadTaskList||this.fireError||this.retryStep>0||(this.dispatchTimeoutCnt++,this.stateChange(gd.a.LoaderState_error,gd.a.LoaderState_error_dispatch,"timeout",Date.now()-this.startTime))}},{key:"onRcvTimeOut",value:function(){!this.loadTaskList||this.fireError||this.retryStep>0||(this.hitProgress?(this.rcvTimeoutCnt++,this.stateChange(gd.a.LoaderState_error,gd.a.LoaderState_error_load,"revTimeout",Date.now()-this.startTime)):(this.TTFBTimeoutCnt++,this.stateChange(gd.a.LoaderState_error,gd.a.LoaderState_error_load,"ttfbTimeout",Date.now()-this.startTime)))}},{key:"stateChange",value:function(e,t,i,a){var n,r;if(!(!this.loadTaskList||this.fireError||this.retryStep>0))switch(e){case gd.a.LoaderState_ready:clearTimeout(this.timerStep),this.timerStep=setTimeout(this.onRcvTimeOut.bind(this),(r=this.TTFBTimeoutCnt)<dr.a.TTFBCfg.length?dr.a.TTFBCfg[r]:dr.a.TTFBCfg[dr.a.TTFBCfg.length-1]);break;case gd.a.LoaderState_progress:clearTimeout(this.timerStep),this.timerStep=setTimeout(this.onRcvTimeOut.bind(this),(n=this.rcvTimeoutCnt)<dr.a.rcvCfg.length?dr.a.rcvCfg[n]:dr.a.rcvCfg[dr.a.rcvCfg.length-1]),this.onProgress(t,i,a);break;case gd.a.LoaderState_done:clearTimeout(this.timerStep),this.timerStep=0,this.onComplete();break;case gd.a.LoaderState_error:clearTimeout(this.timerStep),this.timerStep=0,this.onError(t,i,a)}}},{key:"onProgress",value:function(e,t,i){if(this.hitProgress||(As.addPBItem(fs.cdn_progressCnt),As.addPBItem(fs.cdn_progressTime,Date.now()-this.startTime),this.hitProgress=!0),As.addPBItem(fs.cdn_loadTime,Date.now()-this.startTime),this.startTime=Date.now(),this.loadSizeForSpeed+=i,-1===this.loadTimeForSpeed)this.loadTimeForSpeed=Date.now();else if(Date.now()-this.loadTimeForSpeed>1e3&&(this.speed=Math.ceil(this.loadSizeForSpeed/(Date.now()-this.loadTimeForSpeed)),Ir.a.info("load SPEED(B/S)　：　"+1e3*this.speed+" , Rate : "+this.videoSegment.rate),function(e,t,i){if(dr.g&&dr.g.has(e))for(var a=dr.g.get(e),n=0;n<a.length;n++){var r=a[n].URL.split("/")[2];if(t===r){a[n].speed=i,dr.g.set(e,a);break}}}(this.videoSegment.sourceID,this.cdnTaskLoader.doMainName,this.speed),ur.a.cdnSpeed=this.speed,this.loadSizeForSpeed=0,this.loadTimeForSpeed=Date.now(),this.speed<this.videoSegment.rate?this.speedLowCnt++:this.speedLowCnt--,this.speedLowCnt>5)){Ir.a.info("load lowSpeed ,idc:"+this.cdnTaskLoader.curIDC+",doMainName:"+this.cdnTaskLoader.doMainName),ur.a.cdnSpeed=0,this.speedLowCnt=0,this.speed<this.videoSegment.rate/2&&!Vd&&cr.a.isHit()&&(this.cdnTaskLoader.doMainName?Nd(this.cdnTaskLoader.doMainName,Ed,this.cdnTaskLoader.curIDC):this.videoSegment.dispatchUrl&&Nd(cr.a.getPureIP(this.videoSegment.dispatchUrl),Ed,this.cdnTaskLoader.curIDC),Vd=!0);var a=this.videoSegment.checkP2PHealth();if(a>=3+Math.ceil(this.speed/100))Er.a.loader.message="load-lowSpeed-"+this.videoSegment.idc+"-"+this.videoSegment.ip+"-"+this.videoSegment.sourceID,this.clear(!0),this.videoSegment.setOnP2P(15e3),Ir.a.info("start pure P2P state! health peers : "+a+" , cdnSpeed : "+this.speed+" , byteRate : "+this.videoSegment.rate);else if(this.speed<this.videoSegment.rate/2&&"video"===this.videoSegment.type){Ud=!0;for(var n="",r=0;r<this.loadTaskList.length;r++)n+=this.loadTaskList[r].begin+" - "+this.loadTaskList[r].end+", ";Ir.a.info("lowSpeedFlag ,range, "+n),jd(this.videoSegment.sourceID,this.cdnTaskLoader.doMainName,Ed),vd.a.getEvent().emit(md.a.CdnNodeMgrStateChange+this.videoSegment.type,gd.a.LoaderState_lowSpeed,"",this.loaderIndex)}}if(i>0){if(this.videoSegment.fileType===Fr.a.DASH&&("a0"===this.videoSegment.index||"e0"===this.videoSegment.index)&&0===t){for(var s=0,o=Math.min(50,i);s<o&&0===e[s];)s++;if(s>=o)return Ir.a.error("vp9 load init data is null, "+this.videoSegment.dataUrl),this.stateChange(gd.a.LoaderState_error,gd.a.LoaderState_error_load,"dataError"),Er.a.errorStage="dataNULL",void(Er.a.errorFragment=this)}this.videoSegment.pushData(e,t,i)}}},{key:"onComplete",value:function(){if(this.videoSegment.fileType===Fr.a.FTS){if(Ud)return;this.videoSegment.loadDone=!0}this.videoSegment.clearEndOnP2PTime(),this.hitProgress||(As.addPBItem(fs.cdn_progressCnt),As.addPBItem(fs.cdn_progressTime,Date.now()-this.startTime)),As.addPBItem(fs.cdn_loadTime,Date.now()-this.startTime),this.startTime=Date.now(),ur.a.cdnSpeed=0,this.loadTaskList=null,clearTimeout(this.retryStep),this.retryStep=0,clearTimeout(this.timerStep),this.timerStep=0,this.hitProgress=!1,this.retryCnt=0,this.speed=0,this.speedLowCnt=0,this.loadTimeForSpeed=-1,this.loadSizeForSpeed=0,this.cdnTaskLoader.curLoadTskIdx=0,this.cdnTaskLoader.running&&this.cdnTaskLoader.close(!1)}},{key:"onError",value:function(e,t,i){if(clearTimeout(this.retryStep),this.retryStep=0,this.cdnTaskLoader.running&&this.cdnTaskLoader.close(!0),ur.a.authorFailedStatus!==gd.a.AuthorState_authorOK&&ur.a.authorFailedStatus!==gd.a.AuthorState_reload)return this.clear(!0),dr.g["delete"](this.videoSegment.sourceID),void(this.videoSegment.dataUrl="");switch(e){case gd.a.LoaderState_error_dispatch:Er.a.dispatcher.message="dispatch-"+t+NaN+i+":index = "+this.videoSegment.index+" pos: "+this.videoSegment.startPos+"-"+this.videoSegment.endPos,this.videoSegment.dispatchOnError===undefined&&(this.videoSegment.dispatchOnError=0),this.videoSegment.dispatchOnError+=1,""===ur.a.bgpIP_1&&xr.loadBGPIP(),Ir.a.error("load [Error] type : "+e+" , detail : "+t+" , retryCnt "+this.retryCnt+", msg : "+i+" ,loaderIndex : "+this.loaderIndex),3===this.videoSegment.dispatchOnError&&this.videoSegment.dispatchUrl&&Nd(cr.a.getPureIP(this.videoSegment.dispatchUrl),Dd);break;case gd.a.LoaderState_error_load:if(this.cdnTaskLoader){var a=dr.g.get(this.videoSegment.sourceID);(a&&a.length<=1&&3===this.retryCnt||a.length>=3||2===a.length&&(2===this.retryCnt||5===this.retryCnt))&&Nd(this.cdnTaskLoader.doMainName,Dd,this.cdnTaskLoader.curIDC)}t===gd.a.LoaderState_dataRangeError&&(dr.g["delete"](this.videoSegment.sourceID),this.videoSegment.clearData(this.loadTaskList[0].begin,this.loadTaskList[this.loadTaskList.length-1].end)),"dataError"===t&&this.videoSegment.clearData(this.loadTaskList[0].begin,this.loadTaskList[this.loadTaskList.length-1].end),"statusErr-405"===t&&dr.g["delete"](this.videoSegment.sourceID),"isPointNot80|443"===t&&function(e,t){for(var i=dr.g.get(e),a=cr.a.getUserInfoFromCookie(),n=0;n<i.length;n++)i[n].URL=cr.a.getNewUrl(t,a.userNetType,a.userArea),i[n].URL+="&qd=b";dr.g.set(e,i)}(this.videoSegment.sourceID,this.videoSegment.dispatchUrl),"lowSpeed"!==t&&"tryCatchError"!==t&&this.cdnTaskLoader&&(jd(this.videoSegment.sourceID,this.cdnTaskLoader.doMainName,Dd),function(e,t){var i=e+"|"+t,a=Ad.get(i);a?Ad.set(i,{total:a.total,failcnt:a.failcnt+1}):Ad.set(i,{total:0,failcnt:1})}(this.cdnTaskLoader.doMainName,this.cdnTaskLoader.curIDC)),0===Kd(this.videoSegment.sourceID)&&dr.g["delete"](this.videoSegment.sourceID),ur.a.cdnSpeed=0,Er.a.loader.message="load-"+t+" message- "+i+" idc - "+this.videoSegment.idc+"-"+this.videoSegment.ip+" index- "+this.videoSegment.index+" pos: "+this.videoSegment.startPos+"-"+this.videoSegment.endPos,this.cdnTaskLoader&&-1===this.videoSegment.errIDCList.indexOf(this.cdnTaskLoader.curIDC)&&this.videoSegment.errIDCList.push(this.cdnTaskLoader.curIDC),Ir.a.error("load [Error] range url : "+(this.cdnTaskLoader?this.cdnTaskLoader.dataUrl:null)+" , type : "+e+" , detail : "+t+" , retryCnt : "+this.retryCnt+" , msg : "+i+" ,loaderIndex : "+this.loaderIndex);break;default:Ir.a.error("load [Error] type : "+e+" , detail : "+t+" , retryCnt : "+this.retryCnt+" , msg : "+i)}if(clearTimeout(this.timerStep),this.timerStep=0,this.hitProgress=!1,this.videoSegment.checkP2PHealth()>=4)return Ir.a.info("load [Error],start pure P2P state,url "+this.cdnTaskLoader.dataUrl),this.clear(!0),void this.videoSegment.setOnP2P(15e3);if(this.speed=0,this.speedLowCnt=0,this.loadTimeForSpeed=-1,this.loadSizeForSpeed=0,this.retryCnt++,this.retryCnt>dr.a.dispatchCfg.length){this.retryCnt=0;var n=ur.a.getBufferFunc();(this.videoSegment.fileType.indexOf(Fr.a.M4S)>=0?Math.min(n.buffered.video.len,n.buffered.audio.len):n.len)<2?(this.cdnTaskLoader.running&&this.cdnTaskLoader.close(!0),this.videoSegment.recycleCDNTask(this.loadTaskList),this.loadTaskList=null,this.fireError=!0,Ir.a.error("load [FINAL Error] !!!, loaderIndex "+this.loaderIndex),vd.a.getEvent().emit(md.a.CdnNodeMgrStateChange+this.videoSegment.type,e,t,this.loaderIndex)):this.retryStep=setTimeout(this.reLoad.bind(this),2e3)}else this.retryStep=setTimeout(this.reLoad.bind(this),2e3)}},{key:"reLoad",value:function(){var e;(clearTimeout(this.retryStep),this.retryStep=0,!this.loadTaskList||this.cdnTaskLoader.curLoadTskIndex-1>=this.loadTaskList.length)||(this.startTime=Date.now(),this.videoSegment&&(this.cdnTaskLoader.curLoadTskIdx>0&&this.cdnTaskLoader.curLoadTskIdx--,e=this.videoSegment.fileType!==Fr.a.FTS?this.videoSegment.checkTask(this.loadTaskList[0].begin,this.loadTaskList[this.loadTaskList.length-1].end):[{begin:this.loadTaskList[0].begin,end:this.loadTaskList[this.loadTaskList.length-1].end}]),e&&0!==e.length?(As.addPBItem(fs.cdn_taskCnt),this.loadTaskList=e,this.urlIndex=null,this.videoSegment.fileType===Fr.a.FTS&&(this.videoSegment.segment.dataLen=0,Ud=!1),clearTimeout(this.timerStep),this.timerStep=setTimeout(this.onDispatchTimeOut.bind(this),Wd(this.dispatchTimeoutCnt)),Ir.a.warn("reLoad !!!!!!!!!!!~~"+JSON.stringify(e)+", loaderIndex : "+this.loaderIndex+", retryCnt : "+this.retryCnt),this.cdnTaskLoader.load(this.videoSegment,this.loadTaskList,this.retryCnt,this.urlIndex,this.CDNStateChangeEventID)):this.onComplete())}},{key:"clear",value:function(e){this.loadTaskList&&this.videoSegment.recycleCDNTask(this.loadTaskList),this.loadTaskList=null,clearTimeout(this.retryStep),this.retryStep=0,clearTimeout(this.timerStep),this.timerStep=0,this.hitProgress=!1,this.startTime=0,this.retryCnt=0,this.speed=0,this.speedLowCnt=0,this.loadTimeForSpeed=-1,this.loadSizeForSpeed=0,this.cdnTaskLoader&&(this.cdnTaskLoader.curLoadTskIdx=0,this.cdnTaskLoader.running&&this.cdnTaskLoader.close(!0)),e||(this.fireError=!1),this.loaderIndex=-1,vd.a.getEvent().off(this.CDNStateChangeEventID)}},{key:"mssNodeReset",value:function(){this.retryCnt=0,this.speed=0,this.speedLowCnt=0,this.loadTimeForSpeed=-1,this.loadSizeForSpeed=0,this.startTime=0,this.fireError=!1,this.dispatchTimeoutCnt=0,clearTimeout(this.retryStep),this.retryStep=0,clearTimeout(this.timerStep),this.timerStep=0,this.hitProgress=!1,this.TTFBTimeoutCnt=0,this.rcvTimeoutCnt=0,this.cdnTaskLoader&&(this.cdnTaskLoader.curLoadTskIdx=0,this.cdnTaskLoader.running&&this.cdnTaskLoader.close(!0)),vd.a.getEvent().off(this.CDNStateChangeEventID)}},{key:"getSpeed",value:function(){return this.speed}},{key:"running",get:function(){return null!==this.loadTaskList}},{key:"loadStage",get:function(){return this.cdnTaskLoader.loadStage},set:function(e){this.cdnTaskLoader.loadStage=e}},{key:"isError",get:function(){return this.fireError}}]),e}();function zd(e,t){var i=[];if(dr.g&&dr.g.has(e))for(var a=dr.g.get(e),n=-1,r=-1,s=0;s<a.length;s++)1!==t&&t?a[s].status||i.push(s):(a[s].status||(a[s].speed&&a[s].speed>n?(n=a[s].speed,r=s):a[s].speed||-1!==r||(r=s)),s>=a.length-1&&i.push(r));return i}function Kd(e){var t=0;if(dr.g&&dr.g.has(e))for(var i=dr.g.get(e),a=0;a<i.length;a++)i[a].status||t++;return t}var Yd=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.loadTaskList=null,this.segment&&(this.resetLoader(),vd.a.getEvent().off(md.a.CdnNodeMgrStateChange+this.segment.type)),this.segment=null,this.loaderList=[]}},{key:"resetLoader",value:function(){for(var e=0;e<this.loaderList.length;e++)this.loaderList[e]&&(this.loaderList[e].clear(!1),this.loaderList[e]=null)}},{key:"load",value:function(e,t){if(!this.loadTaskList&&!this.fireError&&0!==t.length){this.segment=e,this.loadTaskList=t,vd.a.getEvent().on(md.a.CdnNodeMgrStateChange+this.segment.type,this.stateChange.bind(this));var i=new Gd;this.loaderList.push(i),i.load(this.segment,this.loadTaskList,-1)}}},{key:"stateChange",value:function(e,t,i){var a=this;if(this.segment&&this.loadTaskList){var n=function(){switch(e){case gd.a.LoaderState_lowSpeed:if(a.loaderList.length>1)return Ir.a.info("already in MSS status"),{v:void 0};if(!dr.g.get(a.segment.sourceID))return{v:void 0};var n=a.checkTastList(),r=zd(a.segment.sourceID,n.loaderNum);if(n.loaderNum<=1||r.length<=1)return Ir.a.info("check MSS load , current dataLen is need 1 loader,so not open MSS "),{v:void 0};var s=0;for(s=0;s<a.loaderList.length;s++)a.loaderList[s].mssNodeReset();s=0;for(var o=function(){a.loaderList[s]||a.loaderList.push(new Gd);var e=null;e=s<n.loaderNum-1?n.tastList.slice(s,++s):n.tastList.slice(s++);for(var t="",i=0;i<e.length;i++)t+=e[i].begin+" - "+e[i].end+", ";var o=a;!function(e,t,i){setTimeout((function(){o.loaderList[t-1]?(Ir.a.info("start MSS load , loaderIndex "+(t-1)+",loadRange "+i),o.loaderList[t-1].load(o.segment,e,t-1,r[t-1])):Ir.a.info("MSS load is null, loaderIndex "+(t-1)+", loaderLen "+this.loaderList.length)}),50*(t-1))}(e,s,t)};s<n.loaderNum;)o();break;case gd.a.LoaderState_error_dispatch:case gd.a.LoaderState_error_load:for(var d=!0,u=0;u<a.loaderList.length;u++)if(!a.loaderList[u].isError){d=!1;break}d?a.cdnFinalErrFun(e,t):a.loaderList[i<0?0:i].clear(!0)}}();return"object"===I()(n)?n.v:void 0}}},{key:"cdnFinalErrFun",value:function(e,t){Ir.a.error("all  loader [FINAL Error]!!!!!!!!!!!!!!!!"),Od(!0),e===gd.a.LoaderState_error_dispatch?Er.a.errorStage="dispatch":t===gd.a.LoaderState_dataRangeError?Er.a.errorStage=t:Er.a.errorStage="load",As.check({rec:"fail",etyp:Er.a.errorStage,info:Er.a.loader.message}),Er.a.errorFragment=this}},{key:"checkTastList",value:function(){this.segment.fileType!==Fr.a.FTS&&(this.loadTaskList=this.segment.checkTask(this.loadTaskList[0].begin,this.loadTaskList[this.loadTaskList.length-1].end));for(var e=0,t="",i=0;i<this.loadTaskList.length;i++)e+=this.loadTaskList[i].end-this.loadTaskList[i].begin,t+=this.loadTaskList[i].begin+" - "+this.loadTaskList[i].end+", ";var a=Kd(this.segment.sourceID);if(0===a||1===a)return{loaderNum:a,tastList:this.loadTaskList};var n=Math.min(Math.max(1,Math.floor(e/1048576)),a);if(Ir.a.info("MSS loader checkTastList, NeedLoaderLen "+e+", needLoaderNum "+n+", tastList "+t),n<=this.loadTaskList.length)return{loaderNum:n,tastList:this.loadTaskList};for(var r=[],s=Math.ceil(e/n),o=this.loadTaskList[0].begin,d=0,u=0;u<n;u++)d<this.loadTaskList.length&&(o+s<=this.loadTaskList[d].end?(r.push({begin:o,end:o+s}),o+=s):(r.push({begin:o,end:this.loadTaskList[d].end}),o=this.loadTaskList[d].end),o>=this.loadTaskList[d].end&&++d<this.loadTaskList.length&&(o=this.loadTaskList[d].begin));for(;d<this.loadTaskList.length;)o<this.loadTaskList[d].end&&r.push({begin:o,end:this.loadTaskList[d].end}),o=this.loadTaskList[d].end,++d<this.loadTaskList.length&&(o=this.loadTaskList[d].begin);return Ir.a.info("MSS loader split tast res ,  "+JSON.stringify(r)),{loaderNum:n,tastList:r}}},{key:"running",get:function(){if(!this.loaderList)return!1;for(var e=0;e<this.loaderList.length;e++)if(this.loaderList[e].running)return!0;return this.reset(),!1}}]),e}(),Qd=new Yd,Jd=new Yd;function Xd(e,t,i){var a="",n=parseInt(i.substring(1));return a=n>=16?cr.a.sliceStr(e+t,5)+i.substring(0,1)+n.toString(16):cr.a.sliceStr(e+t,5)+i.substring(0,1)+"0"+n.toString(16),parseInt("0x"+a)}var Zd,$d,eu,tu,iu,au=function(){function e(t){n()(this,e),this.dispatchUrl=t.dispatchUrl,this.tvid=t.tvid,this.rate=t.levelId,this.vids=t.vids,this.vid=t.vid,this.albumID=t.albumID.toString(),this.sourceID=t.sourceID,this.index=t.index,this.type=t.trackerType,this.startPos=t.startPos,this.endPos=t.endPos,this.size=t.size,this.lastCEPos=-1,this.startTime=t.startTime<0?0:t.startTime,this.endTime=t.endTime<0?864e5:t.endTime,this.endOnP2PTime=0,this.fileType=t.videoType,this.realIdx=t.realSegIdx,this.alias=Xd(this.sourceID,this.vid,this.realIdx),this.fragmentName=this.alias+"_"+this.index+"|"+this.showStartTime+"-"+this.showEndTime,this.idc="",this.ip="",this.errIDCList=[],""!==this.albumID&&"0"!==this.albumID&&this.albumID!==undefined&&0!==this.albumID?this.p2pID=parseInt("0x"+hs()(this.albumID).substr(0,10)).toString():""!==this.tvid&&"0"!==this.tvid&&this.tvid!==undefined&&0!==this.tvid?this.p2pID=parseInt("0x"+hs()(this.tvid).substr(0,10)).toString():this.p2pID=this.vid}return s()(e,[{key:"updateDispatchUrl",value:function(e){this.dispatchUrl=e}},{key:"checkCreateSegment",value:function(){if(this.segment){if(this.segment.alias===this.alias&&this.segment.size===this.size){0!==this.segment.state&&(this.segment.state=0);var e=this;return this.segment.refreshFun=function(){e&&e.refreshBuffer.call(e)},Ir.a.info("segment is exit"),this.segment.setRange(this.startPos,this.endPos),void(this.seekable&&this.segment.setPosList(this.seekable))}Ir.a.info("segment is exit,but size or alias is match,so remove"),Yr.removeSegment(this.alias)}var t=new pd(this.size,this.tvid,this.sourceID,this.albumID,this.realIdx,this.alias,this.vid,this.p2pID,this.rate,this.vids,this.fileType,this.seekable);Yr.setSegment(this.alias,t);var i=this;this.segment.refreshFun=function(){i&&i.refreshBuffer.call(i)},this.segment.setRange(this.startPos,this.endPos)}},{key:"loadData",value:function(e,t){if(this.segment){0!==this.segment.state&&(this.segment.state=0),this.fileType===Fr.a.FTS&&(this.segment.dataLen=0);var i=this.checkTask(e,t);if(0===i.length)return this.segment.checkData(),void Ir.a.info("data is already have,not need load~~~ "+this.index+" : "+e+"-"+t+" state: "+this.segment.state+" cePos "+this.segment.cePos+",curCEPos "+this.lastCEPos);"video"===this.type?(Ir.a.info("after checkTask ,video loadPoint  range = "+JSON.stringify(i)),Qd.load(this,i)):(Ir.a.info("after checkTask ,audio loadPoint  range = "+JSON.stringify(i)),Jd.load(this,i))}}},{key:"p2pLoadSegment",value:function(){"video"===this.type&&this.segment&&this.segment.dataErrCount<10&&Yr.setLoadSegment(this.alias)}},{key:"setOnP2P",value:function(e){this.endOnP2PTime=e+Date.now(),this.type===Fd.a.VIDEO&&(Yd.loadStage="P2P")}},{key:"clearEndOnP2PTime",value:function(){this.endOnP2PTime=-1}},{key:"checkTask",value:function(e,t){return this.segment?this.fileType===Fr.a.FTS?[{begin:e,end:t}]:this.segment.checkTask(e,t):(Ir.a.error("checkTask return null,because of segment is null"),null)}},{key:"checkP2PHealth",value:function(){return this.segment?this.segment.checkP2PHealth():0}},{key:"clearData",value:function(e,t){this.segment&&this.segment.deleteRange(e,t-e)}},{key:"updateLoadRange",value:function(e,t){this.segment&&this.segment.setRange(e,t)}},{key:"setTrackerIP",value:function(e){ad&&(ad.hasProxyByIPInfo(e)?ad.getProxyByIPInfo(e).id=this.p2pID:ad.startProxy(this.p2pID,e))}},{key:"recycleCDNTask",value:function(e){this.segment&&this.segment.recycleCDNTask(e)}},{key:"refreshBuffer",value:function(){this.segment&&(-1!==this.endPos?this.lastCEPos=Math.min(this.segment.cePos,this.endPos):this.lastCEPos=this.segment.cePos)}},{key:"updateCePos",value:function(e){this.segment?this.lastCEPos=e:this.lastCEPos=-1}},{key:"onTracker",get:function(){return ad.hasProxyByID(this.p2pID)}},{key:"isOnP2P",get:function(){return this.endOnP2PTime>0&&Date.now()<=this.endOnP2PTime}},{key:"segment",get:function(){return Yr.getSegment(this.alias)}},{key:"dataUrl",get:function(){return this.segment.dataUrl},set:function(e){this.segment.dataUrl=e}},{key:"done",get:function(){return!!this.segment&&(this.fileType===Fr.a.M4S||this.fileType===Fr.a.DASH||this.fileType===Fr.a.TS?this.segment.done:this.fileType===Fr.a.FTS?this.segment.tsLoadDone:void 0)}}]),e}(),nu=function(e){function t(e,i){return n()(this,t),d()(this,c()(t).call(this,e,i))}return f()(t,e),s()(t,[{key:"pushData",value:function(e,t,i){return this.segment?(this.segment.addData(t,e,i),As.cdnSize=i+As.cdnSize,this.segment.peerMgr&&(this.segment.peerMgr.cdnSize=i+this.segment.peerMgr.cdnSize),!0):(Ir.a.error("pushData segment is null"),!0)}}]),t}(au),ru=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,i))).loadInfo=e.loadInfo,a}return f()(t,e),s()(t,[{key:"pushData",value:function(e,t,i){if(!this.segment)return Ir.a.error("pushData segment is null"),!0;var a=t-this.loadInfo.startPos,n=e.byteLength;return this.segment.addData(a,e,n),As.cdnSize=i+As.cdnSize,this.segment.peerMgr&&(this.segment.peerMgr.cdnSize=n+this.segment.peerMgr.cdnSize),!0}},{key:"loadDone",set:function(e){this.segment.tsLoadDone=e},get:function(){return this.segment.tsLoadDone}}]),t}(au),su=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,i))).seekable=e.seekable,a}return f()(t,e),s()(t,[{key:"pushData",value:function(e,t,i){return!this.segment||(this.segment.addData(t,e,i),this.type===Fd.a.VIDEO&&(As.cdnSize=i+As.cdnSize),this.segment.peerMgr&&this.type===Fd.a.VIDEO&&(this.segment.peerMgr.cdnSize=i+this.segment.peerMgr.cdnSize),!0)}},{key:"dataLen",get:function(){return this.segment.dataLen}}]),t}(au),ou=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.time=0,this.bid=0,this.segmentIndex=0,this.chunkIndex=0,this.chunkPos=0,this.dataFlag=!1}}]),e}(),du=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.levelID=-1,this.startTime=0,this.segmentIndex=0,this.chunkIndex=0,this.chunkPos=0,this.cEndTime=0,this.endPos=0,this.init=!1}}]),e}(),uu=function(){function e(){n()(this,e),this.reset()}return s()(e,[{key:"reset",value:function(){this.levelID=-1,this.segmentIndex=0,this.chunkIndex=0,this.time=0,this.tvid=0}}]),e}(),cu=!1,lu=!1,hu=!1,_u=new uu,fu=new uu,pu=!0,gu=0,mu=!1,vu=Date.now(),bu=function(){function e(){n()(this,e),this.dashInfo=null,this.levelMgr=null,this._levelID=0,this._absStrategy=null,this._readPointer=null,this._loadPointer=null,this._readAudioPointer=null,this._loadAudioPointer=null,this._p2pLoaderPointer=null,this.curLoadSegment=null,this.curLoadAudioSegment=null,this.videoFormatType=null,this.rangeSTime=-1,this.rangeETime=-1,this.audioDone=!1,this.videoDone=!1,this.absTocbs=!1,this.fetchDashStep=0,this.event=null}return s()(e,[{key:"resetDoneStatus",value:function(){this.videoDone=!1,this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||(this.audioDone=!1)}},{key:"refreshLoadRange",value:function(e){e[0][1]>this.rangeETime&&this.done&&this.resetDoneStatus(),this.rangeSTime=e[0][0],this.rangeETime=e[0][1],Ir.a.info("refreshLoadRange time ,start "+this.rangeSTime+", end "+this.rangeETime)}},{key:"feed",value:function(e,t,i,a,n){ur.a.tvId=this.tvid=i.tvid,this.event?this.event.clear():this.event=vd.a.newEvent(),null===this.levelMgr&&(this.levelMgr=new wr),this.event.on(md.a.UpdateDash,this.updateLevelInfo.bind(this)),this.dashInfo&&this.dashInfo.tvid===i.tvid?this.dashInfo.init(e,i,a,n,self):(this.levelMgr.clear(),this.dashInfo=new Dr.a(e,i,a,n)),this.rangeSTime=t[0][0],this.rangeETime=t[0][1],Ir.a.info("feed time range ,start "+this.rangeSTime+", end "+this.rangeETime+",Type "+this.dashInfo.videoFormatType),ur.a.fileType=this.videoFormatType=this.dashInfo.videoFormatType}},{key:"fetchABSDashInfo",value:function(){if(!ur.a.startPlayed())return clearTimeout(this.fetchDashStep),void(this.fetchDashStep=setTimeout(this.fetchABSDashInfo.bind(this),2e3));_u.tvid!==this.tvid&&(-1!==_u.levelID&&_u.reset(),-1!==fu.levelID&&fu.reset());for(var e=this.dashInfo.bitRateList,t=0;t<e.length;t++)cr.a.isUGC(this.tvid)&&200===e[t]||100!==e[t]&&(this.dashInfo.dashInfoMap.has(e[t])||this.dashInfo.FetchBitRateFileInfo(e[t]))}},{key:"checkBitRate",value:function(e){if(null===this.dashInfo)return null;-1===this._levelID?(null===this._absStrategy&&(this._absStrategy=new os),this.fetchDashStep=setTimeout(this.fetchABSDashInfo.bind(this),2e3)):(null!==this._absStrategy&&(this._absStrategy.close(),this._absStrategy=null),_u.tvid===this.tvid&&(-1!==_u.levelID&&_u.reset(),-1!==fu.levelID&&fu.reset()),this.dashInfo.dashInfoMap.has(e)||this.dashInfo.FetchBitRateFileInfo(e,this))}},{key:"seek",value:function(e,t){0===this.levelID&&Ir.a.error("need set bitrate first!"),hu=!1;var i=this.levelID;null===this.dashInfo&&Ir.a.error("need feed first!"),(e<0||e===undefined)&&(e=this.rangeSTime);var a=!1;-1===this._levelID&&this.curLoadSegment&&this.curLoadSegment.rate!==i&&this.levelMgr.has(this.curLoadSegment.rate)&&(i=this.curLoadSegment.rate),-1===this._levelID&&this._readPointer&&this._readPointer.bid!==i&&(a=!0),t||(_u.reset(),fu.reset()),$d=!0,pu=!0,this.absTocbs=!1;var n=this.levelMgr.get(i);if(n||Ir.a.error(" while seek ,levelInfo is null ,bid "+i),e>=n.duration)return hu=!0,void(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(this.videoDone=!0,this.audioDone=!0):this.videoDone=!0);var r=null;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?r=Ar.a.getGapPos(n,e,Fd.a.VIDEO,"start"):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(r=Ar.a.getTSGapPos(n,e,"start")),null!==r){this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||Jd.reset(),Qd.reset(!1),cu=!0,this.resetDoneStatus(),tu=Date.now(),e<this.rangeSTime?(this.rangeSTime=e,Ir.a.info("seek update time start  range ,start "+this.rangeSTime+", end "+this.rangeETime)):e>this.rangeETime&&(this.rangeETime=Math.min(n.duration,this.rangeETime),Ir.a.info("seek update time end range ,start "+this.rangeSTime+", end "+this.rangeETime)),null===this._readPointer&&(this._readPointer=new ou);var s=this._readPointer.segmentIndex;if(this.changeSegmentState(n,"e",r.segmentIndex,0),Ir.a.info("seek update readPointer call changeSegmentState set 0 : e"+r.segmentIndex),this._readPointer.time=r.time,this._readPointer.segmentIndex=r.segmentIndex,this._readPointer.chunkIndex=r.chunkIndex,-1===this._levelID&&0!==this._readPointer.bid&&this._readPointer.bid!==i?this._readPointer.bid=this._readPointer.bid:this._readPointer.bid=i,a&&(_u.time=this._readPointer.time,_u.tvid=this.tvid,_u.levelID=i,_u.segmentIndex=this._readPointer.segmentIndex,_u.chunkIndex=this._readPointer.chunkIndex,iu=!0,Ir.a.info("seek cause switchVideoPointer ,"+JSON.stringify(_u))),this.videoFormatType===Fr.a.FTS?this._readPointer.chunkPos=0:this._readPointer.chunkPos=r.pos,s!==this._readPointer.segmentIndex&&(this.changeSegmentState(n,"e",s,1),Ir.a.info("seek update readPointer call changeSegmentState set 1 : e"+s)),null===this._loadPointer?(this._loadPointer=new du,this.videoFormatType===Fr.a.DASH&&(this._loadPointer.init=!0)):this.videoFormatType!==Fr.a.DASH||this.hasInitData(i,Fd.a.VIDEO)||(this._loadPointer.init=!0),this._loadPointer.startTime=r.time,this._loadPointer.cEndTime=r.time,this._loadPointer.segmentIndex=r.segmentIndex,this._loadPointer.chunkIndex=r.chunkIndex,this._loadPointer.chunkPos=r.pos,this._loadPointer.levelID=i,this._p2pLoaderPointer||(this._p2pLoaderPointer=new du),this._p2pLoaderPointer.levelID=i,this.curLoadSegment){var o=parseInt(this.curLoadSegment.index.slice(1));this._loadPointer.segmentIndex!==o?(this.changeSegmentState(n,"e",o,1),Ir.a.info("seek update loadPointer call changeSegmentState set 1 : e"+o)):(this.curLoadSegment.updateCePos(r.pos),this.curLoadSegment.updateLoadRange(this._loadPointer.chunkPos,this.curLoadSegment.endPos))}if(-1===this._levelID&&(eu=r.chunkIndex),this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){var d=Ar.a.getGapPos(n,e,Fd.a.AUDIO,"start");if(null===d)Ir.a.error("Dash.seek fetch audio start point is null,time = "+e);else{null===this._loadAudioPointer?(this._loadAudioPointer=new du,this.videoFormatType===Fr.a.DASH&&(this._loadAudioPointer.init=!0)):this.videoFormatType!==Fr.a.DASH||this.hasInitData(i,Fd.a.AUDIO)||(this._loadAudioPointer.init=!0),this.changeSegmentState(n,"a",d.segmentIndex,0),Ir.a.info("seek call changeSegmentState set 0 : a"+d.segmentIndex);var u=this._loadAudioPointer.segmentIndex;this._loadAudioPointer.startTime=d.time,this._loadAudioPointer.cEndTime=d.time,this._loadAudioPointer.segmentIndex=d.segmentIndex,this._loadAudioPointer.chunkIndex=d.chunkIndex,this._loadAudioPointer.chunkPos=d.pos,this._loadAudioPointer.levelID=i,a&&(fu.time=this._loadAudioPointer.startTime,fu.tvid=this.tvid,fu.levelID=i,fu.segmentIndex=this._loadAudioPointer.segmentIndex,fu.chunkIndex=this._loadAudioPointer.chunkIndex,mu=!0,Ir.a.info("seek cause switchAudioPointer ,"+JSON.stringify(fu))),u!==this._loadAudioPointer.segmentIndex&&(this.changeSegmentState(n,"a",u,1),Ir.a.info("seek loadAudioPointer call changeSegmentState set 1 : a"+u)),null===this._readAudioPointer&&(this._readAudioPointer=new ou);var c=this._readAudioPointer.segmentIndex;this._readAudioPointer.time=d.time,this._readAudioPointer.segmentIndex=d.segmentIndex,this._readAudioPointer.chunkIndex=d.chunkIndex,this._readAudioPointer.chunkPos=d.pos,-1===this._levelID&&0!==this._readAudioPointer.bid&&this._readAudioPointer.bid!==i?this._readAudioPointer.bid=this._readAudioPointer.bid:this._readAudioPointer.bid=i,c!==this._readAudioPointer.segmentIndex?(this.changeSegmentState(n,"a",c,1),Ir.a.info("seek call changeSegmentState 1, a"+c)):this.curLoadAudioSegment&&(this.curLoadAudioSegment.updateCePos(d.pos),this.curLoadAudioSegment.updateLoadRange(this._loadAudioPointer.chunkPos,this.curLoadAudioSegment.endPos))}}ur.a.dashUpdateVideoTime>0&&(ur.a.authorFailedStatus=gd.a.AuthorState_authorOK,ur.a.dashUpdateVideoTime=0)}else Ir.a.error("Dash.seek fetch video start point is null,time = "+e)}},{key:"read",value:function(e){if(vu=Date.now(),null===this._readPointer&&(this._readPointer=new ou),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||null!==this._readAudioPointer||(this._readAudioPointer=new ou),null!==this.levelMgr){var t=!1,i=!1,a=!1,n=!1,r=!1;if(this.absTocbs)Ir.a.info("abs switch cbs ing,so wait switch finished start read");else if(!cu){if(0===this._readPointer.bid&&(this._readPointer.bid=this.levelID),this._readAudioPointer&&0===this._readAudioPointer.bid&&(this._readAudioPointer.bid=this.levelID),this._readPointer.time>=ur.a.dashUpdateVideoTime&&ur.a.authorFailedStatus===gd.a.AuthorState_reload&&$d){if(!ur.a.canSwitchVd())return void Ir.a.info("playback not allow switch level");var s=this.levelMgr.get(this._readPointer.bid),o=null;this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?((o=Ar.a.getGapPos(s,this._readPointer.time,Fd.a.VIDEO,"start"))&&(this._readPointer.segmentIndex=o.segmentIndex,this._readPointer.chunkIndex=o.chunkIndex,this._readPointer.chunkPos=o.pos,this._readPointer.time=o.time),(o=Ar.a.getGapPos(s,this._readAudioPointer.time,Fd.a.AUDIO,"start"))&&(this._readAudioPointer.segmentIndex=o.segmentIndex,this._readAudioPointer.chunkIndex=o.chunkIndex,this._readAudioPointer.chunkPos=o.pos,this._readAudioPointer.time=o.time)):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(o=Ar.a.getTSGapPos(s,this._readPointer.time,"start"))&&(this._readPointer.segmentIndex=o.segmentIndex,this._readPointer.chunkIndex=o.chunkIndex,this._readPointer.time=o.time,this.videoFormatType===Fr.a.FTS&&(this._readPointer.chunkPos=0)),ur.a.dashUpdateVideoTime=0,ur.a.authorFailedStatus=gd.a.AuthorState_authorOK;var d=this.dashInfo.dashInfoMap.get(this._readPointer.bid);if(d)return Ir.a.info("Authentication ,notice pcw bid "+this._readPointer.bid+", time "+this._readPointer.time),ur.a.dashUpdatedFunc({streamInfo:d,levelID:this._readPointer.bid}),this._readPointer.dataFlag=!1,void(this._readAudioPointer&&(this._readAudioPointer.dataFlag=!1));Ir.a.error("Authentication ,notice pcw , curStreamInfo is null "+this._readPointer.bid)}if(-1===this._levelID&&-1!==_u.levelID&&(this.videoFormatType.indexOf(Fr.a.TS)>=0||(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&-1!==fu.levelID)&&(this._readPointer.time>=_u.time&&$d&&(t=!0),!t&&_u.time>this._readPointer.time&&(n=!0),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||(this._readAudioPointer.time>=fu.time&&pu&&(i=!0),!i&&fu.time>this._readAudioPointer.time&&(r=!0)),t&&(this.videoFormatType.indexOf(Fr.a.TS)>=0||(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&i))){if(!ur.a.canSwitchVd())return void Ir.a.debug("playback not allow switch level");a=!0,iu||(this.changeSegmentState(this.levelMgr.get(this._readPointer.bid),"e",this._readPointer.segmentIndex,1),iu=!1),this._readPointer.bid=_u.levelID,this._readPointer.segmentIndex=_u.segmentIndex,this._readPointer.chunkIndex=_u.chunkIndex,this._readPointer.time=_u.time;var u=this.levelMgr.get(this._readPointer.bid);if(u?(L=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getChunkSEPos(u,Fd.a.VIDEO,this._readPointer.segmentIndex,this._readPointer.chunkIndex):Ar.a.getTSChunkSEPos(u,this._readPointer.segmentIndex,this._readPointer.chunkIndex))?this.videoFormatType===Fr.a.FTS?this._readPointer.chunkPos=0:this._readPointer.chunkPos=L.sPos:Ir.a.error("switch readPointer chunkGapPos is null ,bid  "+JSON.stringify(this._readPointer)):Ir.a.error("switch readPointer levelInfo is null ,bid  "+this._readPointer.bid),Ir.a.info("read Video pointer switch level "+JSON.stringify(this._readPointer)),_u.reset(),this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){mu||(this.changeSegmentState(this.levelMgr.get(this._readAudioPointer.bid),"a",this._readAudioPointer.segmentIndex,1),mu=!1),this._readAudioPointer.bid=fu.levelID,this._readAudioPointer.segmentIndex=fu.segmentIndex,this._readAudioPointer.chunkIndex=fu.chunkIndex,this._readAudioPointer.time=fu.time;var c=Ar.a.getChunkSEPos(u,Fd.a.AUDIO,this._readAudioPointer.segmentIndex,this._readAudioPointer.chunkIndex);if(c)this._readAudioPointer.chunkPos=c.sPos;else{Ir.a.error("switch readAudioPointer audioChunkPos is null");var l=Ar.a.getGapPos(u,fu.time,Fd.a.AUDIO,"start");l?(this._readAudioPointer.segmentIndex=l.segmentIndex,this._readAudioPointer.chunkIndex=l.chunkIndex,this._readAudioPointer.chunkPos=l.pos,this._readAudioPointer.time=l.time):Ir.a.error("switch readAudioPointer startGap is null ")}Ir.a.info("read Audio pointer switch level "+JSON.stringify(this._readAudioPointer)),fu.reset()}var h=this.dashInfo.dashInfoMap.get(this._readPointer.bid);if(h)return Ir.a.info("ABS switch bid ,notice pcw ,"+this._readPointer.bid),ur.a.dashUpdatedFunc({streamInfo:h,levelID:this._readPointer.bid}),this._readPointer.dataFlag=!1,void(this._readAudioPointer&&(this._readAudioPointer.dataFlag=!1));Ir.a.error("ABS switch bid ,notice pcw , curStreamInfo is null "+this._readPointer.bid)}if(-1===this._levelID||this._readPointer.bid===this._levelID){var _=this.levelMgr.get(this._readPointer.bid);if(_!==undefined){var f=null,p=null,g=null;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(p=(f=Ar.a.getFilesInfo(_,Fd.a.VIDEO))[this._readPointer.segmentIndex].seekable.time,g=f[this._readPointer.segmentIndex].seekable.pos):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(p=(f=_.m3u8)[this._readPointer.segmentIndex].time,g=f[this._readPointer.segmentIndex].pos),hu){if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){var m=yu(f,f.length-1,f[f.length-1].seekable.pos.length-1),v=Ar.a.getFilesInfo(_,Fd.a.AUDIO),b=yu(v,v.length-1,v[v.length-1].seekable.pos.length-1);return{tvid:this.tvid,bid:this._readPointer.bid,loadDone:this.done,type:Fr.a.M4S,video:{chunkEOF:!0,data:null,index:m},audio:{chunkEOF:!0,data:null,index:b}}}var y=yu(f,f.length-1,f[f.length-1].pos.length-1);return{tvid:this.tvid,bid:this._readPointer.bid,loadDone:this.done,type:"ts",stream:{chunkEOF:!0,data:null,index:y}}}if(e&&this.videoFormatType===Fr.a.DASH){var k=null,T=null,S=f[0].sourceID,P=Xd(S,_.vid,"e0"),x=Yr.getSegment(P);if(x){var I=Ar.a.getChunkSEPos(_,Fd.a.VIDEO,0,0);if(I){var E=I.ePos-I.sPos;x.hasData(I.sPos,E)&&(k=x.getData(I.sPos,E))}}if(P=Xd(S=(z=Ar.a.getFilesInfo(_,Fd.a.AUDIO))[0].sourceID,_.vid,"a0"),x=Yr.getSegment(P)){var D=Ar.a.getChunkSEPos(_,Fd.a.AUDIO,0,0);if(D){var w=D.ePos-D.sPos;x.hasData(D.sPos,w)&&(T=x.getData(D.sPos,w))}}return k&&T?(Ir.a.info("~~~~~read init data ok,bid = "+this._readPointer.bid),Ir.a.info("initData_video, startPos , len "+k.length+",data "+k),Ir.a.info("initData_audio, startPos , len "+T.length+",data "+T),26!==k[0]&&Ir.a.info("init segment : "+JSON.stringify(x)),{tvid:this.tvid,bid:this._readPointer.bid,loadDone:this.done,type:Fr.a.DASH,video:{data:k},audio:{data:T}}):null}var A=f[this._readPointer.segmentIndex].sourceID,q=f[this._readPointer.segmentIndex].realIdx!==undefined?f[this._readPointer.segmentIndex].realIdx:this._readPointer.segmentIndex,O=Xd(A,_.vid,"e"+q),L=null;L=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getChunkSEPos(_,Fd.a.VIDEO,this._readPointer.segmentIndex,this._readPointer.chunkIndex):Ar.a.getTSChunkSEPos(_,this._readPointer.segmentIndex,this._readPointer.chunkIndex),Ir.a.info("read point ~~"+JSON.stringify(this._readPointer));var C=Yr.getSegment(O),M=0;if(L&&C)if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){var R=L.ePos-this._readPointer.chunkPos;C.hasData(this._readPointer.chunkPos,R)&&(M=R)}else if(this.videoFormatType===Fr.a.TS){var B=Math.min(C.cePos,L.ePos)-this._readPointer.chunkPos;C.hasData(this._readPointer.chunkPos,B)&&(M=B)}else this.videoFormatType===Fr.a.FTS&&(M=C.dataLen-this._readPointer.chunkPos);var N=null;(this.videoFormatType.indexOf(Fr.a.TS)>=0||this._readPointer.time<=this._readAudioPointer.time||Math.round(this._readPointer.time)-Math.round(this._readAudioPointer.time)<15||n)&&(t&&!a||C&&M>0&&(Ir.a.info("read video data  cePos : "+C.cePos+" sPos : "+this._readPointer.chunkPos+" ePos : "+L.ePos),N=C.getData(this._readPointer.chunkPos,M),C.peerMgr&&(C.peerMgr.usedSize=N.length+C.peerMgr.usedSize)));var F=yu(f,this._readPointer.segmentIndex,this._readPointer.chunkIndex);this.videoFormatType===Fr.a.DASH&&F--,N&&(Ir.a.info("~~~~~read video data ok,bid = "+this._readPointer.bid+" index = "+F+" startPos = "+this._readPointer.chunkPos+" endPos = "+(this._readPointer.chunkPos+M)),this._readPointer.chunkPos+=N.length,this._readPointer.dataFlag=!0);var U=!1;if(N&&($d=!1,this.videoFormatType===Fr.a.FTS?C&&C.tsLoadDone&&this._readPointer.chunkPos===C.dataLen&&(U=!0,$d=!0):L&&this._readPointer.chunkPos>=L.ePos&&(U=!0,$d=!0)),U&&this._readPointer.segmentIndex<=f.length-1){if((this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&this._readPointer.chunkIndex<g.length-1&&(this._readPointer.chunkIndex++,this._readPointer.chunkIndex>=g.length-1))if(this._readPointer.segmentIndex<f.length-1){this._readPointer.segmentIndex++,this._readPointer.chunkPos=0,this._readPointer.chunkIndex=0,q!==(f[this._readPointer.segmentIndex].realIdx!==undefined?f[this._readPointer.segmentIndex].realIdx:this._readPointer.segmentIndex)&&(this.changeSegmentState(_,"e",this._readPointer.segmentIndex-1,1),Ir.a.info("read  call changeSegmentState set 1, e"+(this._readPointer.segmentIndex-1)));var V=Ar.a.getChunkSEPos(_,Fd.a.VIDEO,this._readPointer.segmentIndex,this._readPointer.chunkIndex);V&&(this._readPointer.chunkPos=V.sPos)}else this.changeSegmentState(_,"e",this._readPointer.segmentIndex,1),Ir.a.info("~~~~~read video data finish ~~ segmentIndex "+this._readPointer.segmentIndex+" chunkIndex "+(this._readPointer.chunkIndex-1));if(this.videoFormatType.indexOf("ts")>=0&&this._readPointer.chunkIndex<g.length&&(this._readPointer.chunkIndex++,this._readPointer.chunkIndex>=g.length))if(this._readPointer.segmentIndex<f.length-1){this._readPointer.segmentIndex++,this._readPointer.chunkPos=0,this._readPointer.chunkIndex=0,q!==(f[this._readPointer.segmentIndex].realIdx!==undefined?f[this._readPointer.segmentIndex].realIdx:this._readPointer.segmentIndex)&&(this.changeSegmentState(_,"e",this._readPointer.segmentIndex-1,1),Ir.a.info("read  call changeSegmentState set 1, e"+(this._readPointer.segmentIndex-1)));var H=Ar.a.getTSChunkSEPos(_,this._readPointer.segmentIndex,this._readPointer.chunkIndex);H&&(this._readPointer.chunkPos=H.sPos)}else this.changeSegmentState(_,"e",this._readPointer.segmentIndex,1),Ir.a.info("~~~~~read video data finish ~~"+this._readPointer.segmentIndex+" chunkIndex "+(this._readPointer.chunkIndex-1));var W=p[this._readPointer.chunkIndex];this._readPointer.time=cr.a.accAdd(f[this._readPointer.segmentIndex].start_second,W),Ir.a.info("~~~~~read video data ok~~~ video_time = "+this._readPointer.time)}var j=null,G=0,z=null,K=null,Y=null,Q=0,J=!1;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){var X=this.levelMgr.get(this._readAudioPointer.bid);if(z=Ar.a.getFilesInfo(X,Fd.a.AUDIO),this._readAudioPointer.time<=this._readPointer.time||Math.round(this._readAudioPointer.time)-Math.round(this._readPointer.time)<15||r){Ir.a.info("read audio point ~~"+JSON.stringify(this._readAudioPointer)),Y=Ar.a.getChunkSEPos(X,Fd.a.AUDIO,this._readAudioPointer.segmentIndex,this._readAudioPointer.chunkIndex);var Z=Xd(z[this._readAudioPointer.segmentIndex].sourceID,X.vid,"a"+this._readAudioPointer.segmentIndex);if(K=Yr.getSegment(Z),Y&&K){var $=Y.ePos-this._readAudioPointer.chunkPos;i&&!a||K.hasData(this._readAudioPointer.chunkPos,$)&&(G=$)}K&&G>0&&(j=K.getData(this._readAudioPointer.chunkPos,G),K.peerMgr&&(K.peerMgr.usedSize=j.length+K.peerMgr.usedSize))}if(Q=yu(z,this._readAudioPointer.segmentIndex,this._readAudioPointer.chunkIndex),this.videoFormatType===Fr.a.DASH&&Q--,j&&(Ir.a.info("~~~~~read audio data ok, bid = "+this._readAudioPointer.bid+" index = "+Q+" startPos = "+this._readAudioPointer.chunkPos+" endPos = "+(this._readAudioPointer.chunkPos+G)),this._readAudioPointer.chunkPos+=j.length,this._readAudioPointer.dataFlag=!0,pu=!1),j&&Y&&this._readAudioPointer.chunkPos>=Y.ePos&&(J=!0,pu=!0),J){var ee=z[this._readAudioPointer.segmentIndex].seekable.pos.length-1;this._readAudioPointer.segmentIndex<=z.length-1&&this._readAudioPointer.chunkIndex<ee&&(this._readAudioPointer.chunkIndex++,this._readAudioPointer.chunkIndex>=ee&&(this.changeSegmentState(this.levelMgr.get(this._readAudioPointer.bid),"a",this._readAudioPointer.segmentIndex,1),Ir.a.info("read  call changeSegmentState set 1, a"+this._readAudioPointer.segmentIndex),this._readAudioPointer.segmentIndex<z.length-1?(this._readAudioPointer.segmentIndex++,this._readAudioPointer.chunkPos=0,this._readAudioPointer.chunkIndex=0):Ir.a.info("~~~~~read audio data finish ~~"+this._readAudioPointer.segmentIndex+" chunkIndex "+(this._readAudioPointer.chunkIndex-1))));var te=z[this._readAudioPointer.segmentIndex].seekable.time[this._readAudioPointer.chunkIndex];this._readAudioPointer.time=cr.a.accAdd(z[this._readAudioPointer.segmentIndex].start_second,te),Ir.a.info("~~~~~read audio data ok~~~ audio_time = "+this._readAudioPointer.time)}}return ur.a.lastReadSegIndex=f[this._readPointer.segmentIndex].realIdx!==undefined?f[this._readPointer.segmentIndex].realIdx:this._readPointer.segmentIndex,ur.a.lastReadTvID=C?C.tvid:"",this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?C||K?{tvid:C?C.tvid:K.tvid,bid:C?C.rate:K.rate,loadDone:this.done,type:this.videoFormatType===Fr.a.DASH?Fr.a.DASH:Fr.a.M4S,video:{chunkEOF:U,data:N,index:F,spos:N?this._readPointer.chunkPos-N.length:this._readPointer.chunkPos},audio:{chunkEOF:J,data:j,index:Q,spos:j?this._readAudioPointer.chunkPos-j.length:this._readAudioPointer.chunkPos}}:{}:this.videoFormatType!==Fr.a.TS&&this.videoFormatType!==Fr.a.FTS||!C?{}:{tvid:C.tvid,bid:C.rate,loadDone:this.done,type:Fr.a.TS,stream:{chunkEOF:U,data:N,index:F,spos:N?this._readPointer.chunkPos-N.length:this._readPointer.chunkPos}}}Ir.a.warn("DashMove.read, readPointer bid with levelInfo is null,bid = "+this._readPointer.bid)}}}else Ir.a.warn("levelMgr is null,wait~~")}},{key:"getPlayBuffer",value:function(){var e=ur.a.getBufferFunc();return this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Math.min(e.buffered.video.len,e.buffered.audio.len):e.len}},{key:"refreshcEndTime",value:function(e,t){if(this.curLoadSegment){var i,a,n,r=null,s=parseInt(this.curLoadSegment.index.slice(1));if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){if(i=e[s].seekable.pos,a=t[this._loadAudioPointer.segmentIndex].seekable.pos,n=e[s].seekable.time,r=t[this._loadAudioPointer.segmentIndex].seekable.time,this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH&&0!==s){var o=cr.a.searchPosIndex(this.curLoadSegment.lastCEPos,i);o>=0&&(this._loadPointer.cEndTime=cr.a.accAdd(e[s].start_second,n[o]),-1===this._levelID&&(o!==eu||Date.now()-tu>=3e4&&Date.now()-vu<=15e3)&&this.reportData(this.curLoadSegment.rate,o))}if(this.curLoadAudioSegment&&(this.videoFormatType!==Fr.a.DASH||"a0"!==this.curLoadAudioSegment.index)){var d=cr.a.searchPosIndex(this.curLoadAudioSegment.lastCEPos,a);d>=0&&(this._loadAudioPointer.cEndTime=cr.a.accAdd(t[this._loadAudioPointer.segmentIndex].start_second,r[d]))}}else if(this.videoFormatType.indexOf(Fr.a.TS)>=0)if(i=e[s].pos,n=e[s].time,this.videoFormatType===Fr.a.TS){var u=cr.a.searchTSPosIndex(this.curLoadSegment.lastCEPos,i);u>=0&&(this._loadPointer.cEndTime=cr.a.accAdd(e[s].start_second,n[u]),-1===this._levelID&&(u!==eu||Date.now()-tu>=3e4&&Date.now()-vu<=15e3)&&this.reportData(this.curLoadSegment.rate,u))}else this.videoFormatType===Fr.a.FTS&&this.curLoadSegment.loadDone&&(this._loadPointer.cEndTime=cr.a.accAdd(e[this._loadPointer.segmentIndex].start_second,n[this._loadPointer.chunkIndex+1]))}}},{key:"check",value:function(e){null===this._loadPointer&&(Ir.a.info("check load, loadPointer is null,call seek~~~"),this.seek(this.rangeSTime,!0));var t=this.levelID,i=this.curLoadSegment?this.curLoadSegment.rate:this._loadPointer.levelID;-1===this._levelID&&(i===t||!cu&&-1===_u.levelID&&ur.a.startPlayed()&&this._readPointer.dataFlag&&(!this._readAudioPointer||this._readAudioPointer.dataFlag)||(t=this.curLoadSegment.rate)),Zd=!1,lu=!1,(-1!==this._levelID||this.absTocbs)&&(this.videoFormatType!==Fr.a.DASH&&this.videoFormatType!==Fr.a.M4S||this._loadAudioPointer||(this._loadAudioPointer=new du,this._readAudioPointer=new ou,this._loadAudioPointer.levelID=this._loadPointer.levelID,this._loadAudioPointer.cEndTime=this._readPointer.time,this._readAudioPointer.bid=this._readPointer.bid,this._readAudioPointer.time=this._readPointer.time),this.videoFormatType.indexOf(Fr.a.TS)>=0&&this._loadAudioPointer&&(this._loadAudioPointer=null,this._readAudioPointer=null),(i!==t||this.absTocbs)&&(Ir.a.info("load switch video bidrate changed from "+i+" to "+t),e=this.getPlayBuffer(),Qd.reset(),ur.a.dashUpdateVideoTime>0&&(ur.a.dashUpdateVideoTime=0,ur.a.authorFailedStatus=gd.a.AuthorState_authorOK)),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||this._loadAudioPointer.levelID===t&&!this.absTocbs||(Ir.a.info("load switch  audio bidrate changed from "+this._loadAudioPointer.levelID+" to "+t+",buffer "+e),Jd.reset())),-1===this._levelID&&ur.a.authorFailedStatus===gd.a.AuthorState_Done&&(t=i);var a=this.levelMgr.get(t);if(null!==a){var n=null,r=null;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(n=Ar.a.getFilesInfo(a,Fd.a.VIDEO),r=Ar.a.getFilesInfo(a,Fd.a.AUDIO)):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(n=a.m3u8),!cu)if(t===i)this.refreshcEndTime(n,r);else if(-1===this._levelID){var s=this.getFileList(i);this.refreshcEndTime(s.vFList,s.aFList)}if(i!==t||this.absTocbs?(this.videoDone=!1,this.audioDone=!1):this.checkVideoLoadDone(a,n),Yr.memorySize<dr.c.videoMaxSize&&this.checkP2PLoad(a,n,t,i),i=this.curLoadSegment?this.curLoadSegment.rate:this._loadPointer.levelID,!this._loadPointer.init||this._loadAudioPointer&&this._loadAudioPointer.levelID===i&&!this._loadAudioPointer.init){if(e>=dr.j)return void(cu&&(cu=!1));e<0&&(e=0)}var o=!1,d=!1;if(-1===this._levelID&&(i!==t||this._loadAudioPointer&&this._loadAudioPointer.levelID!==t)&&(i!==t&&(this._loadPointer.cEndTime>this._readPointer.time||$d)&&(o=!0),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||this._loadAudioPointer.levelID===t||(this._loadAudioPointer.cEndTime>this._readAudioPointer.time||pu)&&(d=!0),o&&(Ir.a.info("ABS ,video can switch bid"),Qd.reset(),this.updateCEPos(Fd.a.VIDEO,i,Math.max(this._loadPointer.cEndTime,this._readPointer.time)),this.videoFormatType===Fr.a.DASH&&(this._loadPointer.init=!0)),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||!d||(Ir.a.info("ABS ,audio can switch bid"),Jd.reset(),this.updateCEPos(Fd.a.AUDIO,this._loadAudioPointer.levelID,Math.max(this._loadAudioPointer.cEndTime,this._readAudioPointer.time)),this.videoFormatType===Fr.a.DASH&&(this._loadAudioPointer.init=!0))),this._loadPointer.levelID!==i&&Qd.reset(),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||this._loadAudioPointer.levelID===i||Jd.reset(),this.checkCDNLoad(),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||this._loadAudioPointer.levelID!==t||this.checkAudioLoadDone(a),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||(this._loadPointer.levelID===t&&Zd&&this._loadPointer.cEndTime>this._loadAudioPointer.cEndTime&&Math.floor(this._loadPointer.cEndTime)-Math.floor(this._loadAudioPointer.cEndTime)>15&&(Zd=!1),this._loadAudioPointer.levelID===t&&lu&&this._loadAudioPointer.cEndTime>this._loadPointer.cEndTime&&Math.floor(this._loadAudioPointer.cEndTime)-Math.floor(this._loadPointer.cEndTime)>15&&(lu=!1)),this.done&&this.absTocbs&&this._loadPointer.levelID===t&&(Qd.reset(),Jd.reset(),Zd=!0,lu=!0),ur.a.authorFailedStatus===gd.a.AuthorState_Done&&(Zd=!0,Qd.reset(),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||(lu=!0,Jd.reset()),ur.a.authorFailedStatus=gd.a.AuthorState_reload),Zd||lu){var u=cr.a.accSub(dr.j,e);if(-1!==this._levelID){if(this.absTocbs||i!==t||this._loadAudioPointer&&this._loadAudioPointer.levelID!==t){Qd.reset();var c=0;this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(c=this._readPointer.time,(this.absTocbs||i!==t)&&Ir.a.info("CBS video switch bid, time "+c)):c=Math.max(this.rangeSTime,ur.a.getBufferFunc().end),(this.absTocbs||i!==t)&&Ir.a.info("CBS switch bidrate , start video loadPoint  time = "+c,"levelID = "+t),this._loadPointer.levelID=t,this.videoFormatType===Fr.a.DASH&&(this._loadPointer.init=!0);var l=null;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?l=Ar.a.getGapPos(a,c,Fd.a.VIDEO,"start"):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(l=Ar.a.getTSGapPos(a,c,"start")),l?(this.changeSegmentState(a,"e",l.segmentIndex,0),this._loadPointer.segmentIndex=l.segmentIndex,this._loadPointer.chunkPos=l.pos,this._loadPointer.startTime=l.time,this._loadPointer.cEndTime=l.time,l.segmentIndex!==this._readPointer.segmentIndex&&this.changeSegmentState(a,"e",this._readPointer.segmentIndex,1),(this.absTocbs||i!==t)&&(this._readPointer.bid=this._loadPointer.levelID,this._readPointer.segmentIndex=l.segmentIndex,this._readPointer.chunkIndex=l.chunkIndex,this._readPointer.time=l.time,this.videoFormatType===Fr.a.FTS?this._readPointer.chunkPos=0:this._readPointer.chunkPos=l.pos,Ir.a.info("CBS switch bidrate ,start _readPointer "+JSON.stringify(this._readPointer)))):Ir.a.error("CBS switch bidrate, calculate startPoint is null "),this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){Jd.reset(),this._loadAudioPointer.levelID=this._loadPointer.levelID,this.videoFormatType===Fr.a.DASH&&(this._loadAudioPointer.init=!0);var h=this._readAudioPointer.time;Ir.a.info("CBS audio switch bid, time "+h);var _=Ar.a.getGapPos(a,h,Fd.a.AUDIO,"start");Ir.a.info("CBS switch bidrate,start audio Point "+JSON.stringify(_)),_&&(this.changeSegmentState(a,"a",_.segmentIndex,0),this._loadAudioPointer.segmentIndex=_.segmentIndex,this._loadAudioPointer.chunkPos=_.pos,this._loadAudioPointer.startTime=_.time,this._loadAudioPointer.cEndTime=_.time,_.segmentIndex!==this._readAudioPointer.segmentIndex&&this.changeSegmentState(a,"a",this._readAudioPointer.segmentIndex,1),this._readAudioPointer.bid=this._loadPointer.levelID,this._readAudioPointer.segmentIndex=_.segmentIndex,this._readAudioPointer.chunkIndex=_.chunkIndex,this._readAudioPointer.chunkPos=_.pos,this._readAudioPointer.time=_.time,Ir.a.info("CBS switch bidrate, start readAudioPointer "+JSON.stringify(this._readAudioPointer)))}cu=!0}var f=null;Zd&&!cu&&(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?f=Ar.a.getGapPos(a,this._loadPointer.cEndTime,Fd.a.VIDEO,"start"):this.videoFormatType!==Fr.a.TS&&this.videoFormatType!==Fr.a.FTS||(f=Ar.a.getTSGapPos(a,this._loadPointer.cEndTime,"start")),f?(f.segmentIndex!==this._loadPointer.segmentIndex&&this.changeSegmentState(a,"e",f.segmentIndex,0),this._loadPointer.segmentIndex=f.segmentIndex,this._loadPointer.chunkPos=f.pos,this._loadPointer.levelID=t,this._loadPointer.startTime=f.time):Ir.a.warn("DashMove fetch startPoint is null ,load finish,time = "+this._loadPointer.cEndTime));var p=0;if(this._loadPointer.init||(p=this.calculateVideoLoadTime(u,a,n),cu&&(p=Math.min(1,p))),Zd)if(this._loadPointer.init)this._loadPointer.segmentIndex=0,this._loadPointer.chunkIndex=0,this._loadPointer.chunkPos=n[0].seekable.pos[0],this._loadPointer.endPos=n[0].seekable.pos[1];else{var g=null,m=cr.a.accAdd(this._loadPointer.startTime,p);this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?g=Ar.a.getGapPos(a,m,Fd.a.VIDEO,"end"):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(g=Ar.a.getTSGapPos(a,m,"end")),g&&(this._loadPointer.endPos=g.pos,this._loadPointer.chunkIndex=g.chunkIndex)}if(Zd){if(this.absTocbs||!this.curLoadSegment||this.curLoadSegment.index!=="e"+this._loadPointer.segmentIndex||this.curLoadSegment.rate!==t||!this.curLoadSegment.segment){var v=this.constructorSegmentInfo(n,a,Fd.a.VIDEO);this.createSegmentProxy(Fd.a.VIDEO,v),this.curLoadSegment.checkCreateSegment()}Ir.a.info("~~~~~~video Load point"+JSON.stringify(this._loadPointer)+",cETime "+this._loadPointer.cEndTime+",cePos "+this.curLoadSegment.lastCEPos),this._loadPointer.endPos>this._loadPointer.chunkPos?(this.curLoadSegment.loadData(this._loadPointer.chunkPos,this._loadPointer.endPos),this._loadPointer.init=!1):Ir.a.error("~~~~~~video Load error"+JSON.stringify(this._loadPointer))}var b=null,y=0;if(this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||!lu||this._loadAudioPointer.init||(y=this.calculateAudioLoadTime(u,a)),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||!lu||cu||((b=Ar.a.getGapPos(a,this._loadAudioPointer.cEndTime,Fd.a.AUDIO,"start"))?(b.segmentIndex!==this._loadAudioPointer.segmentIndex&&this.changeSegmentState(a,"a",b.segmentIndex,0),this._loadAudioPointer.segmentIndex=b.segmentIndex,this._loadAudioPointer.chunkPos=b.pos,this._loadAudioPointer.levelID=t,this._loadAudioPointer.startTime=b.time):Ir.a.error("DashMove fetch startAudioPoint is null or load finish,time = "+this._loadAudioPointer.cEndTime)),(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&lu)if(this._loadAudioPointer.init)this._loadAudioPointer.segmentIndex=0,this._loadAudioPointer.chunkIndex=0,this._loadAudioPointer.chunkPos=r[0].seekable.pos[0],this._loadAudioPointer.endPos=r[0].seekable.pos[1];else{var k=cr.a.accAdd(this._loadAudioPointer.startTime,y),T=Ar.a.getGapPos(a,k,Fd.a.AUDIO,"end");T&&(this._loadAudioPointer.endPos=T.pos,this._loadAudioPointer.chunkIndex=T.chunkIndex)}if((this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&lu){if(this.absTocbs||!this.curLoadAudioSegment||this.curLoadAudioSegment.index!=="a"+this._loadAudioPointer.segmentIndex||this.curLoadAudioSegment.rate!==t||!this.curLoadAudioSegment.segment){var S=this.constructorSegmentInfo(r,a,Fd.a.AUDIO);this.createSegmentProxy(Fd.a.AUDIO,S),this.curLoadAudioSegment.checkCreateSegment()}Ir.a.info("~~~~~~audio Load point"+JSON.stringify(this._loadAudioPointer)+",cETime "+this._loadAudioPointer.cEndTime+",cePos "+this.curLoadAudioSegment.lastCEPos),this._loadAudioPointer.endPos>this._loadAudioPointer.chunkPos?(this.curLoadAudioSegment.loadData(this._loadAudioPointer.chunkPos,this._loadAudioPointer.endPos),this._loadAudioPointer.init=!1):Ir.a.error("load audio point is error !!!!!!!")}this.absTocbs&&(this.absTocbs=!1)}else{if((o||(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&d)&&os.clearRaiseLevelCount(),Zd){-1!==this.rangeETime&&this._loadPointer.startTime>=this.rangeETime&&Ir.a.info("loadPointer startTime >= rangeETime,this._loadPointer.startTime = "+this._loadPointer.startTime+"rangeETime"+this.rangeETime);var P=o?t:i,x=this.getFileList(P);if(!x)return void Ir.a.error("levelInfo and fileList is null ,bid = "+P);a=x.levelInfo,n=x.vFList;var I=null;if(cu||(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?I=Ar.a.getGapPos(a,this._loadPointer.cEndTime,Fd.a.VIDEO,"start"):this.videoFormatType!==Fr.a.TS&&this.videoFormatType!==Fr.a.FTS||(I=Ar.a.getTSGapPos(a,this._loadPointer.cEndTime,"start")),I?(I.segmentIndex!==this._loadPointer.segmentIndex&&this.changeSegmentState(a,"e",I.segmentIndex,0),this._loadPointer.segmentIndex=I.segmentIndex,this._loadPointer.chunkPos=I.pos,o?(Ir.a.info("ABS video switch  bid from "+this._loadPointer.levelID+" to "+t),this._loadPointer.levelID=t):this._loadPointer.levelID=i,this._loadPointer.startTime=I.time):Ir.a.warn("DashMove fetch startPoint is null ,load finish,time = "+this._loadPointer.cEndTime)),this._loadPointer.init)this._loadPointer.segmentIndex=0,this._loadPointer.chunkIndex=0,this._loadPointer.chunkPos=n[0].seekable.pos[0],this._loadPointer.endPos=n[0].seekable.pos[1];else{var E=null,D=this.calculateVideoLoadTime(u,a,n);cu&&(D=Math.min(1,D));var w=cr.a.accAdd(this._loadPointer.startTime,D);this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?E=Ar.a.getGapPos(a,w,Fd.a.VIDEO,"end"):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(E=Ar.a.getTSGapPos(a,w,"end")),E&&(this._loadPointer.endPos=E.pos,this._loadPointer.chunkIndex=E.chunkIndex)}if(o?(_u.levelID=this._loadPointer.levelID,_u.segmentIndex=I.segmentIndex,_u.chunkIndex=I.chunkIndex,_u.time=this._loadPointer.startTime,_u.tvid=this.tvid,Ir.a.info("load ABS switch bid,  loadPointer: "+JSON.stringify(this._loadPointer)+" switchVideoPointer "+JSON.stringify(_u))):Ir.a.info("load ABS NO switch bid,  loadPointer: "+JSON.stringify(this._loadPointer)),!this.curLoadSegment||this.curLoadSegment.index!=="e"+this._loadPointer.segmentIndex||this.curLoadSegment.rate!==this._loadPointer.levelID||!this.curLoadSegment.segment){var A=this.constructorSegmentInfo(n,a,Fd.a.VIDEO);this.createSegmentProxy(Fd.a.VIDEO,A),this.curLoadSegment.checkCreateSegment()}Ir.a.info("~~~~~~video Load point"+JSON.stringify(this._loadPointer)+",cETime "+this._loadPointer.cEndTime+",cePos "+this.curLoadSegment.lastCEPos),this._loadPointer.endPos>this._loadPointer.chunkPos?(this.curLoadSegment.loadData(this._loadPointer.chunkPos,this._loadPointer.endPos),this._loadPointer.init=!1):Ir.a.error("_loadPointer.endPos <= _loadPointer.chunkPos")}if((this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&lu){var q=d?t:this._loadAudioPointer.levelID,O=this.getFileList(q);O&&(a=O.levelInfo,r=O.aFList);var L=this.calculateAudioLoadTime(u,a),C=null;if(!cu){var M=this._loadAudioPointer.cEndTime;d&&(M=Math.min(this._loadAudioPointer.cEndTime,this._loadPointer.cEndTime),M=Math.max(M,this._readAudioPointer.time)),(C=Ar.a.getGapPos(a,M,Fd.a.AUDIO,"start"))?(C.segmentIndex!==this._loadAudioPointer.segmentIndex&&this.changeSegmentState(a,"a",C.segmentIndex,0),this._loadAudioPointer.segmentIndex=C.segmentIndex,this._loadAudioPointer.chunkPos=C.pos,d&&(this._loadAudioPointer.levelID=t),this._loadAudioPointer.cEndTime=this._loadAudioPointer.startTime=C.time):Ir.a.error("DashMove fetch startAudioPoint is null or load finish,time = "+this._loadAudioPointer.cEndTime)}if(this._loadAudioPointer.init)this._loadAudioPointer.segmentIndex=0,this._loadAudioPointer.chunkIndex=0,this._loadAudioPointer.chunkPos=r[0].seekable.pos[0],this._loadAudioPointer.endPos=r[0].seekable.pos[1];else{var R=cr.a.accAdd(this._loadAudioPointer.startTime,L),B=Ar.a.getGapPos(a,R,Fd.a.AUDIO,"end");B&&(this._loadAudioPointer.endPos=B.pos,this._loadAudioPointer.chunkIndex=B.chunkIndex)}if(d?(Ir.a.info("ABS Audio switch  bid from "+this.curLoadAudioSegment.rate+" to "+t),fu.levelID=this._loadAudioPointer.levelID,fu.segmentIndex=C.segmentIndex,fu.chunkIndex=cu?this._loadAudioPointer.chunkIndex:C.chunkIndex,fu.time=this._loadAudioPointer.startTime,fu.tvid=this.tvid,Ir.a.info("load ,ABS Audio switch  bid , loadAudioPointer  "+JSON.stringify(this._loadAudioPointer)+" switchAudioPointer "+JSON.stringify(fu))):Ir.a.info("ABS Audio No switch  bid , loadAudioPointer  "+JSON.stringify(this._loadAudioPointer)),!this.curLoadAudioSegment||this.curLoadAudioSegment.index!=="a"+this._loadAudioPointer.segmentIndex||this.curLoadAudioSegment.rate!==this._loadAudioPointer.levelID||!this.curLoadAudioSegment.segment){var N=this.constructorSegmentInfo(r,a,Fd.a.AUDIO);this.createSegmentProxy(Fd.a.AUDIO,N),this.curLoadAudioSegment.checkCreateSegment()}Ir.a.info("~~~~~~audio Load point"+JSON.stringify(this._loadAudioPointer)+",cETime "+this._loadAudioPointer.cEndTime+",cePos "+this.curLoadAudioSegment.lastCEPos),this._loadAudioPointer.endPos>this._loadAudioPointer.chunkPos?(this.curLoadAudioSegment.loadData(this._loadAudioPointer.chunkPos,this._loadAudioPointer.endPos),this._loadAudioPointer.init=!1):Ir.a.error("_loadAudioPointer.endPos <= _loadAudioPointer.chunkPos")}}cu=!1}else cu&&(cu=!1)}else Ir.a.warn("m3u8 is null,need call feed first ~~ ,bidrate = "+t)}},{key:"reset",value:function(){if(Ir.a.info("~~~dashMove reset ~~~"),this.videoDone=!1,this.audioDone=!1,this.levelMgr)for(var e in this.levelMgr){var t=this.levelMgr.get(e),i=null;if(t&&(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?i=Ar.a.getFilesInfo(t,Fd.a.VIDEO):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(i=t.m3u8)),i)for(var a=0;a<i.length;a++)this.changeSegmentState(t,"e",a,1);if((this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH)&&t){var n=Ar.a.getFilesInfo(t,Fd.a.AUDIO);if(n)for(var r=0;r<n.length;r++)this.changeSegmentState(t,"a",r,1)}}null!==this.dashInfo&&(vd.a.clearEvent(this.dashInfo.tvid),this.event=null,this.dashInfo.close(),this.dashInfo=null),null!==this._absStrategy&&this._absStrategy.close(),this._absStrategy=null,null!==this._readPointer&&(this._readPointer=null),null!==this._readAudioPointer&&(this._readAudioPointer=null),null!==this._loadPointer&&(this._loadPointer=null),null!==this._loadAudioPointer&&(this._loadAudioPointer=null),null!==this._p2pLoaderPointer&&(this._p2pLoaderPointer=null),null!==this.levelMgr&&this.levelMgr.clear(),this.levelMgr=null,this.curLoadAudioSegment&&(this.curLoadAudioSegment=null),this.curLoadSegment=null,this._levelID=0,this.absTocbs=!1,clearTimeout(this.fetchDashStep),this.fetchDashStep=null}},{key:"errFun",value:function(e){Ir.a.error("new segment return err"+e)}},{key:"updateLevelInfo",value:function(e){this.levelMgr.set(e.levelID,e.data),ur.a.authorFailedStatus===gd.a.AuthorState_Start&&(ur.a.authorFailedStatus=gd.a.AuthorState_Done,this.updateDispatcherUrl(e.data),Ir.a.info("Authentication update dashInfo done ,rate "+e.levelID))}},{key:"updateDispatcherUrl",value:function(e){var t=null,i=null;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(t=Ar.a.getFilesInfo(e,Fd.a.VIDEO),i=Ar.a.getFilesInfo(e,Fd.a.AUDIO)):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(t=e.m3u8),this.curLoadSegment){var a=t[this._loadPointer.segmentIndex].file_name;lr.a.isHTTPS&&a&&(a=a.replace(/^http:/gi,"https:")),this.curLoadSegment.updateDispatchUrl(a)}if(this.curLoadAudioSegment){var n=i[this._loadAudioPointer.segmentIndex].file_name;lr.a.isHTTPS&&n&&(n=n.replace(/^http:/gi,"https:")),this.curLoadAudioSegment.updateDispatchUrl(n)}}},{key:"updateDashInfo",value:function(e){if(null===this.dashInfo)return null;this.dashInfo.updateSetting(e);this.dashInfo.FetchBitRateFileInfo(this._loadPointer.levelID,this)}},{key:"createSegmentProxy",value:function(e,t){switch(t.videoType){case Fr.a.FTS:this.curLoadSegment=new ru(t);break;case Fr.a.TS:this.curLoadSegment=new nu(t);break;case Fr.a.DASH:case Fr.a.M4S:e===Fd.a.VIDEO?this.curLoadSegment=new su(t):this.curLoadAudioSegment=new su(t);break;default:Ir.a.error("mediaInfo.videoType is invaild when  createSegmentProxy, "+t.videoType)}}},{key:"constructorSegmentInfo",value:function(e,t,i){var a,n=null,r=Fd.a.VIDEO;i===Fd.a.VIDEO?(a=this._loadPointer,n="e"):i===Fd.a.AUDIO?(a=this._loadAudioPointer,n="a",r=Fd.a.AUDIO):"p2p"===i&&(a=this._p2pLoaderPointer,n="e");var s=a.chunkPos,o=a.startTime;-1===this._levelID&&(gu=s,tu=Date.now());var d=e[a.segmentIndex].file_name,u=e[a.segmentIndex].realIdx!==undefined?e[a.segmentIndex].realIdx:a.segmentIndex,c=0,l=0;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH){c=e[a.segmentIndex].size;var h=e[a.segmentIndex].seekable.pos;l=h[h.length-1]}else if(this.videoFormatType.indexOf(Fr.a.TS)>=0){c=parseInt(e[a.segmentIndex].size);var _=e[a.segmentIndex].pos;l=_[_.length-1].ePos}var f=e[a.segmentIndex].sourceID;lr.a.isHTTPS&&d&&(d=d.replace(/^http:/gi,"https:"));var p=0;p=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getDuratioSecond(t,r,a.segmentIndex):Ar.a.getTSDuratioSecond(t,a.segmentIndex);var g=null;return this.videoFormatType!==Fr.a.DASH&&this.videoFormatType!==Fr.a.M4S||"e"!==n||(g=e[a.segmentIndex].seekable.pos),{levelId:a.levelID,tvid:this.tvid,dispatchUrl:d,startTime:o,endTime:p,vid:t.vid,index:n+a.segmentIndex,size:c,startPos:s,endPos:l,vids:this.dashInfo.vidList,ad:this.dashInfo.ad,videoType:this.videoFormatType,albumID:this.dashInfo.albumID,trackerType:r,sourceID:f,loadInfo:{},seekable:g,realSegIdx:n+u}}},{key:"changeSegmentState",value:function(e,t,i,a){if(e){var n="a"===t?Fd.a.AUDIO:Fd.a.VIDEO,r=null;if(!(i>=(r=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getFilesInfo(e,n):e.m3u8).length)){var s=Xd(r[i].sourceID,e.vid,t+(r[i].realIdx!==undefined?r[i].realIdx:i)),o=Yr.getSegment(s);o&&(o.state=a,Ir.a.info("changeSegmentState "+t+i+" bid: "+e.bid+" status : "+o.state))}}}},{key:"getSizeList",value:function(e){for(var t=[],i=0;i<e.length;i++){var a=this.levelMgr.get(e[i]);if(a===undefined)break;var n=null;(n=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getNextChunkInfo(a,Fd.a.VIDEO,this._loadPointer.segmentIndex,this._loadPointer.chunkIndex):Ar.a.getTSNextChunkInfo(a,this._loadPointer.segmentIndex,this._loadPointer.chunkIndex))?t.push(n.ePos-n.sPos):t.push(0)}return t}},{key:"reportData",value:function(e,t){if(this.curLoadSegment&&this._absStrategy&&ur.a.absOpen){var i=Date.now()-tu,a=this.curLoadSegment.lastCEPos-gu;if(tu=Date.now(),eu=t,gu=this.curLoadSegment.lastCEPos,!(a<0||i<=0)){var n=null,r=null,s=0,o=parseInt(this.curLoadSegment.index.slice(1)),d=this.levelMgr.get(e);d!==undefined&&(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(n=Ar.a.getFilesInfo(d,Fd.a.VIDEO),r=Ar.a.getCurChunkInfo(d,Fd.a.VIDEO,o,t)):(n=d.m3u8,r=Ar.a.getCurTSChunkInfo(d,o,t))),r&&(s=r.ePos-r.sPos);var u=0;if(!(n&&(u=yu(n,o,t))>=this.dashInfo.chunkNum-1)){for(var c=[],l=[],h=null,_=0;_<this.dashInfo.bitRateList.length;_++)this.dashInfo.dashInfoMap.has(this.dashInfo.bitRateList[_])&&(h=this.levelMgr.get(this.dashInfo.bitRateList[_]))&&h.ff===this.videoFormatType&&h.code===d.code&&(c.push(this.dashInfo.bitRateList[_]),l.push(h.vsize));var f=null;f||(f=this.getPlayBuffer(),f=cr.a.accAdd(f,this.buffer));var p=ur.a.getReBufTimeFunc(),g=this.getSizeList(c);if(0!==g.length){var m={index:u,loadTime:i,rebuffTime:p,totalSizeList:l,bidList:c,chunkSizeList:g,chunk_count:this.dashInfo.chunkNum,lastChunkSize:s,duration:this.dashInfo.allDuration,buffer_level:f,size:d.vsize,loadSize:a,bid:e};this._absStrategy.reportData(m)}}}}}},{key:"checkCDNLoad",value:function(){Qd.running||this.curLoadSegment&&this.curLoadSegment.isOnP2P||this.videoDone||(Zd=!0),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||Jd.running||this.audioDone||(lu=!0)}},{key:"checkAudioLoadDone",value:function(e){if(!(this.audioDone||cu||this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH))if(this.rangeETime>0&&this._loadAudioPointer.cEndTime>=this.rangeETime)this.audioDone=!0,lu=!1;else{var t=Ar.a.getFilesInfo(e,Fd.a.AUDIO);if(e){var i=t.length-1,a=t[i].size;this._loadAudioPointer.segmentIndex>=i&&this.curLoadAudioSegment&&this.curLoadAudioSegment.lastCEPos>=a?(this.audioDone=!0,lu=!1):this.audioDone=!1}}}},{key:"checkVideoLoadDone",value:function(e,t){if(!this.videoDone&&!cu&&e)if(this.rangeETime>0&&this._loadPointer.cEndTime>=this.rangeETime)this.videoDone=!0,Zd=!1,Ir.a.info("cEndTime >= rangeTime or duration,videoDone!!!!, cEndTime "+this._loadPointer.cEndTime+",duration "+e.duration+",rangeEndTime "+this.rangeETime);else{var i=t.length-1,a=t[i].size;this.curLoadSegment&&parseInt(this.curLoadSegment.index.slice(1))>=i&&this.curLoadSegment.lastCEPos>=a?(this.videoDone=!0,Zd=!1,Ir.a.info("segmentIndex and  chunkIndex is Max,videoDone!!!! ")):this.videoDone=!1}}},{key:"checkP2PLoad",value:function(e,t,i,a){if(this.videoFormatType!==Fr.a.FTS&&"off"!==dr.i.limitP2P&&lr.a.canP2P&&!this.videoDone){this._p2pLoaderPointer||(this._p2pLoaderPointer=new du,this._p2pLoaderPointer.levelID=i);var n=!1;if((cu||!this.curLoadSegment||"e"+this._p2pLoaderPointer.segmentIndex!==this.curLoadSegment.index||this._p2pLoaderPointer.levelID!==i||this._p2pLoaderPointer.levelID!==a||this.absTocbs||this.curLoadSegment.done)&&(n=!0),n&&this.videoFormatType===Fr.a.DASH&&this.curLoadSegment&&"e0"===this.curLoadSegment.index&&(n=!1),n){var r=this._loadPointer.cEndTime,s=!1,o=!1;if(-1!==this._levelID)(this._p2pLoaderPointer.levelID!==i||this.absTocbs)&&(Ir.a.info("[P2P loader],CBS p2pLoaderPointer switch  bid from "+this._p2pLoaderPointer.levelID+" to "+i),this._p2pLoaderPointer.levelID=i,this.videoFormatType===Fr.a.DASH&&(this._loadPointer.init=!0),this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(r=this._readPointer.time,Ir.a.info("CBS video switch bid, time "+r)):r=Math.max(this.rangeSTime,ur.a.getBufferFunc().end),o=!0,Qd.reset());else if(-1===this._levelID)if(a!==i)if((this._loadPointer.cEndTime>this._readPointer.time||$d)&&(s=!0),s)Qd.reset(),this.updateCEPos(Fd.a.VIDEO,a,Math.max(this._loadPointer.cEndTime,this._readPointer.time)),Ir.a.info("[P2P loader],ABS p2pLoaderPointer switch  bid from "+this._p2pLoaderPointer.levelID+" to "+i),this._p2pLoaderPointer.levelID=i,this.videoFormatType===Fr.a.DASH&&(this._loadPointer.init=!0),os.clearRaiseLevelCount();else{if(!cu&&this.curLoadSegment&&!this.curLoadSegment.done)return;this._p2pLoaderPointer.levelID=a;var d=this.getFileList(this._p2pLoaderPointer.levelID);d&&(e=d.levelInfo,t=d.vFList)}else this._p2pLoaderPointer.levelID!==i&&(this._p2pLoaderPointer.levelID=i);if(!this.videoDone){var u=null;if(!(u=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getGapPos(e,r,Fd.a.VIDEO,"start"):Ar.a.getTSGapPos(e,r,"start")))return void Ir.a.error("[P2P loader], find start Point is null,time "+r+",bid "+i);var c=null;c=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?t[u.segmentIndex].seekable:t[u.segmentIndex];var l=0;if(this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(l=c.pos.length-2,this._p2pLoaderPointer.endPos=c.pos[l+1]):(l=c.pos.length-1,this._p2pLoaderPointer.endPos=c.pos[l].ePos),this._p2pLoaderPointer.chunkIndex=l,this._p2pLoaderPointer.segmentIndex=u.segmentIndex,this._p2pLoaderPointer.startTime=u.time,this._p2pLoaderPointer.chunkPos=u.pos,o&&(this._readPointer.bid=this._p2pLoaderPointer.levelID,this._readPointer.segmentIndex=this._p2pLoaderPointer.segmentIndex,this._readPointer.chunkIndex=u.chunkIndex,this._readPointer.time=this._p2pLoaderPointer.startTime,this.videoFormatType===Fr.a.FTS?this._readPointer.chunkPos=0:this._readPointer.chunkPos=u.pos,this._loadPointer.cEndTime=u.time,Ir.a.info("[P2P load] , p2p switch  bid , readPointer"+JSON.stringify(this._readPointer)+", cEndTime "+this._loadPointer.cEndTime)),s&&(_u.levelID=this._p2pLoaderPointer.levelID,_u.segmentIndex=this._p2pLoaderPointer.segmentIndex,_u.chunkIndex=u.chunkIndex,_u.time=this._p2pLoaderPointer.startTime,_u.tvid=this.tvid,this._loadPointer.cEndTime=u.time,Ir.a.info("[P2P loader],ABS switch  bid , switchVideoPointer "+JSON.stringify(_u))),this.absTocbs||!this.curLoadSegment||this.curLoadSegment.index!=="e"+this._p2pLoaderPointer.segmentIndex||this.curLoadSegment.rate!==this._p2pLoaderPointer.levelID||!this.curLoadSegment.segment){var h=this.constructorSegmentInfo(t,e,"p2p");this.createSegmentProxy(Fd.a.VIDEO,h),this.curLoadSegment.checkCreateSegment()}this.absTocbs&&this.videoFormatType===Fr.a.TS&&(this.absTocbs=!1),Ir.a.info("[P2P load] , ~~~~~~video Load point"+JSON.stringify(this._p2pLoaderPointer)+",cETime "+this._loadPointer.cEndTime+",cePos "+this.curLoadSegment.lastCEPos),this.curLoadSegment.p2pLoadSegment()}}}}},{key:"hasInitData",value:function(e,t){var i=this.getFileList(e);if(t===Fd.a.VIDEO){var a=Xd(i.vFList[0].sourceID,i.levelInfo.vid,"e0"),n=Ar.a.getChunkSEPos(i.levelInfo,Fd.a.VIDEO,0,0),r=Yr.getSegment(a);if(n&&r&&r.hasData(n.sPos,n.ePos-n.sPos))return!0}else if(t===Fd.a.AUDIO){var s=Xd(i.aFList[0].sourceID,i.levelInfo.vid,"a0"),o=Ar.a.getChunkSEPos(i.levelInfo,Fd.a.AUDIO,0,0),d=Yr.getSegment(s);if(o&&d&&d.hasData(o.sPos,o.ePos-o.sPos))return!0}return!1}},{key:"clearLoadPint",value:function(){this._loadPointer=null}},{key:"updateAuthorPointer",value:function(){ur.a.dashUpdateVideoTime=this._loadPointer.startTime,Ir.a.info("Authentication failed, update dash ,notice pcw time "+ur.a.dashUpdateVideoTime)}},{key:"calculateVideoLoadTime",value:function(e,t,i){var a=0;a=this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?Ar.a.getDuratioSecond(t,Fd.a.VIDEO,this._loadPointer.segmentIndex):Ar.a.getTSDuratioSecond(t,this._loadPointer.segmentIndex);var n=cr.a.accSub(a,this._loadPointer.cEndTime);n<=0&&this._loadPointer.segmentIndex<i.length-1&&(n=1);var r=Math.min(e,n);return-1!==this.rangeETime&&this._loadPointer.cEndTime+r>=this.rangeETime&&(r=cr.a.accSub(this.rangeETime,this._loadPointer.cEndTime),Ir.a.warn("fix loadDuration ~~~,loadPointerTime = "+this._loadPointer.cEndTime+"rangeEndTime = "+this.rangeETime)),this.videoFormatType===Fr.a.FTS&&(r=1),r}},{key:"calculateAudioLoadTime",value:function(e,t){var i=Ar.a.getDuratioSecond(t,Fd.a.AUDIO,this._loadAudioPointer.segmentIndex),a=cr.a.accSub(i,this._loadAudioPointer.cEndTime),n=Math.max(1,Math.min(e,a));return-1!==this.rangeETime&&this._loadAudioPointer.cEndTime+n>=this.rangeETime&&(n=cr.a.accSub(this.rangeETime,this._loadAudioPointer.cEndTime),Ir.a.info("fix audioLoadDuration ~~~_loadAudioPointer = "+this._loadAudioPointer.cEndTime+"rangeEndTime = "+this.rangeETime)),n}},{key:"updateCEPos",value:function(e,t,i){var a=this.levelMgr.get(t);if(a){var n=null;this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?n=Ar.a.getGapPos(a,i,e,"start"):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(n=Ar.a.getTSGapPos(a,i,"start")),n&&(e===Fd.a.VIDEO&&this.curLoadSegment&&this.curLoadSegment.cePos>n.pos&&(Ir.a.info("updateCEPos,LevelID  "+t+" before "+this.curLoadSegment.lastCEPos+" now "+n.pos+" point "+JSON.stringify(n)),this.curLoadSegment.updateCePos(n.pos)),e===Fd.a.AUDIO&&this.curLoadAudioSegment&&this.curLoadAudioSegment.cePos>n.pos&&this.curLoadAudioSegment.updateCePos(n.pos))}}},{key:"getFileList",value:function(e){var t=this.levelMgr.get(e);if(t){var i=null,a=null;return this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?(i=Ar.a.getFilesInfo(t,Fd.a.VIDEO),a=Ar.a.getFilesInfo(t,Fd.a.AUDIO)):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(i=t.m3u8),{vFList:i,aFList:a,levelInfo:t}}return null}},{key:"checkData",value:function(e,t,i,a){var n=this.levelMgr.get(e),r=null;this.videoFormatType===Fr.a.DASH&&t++,this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?r=Ar.a.getFilesInfo(n,Fd.a.VIDEO):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(r=n.m3u8);var s=null,o=null;this.videoFormatType===Fr.a.DASH&&(o=cr.a.searchPosIndex(i,r[t].seekable.pos))>=0&&(s=Ar.a.getChunkSEPos(n,Fd.a.VIDEO,t,o))&&Ir.a.log("p2p Data ,bidRate "+e+", segmentIndex "+t+", index "+o+", startPos "+s.sPos+",endPos "+s.ePos);var d=Xd(r[t].sourceID,n.vid,"e"+(r[t].realIdx!==undefined?r[t].realIdx:t)),u=Yr.getSegment(d);if(u){var c=Math.min(188,a-i),l=u.getData(i,c);if(Ir.a.log("p2p Data ,bidRate "+e+", segmentIndex "+t+", startPos "+i+",endPos "+(i+c)),Ir.a.log(l),s){var h=s.ePos-188,_=u.getData(h,188);Ir.a.log("p2p Data ,bidRate "+e+", segmentIndex "+t+", startPos "+h+",endPos "+s.ePos),Ir.a.log(_)}}}},{key:"clearData",value:function(e){Yr.destroy()}},{key:"done",get:function(){return this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?this.videoDone&&this.audioDone:this.videoDone}},{key:"levelID",get:function(){if(-1===this._levelID){if(this._absStrategy){var e=this._absStrategy.bitrate;return-1!==e&&this.dashInfo.dashInfoMap.has(e)&&ur.a.absOpen||(e=this.dashInfo.curFeedBid),e}return this.dashInfo.curFeedBid}return this._levelID},set:function(e){this._levelID=e}},{key:"buffer",get:function(){var e=0;return this._readPointer&&this._loadPointer&&this._loadPointer.cEndTime>=this._readPointer.time&&(e=cr.a.accSub(this._loadPointer.cEndTime,this._readPointer.time)),this.videoFormatType!==Fr.a.M4S&&this.videoFormatType!==Fr.a.DASH||this._readAudioPointer&&this._loadAudioPointer&&this._loadAudioPointer.cEndTime>=this._readAudioPointer.time&&(e=Math.min(cr.a.accSub(this._loadAudioPointer.cEndTime,this._readAudioPointer.time),e)),e}},{key:"algorithmDes",get:function(){return-1===this._levelID&&this._absStrategy?this._absStrategy.algorithmDes:"absClose"}},{key:"bandwidth",get:function(){return Qd&&Qd.running?1e3*ur.a.cdnSpeed:ur.a.downSpeed}},{key:"Log",get:function(){var e=this.curLoadSegment?this.curLoadSegment.rate.toString():"null",t="┏┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯┯P2PLog -- "+dr.k.version+"--LevelID--"+e+"┯┯┯┯┯┯┯┯┯┯┯┯┓\r\n";t+=" [ cdnSpeed : "+cr.a.trimNumber(ur.a.cdnSpeed,1e5)+"K , cdnSize : "+cr.a.trimNumber(As.cdnSize/1048576)+"M , loading : "+Qd.running+" ] \r\n [ p2pSpeed : "+cr.a.trimNumber(ur.a.downSpeed/1024,1e5)+"K , p2pSize : "+cr.a.trimNumber(As.p2pSize/1048576)+"M , p2pLoadRate : "+(As.p2pSize/(As.cdnSize+As.p2pSize)*100).toFixed(2)+"% ] \r\n [ upSpeed  : "+cr.a.trimNumber(ur.a.upSpeed/1024,1e5)+"K , upSize  : "+cr.a.trimNumber(As.upSize/1048576)+"M ] \r\n < downMax : "+Math.ceil(ur.a.downMax/1024)+"K ,  upMax : "+Math.ceil(ur.a.upMax/1024)+"K >\r\n";var i=this.levelMgr.get(this._readPointer.bid),a=null;this.videoFormatType===Fr.a.M4S||this.videoFormatType===Fr.a.DASH?a=Ar.a.getFilesInfo(i,Fd.a.VIDEO):this.videoFormatType.indexOf(Fr.a.TS)>=0&&(a=i.m3u8);var n=Xd(a[this._readPointer.segmentIndex].sourceID,i.vid,"e"+(a[this._readPointer.segmentIndex].realIdx!==undefined?a[this._readPointer.segmentIndex].realIdx:this._readPointer.segmentIndex)),r=Yr.getSegment(n);return r&&(t+=" RD | "+r.toDataString(this._readPointer.chunkPos)+"\r\n"),this.curLoadSegment.segment&&(t+=" LD | "+this.curLoadSegment.segment.toDataString(-1)+"\r\n",t+=(this.curLoadSegment.segment.vidsDesc!==undefined?this.curLoadSegment.segment.vidsDesc:" [ ]")+"\r\n"),t+=ur.a.p2pLog,t+="┗┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┷┛\r\n"}}]),e}();function yu(e,t,i){for(var a=0,n=0;n<=t;n++)n<t?e[n].hasOwnProperty("seekable")?a+=e[n].seekable.pos.length-1:a+=e[n].pos.length:a+=i;return a}var ku=0,Tu=function(){function e(){n()(this,e),xr.load(),this.setting=null,this.currentList=new bu,this.nextList=new bu,this.nextListFeedDone=!1}return s()(e,[{key:"init",value:function(e){ur.a.platform=e.platform?e.platform:hr,Ir.a.logTarget=e.logger,ur.a.uuid=e.uid,ur.a.encryptFunc=e.encryptFunc,ur.a.getBufferFunc=e.getBufferFunc,ur.a.getReBufTimeFunc=e.reBufTimeFunc,ur.a.isMediaUpdatingFunc=e.isMediaUpdatingFunc,ur.a.dashUpdatedFunc=e.dashUpdatedFunc,ur.a.canSwitchVd=e.canSwitchVd,ur.a.startPlayed=e.startPlayed,ur.a.sendPingBack=e.sendPingBack,ur.a.updateDashRequireArgsFunc=e.getVrsParams,ur.a.getIsVipFunc=e.getIsVip,ur.a.noticeDataArrived=e.noticeDataArrived,ur.a.checkIsMobius=e.checkIsMobius,ur.a.platform===_r&&(dr.i.upLoad=!1)}},{key:"feed",value:function(e,t,i,a,n,r){t!==undefined&&null!==t||Ir.a.error("feed bitrate = "+this.bitrate+"of dashInfo is "+t),a?(Ir.a.info("DataProvider.feed isCurrent"),this.currentList.feed(t,i,e,n,r),this.nextListFeedDone&&this.nextList.clearLoadPint()):(Ir.a.info("DataProvider.feed next"),this.nextList.reset(),this.nextList.feed(t,i,e,n,r),this.nextListFeedDone=!0)}},{key:"setBitrate",value:function(e,t){this.currentList.tvid===e?(Ir.a.info("DataProvider set current bitrate = "+t),-1!==this.currentList._levelID&&-1===t?(Ir.a.info(" CBS  to ABS !!!!!!!!!!"),this.currentList.cbsToAbs=!0):this.currentList.cbsToAbs=!1,-1===this.currentList._levelID&&-1!==t?(Ir.a.info(" ABS  to CBS!!!!!!!!!!"),this.currentList.absTocbs=!0):this.currentList.absTocbs=!1,this.currentList.levelID=t,this.currentList.checkBitRate(t),this.currentList.resetDoneStatus(),ur.a.absStatus=-1===t?1:0):(Ir.a.info("DataProvider set next bitrate = "+t),this.nextList.levelID=t,this.nextList.checkBitRate(t),this._run())}},{key:"_run",value:function(){if(clearTimeout(this._runnerStep),ur.a.authorFailedStatus!==gd.a.AuthorState_authorFailed||0!==ur.a.dashUpdateVideoTime||this.currentList.done||(ur.a.authorFailedStatus=gd.a.AuthorState_Start,this.currentList.updateAuthorPointer(),ur.a.updateDashRequireArgsFunc(this.currentList.updateDashInfo.bind(this.currentList))),(ur.a.authorFailedStatus===gd.a.AuthorState_authorOK||ur.a.authorFailedStatus>=gd.a.AuthorState_Done)&&!Er.a.errorFragment){var e=ur.a.getBufferFunc(),t=0;t=+(t=this.currentList.videoFormatType===Fr.a.M4S||this.currentList.videoFormatType===Fr.a.DASH?Math.min(e.buffered.video.len,e.buffered.audio.len):e.len).toFixed(3),ur.a.pcwBuffer=t,t=cr.a.accAdd(t,this.currentList.buffer),this.currentList.done?this.nextListFeedDone&&(t+=this.nextList.buffer,this.nextList.check(t)):this.currentList.check(t)}ur.a.onLog&&++ku>=10&&(console.info(this.currentList.Log),ku=0),this._runnerStep=setTimeout(this._run.bind(this),100)}},{key:"seek",value:function(e,t){if(Er.a.errorFragment=null,Er.a.errorStage="",Er.a.loader.count=0,Er.a.dispatcher.count=0,t=t?+t.toFixed(3):t,this.currentList.tvid===e)Ir.a.info("DataProvider.seek currentList tvid = "+e+" time = "+t),this.nextListFeedDone&&this.nextList.clearLoadPint(),this.currentList.seek(t),this._run();else if(this.nextList.tvid===e){Ir.a.info("DataProvider.seek nextList tvid = "+e+" time ="+t),this.currentList.reset();var i=this.currentList;this.currentList=this.nextList,this.nextList=i,this.nextListFeedDone=!1,t&&t!==this.currentList.rangeSTime&&(this.currentList.seek(t),this._run())}As.start()}},{key:"read",value:function(e){return this.currentList.read(e)}},{key:"close",value:function(){Ir.a.info("~~dataProvider close,clear data~~"),clearTimeout(this._runnerStep),this.currentList.reset(),this.nextList.reset(),this.nextListFeedDone=!1,Er.a.errorFragment=null,Er.a.errorStage="",Er.a.loader.count=0,Er.a.dispatcher.count=0}},{key:"getBuffTime",value:function(){var e=this.currentList.buffer,t=0;return this.currentList._readPointer&&(t=this.currentList._readPointer.time),this.currentList._readAudioPointer&&(t=Math.min(this.currentList._readAudioPointer.time,t)),{start:t,length:e}}},{key:"refreshLoadRange",value:function(e,t){this.currentList.tvid===e&&this.currentList.refreshLoadRange(t)}},{key:"checkData",value:function(e,t,i,a){this.currentList.checkData(e,t,i,a)}},{key:"recover",value:function(e){this.currentList.clearData(e)}},{key:"error",get:function(){return Er.a.errorFragment?Er.a.errorStage:""}},{key:"stats",get:function(){var e=Qd.running||Jd.running?{domain:ur.a.cdnLoadDoMain,bw:1e3*ur.a.cdnSpeed,bps:1e3*ur.a.cdnSpeed}:{domian:"",bw:ur.a.downSpeed,bps:0};return{bandwidth:e.speed,bps:e.bps,cdnHost:e.domain,netProtocol:lr.a.isHTTPS?"https":"http"}}},{key:"algorithmDes",get:function(){return this.currentList.algorithmDes}}],[{key:"version",get:function(){return dr.k.version}}]),e}();window.DataProvider=Tu,window.QIYI_HTML5_P2P_PlayBack_0002=Tu;var Su=Tu,Pu=function(e){function t(e,i){var a;n()(this,t),(a=d()(this,c()(t).call(this))).pack=i,a.params=e,a.eventlog={vrsready:!1},a.adWholeCorner=!1,a.id=e.parentId,a.ppt=e.ppt||"0",a.local=e.local||"cn_s",a.cyclePlay=!!e.cyclePlay,a.ost=a.getOst(e.ost,e.bd),a.isEnjoy="enjoy"==e.playerType,a.playbackrate=e.playrate,a.playratelist=e.playratelist,a.poster=e.poster;var r=e.skinType||"";a.isMini=!!r,a.isBanner=r.indexOf("banner")>-1,a.isSimple="simple"==r||a.isBanner,a.boss=e.boss||!1,a.playerVersion=bn.a||e.playerVersion,"false"===e.autoplay||!1===e.autoplay||"0"==e.autoplay?a.autoplay=!1:a.autoplay=!0,a.isInteractVideo=!(1!=Number(e.isEnabledInteraction)||1!=Number(e.interactionType)&&0!=Number(e.interactionType)||$i.a.browser.EDGE||na.a.isTWLocale()),a.interactionMode=e.interactionType,a.isIVMain=a.isInteractVideo,a.iv_state={},a.isInteracting=!1,a.adPlaySource=null,a.ivosRuning=!1,a.ptr=new ir(e),a.sptr=new ar(e),a.pingback=new Xn(h()(a)),a.pingbackV6=new $n(h()(a)),a.pingbackQOS=new tr(h()(a)),a.autoplay?ir.sTime_showVideo=ir.usedTime_selfLoaded:ir.needRecord=!1,a.movieinfo=new Da(h()(a)),a.i18n=na.a,a.user=Zi.a,a.VI=Qi,a.picInPic=!1,a.isFullScreen=!1,a.isWebFullScreen=!1,a.isSmallWindowMode=e.isSmallWindowMode||!1,na.a.setLocale(a.local),e.ptid&&$i.a.setPtid(e.ptid),La.closeBit(1,37),na.a.isTWLocale()?La.closeBit(4,46):(La.openBit(4,3),La.openBit(4,46)),La.openBit(4,14),a.firstLoadMovie=!0,a.logger=new v.a("DataEngine[".concat(a.id,"]")),a.p2p=new or(a.id),a.mutedstart=!1,a.isInstallClient=!1,e.feedMode&&(a.logger.info("Turn off p2p by feed mode"),a.p2p.enabled=!1);var s=Hi("__bid__");return a.userSetBid=s?parseInt(s):0,a}return f()(t,e),s()(t,[{key:"initP2P",value:function(){var e=this.p2p,t=this.logger;if(Su&&e.enabled){var i=performance.now(),a=window.QIYI_HTML5_P2P_PlayBack_0002;e.__setSDK(a),t.info("P2P core load ready, cost ".concat((performance.now()-i).toFixed(3),"ms"))}}},{key:"getOst",value:function(e,t){return e=1===parseInt(e,10)?1===parseInt(t)||"true"===t?1:2:0}},{key:"getMovieInfo",value:function(){return this.movieinfo.current}},{key:"init",value:function(e){this.logger.log("DataEngine Init"),this._v=e,this.episode=new rr(this.id),this.isInteractVideo?this.initInteractVideo(this.params):this._initNormalVideo()}},{key:"initInteractVideo",value:function(e){this._initPlayProxy(),this.pack.ad&&!this.adproxy&&(this.adproxy=new mn(this),this.adproxy.init()),this.IVRecorder?this.IVRecorder.updateParams(e):this.IVRecorder=new kn(this,e),this.recorder||(this.recorder=new vn(this)),this.initInteractPackage(e)}},{key:"initInteractPackage",value:function(e){this.IVPackageManager?(this.IVPackageManager.reset(),this.IVPackageManager.init(e)):this.IVPackageManager=new Yn(this,e)}},{key:"_initPlayProxy",value:function(){this.playproxy||(this.playproxy=new cn(this),this.playproxy.init(this._v,this.params.channelID),this._initVolume())}},{key:"_initAdProxy",value:function(){if(this.pack.ad&&!this.adproxy)this.adproxy=new mn(this),this.adproxy.init();else{var e=function(){};this.adproxy={clear:e,resize:e,getAdInfo:e}}}},{key:"_initVolume",value:function(){this._tempvolume=this.voice,"1"==this.params.isMute||this.params.masflag?this.setVolume(0,!0):this.setVolume(this.voice)}},{key:"_initNormalVideo",value:function(){this.isMini||(this.recorder=new vn(this)),this.playproxy=new cn(this),this._initAdProxy(),this.playproxy.init(this._v,this.params.channelID),this._initVolume(),this.load(this.params)}},{key:"load",value:function(e){this.playproxy.load(e)}},{key:"preload",value:function(e,t){this.playproxy.preload(e,t)}},{key:"checkPreload",value:function(){return this.playproxy.checkPreload()}},{key:"refresh",value:function(e){this.playproxy.refresh(e)}},{key:"getCurrentGas",value:function(){return this.playproxy.getCurrentGas()}},{key:"abort",value:function(){this.playproxy.pause(!1,!0),this.autoplay=!1}},{key:"abortAres",value:function(){this.playproxy.abortAres()}},{key:"abortAllAres",value:function(e){this.playproxy.abortAllAres(e)}},{key:"abortAllAresAndSeek",value:function(e,t){this.playproxy.abortAllAres(e),this.playproxy.seek(t)}},{key:"video",value:function(){return this.playproxy.video()}},{key:"play",value:function(e){this.playproxy.play(e)}},{key:"pause",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.playproxy.pause(e,t)}},{key:"isPaused",value:function(){return this.playproxy.isPaused()}},{key:"replay",value:function(){this.playproxy.replay()}},{key:"seek",value:function(e,t,i){this.playproxy.isPatch()||this.playproxy.seek(e,t,i)}},{key:"lockSeek",value:function(){this.playproxy.lockSeek()}},{key:"unlockSeek",value:function(){this.playproxy.unlockSeek()}},{key:"isSeeking",value:function(){return!!this.playproxy.hasSeeking}},{key:"switchDefinition",value:function(e,t){this.playproxy.switchDefinition(e,t)}},{key:"isSwitchingDefinition",value:function(){return this.playproxy._vdsSwitch}},{key:"switchAudioDefinition",value:function(e){this.movieinfo.currentLid!==e&&(this.emit(Va.a.NTF_AudioSwitching,e),this.playproxy.switchAudioTrack(e))}},{key:"getBufferTime",value:function(){return this.playproxy.getBufferTime()}},{key:"getSrc",value:function(){return this.playproxy.getSrc()}},{key:"setMuted",value:function(e){var t=this.getVolume();this._tempvolume=t>0?t:this._tempvolume||.6,e?this.setVolume(0):this.setVolume(this._tempvolume)}},{key:"getMuted",value:function(){return 0===this.getVolume()}},{key:"getPlayingDuration",value:function(){return this.playproxy._playingDuration}},{key:"getSkipHeaderTime",value:function(){var e=this.playproxy._skipHT,t=parseInt(this.getDuration());return e>=t&&(e=t-1),e}},{key:"getSkipTailTime",value:function(){return this.playproxy._skipTT}},{key:"isSkipPrelude",value:function(e,t){var i=this.skip;if("boolean"!=typeof e)return i;i!=e&&(this.skip=e,!0!==t&&this.playproxy.setSkipPrelude())}},{key:"setStartPlayTime",value:function(e,t){this.movieinfo.setStartPlayTime(e,t)}},{key:"getStartPlayTime",value:function(){return this.movieinfo.startPlayTime}},{key:"getEndPlayTime",value:function(){return this.movieinfo.endPlayTime}},{key:"getDuration",value:function(){return this.playproxy.getDuration()}},{key:"getVolume",value:function(){return this.playproxy.getVolume()}},{key:"setVolume",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.playproxy.setVolume(e),this.playproxy.video().muted=t}},{key:"getVipTypes",value:function(){return this.getMovieInfo().vipTypes}},{key:"getCurrentVD",value:function(){return this.playproxy.getCurrentVD()}},{key:"getPlayInfo",value:function(e){var t=this;t._getpcall=t._getpcall||[],t._getpcall.push(e);var i=t.getMovieInfo(),a=function(){var e={};e.tvid=i.tvid,e.vid=i.vid,e.cid=i.cid,e.albumId=i.albumId,e.duration=t.getDuration(),e.rate=t.getCurrentVD(),e.vidl=t.movieinfo.vidl,e.previewImageUrl=i.previewImageUrl,e.audl=i.audl;var a=t._getpcall.slice(0);t._getpcall=[];for(var n=0;n<a.length;n++)a[n]&&function(t){setTimeout((function(){t(e)}),0)}(a[n]);a=null};i.originalData?a():t.on(Va.a.NTF_VRSReady,a)}},{key:"getVideoInfo",value:function(e){this.playproxy.getVideoInfo(e)}},{key:"getVideoInfoByTvid",value:function(e,t){this.playproxy.getVideoInfoByTvid(e,t)}},{key:"getCurrStatus",value:function(){return this.playproxy.currStatus}},{key:"isAd",value:function(){return this.playproxy.isAd()}},{key:"isPatch",value:function(){return this.playproxy.isPatch()}},{key:"getCurrentAdInfo",value:function(){var e={};return this.isAd()&&(e=this.adproxy.getAdInfo()),e}},{key:"switchVideo",value:function(e){"false"===e.autoplay||!1===e.autoplay||"0"==e.autoplay||0==e.autoplay?this.autoplay=!1:"true"!==e.autoplay&&!0!==e.autoplay&&"1"!=e.autoplay&&1!=e.autoplay||(this.autoplay=!0),this.playproxy.switchVideo(e)}},{key:"isTryWatch",value:function(){return this.movieinfo.isTryWatch}},{key:"getPreviewType",value:function(){return parseInt(this.movieinfo.previewType||-1,10)}},{key:"getPreviewTime",value:function(){return this.movieinfo.previewTime||Infinity}},{key:"recharge",value:function(e,t){this.playproxy.noticeRecharge(e,t)}},{key:"hasStatus",value:function(e){return this.playproxy.hasStatus(e)}},{key:"destroy",value:function(){this.p2p.enabled&&this.p2p.close(),this.episode.destroy(),this.adproxy.destroy(),this.playproxy.destory(),this.movieinfo.clear(),this.recorder.stopTimer(),this.pingback.destory(),this.pingbackV6.destory(),this.emit(Va.a.Status_Destroy)}},{key:"getPlaybackRate",value:function(){return this.playproxy.getPlaybackRate()}},{key:"setPlaybackRate",value:function(e){this.playproxy.setPlaybackRate(e)}},{key:"getCurrenttime",value:function(){return this.playproxy.getCurrenttime()}},{key:"getEngineType",value:function(){return Va.a.QVS_ENGINE}},{key:"getPageTmpltType",value:function(){return this.ptr.pageTmpltType}},{key:"un",value:function(e,t){return this.off(e,t),this}},{key:"getVideoMuted",value:function(){return this.playproxy.video().muted}},{key:"resize",value:function(){this.adproxy.resize()}},{key:"jsNotifyAdManager",value:function(e){this.emit(Va.a.NTF_AD_NotifyManager,e)}},{key:"notyfyADInfo",value:function(e){this.adproxy.sdk&&this.adproxy.sdk.emit(e.type,e.data)}},{key:"setEndPlay",value:function(e){this.playproxy.setEndPlay(e)}},{key:"getCurrManifestType",value:function(){return this.playproxy.qvs.currentManifestType}},{key:"getManifestTypes",value:function(){return this.playproxy.getManifestTypes()}},{key:"getDownloadSpeed",value:function(){return this.playproxy?this.getCurrLoaderMode()===Va.a.CDN_LOADERMODE?this.playproxy.qvs.stats.downloadSpeed:this.p2p.stats().bandwidth:null}},{key:"getCDNInfo",value:function(){if(this.getCurrLoaderMode()===Va.a.CDN_LOADERMODE){var e=this.playproxy.qvs.stats;return{protocol:e.netProtocol||"",host:e.cdnHost||""}}var t=this.p2p.stats();return{protocol:t.netProtocol||"",host:t.cdnHost||""}}},{key:"startFireFPSEvent",value:function(){this.playproxy.qvs.media.startReportFPS()}},{key:"stopFireFPSEvent",value:function(){this.playproxy.qvs.media.stopReportFPS()}},{key:"getCurrLoaderMode",value:function(){return this.playproxy.qvs.currentLoaderMode}},{key:"getDataBufferInfo",value:function(){return this.playproxy.qvs.bufferInfo.data}},{key:"setPlayPingbackInfo",value:function(e){this.pingback&&this.pingback.setPlayPingbackInfo(e),this.pingbackV6&&this.pingbackV6.setPlayPingbackInfo(e)}},{key:"setDelayPlayInfo",value:function(e){this.playproxy.setDelayPlayInfo(e)}},{key:"clearDelayPlayInfo",value:function(e){this.playproxy.clearDelayPlayInfo(e)}},{key:"getBufferInfo",value:function(){return this.playproxy.qvs.bufferInfo}},{key:"getMP4URLByTvid",value:function(e,t){this.playproxy.getMP4URLByTvid(e,t)}},{key:"audioEnabled",get:function(){return La.hasBit(1,3)&&!($i.a.browser.FIREFOX||$i.a.browser.EDGE)}},{key:"vd",get:function(){var e=qa.a.read(qa.a.PLAYER_VD_KEY)||2;if(e=parseInt(e,10),this.firstLoadMovie&&(this.firstLoadMovie=!1,!this.playproxy._autoVdUsing||96!=e&&1!=e||(e=2,qa.a.write(qa.a.PLAYER_VD_KEY,e)),Zi.a.isLogin()&&S.a.get("QP0023")&&(e=4,this.playproxy._autoVdUsing=!1,S.a.set("QP0025","1",{expires:2592e5,path:"/",domain:"iqiyi.com"}),S.a.remove("QP0023",{path:"/",domain:"iqiyi.com"}),qa.a.write(qa.a.PLAYER_VD_KEY,e)),this.userSetBid>0&&(e=Xi.getOldVd(this.userSetBid),qa.a.write(qa.a.PLAYER_VD_KEY,e))),96===e||1===e||2===e||Zi.a.isLogin()||na.a.isTWLocale()||(e=2,qa.a.write(qa.a.PLAYER_VD_KEY,e)),this.params.vd!==undefined&&!na.a.isTWLocale())if(Zi.a.isLogin()){var t=qa.a.read(qa.a.PLAYER_VD_KEY)||this.params.vd,i=Xi.getNewVd(t);e=i>Xi.getNewVd(this.params.vd)?i:this.params.vd}else e=this.params.vd;return e},set:function(e){qa.a.write(qa.a.PLAYER_VD_KEY,e)}},{key:"autoVdValue",get:function(){return this.playproxy.autoVdValue}},{key:"autoVdEnabled",get:function(){var e=this.movieinfo,t=this.playproxy,i=this.p2p,a=e.getVDInfo(),n=undefined;return a&&(n=a.fileFormat),i.enabled&&t._autoVdEnable&&t._shouldP2PAssembled(n)}},{key:"autoVdUsing",get:function(){return this.playproxy._autoVdUsing&&this.autoVdEnabled}},{key:"autoVdAlgot",get:function(){return this.autoVdUsing&&this.p2p.enabled?this.p2p.algot():""}},{key:"skip",get:function(){return"noskip"!==S.a.get("QC157",{memory:!0})},set:function(e){e?S.a.remove("QC157",{path:"/",domain:"iqiyi.com"}):S.a.set("QC157","noskip",{expires:31536e6,path:"/",domain:"iqiyi.com"})}},{key:"voice",get:function(){var e=Number(this.params.voice)||parseFloat(qa.a.read("QiyiPlayerVoice"));return isNaN(e)&&(e=.6),Number(e)>1&&(e=1),e}}]),t}(p.a),xu=function(){function e(){n()(this,e)}return s()(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this}},{key:"once",value:function(e,t){var i=this;function a(){i.off(e,a),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},a.fn=t,this.on(e,a),this}},{key:"off",value:function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,a=this._callbacks[e];if(!a)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var n=0;n<a.length;n++)if((i=a[n])===t||i.fn===t){a.splice(n,1);break}return this}},{key:"emit",value:function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i)for(var a=0,n=(i=i.slice(0)).length;a<n;++a)i[a].apply(this,t);return this}},{key:"listeners",value:function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]}},{key:"hasListeners",value:function(e){return!!this.listeners(e).length}}]),e}();xu.prototype.addEventListener=xu.prototype.on,xu.prototype.removeEventListener=xu.prototype.off;var Iu=Object.prototype,Eu=function(e){var t=Iu.toString.call(e);return t.substring(8,t.length-1).toLowerCase()},Du=function(e){return I()(e)},wu=function(e,t){return Iu.hasOwnProperty.call(e,t)},Au=function(e){return e==Infinity||e==-Infinity},qu=function(e){return!isNaN(e)&&"number"==Eu(e)},Ou=function(e){return!(!qu(e)||Au(e))},Lu=function(e){return!!Ou(e)&&0==e%1},Cu=function(e){if(e){var t=Du(e);return"object"==t||"function"==t}return!1},Mu=function(e){return Cu(e)&&"function"!=Eu(e)},Ru=function(e){return!(!e||"object"!=Eu(e))&&(!e.nodeType&&!e.setInterval)},Bu=function(e){return"string"==Eu(e)},Nu=function(e){if(!Fu(e)&&Mu(e)){var t=e.length;if(Lu(t)&&t>=0)return!0}return!1},Fu=function(e){return!(!e||e.window!=e)},Uu={_class:Eu,_type:Du,owns:wu,nan:function(e){return e!=e},bool:function(e){return"boolean"==Eu(e)},infinite:Au,number:qu,iod:Ou,decimal:function(e){return!!Ou(e)&&0!=e%1},integer:Lu,oof:Cu,object:Mu,hash:Ru,plainObject:Ru,undef:function(e){return"undefined"==Du(e)},fn:function(e){return"function"==Eu(e)},string:Bu,nos:function(e){return Ou(e)||Bu(e)},array:function(e){return"array"==Eu(e)},arraylike:Nu,window:Fu,empty:function(e){if(Bu(e)||Nu(e))return 0===e.length;if(Ru(e))for(var t in e)if(wu(e,t))return!1;return!0},element:function(e){return!(!e||1!==e.nodeType)},regexp:function(e){return"regexp"==Eu(e)}},Vu=function(){var e={};e.is=Uu,e.extend=e.assign=function(e){if(e){var i=t.call(arguments,1);n(i,(function(t){c(t,(function(t,i){Uu.undef(t)||(e[i]=t)}))}))}return e};var t=[].slice;e.each=n,e.uid=function(e){return e=e||7,Math.random().toString(35).substr(2,e)},e.map=function(e,t){var i=[];return n(e,(function(e,a,n){i[a]=t(e,a,n)})),i},e.filter=function(e,t){var i=[];return n(e,(function(e,a,n){t(e,a,n)&&i.push(e)})),i},e.identity=function(e){return e},e.compact=function(t){return e.filter(t,e.identity)},e.some=function(e,t){return-1!=r(e,t)},e.every=function(e,t){return-1==r(e,o(t))},e.reduce=u,e.sum=function(t){return e.reduce(t,(function(e,t){return e+t}),0)},e.findIndex=r,e.find=function(t,i){var a=e.findIndex(t,i);if(-1!=a)return t[a]},e.indexOf=d,e.includes=function(e,t){return-1!=d(e,t)},e.toArray=s,e.slice=function(e,t,i){var n=[],r=a(e);return r>=0&&(t=t||0,0!==i&&(i=i||r),Uu.fn(e.slice)||(e=s(e)),n=e.slice(t,i)),n},e.negate=o,e.forIn=c,e.keys=function(e){var t=[];return c(e,(function(e,i){t.push(i)})),t},e.values=function(e){var t=[];return c(e,(function(e,i){t.push(e)})),t};var i=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function a(e){if(null!=e)return e.length}function n(e,t){var i=a(e);if(i&&Uu.fn(t))for(var n=0;n<i&&!1!==t(e[n],n,e);n++);return e}function r(e,t){var i=-1;return n(e,(function(e,a,n){if(t(e,a,n))return i=a,!1})),i}function s(e){var t=[];return n(e,(function(e){t.push(e)})),t}function o(e){return function(){return!e.apply(this,arguments)}}function d(e,t){return Uu.string(e)?e.indexOf(t):r(e,(function(e){return t===e}))}function u(e,t,i){return n(e,(function(a,n){i=t(i,a,n,e)})),i}function c(e,t){if(e)for(var i in e)if(Uu.owns(e,i)&&!1===t(e[i],i,e))break;return e}function l(e){return e||0==e?e+"":""}e.trim=function(e){return null==e?"":(""+e).replace(i,"")},e.invert=function(e){var t={};return c(e,(function(e,i){t[e]=i})),t},e.lower=function(e){return l(e).toLowerCase()},e.upper=function(e){return l(e).toUpperCase()},e.first=function(e){if(e)return e[0]},e.startsWith=function(e,t){return 0==d(e,t)},e.tostr=l,e.get=function(t,i){if((i=f(i)).length&&e.every(i,(function(e){if(null!=t)return t=t[e],!0})))return t},e.sumBy=function(t,i){var a=0;return e.each(t,(function(t){a+=e.get(t,i)||0})),a},e.has=function(t,i){if((i=f(i)).length&&e.every(i,(function(e){if(null!=t&&Uu.owns(t,e))return t=t[e],!0})))return!0;return!1},e.only=function(e,t){return e=e||{},Uu.string(t)&&(t=t.split(/ +/)),u(t,(function(t,i){return null!=e[i]&&(t[i]=e[i]),t}),{})},e.curry=function(t){var i=t.length;return function a(n){return function(){var r=n.concat(e.slice(arguments));return r.length>=i?(r.length=i,t.apply(this,r)):a(r)}}([])},e.mapObject=e.mapValues=function(e,t){var i={};return c(e,(function(e,a,n){i[a]=t(e,a,n)})),i},e.before=function(e,t){return function(){if(e>1)return e--,t.apply(this,arguments)}},e.once=function(t){return e.before(2,t)},e.len=a,e.last=function(t){var i=e.len(t);if(i)return t[i-1]},e.max=function(t,i){var a=-1,r=-Infinity;return i=i||e.identity,n(t,(function(e,t){(e=i(e))>r&&(r=e,a=t)})),a>-1?t[a]:r},e.split=function(e,t,i){return(e=l(e)).split(t,i)},e.size=function(t){var i=e.len(t);return null==i&&(i=e.keys(t).length),i},e.flatten=function(e){var t=[];return n(e,(function(e){Uu.arraylike(e)?n(e,(function(e){t.push(e)})):t.push(e)})),t},e.union=function(){return e.uniq(e.flatten(arguments))},e.uniq=function(t){return e.uniqBy(t)},e.uniqBy=function(t,i){var a=[],r=[];return Uu.fn(i)||(i=null),n(t,(function(t){var n=t;i&&(n=i(t)),e.includes(r,n)||(r.push(n),a.push(t))})),a},e.remove=function(t,i){for(var a=e.len(t)||0,n=[];a--;)i(t[a],a,t)&&n.push(a);return function(t,i){var a=[],n=e.len(i);if(n)for(i=i.sort((function(e,t){return e-t}));n--;){var r=i[n];a.push(Array.prototype.splice.call(t,r,1)[0])}return a.reverse(),a}(t,n)},e.endsWith=function(t,i){return(i+="")==e.slice(t,e.len(t)-e.len(i))},e.isMatch=function(e,t){var i=!0;return e=e||{},c(t,(function(t,a){if(t!==e[a])return i=!1,!1})),i},e.throttle=function(t,i,a){return i=i||0,a=e.extend({leading:!0,trailing:!0,maxWait:i},a),e.debounce(t,i,a)},e.debounce=function(t,i,a){i=i||0;var n,r=(a=e.extend({leading:!1,trailing:!0},a)).maxWait,s=0,o=0,d=Date.now();function u(){return!(d-s>i)&&!(r&&d-o>r)}function c(e,t,i){return s=Date.now(),e.apply(t,i)}function l(){n&&(clearTimeout(n),n=null)}function h(){d=Date.now();var e=u();o=d;var r=this,s=arguments;l(),e?a.trailing&&(n=setTimeout((function(){c(t,r,s)}),i)):c(t,r,s)}return a.leading||(s=d),h.cancel=l,h};var h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,_=/\\(\\)?/g;function f(e){if(Uu.array(e))return e;var t=[];return l(e).replace(h,(function(e,i,a,n){var r=i||e;a&&(r=n.replace(_,"$1")),t.push(r)})),t}return e}(),Hu=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this))).contextName=e,i}return f()(t,e),s()(t,[{key:"setParent",value:function(e){if(e){this[e.contextName]=this.parent=e}}},{key:"getParentByName",value:function(e){for(var t=this;t;){if(t.contextName==e)return t;t=t.parent}}},{key:"getVal",value:function(e){for(var t=this;t;){if(Vu.has(t,e))return t[e];t=t.parent}}},{key:"getMultiVals",value:function(e){var t=this,i={};return Vu.each(e,(function(e){i[e]=t.getVal(e)})),i}},{key:"getParam",value:function(){for(var e=this,t=6,i=[];t--&&e;)i.push(e),e=e.parent;return i.reverse(),i.unshift({}),Vu.extend.apply(Vu,i)}}]),t}(xu),Wu=Vu.is,ju={sep:"&",eq:"=",encode:encodeURIComponent,decode:decodeURIComponent,keepRaw:!1,sort:null,ignoreValues:[undefined]};function Gu(e,t,i){return i=Vu.find(arguments,(function(e){return Wu.object(e)})),e=Wu.nos(e)?e:undefined,t=Wu.nos(t)?t:undefined,i=Vu.extend({},ju,i,{sep:e,eq:t})}var zu=function(e,t,i,a){e+="";var n=(a=Gu(t,i,a)).decode;return e=e.split(a.sep),Vu.reduce(e,(function(e,t){if(2==(t=t.split(a.eq)).length){var i=t[0],r=t[1];if(!a.keepRaw)try{i=n(i),r=n(r)}catch(s){}e[i]=r}return e}),{})},Ku=function(e,t,i,a){a=Gu(t,i,a);var n=Vu.keys(e),r=a.sort;r&&(Wu.fn(r)?n.sort(r):n.sort());var s=a.encode,o=[];return Vu.each(n,(function(t){var i=e[t];Vu.includes(a.ignoreValues,i)||((Wu.nan(i)||null==i)&&(i=""),a.keepRaw||(t=s(t),i=s(i)),o.push(t+a.eq+i))})),o.join(a.sep)},Yu=Vu.is,Qu=Vu.curry((function Vf(e,t){var i={};e&&t&&Vu.forIn(t,(function(t,a){var n=e[a];if(null!=n)if(Yu.object(n)){var r=n.type||function(e){return Yu._class(e)}(t),s=n.name;"object"==r?i[s]=Vf(n.child,t):"array"==r&&(i[s]=Vu.map(t,(function(e){return Vf(n.child,e)})))}else i[n]=t}));return i}));var Ju,Xu,Zu={visit:"v",player:"pl",policy:"p",show:"s",template:"tp",creative:"c",tracking:"t",exchangeTracking:"x",mixer:"m",statistics:"st",ad:"a",inventory:"i",questionnaireInquiry:"qi"},$u={success:"s",error:"e",load:"l",skip:"sk",skipClick:"sc",click:"clk",impression:"imp",adblock:"adb",close:"cls",start:"st",unsupported:"uns"},ec=Qu({pingbackType:"p",subtype:"t",uaaUserId:"u",cupidUserId:"a",episodeId:"v",albumId:"b",channelId:"c",vvId:"e",adPlayerId:"y",customInfo:"x",timestamp:"s",videoDuration:"d",isVIP:"g",isPreload:"pl",passportId:"pp",location:"lc",sdkVersion:"av",clientVersion:"vv",requestId:"rid",sequenceId:"sq",orderItemId:"od",creativeId:"ct",dspId:"dp",adInfo:"ai",adStrategy:"as",rawInventory:"ri",originalInventory:"oi",deliveredInventory:"di",forbiddenInventory:"fi",requestDuration:"rd",requestCount:"rc",reqCount:"rc",errorCode:"ec",errCode:"ec",errorMessage:"em",errMessage:"em",errMsg:"em"}),tc={visit:"episodeId albumId channelId location passportId customInfo isPreload",show:"requestCount requestDuration",creative:"",tracking:"",statistics:"",ad:"episodeId albumId channelId sequenceId",inventory:"episodeId albumId channelId rawInventory originalInventory deliveredInventory forbiddenInventory"},ic=(i(257),Object.prototype.toString),ac=function(e){switch(ic.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}if("object"==I()(e)&&e&&"number"==typeof e.length)try{if("function"==typeof e.callee)return"arguments"}catch(t){if(t instanceof TypeError)return"arguments"}return null===e?"null":e===undefined?"undefined":e&&1===e.nodeType?"element":e===Object(e)?"object":I()(e)},nc=+Date.now(),rc=window.document,sc=/^(?:text|application)\/javascript/i,oc=/^(?:text|application)\/xml/i,dc=/^\s*$/,uc=function Hf(e){var t=bc({},e||{});for(Ju in Hf.settings)t[Ju]===undefined&&(t[Ju]=Hf.settings[Ju]);lc(t),t.crossDomain||(t.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(t.url)&&RegExp.$2!=window.location.host);var i=t.dataType,a=/=\?/.test(t.url);if("jsonp"==i||a)return a||(t.url=gc(t.url,t.jsonpCallback+"=?")),Hf.JSONP(t);t.url||(t.url=window.location.toString()),mc(t);var n,r=t.accepts[i],s={},o=/^([\w-]+:)\/\//.test(t.url)?RegExp.$1:window.location.protocol,d=Hf.settings.xhr();t.crossDomain||(s["X-Requested-With"]="XMLHttpRequest"),r&&(s.Accept=r,r.indexOf(",")>-1&&(r=r.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(r)),(t.contentType||t.data&&"GET"!=t.type.toUpperCase())&&(s["Content-Type"]=t.contentType||"application/x-www-form-urlencoded"),t.headers=bc(s,t.headers||{}),d.onreadystatechange=function(){if(4==d.readyState){clearTimeout(n);var e,a=!1;if(d.status>=200&&d.status<300||304==d.status||0==d.status&&"file:"==o){i=i||function(e){return e&&("text/html"==e?"html":"application/json"==e?"json":sc.test(e)?"script":oc.test(e)&&"xml")||"text"}(d.getResponseHeader("content-type")),e=d.responseText;try{"script"==i?(0,eval)(e):"xml"==i?e=d.responseXML:"json"==i&&(e=dc.test(e)?null:JSON.parse(e))}catch(r){a=r}a?_c(a,"parsererror",d,t):hc(e,d,t)}else _c(null,"error",d,t)}};var u=!("async"in t)||t.async;for(Xu in d.open(t.type,t.url,u),t.headers)d.setRequestHeader(Xu,t.headers[Xu]);return!1===function(e,t){var i=t.context;if(!1===t.beforeSend.call(i,e,t)||!1===cc(t,i,"ajaxBeforeSend",[e,t]))return!1;cc(t,i,"ajaxSend",[e,t])}(d,t)?(d.abort(),!1):(t.timeout>0&&(n=setTimeout((function(){d.onreadystatechange=pc,d.abort(),_c(null,"timeout",d,t)}),t.timeout)),d.send(t.data?t.data:null),d)};function cc(e,t,i,a){if(e.global)return!0}function lc(e){e.global&&0==uc.active++&&cc(e)}function hc(e,t,i){var a=i.context;i.success.call(a,e,"success",t),cc(i),fc("success",t,i)}function _c(e,t,i,a){var n=a.context;a.error.call(n,i,t,e),cc(a),fc(t,i,a)}function fc(e,t,i){var a=i.context;i.complete.call(a,t,e),cc(i),function(e){e.global&&!--uc.active&&cc(e)}(i)}function pc(){}function gc(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function mc(e){"object"===ac(e.data)&&(e.data=function(e,t){var i=[];return i.add=function(e,t){this.push(vc(e)+"="+vc(t))},function a(e,t,i,n){var r="array"===ac(t);for(var s in t){var o=t[s];n&&(s=i?n:n+"["+(r?"":s)+"]"),!n&&r?e.add(o.name,o.value):(i?"array"===ac(o):"object"===ac(o))?a(e,o,i,s):e.add(s,o)}}(i,e,t),i.join("&").replace("%20","+")}(e.data)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=gc(e.url,e.data))}uc.active=0,uc.JSONP=function(e){if(!("type"in e))return uc(e);var t,i="jsonp"+ ++nc,a=rc.createElement("script"),n={abort:function(){a.parentNode&&a.parentNode.removeChild(a),i in window&&(window[i]=pc),fc("abort",n,e)}},r=rc.getElementsByTagName("head")[0]||rc.documentElement;return e.error&&(a.onerror=function(){n.abort(),e.error(e,"error")}),window[i]=function(r){clearTimeout(t),a.parentNode&&a.parentNode.removeChild(a),delete window[i],e.checkParserError&&!function(e){return"object"==I()(e)&&"[object object]"==Object.prototype.toString.call(e).toLowerCase()&&!e.length}(r)?e.error(e,"parsererror"):hc(r,n,e)},mc(e),a.src=e.url.replace(/\?(.+)=\?/,"?$1="+i),r.insertBefore(a,r.firstChild),e.timeout>0&&(t=setTimeout((function(){n.abort(),fc("timeout",n,e)}),e.timeout)),n},uc.settings={type:"GET",beforeSend:pc,success:pc,error:pc,complete:pc,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,checkParserError:!1},uc.get=function(e,t){return uc({url:e,success:t})},uc.post=function(e,t,i,a){return"function"===ac(t)&&(a=a||i,i=t,t=null),uc({type:"POST",url:e,data:t,success:i,dataType:a})},uc.getJSON=function(e,t){return uc({url:e,success:t,dataType:"json"})};var vc=encodeURIComponent;function bc(e){var t=Array.prototype.slice;return t.call(arguments,1).forEach((function(t){for(Ju in t)t[Ju]!==undefined&&(e[Ju]=t[Ju])})),e}var yc=uc,kc=Vu.is,Tc=function(){return S.a.get("P00001")||""},Sc=function(e){return S.a.get(e)||""},Pc=function(e,t,i){return S.a.set(e,t,i)},xc=function(e){(new Image).src=e},Ic=function(e){var t=(e=e||{}).slot||{},i=e.creative||{},a=[t.cuepointType,e.dspId,e.orderItemId,i.creativeId,i.templateType];return(a=Vu.map(a,(function(e){return null==e&&(e=""),e}))).join("||")},Ec=function Wf(e,t,i,a){if(e&&t){var n=e.split(t);if(i=Vu.tostr(i),e=n.join(i),a){var r=encodeURIComponent(t);r!=t&&(e=Wf(e,r,i))}}return e},Dc=function(e){var t=0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp"),i=0===document.createElement("canvas").toDataURL("image/heic").indexOf("data:image/heic");return/\.jpg$/.test(e)?(e+="?caplist=jpg",t&&(e+=",webp"),i&&(e+=",heic"),e):e},wc=function(e,t){var i=new Image;return new Promise((function(a,n){var r=function(){i.removeEventListener("load",o),i.removeEventListener("error",s)},s=function(){r(),n("error")},o=function(){r(),a(i)};t&&setTimeout((function(){r(),n("timeout")}),t),e=e.replace(/^(https:|http:)/,""),e=Dc(e),i.addEventListener("load",o),i.addEventListener("error",s),i.setAttribute("src",e)}))},Ac=function(e,t,i){e=e||{},t=t||{},t={width:kc.number(t.width)?t.width:Infinity,height:kc.number(t.height)?t.height:Infinity},i={width:(i=i||{}).width||0,height:i.height||0};var a=Math.max(i.width/e.width,i.height/e.height),n=Math.min(t.width/e.width,t.height/e.height);return a>n&&(a=n=NaN),{min:a,max:n}},qc=function(e){var t=NaN;kc.string(e)&&(e=e.split(","));var i=Vu.first(e);if(!i)return t;if("string"!=typeof i)return t;var a=i.charCodeAt(0);return(a>47&&a<58||a>64&&a<91)&&(t=a),t},Oc=function(){var e=Sc("idx")||"";if(e){var t=JSON.parse(e),i="ip:"+t.ip.replace(/X/g,".")+",gc:"+t.geocode+",ept:"+t.exptime;return t=Vu.extend(t,{idx:i})}return!1},Lc=Vu.is,Cc=["isVIP","isPreload"],Mc=function(){function e(){n()(this,e);this.uncompressedParam={},this.compressedParam={},this.pingbackParam={}}return s()(e,[{key:"init",value:function(e,t,i){var a=this;a.addUncompressedParam(t),a.addCompressedParam(i),a.getType(),a.getContextParam(e),a.filterContextParam(),a.mergeContextParam(),a.normalizeParam(),a.compressKey(),a.mergePingbackParam(),a.send()}},{key:"getContextParam",value:function(e){e instanceof Hu?(this.context=e,this.contextParam=e.getParam()):this.contextParam=e}},{key:"filterContextParam",value:function(){var e="pingbackType subtype timestamp vvId adPlayerId uaaUserId cupidUserId sdkVersion clientVersion isVIP videoDuration requestId "+tc[this.pingbackType];this.contextParam=Vu.only(this.contextParam,e)}},{key:"mergeContextParam",value:function(){this.addUncompressedParam(this.contextParam)}},{key:"getType",value:function(){var e=this,t=e.uncompressedParam;e.pingbackType=e.pingbackType||t.pingbackType,e.subtype=e.subtype||t.subtype,t.pingbackType=Zu[e.pingbackType]||e.pingbackType,t.subtype=$u[e.subtype]||e.subtype}},{key:"normalizeParam",value:function(){var e=this,t=e.uncompressedParam;if(e.context&&"ad"==e.context.contextName){var i=e.context;e.addUncompressedParam({adInfo:i.adInfo})}Vu.each(Cc,(function(e){var i=t[e];Lc.bool(i)&&(t[e]=i?1:0)}));var a=0;a=e.context&&e.context.getVal("deltaTime")||0,t.timestamp=Date.now()+a,Vu.forIn(t,(function(e,i){if(Lc.string(e)){var a=e.length;"em"==i&&a>300&&(e=e.slice(0,150)+"||"+e.slice(a-150)),t[i]=e}}))}},{key:"addCompressedParam",value:function(e){Vu.extend(this.compressedParam,e)}},{key:"addUncompressedParam",value:function(e){Vu.extend(this.uncompressedParam,e)}},{key:"compressKey",value:function(){this.addCompressedParam(ec(this.uncompressedParam))}},{key:"mergePingbackParam",value:function(){if(this.context){var e=this.context.getVal("pingbackParam");Vu.extend(this.pingbackParam,e)}}},{key:"send",value:function(){var e=this,t=e.compressedParam||{},i=e.pingbackParam||{},a={},n="";e.context&&e.context.getParentByName("sdk").logger.getLogger("pingback")("send",e.pingbackType||t.p,e.subtype||t.t,e.uncompressedParam,t,i);Vu.forIn(t,(function(e,t){Vu.has(i,t)||(a[t]=e)})),Lc.empty(i)||(n="&"+Ku(i,"&","=",{keepRaw:!0}));var r="//msg.qy.net/cp2.gif?"+Ku(a)+n;xc(r)}}]),e}(),Rc=function(e,t,i){return(new Mc).init(e,t,i)},Bc=function(e,t,i){return Rc(e,{pingbackType:"statistics",subtype:t,customInfo:i})};function Nc(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function Fc(e,t,i,a,n,r){return Nc(function(e,t){return e<<t|e>>>32-t}(Nc(Nc(t,e),Nc(a,r)),n),i)}function Uc(e,t,i,a,n,r,s){return Fc(t&i|~t&a,e,t,n,r,s)}function Vc(e,t,i,a,n,r,s){return Fc(t&a|i&~a,e,t,n,r,s)}function Hc(e,t,i,a,n,r,s){return Fc(t^i^a,e,t,n,r,s)}function Wc(e,t,i,a,n,r,s){return Fc(i^(t|~a),e,t,n,r,s)}function jc(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var i,a,n,r,s,o=1732584193,d=-271733879,u=-1732584194,c=271733878;for(i=0;i<e.length;i+=16)a=o,n=d,r=u,s=c,o=Uc(o,d,u,c,e[i],7,-680876936),c=Uc(c,o,d,u,e[i+1],12,-389564586),u=Uc(u,c,o,d,e[i+2],17,606105819),d=Uc(d,u,c,o,e[i+3],22,-1044525330),o=Uc(o,d,u,c,e[i+4],7,-176418897),c=Uc(c,o,d,u,e[i+5],12,1200080426),u=Uc(u,c,o,d,e[i+6],17,-1473231341),d=Uc(d,u,c,o,e[i+7],22,-45705983),o=Uc(o,d,u,c,e[i+8],7,1770035416),c=Uc(c,o,d,u,e[i+9],12,-1958414417),u=Uc(u,c,o,d,e[i+10],17,-42063),d=Uc(d,u,c,o,e[i+11],22,-1990404162),o=Uc(o,d,u,c,e[i+12],7,1804603682),c=Uc(c,o,d,u,e[i+13],12,-40341101),u=Uc(u,c,o,d,e[i+14],17,-1502002290),o=Vc(o,d=Uc(d,u,c,o,e[i+15],22,1236535329),u,c,e[i+1],5,-165796510),c=Vc(c,o,d,u,e[i+6],9,-1069501632),u=Vc(u,c,o,d,e[i+11],14,643717713),d=Vc(d,u,c,o,e[i],20,-373897302),o=Vc(o,d,u,c,e[i+5],5,-701558691),c=Vc(c,o,d,u,e[i+10],9,38016083),u=Vc(u,c,o,d,e[i+15],14,-660478335),d=Vc(d,u,c,o,e[i+4],20,-405537848),o=Vc(o,d,u,c,e[i+9],5,568446438),c=Vc(c,o,d,u,e[i+14],9,-1019803690),u=Vc(u,c,o,d,e[i+3],14,-187363961),d=Vc(d,u,c,o,e[i+8],20,1163531501),o=Vc(o,d,u,c,e[i+13],5,-1444681467),c=Vc(c,o,d,u,e[i+2],9,-51403784),u=Vc(u,c,o,d,e[i+7],14,1735328473),o=Hc(o,d=Vc(d,u,c,o,e[i+12],20,-1926607734),u,c,e[i+5],4,-378558),c=Hc(c,o,d,u,e[i+8],11,-2022574463),u=Hc(u,c,o,d,e[i+11],16,1839030562),d=Hc(d,u,c,o,e[i+14],23,-35309556),o=Hc(o,d,u,c,e[i+1],4,-1530992060),c=Hc(c,o,d,u,e[i+4],11,1272893353),u=Hc(u,c,o,d,e[i+7],16,-155497632),d=Hc(d,u,c,o,e[i+10],23,-1094730640),o=Hc(o,d,u,c,e[i+13],4,681279174),c=Hc(c,o,d,u,e[i],11,-358537222),u=Hc(u,c,o,d,e[i+3],16,-722521979),d=Hc(d,u,c,o,e[i+6],23,76029189),o=Hc(o,d,u,c,e[i+9],4,-640364487),c=Hc(c,o,d,u,e[i+12],11,-421815835),u=Hc(u,c,o,d,e[i+15],16,530742520),o=Wc(o,d=Hc(d,u,c,o,e[i+2],23,-995338651),u,c,e[i],6,-198630844),c=Wc(c,o,d,u,e[i+7],10,1126891415),u=Wc(u,c,o,d,e[i+14],15,-1416354905),d=Wc(d,u,c,o,e[i+5],21,-57434055),o=Wc(o,d,u,c,e[i+12],6,1700485571),c=Wc(c,o,d,u,e[i+3],10,-1894986606),u=Wc(u,c,o,d,e[i+10],15,-1051523),d=Wc(d,u,c,o,e[i+1],21,-2054922799),o=Wc(o,d,u,c,e[i+8],6,1873313359),c=Wc(c,o,d,u,e[i+15],10,-30611744),u=Wc(u,c,o,d,e[i+6],15,-1560198380),d=Wc(d,u,c,o,e[i+13],21,1309151649),o=Wc(o,d,u,c,e[i+4],6,-145523070),c=Wc(c,o,d,u,e[i+11],10,-1120210379),u=Wc(u,c,o,d,e[i+2],15,718787259),d=Wc(d,u,c,o,e[i+9],21,-343485551),o=Nc(o,a),d=Nc(d,n),u=Nc(u,r),c=Nc(c,s);return[o,d,u,c]}function Gc(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function zc(e){var t,i=[];for(i[(e.length>>2)-1]=undefined,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function Kc(e){var t,i,a="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),a+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return a}function Yc(e){return unescape(encodeURIComponent(e))}function Qc(e){return function(e){return Gc(jc(zc(e),8*e.length))}(Yc(e))}function Jc(e,t){return function(e,t){var i,a,n=zc(e),r=[],s=[];for(r[15]=s[15]=undefined,n.length>16&&(n=jc(n,8*e.length)),i=0;i<16;i+=1)r[i]=909522486^n[i],s[i]=1549556828^n[i];return a=jc(r.concat(zc(t)),512+8*t.length),Gc(jc(s.concat(a),640))}(Yc(e),Yc(t))}var Xc=function(e,t,i){return t?i?Jc(t,e):Kc(Jc(t,e)):i?Qc(e):Kc(Qc(e))};i(433),"http https ftp gopher file".split(" ");function Zc(e,t){var i=[],a=Vu.indexOf(e,t);return-1==a?i[0]=e:(i[0]=e.slice(0,a),i[1]=e.slice(a+t.length)),i}var $c=function(e,t){if("string"!=typeof e)return e;var i,a,n={};n.href=e,a=(i=Zc(e,"#"))[0],i[1]&&(n.hash="#"+i[1]),a=(i=function(e,t){var i="";return e=e.replace(t,(function(e){return i=e,""})),[i,e]}(a,/^[a-zA-Z][a-zA-Z0-9+-.]*:/))[1],n.protocol=i[0].toLowerCase(),a=(i=Zc(a,"?"))[0];var r=i[1];if(t&&(r=zu(r)),n.query=r,"/"!=a.charAt(0)&&n.schema)return n.opaque=a,n;Vu.startsWith(a,"//")&&(i=Zc(a=a.slice(2),"/"),n.pathname="/"+unescape(i[1]||""),i=function(e){var t=Zc(e,"@"),i=t[0],a=t[1];a||(a=t[0],i=null);return[i,a]}(i[0]),n.auth=i[0],i=Zc(i[1],":"),n.hostname=i[0],n.port=~~i[1]);return n},el={adPlayerId:"a",uaaUserId:"u",cupidUserId:"i",passportId:"p",requestId:"s",timestamp:"h",encryption:{name:"e",type:"object",child:{episodeId:"b",albumId:"l",channelId:"k",cuepointList:{name:"q",type:"array",child:{cuepointType:"ct",adZoneId:"zi",startTime:"st",sequenceId:"si",requestAdDuration:"rd",keyword:"kw",limit:"lm",skip:"sk"}},referrer:"r",offline:"o",mobileKey:"t",userAgent:"m",continuingVideoPlayedCount:"n",continuingVideoPlayedDuration:"y",continuingAdPlayedDuration:"w",isVIP:"v",passportCookie:"pc",network:"nw",needPolicy:"po",encryptionVersion:"pv",isPreload:"pr",couponCode:"cc",couponVer:"mv",url:"ul",videoPlayedDurationInDay:"cd",adPlayedDurationInDay:"ca",midrollPointsPlayedInView:"nm",lastRollCompleteInterval:"in",lastMidrollRequestTime:"lm",clientVersion:"cv",sdkVersion:"sv",supportIQiyiTracking:"gt",supportEmptyTracking:"ea",searchQuery:"sq",prerollOrderItemIds:"poi",pauseRequestTimes:"pt",playSource:"ps",requestIndex:"rix",vvId:"veid",usePartnerData:"upd",ptid:"ptid",timePoint:"tp",vft:"vft",idx:"idx"}}},tl=function(e){var t;e=Vu.tostr(e);for(var i=[],a=0;a<e.length;a++)(t=e.charCodeAt(a))<128?i.push(t):t<2048?i.push(192|t>>6,128|63&t):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|63&t):i.push(239,191,189);return i},il=function(e){for(var t=[],i=0,a=0,n=0;n<e.length;n++){if((i=e[n])>224)a=(15&i)<<12,a|=(63&(i=e[++n]))<<6,a|=63&(i=e[++n]);else if(i>192)a=(31&i)<<6,a|=(63&(i=e[++n]))<<6;else{if(i>128)throw new Error("InvalidCharacterError");a=i}t.push(String.fromCharCode(a))}return t.join("")},al=ll("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),nl=ll("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_");function rl(e,t){var i=sl(e,t);return il(i)}function sl(e,t){var i=al;((t=t||{}).useURL||null==t.useURL&&function(e){return/[-_]/.test(e)}(e))&&(i=nl),e=e.replace(/\s+$/,"").replace(/=+$/,"").replace(/[\n\r]/g,"");for(var a=Vu.map(e.split(""),(function(e){return~~i.decodeMap[e]})),n=[],r=0;r<a.length;r+=4){var s=cl(Vu.slice(a,r,r+4));n.push.apply(n,s)}return n}function ol(e,t){return dl(tl(e),t)}function dl(e,t){var i=al;(t=t||{}).useURL&&(i=nl);for(var a=[],n=0;n<e.length;n+=3)a.push.apply(a,ul(Vu.slice(e,n,n+3)));return(a=Vu.map(a,(function(e){return i.encodeMap[e]||"="}))).join("")}function ul(e){var t=[];return null==e[2]?t[3]=64:t[3]=63&e[2],null==e[1]?t[2]=64:t[2]=(15&e[1])<<2|e[2]>>6,t[1]=(3&e[0])<<4|e[1]>>4,t[0]=e[0]>>2,t}function cl(e){var t=[];return null!=e[3]&&(t[2]=((3&e[2])<<6)+e[3]),null!=e[2]&&(t[1]=((15&e[1])<<4)+((60&e[2])>>2)),null!=e[1]&&(t[0]=(e[0]<<2)+((48&e[1])>>4)),t}function ll(e){var t=function(e){for(var t={},i=0;i<e.length;i++)t[i]=e.charAt(i);return t}(e);return{encodeMap:t,decodeMap:Vu.invert(t)}}var hl={encode:ol,btoa:ol,decode:rl,atob:rl,encodeBytes:dl,decodeToBytes:sl};function _l(e,t){var i=hl.decodeToBytes(e);return i=Vu.map(i,(function(e,i){return e^t.charCodeAt(i%t.length)})),il(i)}function fl(e,t){var i=tl(e);return i=Vu.map(i,(function(e,i){return e^t.charCodeAt(i%t.length)})),hl.encodeBytes(i)}function pl(e){var t=ml(e),i=zu(t),a=i.a,n=_l(i.e,a);return i.e=zu(n),i}function gl(e){var t=pl(e),i=t.e||{},a=0,n=0,r=parseInt(i.b),s=parseInt(i.l),o=Vu.last(t.a);return r>100&&(a=parseInt(r/100%100)),s>100&&(n=parseInt(s/100%100)),a+"y"+o+"w"+n}function ml(e){var t=Vu.split(e,"?");return Vu.last(t)}function vl(e,t){return function(e,t){t=Vu.split(t,"");for(var i,a=tl(e),n=Math.floor(a.length/2)-16,r=31;r>=1;--r){var s=a[n+r]%(r+1);r!=s&&(i=t[r],t[r]=t[s],t[s]=i)}return t.join("")}(t,Xc(t+"cupid_show2.0"+ml(e)))}var bl={decryptBySeed:_l,encryptBySeed:fl,decryptShowRequestByUrl:pl,decryptShowResponse:function(e,t){return _l(t,gl(e))},encryptShowResponse:function(e,t){return fl(t,gl(e))},getShowCheckSum:vl,validateShowChecksum:function(e,t){var i,a=t.match(/,"c_c_":"(\w+)"/);return!(!a||(i=a[1],vl(e,t.replace(a[0],""))!=i))}},yl=Qu({v:"version",ics:"ipCollectionServers",cl:"clientIP",de:"serverIP",set:"serverTime",ec:"errorCode",sr:"serverError",ar:"areaId",ui:"cupidUserId",ntc:"needTimeChecking",vmd:"vipMarketingDocuments",ci:"cacheIP",idc:"idc",ims:"ims",inv:{name:"inventory",type:"object",child:{fi:"forbiddenInventory",ri:"rawInventory",oi:"originalInventory",di:"deliveredInventory"}},vcc:{name:"vipCheckConflict",type:"object",child:{v:"isVIP",c:"code",m:"message"}},pbp:"pingbackParam",m:{name:"midrollPoints",type:"object",child:{ac:"autoChoose",nm:"nextMidroll"}},pc:"pingbackConfig",vcr:{name:"vipCheckResult",type:"object",child:{v:"isVIP",uvt:"userVipType"}},vdi:{name:"videoInfo",type:"object",child:{dsa:"disableSkipAd",vd:"videoDuration",ai:"albumId",vt:"videoType"}},s:{name:"slots",type:"array",child:{ctp:"cuepointType",az:"adZoneId",st:"startTime",kw:"keyword",ea:{name:"emptyTracking",type:"object",child:{tss:"timeSlices",trp:"trackingParam"}},a:{name:"ads",type:"array",child:{comment:"comment",o:"order",ori:"orderItemId",tp:"timeSlices",p:"priority",hkw:"hitKeywords",dtp:"deliverType",ipt:"impressionTime",skt:"skipTime",bge:"badge",h:"host",se:"settle",ta:"targetedAd",ug:"userGroup",ds:"isDSP",dsi:"dspId",dst:"dspType",dsc:"dspIcon",oet:"orderItemEndTime",msm:"macroSubstitutionMap",ies:{name:"ies",type:"array",child:{dm:"domain",msm:"macroSubstitutionMap"}},va:{name:"vast",type:"object",child:{vo:"vastObject"}},rp:{name:"replay",type:"object",child:{rpt:"replayTimes",bst:"replayShowTime",bct:"replayCloseTime"}},cr:{name:"creative",type:"object",child:{cra:"creativeId",crb:"creativeType",crc:"creativeTemplate",tt:"templateType",co:"creativeObject"}},clt:"clickThrough",ctt:"clickThroughType",ct:{name:"clickTracking",type:"object",child:{at:"exchangeTracking",ctc:"cupidTracking",tpt:"thirdPartyTracking"}},it:{name:"impressionTracking",type:"object",child:{at:"exchangeTracking",ctc:"cupidTracking",tpt:"thirdPartyTracking"}},et:{name:"eventTracking",type:"array",child:{ev:"event",tr:"trackings"}},qt:{name:"iqiyiTracking",type:"object",child:{ct:{name:"cupidTracking",type:"object",child:{evs:"events",trp:"trackingParam"}},at:{name:"exchangeTracking",type:"object",child:{evs:"events",trp:"trackingParam"}}}},st:"startTime",fc:{name:"fullCorner",type:"object",child:{si:"showInterval",sd:"showDuration"}},acc:"seekable",tot:"toast"}}}},c:{name:"policySlots",type:"array",child:{az:"adZoneId",ctp:"cuepointType",sts:"startTimes",du:"duration",azl:"adZoneStyle"}},c_c_:"couponCode"}),kl=(i(300),function(){this.version="1.3.4";var e={mergeCDATA:!0,grokAttr:!0,grokText:!0,normalize:!0,xmlns:!0,namespaceKey:"_ns",textKey:"_text",valueKey:"_value",attrKey:"_attr",cdataKey:"_cdata",attrsAsObject:!0,stripAttrPrefix:!0,stripElemPrefix:!0,childrenAsArray:!0},t=new RegExp(/(?!xmlns)^.*:/),i=new RegExp(/^\s+|\s+$/g);return this.grokType=function(e){return/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):e},this.parseString=function(e,t){return this.parseXML(this.stringToXML(e),t)},this.parseXML=function(a,n){for(var r in n)e[r]=n[r];var s={},o=0,d="";if(e.xmlns&&a.namespaceURI&&(s[e.namespaceKey]=a.namespaceURI),a.attributes&&a.attributes.length>0){for(var u={};o<a.attributes.length;o++){var c=a.attributes.item(o);f={};var l="";l=e.stripAttrPrefix?c.name.replace(t,""):c.name,e.grokAttr?f[e.valueKey]=this.grokType(c.value.replace(i,"")):f[e.valueKey]=c.value.replace(i,""),e.xmlns&&c.namespaceURI&&(f[e.namespaceKey]=c.namespaceURI),e.attrsAsObject?u[l]=f:s[e.attrKey+l]=f}e.attrsAsObject&&(s[e.attrKey]=u)}if(a.hasChildNodes())for(var h,_,f,p=0;p<a.childNodes.length;p++)4===(h=a.childNodes.item(p)).nodeType?e.mergeCDATA?d+=h.nodeValue:s.hasOwnProperty(e.cdataKey)?(s[e.cdataKey].constructor!==Array&&(s[e.cdataKey]=[s[e.cdataKey]]),s[e.cdataKey].push(h.nodeValue)):e.childrenAsArray?(s[e.cdataKey]=[],s[e.cdataKey].push(h.nodeValue)):s[e.cdataKey]=h.nodeValue:3===h.nodeType?d+=h.nodeValue:1===h.nodeType&&(0===o&&(s={}),_=e.stripElemPrefix?h.nodeName.replace(t,""):h.nodeName,f=kl.parseXML(h),s.hasOwnProperty(_)?(s[_].constructor!==Array&&(s[_]=[s[_]]),s[_].push(f)):(e.childrenAsArray?(s[_]=[],s[_].push(f)):s[_]=f,o++));else d||(e.childrenAsArray?(s[e.textKey]=[],s[e.textKey].push(null)):s[e.textKey]=null);if(d)if(e.grokText){var g=this.grokType(d.replace(i,""));null!==g&&g!==undefined&&(s[e.textKey]=g)}else e.normalize?s[e.textKey]=d.replace(i,"").replace(/\s+/g," "):s[e.textKey]=d.replace(i,"");return s},this.xmlToString=function(e){try{return e.xml?e.xml:(new XMLSerializer).serializeToString(e)}catch(Rf){return null}},this.stringToXML=function(e){try{var t=null;return window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t)}catch(i){return null}},this}.call({})),Tl=kl,Sl=Vu.is;function Pl(e,t){var i,a={};if(Sl.string(e))try{(i=Tl.parseString(e,{attrKey:"attr",textKey:"#text"})).html&&!i.VAST&&(a.error="parse error",t("vastXML parse error")),t("vastJson",i)}catch(k){a.error=k,t("vastXML parse error",k)}else i=e;if(i.VAST){var n=i.VAST[0],r=xl(n.Ad);t("$ad",r,n);var s=xl(r.Wrapper);t("$wrapper",s);var o=xl(r.InLine);if(t("$inline",o),s){var d=xl(s.VASTAdTagURI);a.redirect=El(d)}var u=s||o;if(u){var c=Il(u.Impression);a.impressionTrackings=Vu.compact(Vu.map(c,(function(e){return El(e)}))),t("ret.impressionTrackings",a.impressionTrackings);var l=xl(u.Creatives[0].Creative);if(t("$creative",l),l){var h=xl(l.Linear);t("$linear",h);var _=xl(h.Duration);a.duration=El(_),t("ret.duration",a.duration);var f,p=xl(h.AdParameters);a.adParameters=El(p),t("ret.adParameters",a.adParameters);try{var g=xl(h.VideoClicks[0].ClickThrough);a.clickThrough=El(g)}catch(T){a.clickThrough=""}t("ret.clickThrough",a.clickThrough);try{var m=xl(h.Icons[0].Icon[0].StaticResource);a.icon=El(m)}catch(T){a.icon=""}t("ret.icon",a.icon);try{f=xl(h.MediaFiles[0].MediaFile)}catch(T){}t("creativeNode",f),a.creativeUrl=El(f)||"",a.creativeWidth=Dl(f,"width")||"",a.creativeHeight=Dl(f,"height")||"",t("ret.creativeUrl",a.creativeUrl),t("ret.creativeWidth",a.creativeWidth),t("ret.creativeHeight",a.creativeHeight);try{var v=Il(h.VideoClicks[0].ClickTracking);a.clickTrackings=Vu.compact(Vu.map(v,(function(e){return El(e)})))}catch(T){a.clickTrackings=[]}t("ret.clickTrackings",a.clickTrackings);var b=[];try{b=Il(h.TrackingEvents[0].Tracking)}catch(T){b=[]}t("eventTrackings",b);var y=a.eventTracking={};Vu.each(b,(function(e){var t=Dl(e,"event");Sl.array(y[t])||(y[t]=[]);var i=El(e);i&&y[t].push(i)})),t(y,a.eventTracking)}}}return a.isEmpty=function(e,t){if(!e.VAST)return!0;var i=e.VAST[0]&&xl(e.VAST[0].Ad);return!i||(t("$ad:",i),!xl(i.InLine)&&!xl(i.Wrapper))}(i,t),a}function xl(e){return e&&e instanceof Array?e[0]:e}function Il(e){return e&&e instanceof Array?e:[e]}function El(e){return e&&e["#text"]&&e["#text"][0]?e["#text"]:""}function Dl(e,t){return e&&e.attr&&e.attr[t]&&e.attr[t]._value}var wl={"image/jpeg":{extensions:["jpg","jpeg","jpe"]},"image/gif":{extensions:["gif"]},"image/png":{extensions:["png"]},"image/webp":{extensions:["webp"]},"application/x-shockwave-flash":{extensions:["swf"]},"video/mp4":{extensions:["mp4","mp4v","mpg4"]},"video/x-flv":{extensions:["flv"]},"video/x-f4v":{extensions:["f4v"]},"video/webm":{extensions:["webm"]},"text/html":{extensions:["html","htm","shtml"]}};function Al(e){return function(e){e=Vu.lower(e);var t=Vu.keys(wl);return Vu.find(t,(function(t){return Vu.includes(wl[t].extensions,e)}))}(e)}var ql=function(e){return function(e){return Vu.includes(e,"image")?"image":Vu.includes(e,"flash")?"swf":Vu.includes(e,"video")?"video":Vu.includes(e,"html")?"html":void 0}(Ol(e))},Ol=function(e){if(e=$c(e)){var t=function(e){var t=(e+="").split(".");return"."+Vu.last(t)}(e.pathname);return Al(t=Vu.slice(t,1))}},Ll=function(){function e(){n()(this,e),this.init()}return s()(e,[{key:"init",value:function(){this._timerIdMap={timeout:{},interval:{}}}},{key:"run",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"interval",i=arguments.length>1?arguments[1]:undefined,a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:16.7,n=Date.now,r=n(),s=[n(),Math.random()].join(""),o=function d(){e.setIdMap(s,t,d),n()-r>=a&&("interval"===t&&(r=n(),r),i(),"timeout"===t&&e.clearTimeout(s))};return this.setIdMap(s,t,o),s}},{key:"setIdMap",value:function(e,t,i){var a=requestAnimationFrame(i);this._timerIdMap[t][e]=a}},{key:"setTimeout",value:function(e,t){return this.run("timeout",e,t)}},{key:"clearTimeout",value:function(e){cancelAnimationFrame(this._timerIdMap.timeout[e])}},{key:"setInterval",value:function(e,t){return this.run("interval",e,t)}},{key:"clearInterval",value:function(e){cancelAnimationFrame(this._timerIdMap.interval[e])}}]),e}(),Cl=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).repeatCount=i||Infinity,a.interval=e,a.reset(),a.raf=new Ll,a}return f()(t,e),s()(t,[{key:"reset",value:function(){this.stop(),this.currentCount=0}},{key:"stop",value:function(){this.running&&(this.raf.clearInterval(this.timer),this.timer=null),this.running=!1}},{key:"start",value:function(){var e=this;e.running||(e.timer=this.raf.setInterval((function(){e.currentCount++,e.emit("timer"),e.currentCount==e.repeatCount&&(e.emit("timerComplete"),e.stop())}),e.interval)),e.running=!0}}]),t}(xu);Cl.interval=function(e,t,i){var a=new Cl(t,i);return a.on("timer",e),a.start(),a},Cl.timeout=function(e,t){return Cl.interval(e,t,1)};var Ml=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this))).type=e,a.ad=i,a.creativeObject=i.creative.creativeObject,a.vv=i.getParentByName("vv"),a.log=a.vv.sdk.logger.getLogger(e+":"+i.id),a.$adContainer=a.vv.mw.adcontainer(),a.$adzone=document.createElement("div"),i.$adzone=a.$adzone,i.$adzone.setAttribute("data-adzone",i.slot.adZoneId),a}return f()(t,e),s()(t,[{key:"emitCreativeError",value:function(e,t){var i=this.ad;"timeout"==e?i.emit("error",{data:{creativeUrl:t},message:"creative timeout"}):i.emit("error",{data:{creativeUrl:t},message:"creative http error"})}},{key:"loadImage",value:function(e,t){var i=this;return t=t||3e4,"image/gif"==Ol(e)&&(e=e+"?"+Date.now()),wc(e,t)["catch"]((function(t){return"timeout"===t?i.emitCreativeError("timeout",e):i.emitCreativeError("error",e),Promise.reject(t)}))}},{key:"initProgress",value:function(){var e=this,t=e.ad,i=Vu.once((function(){e.timer&&e.timer.stop(),e.timer=null,e.ad.emit("complete",{type:"timer-complete"})})),a=e.getDuration();if(a>0&&Infinity!=a){var n=e.timer=new Cl(1e3,a);n.on("timer",(function(){t.remain=t.duration-n.currentCount,e.updateCountdown()})),n.on("timerComplete",i),n.reset(),n.start()}}},{key:"fakeHide",value:function(){var e=this;e.$adzone.style.position="absolute",e.$adzone.style.width="600px",e.$adzone.style.height="300px",e.$adzone.style.top="10px",e.$adzone.style.left="10px",e.$adzone.style.display="",e.$adzone.style.visibility="hidden"}},{key:"putOnDocument",value:function(){var e=this;e.$adzone.style.position="absolute",e.hasPutOnDoc||("viewPoint"!=e.type&&e.$adzone.appendChild(e.creativeElement),e.$adzone.parentNode||(e.$adContainer.appendChild(e.$adzone),e.hasPutOnDoc=!0))}},{key:"tryAddStyle",value:function(e){var t=this;this.vv.sdk.setViewController((function(){e&&e(),t.addStyle()}))}},{key:"addClickEvt",value:function(){var e=this;e.clickHandler=function(){e.ad.emit("clickAndOpen")},e.$adzone&&e.$adzone.addEventListener("click",e.clickHandler)}},{key:"addStyle",value:function(){var e=this,t=e.vv.sdk.viewController;e.$adzone.setAttribute("adId",e.ad.id),e.$adzone.setAttribute("templateType",e.type),0!=e.creativeObject.isCloseable&&t.addCloseBtn(e);var i=!!e.creativeObject.needAdBadge,a=e.option||{};a.type=e.template,i&&t.addAdBadge(e.$adzone,a);var n=!!e.creativeObject.showMuteButton;"video"==e.creativeObject.renderType&&n&&t.addVolumnBtn(e)}},{key:"destroyAdzone",value:function(){var e=this.ad;"roll"==this.type||(this.log("destroy adzone"),e.$adzone.parentNode&&e.$adzone.parentNode.removeChild(e.$adzone),e.$adzone.removeEventListener("click",this.clickHandler),e.$adzone.innerHTML="",e.$adzone.setAttribute("data-adzone",""))}},{key:"updateCountdown",value:function(){var e,t=this.ad;if(this.onFirstPlaying(),e=t.remain,this.log("countdown",t.remain+"/"+t.duration),e<0)return this.log("countdown < 0 不应该发生"),void t.abort()}},{key:"pause",value:function(){this.log("pause"),this.timer&&this.timer.stop()}},{key:"resume",value:function(){this.log("resume"),this.timer&&this.timer.start()}},{key:"stop",value:function(){var e=this;e.log("stop"),e.timer&&e.timer.stop(),e.timer=null,e.isStopped=!0,e.destroyAdzone()}},{key:"reset",value:function(){this.isStopped=!1,this.hasPlaying=!1}},{key:"resize",value:function(){}},{key:"abort",value:function(){}},{key:"getDuration",value:function(){return Infinity}},{key:"detectCollision",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.willDefinitelyCollide,i=this,a=i.ad,n=i.$adzone||{},r=n.style,s=i.vv.adCollisionDetection,o={id:a.id,x:r.left.replace("px",""),y:r.top.replace("px",""),width:r.width.replace("px",""),height:r.height.replace("px",""),willDefinitelyCollide:t};s.addAdIntoCollisingList(o),s.notifyWholeCornerToHide()}}]),t}(xu),Rl=Vu.is,Bl={1:300,2:600,3:1126.4,4:1536,5:3072,10:8192,96:170},Nl=Vu.map([["jUrl","f4v",1,-1e3],["bUrl","f4v",170],["gUrl","f4v",300],["cUrl","f4v",1536],["lowUrl","f4v",300,-1],["highUrl","f4v",600,-1],["m200Url","mp4",300],["m400Url","mp4",600],["jVid","vid",1,-1e3],["bVid","vid",170],["gVid","vid",300],["cVid","vid",1536],["m200Vid","vid",300,-1],["m400Vid","vid",600,-1]],(function(e){return{key:e[0],videoFormat:e[1],minBandwidth:e[2],priority:e[3]}}));var Fl={impression:0,click:1,push:2,trueview:3,start:10,firstQuartile:11,midpoint:12,thirdQuartile:13,complete:14,downloadStart:20,downloaded:21},Ul={"1q":"firstQuartile",mid:"midpoint","3q":"thirdQuartile",stop:"complete",sp:"complete"},Vl=Vu.is,Hl=Qu({type:"a",timestamp:"b",videoEventId:"r",securityCode:"s",md5Version:"ve",uploadId:"up",clientVersion:"cv",sdkVersion:"sv",startTime:"st"}),Wl=function(){function e(){n()(this,e)}return s()(e,[{key:"init",value:function(e){var t=this;return t.compressedParam={},t.uncompressedParam={},t.trackingParam={},e instanceof Hu&&(t.context=e),t}},{key:"addCompressedParam",value:function(e){return Vu.extend(this.compressedParam,e),this}},{key:"addUncompressedParam",value:function(e){return Vu.extend(this.uncompressedParam,e),this}},{key:"addTrackingParam",value:function(e){return Vu.extend(this.trackingParam,e),this}},{key:"setType",value:function(e){var t="exchange"==e;return this.isExchange=t,this.type="cupid",t&&(this.type="exchange"),this}},{key:"addFrontendParam",value:function(){var e={md5Version:1},t=this.context;return t&&(e.uploadId=t.getVal("uploadId"),e.clientVersion=t.getVal("clientVersion"),e.sdkVersion=t.getVal("sdkVersion"),e.videoEventId=t.getVal("vvId"),e.startTime=t.getVal("startTime")||0),this.addUncompressedParam(e),this}},{key:"mergeUncompressedParam",value:function(){var e=Hl(this.uncompressedParam);return this.addCompressedParam(e),this}},{key:"setEvent",value:function(t){var i=this;return i.eventName=e.normalizeEventName(t),i.eventCode=e.getEventCodeByName(i.eventName),i.compressedParam.a=i.uncompressedParam.type=i.eventCode,i}},{key:"encryptParam",value:function(){var t=this,i=e.encryptCupid;return t.isExchange&&(i=e.encryptExchange),i(t.compressedParam,t.context,t.trackingParam),t}},{key:"getUrl",value:function(){var t=this,i=e.cupidUrl,a="";t.isExchange&&(i=e.exchangeUrl);var n=t.compressedParam||{},r=t.trackingParam||{},s={};return Vu.forIn(n,(function(e,t){Vu.has(r,t)||(s[t]=e)})),Vl.empty(r)||(a="&"+Ku(r,"&","=",{keepRaw:!0})),i=i+"?"+Ku(s)+a,t.url=i,t}},{key:"_send",value:function(e){var t=this,i=function(){};t.context&&(i=t.context.getParentByName("sdk").logger.getLogger("qiyitracking"));i("send",t.type,t.eventName),i("verbose send",t.type,t.eventName,t.uncompressedParam,t.compressedParam,t.trackingParam);var a=Date.now(),n=t.url;return/https/i.test(window.location.protocol)&&(n=n.replace(/^http:/,"https:")),i("url",n),yc({url:n,dataType:"jsonp",jsonpCallback:"cb",timeout:1e4,success:function(i,n){t.response={textStatus:n,duration:Date.now()-a,data:i},e()},error:function(){t.response={textStatus:"timeout",duration:Date.now()-a,data:"error"},e()},complete:function(i,n){"timeout"==n&&(t.response={textStatus:n,duration:Date.now()-a,data:"error"},e())}}),t}},{key:"send",value:function(e){return this.addFrontendParam().mergeUncompressedParam().encryptParam().getUrl()._send(e)}},{key:"sendPingback",value:function(e){var t,i=this,a={pingbackType:"tracking",subtype:"success",requestCount:-1},n=i.response,r=function(){};i.context&&(r=i.context.getParentByName("sdk").logger.getLogger("qiyitracking"));Vu.includes(n.data,"ok")?(r("response success",n),a.requestDuration=n.duration):(r("error",n),a.subtype="error",t=601,"timeout"==n.textStatus?t=602:"success"!=n.textStatus&&(t=603)),i.isExchange?(a.pingbackType="exchange",Vl.number(t)&&(t+=500)):i.isQixiao&&(a.pingbackType=undefined,Vl.number(t)&&(t+=900)),a.errorCode=t;var s=i.context;"slot"==i.context.ContextName&&(s={slot:i.context}),a.adInfo=Ic(s),Rc(i.context,a,e)}}],[{key:"getEventCodeByName",value:function(e){return Fl[e]}},{key:"normalizeEventName",value:function(e){return e=Ul[e]||e}},{key:"encryptCupid",value:function(e,t,i){var a=Date.now();t&&(a+=t.getVal("deltaTime")||0),e.b=parseInt(a/1e3);var n=Vu.map("a b c d r".split(" "),(function(t){return e[t]==undefined||null==e[t]?i[t]:e[t]}));e.s=Xc(n.join("")+"cupid")}},{key:"encryptExchange",value:function(e,t,i){var a=Date.now();t&&(a+=t.getVal("deltaTime")||0),e.b=parseInt(a/1e3);var n=Vu.map("a v b c r d q".split(" "),(function(t){return e[t]==undefined||null==e[t]?i[t]:e[t]}));e.s=Xc(n.join("")+"qax-track")}},{key:"send",value:function(t,i,a,n,r){var s=new e;s.init(a).addTrackingParam(i).addUncompressedParam(t).setType(n).setEvent(r).send((function(){s.sendPingback()}))}}]),e}();Wl.cupidUrl="https://t7z.cupid.iqiyi.com/track2",Wl.exchangeUrl="https://t7z.cupid.iqiyi.com/etx";var jl=Vu.is;function Gl(e,t){return Vu.trim(function(e,t){return zl(e,t||e.clickThrough,1)}(e,t||e.clickThrough))}function zl(e,t,i){t=t||"",t=Vu.trim(t);var a,n=function(e){var t=e.getVal("userIP"),i=e.getVal("cupidUserId"),a=e.getVal("uaaUserId"),n=e.getVal("requestId"),r=e.getVal("clickArea"),s=e.getVal("trueviewSource");return{"[UDID]":i,"[M_IDFA]":a,"[IDFA]":i,"[IQIYI_HCID]":i,"[IQIYI_FCID]":a,"[QIYI_ID]":a,__UDID__:i,__IP__:t,"[M_ADIP]":t,"[M%5fADIP]":t,__QRID__:n,__REQUESTID__:n,"[QIYI_AUTHCOOKIE]":e.getVal("passportCookie"),"[IQIYI_OFFSET]":e.getPlayedTime(),CUPID_IAP:"1_10_101",CUPID_CLA:r,CUPID_TRS:s}}(e),r={},s=!0;Vu.each(Vu.compact(e.ies),(function(n){if(Vu.some(n.domain,(function(e){return!!function(e,t){if((t=$c(t)).hostname==e||Vu.endsWith(t.hostname,"."+e))return!0;return!1}(e,t)&&(a=e,!0)})))if(isNaN(i))s=!0,r=Vu.extend(r,n.macroSubstitutionMap);else{var o=a+"_"+i;if(e.iesKeyReplaced[o])return s=!1,!1;var d=Vu.extend({},n.macroSubstitutionMap);for(var u in d)d[u]=d[u]+"_"+i;r=Vu.extend(r,d)}}));var o=t;if(s&&!jl.empty(r)&&(o=Kl(o,r,!0),e.debug("replace url macro",t,o),o!==t)){var d=a+"_"+i;e.iesKeyReplaced[d]=!0}t=Kl(o,n,!0);var u=function(e){var t=Date.now(),i=e.getVal("deltaTime");jl.integer(i)&&(t+=i);return t}(e);return t=function(e,t){return t=t||Date.now(),Kl(e,{"[timestamp]":t,"[M_timestamp]":t,"[TIMESTAMP]":t,"[randnum]":t,__timeStamp__:t,__TS__:t},!0)}(t,u)}function Kl(e,t,i){return Vu.forIn(t,(function(t,a){e=function n(e,t,i,a){if(e&&t){var r=e.split(t);if(i=Vu.tostr(i),e=r.join(i),a){var s=encodeURIComponent(t);s!=t&&(e=n(e,s,i))}}return e}(e,a,t,i)})),e}var Yl=function(){function e(t,i){n()(this,e);t instanceof Hu&&(this.context=t),this.eventName=Wl.normalizeEventName(i),this.eventCode=Wl.getEventCodeByName(this.eventName)}return s()(e,[{key:"sendAll",value:function(){this.sendCupid(),this.sendExchange(),this.sendThirdParty()}},{key:"sendCupid",value:function(){var e=this.context;if("ad"==e.contextName){var t=Vu.get(e,"iqiyiTracking.cupidTracking")||{};if(Vu.includes(t.events,this.eventCode)){var i=t.trackingParam;Wl.send({},i,e,"cupid",this.eventName)}}}},{key:"sendExchange",value:function(){var e=this.context;if("ad"==e.contextName){var t=Vu.get(e,"iqiyiTracking.exchangeTracking")||{};if(Vu.includes(t.events,this.eventCode)){var i=t.trackingParam;Wl.send({},i,e,"exchange",this.eventName)}}}},{key:"sendThirdParty",value:function(){var e=this,t=e.getThirdParty(),i=e.context.getVal("pingbackConfig")||{},a=e.context.getParentByName("sdk").logger.getLogger("tracking"),n=Vu.keys(i);Vu.each(t,(function(t){a("send","thirdParty",e.eventName,t);var r=Vu.find(n,(function(e){return Vu.startsWith(t,e)}));if(r){a("match pingback config",r);var s=new Wl;s.context=e.context,s.url=t,s.isQixiao=!0,s._send((function(){s.sendPingback(i[r])}))}else xc(t)}))}},{key:"getThirdParty",value:function(){var e=this,t=e.context;if("ad"!=t.contextName)return[];var i=e.eventName,a=Vu.get(t,i+"Tracking.thirdPartyTracking"),n=Vu.get(t,["eventTracking",i]),r=Vu.compact(Vu.union(a,n));return Vu.map(r,(function(i){return function(e,t,i){return t=Vu.trim(zl(e,t,i))}(t,i,e.eventCode)}))}}],[{key:"send",value:function(t,i){new e(t,i).sendAll()}}]),e}(),Ql="postMessage"in window,Jl=function(){function e(t){n()(this,e);t=t||{},this.type=t.type,this.callback=null,this.element=t.element,this.aresToEos()}return s()(e,[{key:"aresToEos",value:function(){var e=this;Ql||(e.element.contentWindow.navigator.eosMessage=function(t){e.callback(t)})}},{key:"listen",value:function(e){var t=e||function(){};this.callback=t,Ql&&window.addEventListener("message",this.callback,!1)}},{key:"send",value:function(e){Ql?this.element.contentWindow.postMessage(e,"*"):(0,window.navigator.eosMessage)({data:e})}}]),e}(),Xl=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,e,i))).mw=a.vv.mw,a.$video=a.vv.mw.video(),a.isOutVideo=!1,a.isRatioFixed=!0,a.canExpand=!0,"roll"==a.type&&(a.renderType="roll",i.$adzone=a.$adzone=a.$adContainer),a.creativeUrl=a.creativeUrl||a.creativeObject.url,a.renderType=a.renderType||ql(a.creativeObject.url),"mraid"==a.type&&(a.creativeMode="Interactive"),a.hasPlaying=!1,a.size={},a.isSkippableAd="skippable"==i.deliverName(),a.showGuide=!1,a}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this,t=this.ad;return"mraid"==e.type&&e.vv.mw.isFullScreen()&&e.vv.exitFullscreen(),new Promise((function(i,a){if(e.isStopped)return a(new Error("has ended"));if(e.trySetCrazyMode(),e.log("load"),"roll"==e.renderType){var n=e.vv,r="mp4";/data/i.test(n.mw.getEngineType())&&(r="f4v");var s=function(e,t,i){e=e||{};var a=Bl[t]||1024,n=Vu.map(Nl,(function(t){var n=-1,r=t.key,s=e[r];return i==t.videoFormat&&(s=e[r],Rl.empty(s)||(n=2e3+(t.priority||0),a>=t.minBandwidth?n+=t.minBandwidth:n+=1/t.minBandwidth)),Vu.extend({score:n,video:s},t)})),r=Vu.max(n,(function(e){return e.score}));if(r.score>0){var s="g",o=r.minBandwidth;return o<=170?s="b":o>1536&&(s="c"),r.videoDefinition=t,r.definitionLevel=s,r}}(t.creative.creativeObject,n.videoDefinition,r);if(s){e.log("matched ad video",s),t.matchedVideo=s;var o=s.video;"mp4"==r&&(o+="?pv=0.2"),e.creativeUrl=t.creativeUrl=o,i()}else{var d=new Error("fail to match ad video",t.creative.creativeObject);t.emit("error",d),a(d)}}else if("html"==e.renderType)i(e.loadMraid()),t.error||t.emit("creativeLoad");else{a(new Error("unknown template render type"))}}))}},{key:"loadRollToVideo",value:function(){var e=this.ad,t=this.vv.mw,i=this;if("roll"==i.renderType){e.on("video-playing",(function n(){var t=e.slot.ads[e.index()-1],a=!0;t&&("ended"==t.state||t.error||e.error||(a=!1)),a?(i.onFirstPlaying(),e.off("video-playing",n)):i.log("invalid playing")}));var a={file:i.creativeUrl,id:e.id,type:e.typeName(),seekable:Boolean(e.seekable)||15==e.slot.cuepointType,offset:parseInt(e.slot.startTime),videoEventId:i.vv.videoEventId,duration:e.duration};if(a.file=a.file.replace(/\.qiyi\.com/,".iqiyi.com"),a.file=a.file.replace(/\/\/data\.video\.iqiyi\.com/,"//pcw-data.video.iqiyi.com"),this.log("video load",a,a.videoEventId,e.slot.startTime),t.load(a),0===e.index())e.getParentByName("sdk").loadEndTime=Date.now()}}},{key:"loadMraid",value:function(){var e=this;return new Promise((function(t,i){var a=document.createElement("iframe");a.setAttribute("scrolling","no"),a.setAttribute("frameborder",0),a.style.width="100%",a.style.height="100%",e.creativeElement=a,e.fakeHide(),e.putOnDocument();var n=function(t){var i=t.data;if(i){if("string"==typeof i)try{i=JSON.parse(i)}catch(a){return void e.log("parse data error",a)}i.key==e.msgKey&&("clickandopen"==i.type||"interactive"==i.type?(e.ad.hasInteracted||(e.ad.hasInteracted=!0),"clickandopen"==i.type&&e.ad.emit("clickAndOpen",i.data)):"error"==i.type&&e.log("mraid creative error",i.data))}},r=function(){var a;clearTimeout(s);try{a=e.creativeElement.contentDocument}catch(r){e.log("html creative can not get contentDocument:",r)}a&&a.getElementsByTagName("cupid-iframe").length>0?(e.message=new Jl({type:"mraid",element:e.creativeElement}),e.message.listen(n),t()):(e.log("html creative load error"),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error")))},s=setTimeout((function(){e.creativeElement.removeEventListener("load",r),e.log("mraid html creative load error timeout"),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error"))}),1e4);e.creativeElement.addEventListener("load",r);var o=e.creativeUrl.replace(/^(https:|http:)/,"")+"?isMute=1&domain="+document.domain;e.creativeElement.setAttribute("src",o)}))}},{key:"onFirstPlaying",value:function(){var e=this;if(!e.hasPlaying){e.hasPlaying=!0;var t=e.ad,i=t.slot,a=t.order>1?t.slot.ads[t.order-2]:null;e.vv.stopVideo(e.ad.typeName()),t.isSeekableOriginalRoll()&&e.vv.schedule&&e.vv.schedule.bindAfterSeekedEvt(),t.remain=t.duration,e.log("on first playing"),t.emit("impression"),e.slotDuration=Zl(t.slot.ads),i.hasSkippableAdInSlot&&(e.skippableDuration=$l(t.slot.ads)),e.initProgress();var n=t.deliverName();if("brief"==n&&t.toast)t.getParentByName("sdk").emit("adplayer_showtip",{des:t.toast,time:2});"vip"==n||"origin"==n||"sports-vip"==n||"brief"==n||"overlay-brief"==n||("skippable"==n?n=a&&"skippable"==a.deliverName()?"skippable-after":"skippable-before":"trueView"==n?n="trueview-before":"roll"==e.type?n="normal":"mraid"==e.type&&(n="rolllike")),e.setVideoOptions(n,t,!0)}}},{key:"initProgress",value:function(){var e=this,t=e.ad,i=e.vv.mw,a=[{position:.25,event:"1q"},{position:.5,event:"mid"},{position:.75,event:"3q"},{position:1,event:"sp"}],n=e.isSkippableAd?t.duration+5:t.duration,r=Vu.once((function(){e.timer&&e.timer.stop(),e.timer=null,Vu.remove(a,(function(e){return Yl.send(t,e.event),t.emit("pingback",{subtype:e.event}),!0}));var n=i?i.duration()-i.currentTime():0;n>0&&n<1?setTimeout((function(){e.ad.emit("complete",{type:"timer-complete"})}),1e3):e.ad.emit("complete",{type:"timer-complete"})}));if(n>0){var s=e.timer=new Cl(1e3,n);s.on("timer",(function(){t.remain=t.duration-s.currentCount,e.updateCountdown(),e.vv.adPlayedDurationInView++,Vu.remove(a,(function(i){var a=Math.round(t.duration*i.position);if(s.currentCount==a)return e.log("match quartile",i.event,s.currentCount),Yl.send(t,i.event),t.emit("pingback",{subtype:i.event}),"sp"==i.event&&e.isSkippableAd&&t.sendPlayDurationPingback(t.duration),!0}))})),s.on("timerComplete",r),s.reset(),s.start()}t.on("video-ended",(function(){r()}))}},{key:"play",value:function(){var e=this;return new Promise((function(t,i){if(e.log("ready play roll"),e.isStopped)return i("ended");if("roll"==e.renderType)return e.detectCollision({willDefinitelyCollide:!0}),t();if(e.vv.sdk.emit("single_ad_start",{type:"rollLike"}),e.log("rollLike start play"),e.vv.isCurrentVV&&e.vv.disableVideo(),e.vv.schedule.setCurrentAd(e.ad.id),e.$adzone.style.zIndex="3000",e.vv.mw.isFullScreen()&&e.vv.exitFullscreen(),e.ad.clickThrough&&(e.$adzone.style.cursor="pointer"),e.creativeElement.style.width="100%",e.creativeElement.style.height="100%",e.creativeElement.style.visibility="",e.creativeElement&&e.creativeElement.contentWindow&&e.message){e.msgKey=e.vv.videoEventId+Date.now();try{e.message.send(JSON.stringify({type:"ready",key:e.msgKey}))}catch(a){e.log("stringify data error",a),i(a)}}eh(e.$adzone),eh(e.$adContainer),e.resize(!0),e.onFirstPlaying(),t()}))}},{key:"resume",value:function(){var e=this;return e.log("resume"),e.timer&&e.timer.start(),e.midrollTip&&e.midrollTip.start(),Promise.resolve()}},{key:"pause",value:function(){this.log("pause");var e=this.vv.sdk,t="";e.rollView&&(t=e.rollView.options&&e.rollView.options.theme),!this.timer||this.isSkippableAd&&Vu.includes(t,"guide")||this.timer.stop()}},{key:"updateCountdown",value:function(){var e=this,t=e.ad;e.onFirstPlaying();var i,a,n=t.slot,r=n.ads,s=e.isSkippableAd?t.remain+5:t.remain,o=e.isSkippableAd?t.duration+5:t.duration;if(r.length<=1)i=s;else{var d=Vu.slice(r,t.index()+1);i=s+Zl(d),e.log("countdown",s+"/"+o,i+"/"+e.slotDuration),n.hasSkippableAdInSlot&&(a=s+$l(d)+5)}var u=e.vv.sdk;if(u.viewController&&u.rollView){var c="mraid"==e.type&&e.ad.hasInteracted;u.rollView.updateCountdown(i,c)}if(n.hasSkippableAdInSlot&&!e.isSkippableAd&&u.viewController&&u.rollView&&(e.log("skippable countdown",a+"/"+e.skippableDuration),u.rollView.updateSkippableCountdown(a)),"trueView"==t.deliverName()){var l=t.duration-t.remain;if(l>=t.impressionTime&&t.emit("trueview"),u.rollView){var h=u.rollView.options&&u.rollView.options.theme;if(Vu.includes(h,"before")){var _=t.skipTime-l;_<=0?(e.log("trueview can skip now"),u.rollView.trySetOptions({theme:"trueview-after",ad:t}),u.rollView.updateCountdown(i)):(e.log("trueview countdown",_+"/"+t.skipTime),u.rollView.updateTrueViewCountdown(_))}}}if(e.isSkippableAd){var f=t.duration-t.remain,p=e.mw.duration()-e.mw.currentTime();if(f>=t.impressionTime&&t.emit("trueview"),u.rollView){var g=u.rollView.options&&u.rollView.options.theme;if(Vu.includes(g,"before")){var m=5-f;m<=0?(e.log("skippable can skip now"),u.rollView.trySetOptions({theme:"skippable-after",ad:t}),u.rollView.updateCountdown(i)):(e.log("skippable countdown",m+"/"+e.skippableDuration),u.rollView.updateSkippableCountdown(m))}p>=1&&t.remain<=0&&!e.showGuide&&(e.showGuide=!0,e.loadGuide())}}}},{key:"setVideoOptions",value:function(e,t,i){var a=this,n=a.vv.sdk;n.setViewController((function(){n.rollView.trySetOptions({theme:e,ad:t}),i&&n.rollView.setVipTitle(e,a),a.updateCountdown()}))}},{key:"trySetCrazyMode",value:function(){var e=this;if("mraid"==e.type){var t=e.vv.mw.isFullScreen();e.isOutVideo=!1,e.isRatioFixed=!1,t&&(e.canExpand=!1)}}},{key:"resize",value:function(){var e=this;if(!e.isStopped){var t=e.size;t.videoWidth=e.$video.offsetWidth,t.videoHeight=e.$video.offsetHeight,e.setPosition(),e.$adzone.style.width=t.videoWidth+"px",e.$adzone.style.height=t.videoHeight+"px",e.$adzone.style.top=t.y,e.$adzone.style.left=t.x,e.detectCollision({willDefinitelyCollide:!0})}}},{key:"setPosition",value:function(){var e=this.size,t=this.vv.mw,i=(t.width()-this.$video.offsetWidth)/2,a=(t.height()-this.$video.offsetHeight)/2;e.x=i,e.y=a}},{key:"stop",value:function(e){var t=this;(e=e||{},t.log("stop template",e),t.timer&&t.timer.stop(),t.timer=null,t.isStopped=!0,t.message=null,t.destroyAdzone(),"roll"==t.type&&e.abort&&t.vv.isCurrentVV()&&t.vv.schedule.getCurrentAd()==t.ad&&(t.isSkippableAd&&t.vv.mw.play(),t.log("force abort video"),t.vv.mw.abort()),t.vv.schedule.getCurrentAd()==t.ad&&t.setVideoOptions(),"mraid"==t.type)&&(t.vv.schedule.removeCurrentAd(),t.vv.sdk.emit("single_ad_end",{type:"rollLike"}),t.log("rollLike stop"),t.vv.isCurrentVV()&&t.vv.enableVideo())}},{key:"getDuration",value:function(){var e=this.creativeObject.duration;return e||(e=NaN),e&&e!=Infinity&&(e=parseInt(e)),e}},{key:"loadGuide",value:function(){var e,t=this,i=t.mw,a=t.ad,n=a.slot.ads,r=t.vv.sdk,s=t.isSkippableAd?a.remain+5:a.remain,o=t.isSkippableAd?a.duration+5:a.duration;if(n.length<=1)e=s;else{var d=Vu.slice(n,a.index()+1);e=s+Zl(d),t.log("countdown",s+"/"+o,e+"/"+t.slotDuration)}r.setViewController((function(){r.rollView.updateCountdown(e),r.rollView.trySetOptions({theme:"skippable-guide",ad:a})})),i.pause()}}]),t}(Ml);function Zl(e){return Vu.reduce(e,(function(e,t){return"skippable"==t.deliverName()?e+t.duration+5:e+t.duration}),0)}function $l(e){return Vu.reduce(e,(function(e,t){return"skippable"==t.deliverName()?e:e+t.duration}),0)}function eh(e){e.style.display="",e.style.visibility=""}var th=function(e){function t(e,i){return n()(this,t),d()(this,c()(t).call(this,e,i))}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this.ad,t=this.vv;e.creative.creativeObject.url=Dc(e.creative.creativeObject.url);var i=Vu.extend({id:e.id,orderItemId:e.orderItemId,adZoneId:e.slot.adZoneId,templateType:e.creative.templateType,startTime:e.slot.startTime},e.creative.creativeObject);return t.sdk.emit("adplayer_ad_info",{type:"definitionSwitchingAd",data:{definitionSwitchingAd:i,tvId:t.episodeId,videoEventId:t.videoEventId}}),this.log("notify player definitionSwitchingAd",i),Promise.resolve()}},{key:"play",value:function(){return Promise.resolve()}}]),t}(Ml),ih=function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,e,i));var r=h()(a);return r.isRatioFixed=!0,r.canExpand=!0,r.creativeUrl=r.creativeUrl||r.creativeObject.url,r.renderType=r.renderType||ql(r.creativeUrl),r.isSuperShow=!!r.creativeObject.actUrl,r.size={},Vu.includes(["image","html","video"],r.renderType)||r.ad.emit("error",new Error("unknown render type: "+r.creativeUrl)),r.hasPlaying=!1,r.hasPutOnDoc=!1,r.hasOpenVolumn=!1,a}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this,t=e.ad;return new Promise((function(i,a){if(e.isStopped&&a(new Error("has ended")),e.log("load"),"image"==e.renderType){i(e.loadImage(e.creativeUrl,5e3).then((function(t){e.creativeElement=t,e.size.creativeRawWidth=t.width,e.size.creativeRawHeight=t.height})))}else"html"==e.renderType?i(e.loadHtml()):"video"==e.renderType&&i(e.loadVideo());t.error||t.emit("creativeLoad")}))}},{key:"loadVideo",value:function(){var e=this;return new Promise((function(t,i){var a=document.createElement("video");a.style.width="100%",a.style.height="100%",a.setAttribute("preload","auto"),a.muted=!0,e.creativeElement=a;var n=e.creativeObject.playCount||1;e.fakeHide();var r=setTimeout((function(){e.creativeElement.removeEventListener("loadstart",s),e.log("video creative load error timeout"),e.emitCreativeError("timeout",e.creativeUrl),i(new Error("creative error"))}),15e3),s=function(){var t;e.log("video pause load start");try{t=e.creativeElement}catch(a){e.log("video creative can not get contentDocument:",a)}t?(t.addEventListener("click",l),t.addEventListener("ended",d),t.addEventListener("error",u),t.addEventListener("canplay",c)):(e.log("video creative load error"),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error")))},o=1,d=function(){e.log("current play ended",o+"/"+n),o<n?(this.currentTime=0,this.play(),o++):(this.pause(),e.ad.emit("complete"))},u=function(){e.log("video creative load error"),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error"))},c=function(){clearTimeout(r),e.size.creativeRawWidth=e.creativeObject.width,e.size.creativeRawHeight=e.creativeObject.height,e.log("current play count",o+"/"+n),t()},l=function(){e.ad.emit("click")},h=e.creativeUrl,_=$c(h),f=function(){if(document.createElement("video").canPlayType){var e=document.createElement("video"),t=e.canPlayType('video/ogg; codecs="theora, vorbis"');if(t)return"probably"==t;var i=e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');return!!i&&"probably"==i}return!1}();if(f&&/.+\.mp4$/.test(_.href)){e.creativeElement.addEventListener("loadstart",s),_.query&&!/pv=0.2/.test(_.query)?h+="&pv=0.2":_.query||(h+="?pv=0.2");var p=h.replace(/^(https:|http:)/,"");p=p.replace(/\/\/data\.video\.iqiyi\.com/,"//pcw-data.video.iqiyi.com"),e.creativeElement.setAttribute("src",p),e.putOnDocument()}else e.log("browser support error or video format error",f),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error"))}))}},{key:"loadHtml",value:function(){var e=this;return new Promise((function(t,i){var a=document.createElement("iframe");a.setAttribute("scrolling","no"),a.setAttribute("frameborder",0),a.style.width="100%",a.style.height="100%",e.creativeElement=a,e.fakeHide();var n=setTimeout((function(){e.creativeElement.removeEventListener("load",r),e.log("html creative load error timeout"),e.emitCreativeError("timeout",e.creativeUrl),i(new Error("creative error"))}),1e4),r=function(){var a;clearTimeout(n);try{a=e.creativeElement.contentDocument}catch(r){e.log("html creative can not get contentDocument:",r)}a&&a.getElementsByTagName("cupid-iframe").length>0?(a.addEventListener("click",(function(){e.ad.emit("click")})),t()):(e.log("html creative load error"),e.emitCreativeError("error",e.creativeUrl),i(new Error("creative error")))};e.creativeElement.addEventListener("load",r);var s=e.creativeUrl.replace(/^(https:|http:)/,"");e.creativeElement.setAttribute("src",s+"?isMute=1&domain="+document.domain),e.putOnDocument()}))}},{key:"play",value:function(){var e=this;return new Promise((function(t,i){if(e.isStopped)return i("ended");if(e.isSuperShow){var a=1e3*e.creativeObject.actDuration||2e3;wc(e.creativeObject.actUrl).then((function(t){e.actCreativeElement=t,e.creativeElement.style.display="none",e.superShowPlaying=!0,e.showSuperShow(),e.tryAddStyle(),e.ad.emit("impression"),setTimeout((function(){e.actCreativeElement.style.display="none",e.superShowPlaying=!1,e.ad.aborted||e._play()}),a)}))["catch"]((function(){e.superShowPlaying=!1,e._play()}))}else e._play();t()}))}},{key:"_play",value:function(){var e=this;e.log("play"),e.creativeObject.isSuperPause||(e.$adzone.style.boxShadow="#000 0px 0px 1.4rem"),e.putOnDocument(),e.tryAddStyle(),e.addClickEvt(),e.creativeElement.style.width="100%",e.creativeElement.style.height="100%",e.creativeElement.style.visibility="",e.creativeElement.style.display="",e.ad.clickThrough&&(e.$adzone.style.cursor="pointer"),ah(e.$adzone),e.$adContainer&&ah(e.$adContainer),e.resize(!0),e.isAudioPause()&&e.initAudio(),"video"==e.renderType&&e.creativeElement&&e.creativeElement.play(),e.notifyPlayerAudioPauseStart(),e.onFirstPlaying()}},{key:"showSuperShow",value:function(){var e=this;e.actCreativeElement.style.width="100%",e.actCreativeElement.style.height="100%",e.actCreativeElement.style.visibility="",e.$adzone.appendChild(e.actCreativeElement),e.$adContainer.appendChild(e.$adzone),ah(e.$adzone),e.$adContainer&&ah(e.$adContainer),e.resizeSuperShow()}},{key:"resizeSuperShow",value:function(){var e=this,t={},i=e.vv.mw.video(),a=e.creativeObject;t.videoWidth=i.offsetWidth,t.videoHeight=i.offsetHeight,t.creativeWidth=a.actWidth||980,t.creativeHeight=a.actHeight||540;var n=[980,540];t.boxWidth=t.videoWidth*a.actWidthScale||n[0],t.boxHeight=t.videoHeight*a.actHeightScale||n[1],t.boxWidth=Math.min(t.boxWidth,t.videoWidth),t.boxHeight=Math.min(t.boxHeight,t.videoHeight);var r=Ac({width:t.creativeWidth,height:t.creativeHeight},{width:t.boxWidth,height:t.boxHeight});r.max?(t.scale=r.max,t.computedWidth=t.creativeWidth*t.scale,t.computedHeight=t.creativeHeight*t.scale,e.setPosition(t),e.$adzone.style.width=t.computedWidth+"px",e.$adzone.style.height=t.computedHeight+"px",e.$adzone.style.top=t.y+"px",e.$adzone.style.left=t.x+"px",e.$adzone.style.position="absolute",e.log("resize supershow",t)):e.log("fail to resize"),e.detectCollision()}},{key:"onFirstPlaying",value:function(){var e=this;if(!e.hasPlaying){e.hasPlaying=!0;var t=e.ad;t.remain=t.duration,e.log("on first playing"),t.emit("impression"),"video"!=e.renderType&&e.initProgress(),t.hasDspIcon()&&t.putIcon(t.dspIcon),1==t.targetedAd&&(e.log("precise ad and add icon"),t.putIcon("http://pic9.iqiyipic.com/common/20161221/privacy.png").then((function(e){e.addEventListener("click",(function(){window.open("http://www.iqiyi.com/common/secret.html")}))}))),Infinity!=e.ad.duration&&"video"!=e.renderType&&e.updateCountdown()}}},{key:"resize",value:function(){var e=this;if(e.superShowPlaying)e.resizeSuperShow();else{var t=e.size,i=e.vv.mw.video(),a=e.creativeObject;t.videoWidth=i.offsetWidth,t.videoHeight=i.offsetHeight,t.creativeWidth=a.width,t.creativeHeight=a.height,t.creativeWidth=t.creativeWidth||e.size.creativeRawWidth||300,t.creativeHeight=t.creativeHeight||e.size.creativeRawHeight||250,a.width==e.size.creativeRawWidth&&a.height==e.size.creativeRawHeight||e.log("实际尺寸与填写尺寸不同");var n=[600,500];t.boxWidth=t.videoWidth*a.widthScale||n[0],t.boxHeight=t.videoHeight*a.heightScale||n[1],t.boxWidth=Math.min(t.boxWidth,t.videoWidth),t.boxHeight=Math.min(t.boxHeight,t.videoHeight);var r=Ac({width:t.creativeWidth,height:t.creativeHeight},{width:t.boxWidth,height:t.boxHeight});r.max?(t.scale=r.max,t.computedWidth=t.creativeWidth*t.scale,t.computedHeight=t.creativeHeight*t.scale,e.setPosition(e.size),e.$adzone.style.width=t.computedWidth+"px",e.$adzone.style.height=t.computedHeight+"px",e.$adzone.style.top=t.y+"px",e.$adzone.style.left=t.x+"px",e.log("resize",t)):e.log("fail to resize"),e.detectCollision()}}},{key:"setPosition",value:function(e){var t=this.vv.mw,i=t.video(),a=(t.width()-i.offsetWidth)/2,n=(t.height()-i.offsetHeight)/2;e.x=a+(e.videoWidth-e.computedWidth)/2,e.y=n+(e.videoHeight-e.computedHeight)/2}},{key:"getDuration",value:function(){var e=this.creativeObject.duration;return e||(e=Infinity),e&&e!=Infinity&&(e=parseInt(e)),e&&e!=Infinity&&(e=parseInt(e)),e}},{key:"toggleVideoVolumn",value:function(){var e=this,t=e.ad,i=e.creativeElement;i.muted=!i.muted;var a=i.muted;if(e.log("video pause muted",a),!a){e.hasOpenVolumn||(e.hasOpenVolumn=!0,Bc(t,"clk","volume_button;vss:1"));var n=e.vv.mw.volume();i.volume=n||.15,e.log("video pause volume",i.volume)}return a}},{key:"isAudioPause",value:function(){return!!this.creativeObject.audioUrl}},{key:"initAudio",value:function(){var e=this;e.$audio=document.createElement("audio"),e.$audio.preload="auto";var t=e.creativeObject.audioUrl,i=$c(t);i.query&&!/pv=0.2/.test(i.query)?t+="&pv=0.2":i.query||(t+="?pv=0.2"),e.$audio.src=t.replace(/^(https:|http:)/,""),e.vv.audioPause=e.ad,e.bindAudioEvt()}},{key:"closeAudioPause",value:function(e){var t=this;if(!t.isStopped&&!t.hasClosed)if(t.hasClosed=!0,"manual"!=e)if(t.$audio&&!t.audioError){t.$adzone.classList.add("cupid-fade-out");var i=t.vv.mw.volume();t.log("audio volume",i),t.$audio.volume=i,t.$audio.play()}else t.abortAudioPause();else t.abortAudioPause(e)}},{key:"bindAudioEvt",value:function(){var e=this;e.$audio&&(e.$audio.addEventListener("play",(function(){e.log("audio start play"),e.audioPlayed=!0,e.sendAudioPingback(0)})),e.$audio.addEventListener("ended",(function(){e.log("audio ended"),e.$audio=null,e.sendAudioPingback(1),e.abortAudioPause()})),e.$audio.addEventListener("error",(function(){e.audioError=!0,e.$audio=null,e.audioPlayed&&e.abortAudioPause()})))}},{key:"notifyPlayerAudioPauseEnd",value:function(e){var t=this.vv.sdk;this.log("notify player pause end, is audio:",this.isAudioPause()),t.emit("pause_end",{type:this.isAudioPause()?"audio":"common",status:e||"common"})}},{key:"notifyPlayerAudioPauseStart",value:function(){var e=this,t=e.vv.sdk;e.log("notify player pause start, is audio:",e.isAudioPause()),t.emit("pause_start",{type:e.isAudioPause()?"audio":"common",duration:e.isAudioPause()?2.5:0})}},{key:"abortAudioPause",value:function(e){this.vv.audioPause=null,this.notifyPlayerAudioPauseEnd(e),this.ad.abort()}},{key:"sendAudioPingback",value:function(e){var t=this.ad,i=Ku({acp:e},",",":");Bc(t,"auu",i)}}]),t}(Ml);function ah(e){e.style.display="",e.style.visibility=""}var nh=function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,e,i));var r=h()(a);return r.size={},r.creativeObject=i.creative.creativeObject,r.creativeUrl=r.creativeUrl||r.creativeObject.creativeUrl,r.renderType=r.renderType||ql(r.creativeUrl),r.option={position:"bottom-left"},"image"!==r.renderType&&r.ad.emit("error",new Error("unknown render type: "+r.creativeUrl)),a}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this,t=e.ad;return new Promise((function(i){i(e.loadImage(e.creativeUrl,5e3).then((function(i){e.creativeElement=i,e.size.creativeRawWidth=i.width,e.size.creativeRawHeight=i.height,t.error||t.emit("creativeLoad")})))}))}},{key:"play",value:function(){var e=this;return new Promise((function(t){e.log("play"),e.creativeElement.style.width="100%",e.creativeElement.style.height="100%",e.creativeElement.style.visibility="",e.putOnDocument(),e.tryAddStyle(),e.addClickEvt(),rh(e.$adzone),e.$adContainer&&rh(e.$adContainer),e.resize(!0),e.onFirstPlaying(),t()}))}},{key:"resize",value:function(){var e=this,t=e.size,i=e.vv.mw.video();i&&(t.videoWidth=i.offsetWidth,t.videoHeight=i.offsetHeight);var a=e.creativeObject,n=Vu.split(a.dpi,"*");a?(t.creativeWidth=a.width,t.creativeHeight=a.height,a.width===t.creativeRawWidth&&a.height===t.creativeRawHeight||e.log("实际尺寸与填写尺寸不同")):(t.creativeWidth=n[0]||t.creativeRawWidth||300,t.creativeHeight=n[1]||t.creativeRawHeight||250);var r=[640,100];t.boxWidth=t.videoWidth*a.maxWidthScale||r[0],t.boxHeight=t.videoHeight*a.maxHeightScale||r[1],t.boxWidth=Math.min(t.boxWidth,t.videoWidth),t.boxHeight=Math.min(t.boxHeight,t.videoHeight);var s=Ac({width:t.creativeWidth,height:t.creativeHeight},{width:t.boxWidth,height:t.boxHeight});s.max&&(t.scale=s.max,t.computedWidth=t.creativeWidth*t.scale,t.computedHeight=t.creativeHeight*t.scale),t.computedWidth&&t.computedHeight?(e.setPosition(),e.$adzone.style.position="absolute",e.$adzone.style.width=t.computedWidth+"px",e.$adzone.style.height=t.computedHeight+"px",e.$adzone.style.top=t.y+"px",e.$adzone.style.left=t.x+"px"):e.log("fail to resize"),e.log("resize",t),e.detectCollision()}},{key:"setPosition",value:function(){var e=this.size,t=this.creativeObject,i=this.vv.mw,a=i.video(),n=(i.width()-a.offsetWidth)/2,r=(i.height()-a.offsetHeight)/2,s=e.videoWidth*t.xScale-e.computedWidth/2,o=e.videoHeight*t.yScale-e.computedHeight/2;e.x=n+s,e.y=r+o,this.log("set position size",e)}},{key:"onFirstPlaying",value:function(){var e=this;if(!e.hasPlaying){e.hasPlaying=!0,e.log("on first playing");var t=e.ad;t.emit("impression"),t.remain=t.duration,e.initProgress(),t.hasDspIcon()&&t.putIcon(t.dspIcon)}}},{key:"getDuration",value:function(){var e=this.creativeObject.duration;return e||(e=Infinity),e&&e!=Infinity&&(e=parseInt(e)),e}}]),t}(Ml);function rh(e){e.style.display="",e.style.visibility=""}var sh=298,oh=92,dh=function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,e,i));var r=h()(a);return r.isRatioFixed=!1,r.canExpand=!0,r.creativeUrl=r.creativeObject.imgUrl,r.renderType="viewPoint",r.creativeObject.priceText=function(e){if(e=parseFloat(e),isNaN(e))return"";return"￥"+e}(r.creativeObject.price),r.size={},r.log("render type",r.renderType,r.creativeObject,e),r.hasPlaying=!1,r.hasPutOnDoc=!1,a}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this,t=e.ad;return new Promise((function(i,a){if(e.isStopped)return a(new Error("has ended"));e.log("load");i(e.loadImage(e.creativeUrl,5e3).then((function(t){e.creativeElement=t,e.size.creativeRawWidth=t.width,e.size.creativeRawHeight=t.height}))),t.error||t.emit("creativeLoad")}))}},{key:"play",value:function(){var e=this;return new Promise((function(t,i){if(e.isStopped)return i("ended");e.log("play"),e.tryAddStyle((function(){e.vv.sdk.viewController.renderViewPointTip(e.$adzone,e.creativeObject)})),e.addClickEvt(),e.putOnDocument(),e.creativeElement.style.width="100%",e.creativeElement.style.height="100%",e.creativeElement.style.visibility="",e.ad.clickThrough&&(e.$adzone.style.cursor="pointer"),uh(e.$adzone),e.$adContainer&&uh(e.$adContainer),e.resize(),e.onFirstPlaying(),t()}))}},{key:"onFirstPlaying",value:function(){var e=this;if(!e.hasPlaying){e.hasPlaying=!0;var t=e.ad;t.remain=t.duration,e.log("on first playing");var i=e.vv.sdk;e.log("notify player start_viewpoint"),i.emit("adplayer_ad_info",{type:"start_viewpoint",data:{startTime:t.slot.startTime,templateType:e.type,adUid:t.id,adZoneId:t.slot.adZoneId,videoEventId:e.vv.videoEventId}}),Bc(t,"impression","viewPointTips"),"tips"==e.creativeObject.impressionArea&&e.ad.emit("impression"),e.initProgress(),t.hasDspIcon()&&t.putIcon(t.dspIcon),1==t.targetedAd&&(e.log("precise ad and add icon"),t.putIcon("http://pic9.iqiyipic.com/common/20161221/privacy.png").then((function(e){e.addEventListener("click",(function(){window.open("http://www.iqiyi.com/common/secret.html")}))}))),Infinity!=e.ad.duration&&e.updateCountdown()}}},{key:"getDuration",value:function(){var e=this.creativeObject.duration;return e||(e=10),e!=Infinity&&(e=parseInt(e)),e}},{key:"resize",value:function(){var e=this,t=e.size,i=e.vv.mw.video();t.videoWidth=i.offsetWidth,t.videoHeight=i.offsetHeight,t.displayWidth=298,t.displayHeight=92,t.computedWidth=t.displayWidth,t.computedHeight=t.displayHeight,e.setPosition(),e.$adzone.style.width=t.computedWidth+"px",e.$adzone.style.height=t.computedHeight+"px",e.$adzone.style.top=t.y+"px",e.$adzone.style.left=t.x+"px",e.log("resize",t),e.detectCollision()}},{key:"setPosition",value:function(){var e,t=this.size,i=this.vv.mw,a=i.video(),n=(i.width()-a.offsetWidth)/2,r=(i.height()-a.offsetHeight)/2,s=0;e=t.videoHeight-70-oh,s=40,"right"==this.creativeObject.position&&(s=t.videoWidth-s-sh),t.x=s+n,t.y=e+r}},{key:"reset",value:function(){this.isStopped=!1,this.hasPlaying=!1,this.hasPutOnDoc=!1}},{key:"addClickEvt",value:function(){var e=this;e.clickHandler=function(t){var i=t.target;if("detial-btn"==i.getAttribute("class"))Bc(e.ad,"click","viewPointTipsDetails"),e.ad.emit("clickAndOpen",i),t.preventDefault(),t.stopPropagation();else{e.vv.exitFullscreen();var a=e.ad,n=e.vv.sdk;e.log("notify player expand_viewpoint"),n.emit("adplayer_ad_info",{type:"expand_viewpoint",data:{startTime:a.slot.startTime,templateType:a.creative.templateType,adUid:a.id,adZoneId:a.slot.adZoneId,videoEventId:e.vv.videoEventId}}),Bc(e.ad,"click","viewPointTips")}},e.$adzone&&e.$adzone.addEventListener("click",e.clickHandler)}}]),t}(Ml);function uh(e){e.style.display="",e.style.visibility=""}var ch=function(){function e(t,i){n()(this,e);var a=i.vv.sdk;this.log=a.logger.getLogger("wholeCornerTimer"),this.log("init whole corner timer",i.ad),this.status=this.initStatus(t),this.timer=this.initTimer(),this.ad=i.ad,this.view=i.vv}return s()(e,[{key:"initStatus",value:function(e){return{showStatus:{duration:e.showDuration,showedSeconds:0,currentSlice:0},hideStatus:{duration:e.showInterval,hidedSeconds:0,currentSlice:0},display:!0}}},{key:"initTimer",value:function(){var e=new Cl(1e3);return e.on("timer",this.timerHandler.bind(this)),e}},{key:"timerHandler",value:function(){var e=this.status;(function(e){var t=e.display,i=e.hideStatus;return!t&&i.duration===i.hidedSeconds})(e)&&this.resetToShow(),function(e){var t=e.display,i=e.showStatus;return t&&i.duration===i.showedSeconds}(e)&&this.resetToHide(),e.display&&this.updateShowStatus(),e.display||this.updateHideStatus()}},{key:"resetToShow",value:function(){var e=this.status,t=this.timer,i=this.view.adCollisionDetection;e.display=!0,e.showStatus.currentSlice++,e.hideStatus.hidedSeconds=0,i.wholeCornerCollidedWithOriginalList()?(i.notifyWholeCornerToHide(),t.running&&t.stop(),this.log("wholecorner collisied to others while reset to show, keep hide",e)):(i.notifyWholeCornerToShow(),this.log("reset to show",e,i.wholeCornerCollidedWithOriginalList()))}},{key:"resetToHide",value:function(){var e=this.status,t=this.view.adCollisionDetection;e.display=!1,e.hideStatus.currentSlice++,e.showStatus.showedSeconds=0,t.wholeCornerCollidedWithOriginalList()?(t.notifyWholeCornerToHide(),this.log("wholecorner collisied to others while reset to hide, keep hide",e)):(t.notifyWholeCornerToHide({forceHide:!0}),this.log("reset to hide",e))}},{key:"updateShowStatus",value:function(){this.status.showStatus.showedSeconds++;var e=this.status.showStatus,t=e.showedSeconds,i=e.duration;0!=t%10&&t!=i||this.log("updating show status",t+"/"+i)}},{key:"updateHideStatus",value:function(){this.status.hideStatus.hidedSeconds++;var e=this.status.hideStatus,t=e.hidedSeconds,i=e.duration;0!=t%10&&t!=i||this.log("updating hide status",t+"/"+i)}}]),e}();function lh(e){e.style.display="",e.style.visibility=""}var hh={roll:Xl,crazy:Xl,mraid:Xl,common_pause:ih,definition_switching:th,common_overlay:nh,viewPoint:dh,whole_corner:function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,e,i));var r=h()(a);return r.vv.wholeCorner=i,r.isRatioFixed=!0,r.size={},r.creativeObject=i.creative.creativeObject,r.creativeUrl=r.creativeUrl||r.creativeObject.creativeUrl,r.renderType=r.renderType||ql(r.creativeUrl),r.option={position:"bottom-left"},"image"!==r.renderType&&r.ad.emit("error",new Error("unknown render type: "+r.creativeUrl)),a}return f()(t,e),s()(t,[{key:"load",value:function(){var e=this,t=e.ad;return new Promise((function(i){i(e.loadImage(e.creativeUrl,5e3).then((function(i){e.creativeElement=i,e.size.creativeRawWidth=i.width,e.size.creativeRawHeight=i.height,t.error||t.emit("creativeLoad")})))}))}},{key:"play",value:function(){var e=this;return new Promise((function(t){e.log("play"),e.creativeElement.style.width="100%",e.creativeElement.style.height="100%",e.creativeElement.style.visibility="",e.putOnDocument(),e.tryAddStyle(),e.addClickEvt(),e.initTimerController(),lh(e.$adzone),e.$adContainer&&lh(e.$adContainer),e.resize(!0),e.onFirstPlaying(),t()}))}},{key:"pause",value:function(){this.log("pause")}},{key:"resize",value:function(){var e=this,t=e.size,i=e.vv.mw.video();i&&(t.videoWidth=i.offsetWidth,t.videoHeight=i.offsetHeight);var a=e.creativeObject,n=Vu.split(a.dpi,"*");a?(t.creativeWidth=a.width,t.creativeHeight=a.height,a.width===t.creativeRawWidth&&a.height===t.creativeRawHeight||e.log("实际尺寸与填写尺寸不同")):(t.creativeWidth=n[0]||t.creativeRawWidth||300,t.creativeHeight=n[1]||t.creativeRawHeight||250);var r=[640,100];t.boxWidth=t.videoWidth*a.maxWidthScale||r[0],t.boxHeight=t.videoHeight*a.maxHeightScale||r[1],t.boxWidth=Math.min(t.boxWidth,t.videoWidth),t.boxHeight=Math.min(t.boxHeight,t.videoHeight);var s=Ac({width:t.creativeWidth,height:t.creativeHeight},{width:t.boxWidth,height:t.boxHeight});s.max&&(t.scale=s.max,t.computedWidth=t.creativeWidth*t.scale,t.computedHeight=t.creativeHeight*t.scale),t.computedWidth&&t.computedHeight?(e.setPosition(),e.$adzone.style.position="absolute",e.$adzone.style.width=t.computedWidth+"px",e.$adzone.style.height=t.computedHeight+"px",e.$adzone.style.top=t.y+"px",e.$adzone.style.left=t.x+"px"):e.log("fail to resize"),e.log("resize",t),e.detectCollision()}},{key:"detectCollision",value:function(){var e=this,t=e.ad,i=(e.$adzone||{}).style,a=e.vv.adCollisionDetection,n={id:t.id,x:i.left.replace("px",""),y:i.top.replace("px",""),width:i.width.replace("px",""),height:i.height.replace("px",""),willDefinitelyCollide:!0};e.wholeCornerTimerController&&(n.timer=e.wholeCornerTimerController.timer,n.timerStatus=e.wholeCornerTimerController.status),a.setWholeCorner(n),a.notifyWholeCornerToShow()}},{key:"setPosition",value:function(){var e=this.size,t=this.creativeObject,i=this.vv.mw,a=i.video(),n=(i.width()-a.offsetWidth)/2,r=(i.height()-a.offsetHeight)/2,s=e.videoWidth*t.xScale-e.computedWidth/2,o=e.videoHeight*t.yScale-e.computedHeight/2;e.x=n+s,e.y=r+o,this.log("set position size",e)}},{key:"onFirstPlaying",value:function(){if(!this.hasPlaying){this.hasPlaying=!0,this.log("on first playing");var e=this.ad;e.emit("impression"),e.hasDspIcon()&&e.putIcon(e.dspIcon)}}},{key:"initTimerController",value:function(){var e=this,t=e.ad,i=t&&t.fullCorner?t.fullCorner:{};e.isInterval=!(!i.showDuration||!i.showInterval),e.isInterval&&(e.wholeCornerTimerController=new ch(i,e),e.timer=e.wholeCornerTimerController.timer,e.timer.start())}}]),t}(Ml)};var _h,fh,ph={0:"page",1:"preroll",2:"midroll",3:"postroll",4:"corner",5:"mark",6:"pause",7:"toolbar",8:"viewPoint",9:"overlay",10:"common_overlay",11:"common_overlay",13:"whole_corner",15:"briefRoll"},gh={1:"PMP",2:"trueView",3:"vip",4:"origin",6:"skippable",7:"sports-vip",8:"brief",9:"brief",12:"overlay-brief",13:"brief"},mh={0:{negative:[32,128]},32:{positive:[32,128]}},vh={CODE_S_HTTP_ERROR:301,CODE_S_PARSE_ERROR:304,CODE_VIDEO_HTTP_ERROR:504,CODE_S_INVALID_PLAYER:308,CODE_S_PARAM_ERROR:305,CODE_S_COUPON_NOT_FOUND:309},bh=function(){function e(){n()(this,e)}return s()(e,[{key:"parse",value:function(e){try{e=JSON.parse(e)}catch(t){}return e}},{key:"stringify",value:function(e){try{e=JSON.stringify(e)}catch(t){}return e}},{key:"set",value:function(e,t){t=this.stringify(t);try{localStorage[e]=t}catch(i){}}},{key:"get",value:function(e){var t;try{t=localStorage[e],t=this.parse(t)}catch(i){}return t}}]),e}(),yh=new(function(){function e(t,i){n()(this,e);this.store=i,this.key=t,this.data=this.store.get(t)}return s()(e,[{key:"save",value:function(){this.store.set(this.key,this.data)}}]),e}())("mars",new bh);_h=yh.data||{},fh=(new Date).getDay()!=new Date(_h.timestamp).getDay(),_h.timestamp&&!fh||(yh.data={timestamp:(new Date).getTime(),adPlayedDurationInDay:0,videoPlayedDurationInDay:0},yh.save()),yh.save();var kh=yh,Th=Vu.is,Sh=function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,"ad"));var r=h()(a);return Vu.extend(r,e),r.setParent(i),r.slot=i,r.state="idle",r.memory={},r.elements=[],r.bindEvent(),r.init(),r.setAdMap(),a}return f()(t,e),s()(t,[{key:"init",value:function(){var e=this;e.playTimes=0,e.iesKeyReplaced={},e.id=Vu.compact(["ad",e.getVal("videoEventId"),Vu.uid(),e.comment]).join("-");var t=e.getParentByName("sdk");e.debug=t.logger.getLogger("ad:"+e.id),e.timeSlices=Vu.split(e.timeSlices,","),e.impressionTracking=e.impressionTracking||{},e.clickTracking=e.clickTracking||{},e.eventTracking=function(e){var t={};return Vu.each(e,(function(e){if(e){var i=e.event;Th.array(t[i])||(t[i]=[]),Vu.each(e.trackings,(function(e){t[i].push(e)}))}})),t}(e.eventTracking),e.creative=e.creative||{},function(e,t,i){if(t){var a=Pl(t,e.debug);i("parsed vast",a,t),a.isEmpty?(i("empty vast"),e.sendThirdPartyPingback({errorCode:904,errorMessage:t})):a.error?(i("vast xml parse error",a.error),e.sendThirdPartyPingback({errorCode:903,errorMessage:t})):(function(e,t){if(e&&t){var i="${SETTLEMENT}";Vu.each("redirect clickThrough creativeUrl".split(" "),(function(a){e[a]=Ec(e[a],i,t)})),e.clickTrackings=Vu.map(e.clickTrackings,(function(e){return Ec(e,i,t)})),e.impressionTrackings=Vu.map(e.impressionTrackings,(function(e){return Ec(e,i,t)})),Vu.mapValues(e.eventTracking,(function(e){return Vu.map(e,(function(e){return Ec(e,i,t)}))}))}}(a,e.settle),a.clickThrough&&(e.clickThrough=a.clickThrough),e.dspIcon||(e.dspIcon=a.icon),e.impressionTracking.thirdPartyTracking=Vu.union(e.impressionTracking.thirdPartyTracking,a.impressionTrackings),e.clickTracking.thirdPartyTracking=Vu.union(e.clickTracking.thirdPartyTracking,a.clickTrackings),Vu.forIn(a.eventTracking,(function(t,i){e.eventTracking[i]=e.eventTracking[i]||[],e.eventTracking[i]=Vu.union(e.eventTracking[i],t)})),e.creative.creativeObject=function(e,t,i){t=t||{},"common_overlay"==e?t.creativeUrl=i.creativeUrl||t.creativeUrl:t.url=i.creativeUrl||t.url;return t}(e.creative.templateType,e.creative.creativeObject,a))}}(e,Vu.get(e,"vast.vastObject"),e.debug),e.creative.rawCreativeObject=e.creative.creativeObject,e.creative.creativeObject=function(e){var t={};return Vu.forIn(e,(function(e,i){if(Th.string(e)&&(e=Vu.trim(e)),"true"==e)e=!0;else if("false"==e)e=!1;else{var a=parseFloat(e);a==e&&(e=a)}t[i]=e})),t}(e.creative.creativeObject),e.duration=e.creative.creativeObject.duration,e.seekable=e.seekable||0,e.clickArea="",e.trueviewSource=1,e.adInfo=Ic(e),this.handleAdMsm()}},{key:"handleAdMsm",value:function(){var e=this;e.macroSubstitutionMap&&Vu.forIn(e.macroSubstitutionMap,(function(t,i){t=hl.decode(t),t=encodeURIComponent(t),e.macroSubstitutionMap[i]=t}))}},{key:"bindEvent",value:function(){!function(e){e.on("video-playing",(function(){e.slot.show.request.vv.videoState="playing"})),e.on("video-play",(function(){e.slot.show.request.vv.videoState="play",e.play()})),e.on("video-loadstart",(function(){e.emit("creativeLoad")})),e.on("video-pause",(function(){e.slot.show.request.vv.videoState="paused",e.pause()})),e.on("video-willended",(function(){var t=e.template;"skippable"==e.deliverName()&&(t.showGuide=!0,t.loadGuide())})),e.on("video-ended",(function(){e.emit("complete",{type:"video-ended"})})),e.on("video-error",(function(){var t=e.getParentByName("vv"),i=t.sdk,a=e.slot.show.request;if(i.setViewController(),e.template){e.emit("error",{message:"creative http error",data:{creativeUrl:e.template.creativeUrl}});var n=t.schedule;(e==n.getCurrentAd()||t.isCurrentVV()&&0==e.index())&&e.abort()}a&&a.checkErrorCreativeUrls(e)})),e.on("click",Vu.throttle((function(){e.debug("click",e.adInfo),Yl.send(e,"click"),"skippable"==e.deliverName()&&e.emit("trueview")}),500,{trailing:!1})),e.once("impression",(function(){if(!e.hasImpressed)if("ended"!=e.state||e.slot.isViewPoint()){e.debug("impression",e.creative.templateType,e.orderItemId),e.hasImpressed=!0,e.handleConflict(),e.slot.sendEmptyTrackingBeforeTimeSlice(qc(e.timeSlices)),Yl.send(e,"impression");var t=e.slot.show.request;if(t.sendInventory(),xh(e)){e.debug("roll ad start");var i=t.vv;i.onNetworkFree(),function(e){var t=1===e.slot.cuepointType,i=e.index()===e.slot.ads.length-1;return t&&i}(e)&&i.schedule&&i.schedule.requestWholeCorner(),e.emit("pingback",{subtype:"start"}),Yl.send(e,"start")}}else e.debug("impression 失败, 广告已结束",e)})),e.once("trueview",(function(){e.debug("trueview",e.creative.templateType,e.orderItemId),Yl.send(e,"trueview")})),e.on("skip",(function(t){e.debug("click skip");var i=t||!1;Vu.includes(["trueView","vip","sports-vip"],e.deliverName())||i?e.debug("not send skip click"):e.emit("pingback",{subtype:"skipClick"});var a=e.getParentByName("sdk");if(e.isSkippable()||i){e.debug("skip success");var n={subtype:"skip",customInfo:{ofs:e.getPlayedTime(),skt:e.getSkippedType()}};if("skippable"==e.deliverName()){var r={tag:e.getSkippedStage(),tnr:e.getSlotLength(),cor:e.getVal("order")};Vu.extend(n.customInfo,r)}e.emit("pingback",n),"skippable"==e.deliverName()&&e.sendPlayDurationPingback(e.getPlayedTime()),"trueView"==e.deliverName()&&Yl.send(e,"skip"),a.rollView&&a.rollView.pingback("ply_adskpd"),Vu.each(e.slot.ads,(function(e){e.skipped=!0})),e.emit("end",{type:"skip"})}else a.viewController&&a.viewController.pullCashier(e)})),e.once("creativeLoad",(function(){Rc(e,{pingbackType:"creative",subtype:"load",customInfo:Vu.get(e,"matchedVideo.definitionLevel")})})),e.on("clickAndOpen",(function(t,i){e.hasImpressed||e.slot.isViewPoint()?(e.emit("click"),e.emit("open",t,i)):e.debug("has not impressed")})),e.on("open",Vu.throttle((function(t,i){if(e.debug("open"),Th.element(t)){var a=t;t=a.getAttribute("href"),i=i||a.getAttribute("target")}t=t||Gl(e),Vu.size(t)>2&&window.open(t,i||"_blank")}),500,{trailing:!1})),e.once("complete",(function(t){e.debug("complete");var i=e.getParentByName("vv");(xh(e)&&(kh.data.adPlayedDurationInDay+=e.duration,kh.save()),"pause"==Ph(e))?i.schedule.loadPause({from:e,requestIndex:e.slot.show.request.requestIndex+1}):e.emit("end",t)})),e.once("end",(function(t){if(t=t||{},e.debug("end by",t.type),e.state="ended",e.template){var i={};"timer-complete"==t.type&&(i.abort=!0),e.template.stop(i)}if(Ih(e)){var a=e.getParentByName("vv");Vu.remove(a.currentOverlayAds,(function(t){return e==t}))}Vu.each(e.elements,(function(e){e.parentNode&&e.parentNode.removeChild(e)})),e.slot.isViewPoint()&&e.slot.hasNotifiedStart&&(e.slot.notifyPlayer("adplayer_ad_end"),e.slot.complete()),e.slot.hasInited&&!e.slot.isViewPoint()&&e.tryPlayNextAd(),e.slot.isWholeCorner()?function(e){var t=e.getParentByName("vv").adCollisionDetection;t.setWholeCorner({}),t.notifyWholeCornerToHide()}(e):function(e){var t=e.slot,i=e.getParentByName("vv").adCollisionDetection;if(t.isWholeCorner())return;i.removeAd(e.id),e.debug("wholecorner isvalid",i.wholeCornerIsValid(),";wholecorner status",i.getWholeCorner().showing),i.notifyWholeCornerToShow()}(e)})),e.on("pingback",(function(t){var i=Vu.map(e.slot.ads,(function(e){return e.timeSlices.join("")})).join("|"),a=t.customInfo||{};a.rpt=e.playTimes-1,e.isSeekableOriginalRoll()&&Vu.includes(["1q","mid","3q","sp"],t.subtype)&&(a.sek=e.isSeeked?1:0);var n=e.slot.show.request;n.adBreak&&(t.sequenceId=n.adBreak.sequenceId),t=Vu.extend({},t,{pingbackType:"ad",orderItemId:e.orderItemId,creativeId:e.creative.creativeId,dspId:e.dspId,adStrategy:[e.slot.cuepointType,e.timeSlices.join(""),i].join(":"),customInfo:Ku(a,",",":")}),Rc(e,t)})),e.on("tracking",(function(t){t&&Yl.send(e,t)})),e.on("progressReseted",(function(t){var i=e.template.timer;i&&(i.stop(),Th.number(t)&&(i.currentCount=t,i.start()),e.debug("after ad progress reset to",t,e.template.timer.currentCount))})),e.on("error",(function(t){t=t||{},e.debug("error",t.message,t.data,e.adInfo),e.error=t;var i=t.message;if("creative http error"==i||"creative timeout"==i){var a=Vu.get(t,"data.creativeUrl"),n="creative timeout"==i?505:504;e.emit("creativeError",a,n)}setTimeout((function(){e.state="error"}))})),e.once("creativeError",(function(t,i){Rc(e,{pingbackType:"creative",subtype:"error",errorCode:i,errorMessage:t,requestCount:-1})})),e.on("closeViewPoint",(function(){Bc(e,"close","viewPointTips")}))}(this)}},{key:"index",value:function(){return Vu.indexOf(this.slot.ads,this)}},{key:"tryLoadToVideo",value:function(){var e=this;return e.load().then((function(){return e.isLiving((function(){return e.template.loadRollToVideo()}))}))["catch"]((function(t){var i=e.slot.show.request;i.noCreativeUrlAds&&"fail to match ad video"==t.message&&i.noCreativeUrlAds.push(t.data),e.debug("load to video fail",t)}))}},{key:"load",value:function(){var e=this;return"ended"==e.state?Promise.reject("ended"):e.initTemplate().then((function(){return e.memory.load=e.memory.load||new Promise((function(t){e.debug("load"),e.state="loading",t(e.template.load())})),e.memory.load}))}},{key:"initTemplate",value:function(){var e=this;return e.isLiving((function(){return e.memory.initTemplate=e.memory.initTemplate||new Promise((function(t,i){e.template=function(e){var t=e.creative.templateType,i=hh[t];if(i)return new i(t,e)}(e),e.template?(e.duration=e.template.getDuration(),isNaN(e.duration)?i(new Error("invalid duration")):(e.debug("init template success"),"trueView"!=e.deliverName()&&"skippable"!=e.deliverName()||(e.impressionTime=function(e,t){var i=Vu.endsWith(e,"%"),a=parseFloat(e);i&&(e=t*a/100);e>=0&&e<=t||(e=t/2);return e=parseInt(e)}(e.impressionTime,e.duration),e.skipTime=function(e,t){(e=parseInt(e))>=0&&e<=t||(e=Math.min(5,t));return e}(e.skipTime,e.duration)),t())):(Rc(e,{pingbackType:"statistics",subtype:"unsupported"}),i(new Error("unknown template:"+e.creative.templateType)))}))["catch"]((function(t){return e.emit("error",t),Promise.reject(t)})),e.memory.initTemplate}))}},{key:"setAdMap",value:function(){this.getParentByName("sdk").adMap[this.id]=this}},{key:"getPlayedTime",value:function(){return(this.duration||0)-(this.remain||0)}},{key:"play",value:function(){var e=this;return e.isLiving((function(){return e.load()})).then((function(){return e.isLiving((function(){if("paused"==e.slot.show.request.vv.videoState&&xh(e)&&"roll"==e.template.type)return Promise.resolve();if("paused"==e.state)return e.resume();if("playing"!=e.state){e.playTimes++,e.state="playing";var t=e.slot.show.request;return"pause"==t.type&&t.from&&t.from.abort(),e.isConflict()?Promise.reject(new Error("conflict")):(Ih(e)&&e.getParentByName("vv").currentOverlayAds.push(e),(e.slot.isViewPoint()||e.slot.isWholeCorner())&&e.slot.notifyPlayer("adplayer_ad_start"),e.debug("ad template play",e),e.template.play())}}))}))["catch"]((function(t){return e.error=e.error||t,e.debug("play error",e.error.message),e.error&&e.emit("end",{type:"error"}),Promise.reject(t)}))}},{key:"resume",value:function(){var e=this;return e.isLiving((function(){e.debug("resume");var t=e.template;return e.state="playing",t&&Th.fn(t.resume)?t.resume():t.play()}))}},{key:"tryPlayNextAd",value:function(){var e=this,t=e.slot.ads[e.index()+1];t?t.skipped?t.tryPlayNextAd():(e.debug("play next ad"),t.play()):e.skipped||e.aborted?e.slot.end():e.slot.complete()}},{key:"abort",value:function(){this.aborted=!0,this.emit("end",{type:"abort"})}},{key:"pause",value:function(){var e=this;return e.isLiving((function(){e.state="paused",e.template.pause()}))}},{key:"isLiving",value:function(e){var t;if(this.error?t=this.error:"ended"==this.state&&(t="ended"),t)return Promise.reject(t);var i=e();return Promise.resolve(i)}},{key:"deliverName",value:function(){return gh[this.deliverType]||""}},{key:"typeName",value:function(){return Ph(this)}},{key:"hasDspIcon",value:function(){return!(1!=this.isDSP||!this.dspIcon)}},{key:"putIcon",value:function(e,t){var i=this;return t=t||{},/\.qiyipic\.com/.test(e)&&(e=e.replace(/\.qiyipic\.com/,".iqiyipic.com")),wc(e).then((function(a){return i.$adzone?(i.debug("put icon",e),a.style.bottom=(t.bottom||0)+"px",a.style.left=(t.left||0)+"px",a.style.width="25px",a.style.height="25px",a.style.position="absolute",i.$adzone.appendChild(a),i.elements.push(a),a):new Error("no adzone")}))}},{key:"reset",value:function(){var e=this;e.debug("reset"),e.off(),e.bindEvent(),e.state="idle";var t=e.template;t&&t.reset&&t.reset()}},{key:"isConflict",value:function(){if(Ih(this)){var e=this.slot.show.request.vv.currentOverlayAds;if(Vu.some(e,(function(e){return e.slot.isViewPoint()})))return!0}return!1}},{key:"handleConflict",value:function(){var e=this,t=e.slot.show.request,i=t.vv.currentOverlayAds;"pause"!=t.type&&"midroll"!=t.type||Vu.each(i,(function(e){var i=e.$adzone;i&&(i.style.display="none"),"midroll"==t.type&&e.pause()}));var a=Vu.filter(i,(function(t){if(e!=t){if(e.slot.adZoneId==t.slot.adZoneId)return!0;if(e.slot.isViewPoint())return!0}return!1}));Vu.each(a,(function(t){e.debug("same adzone conflict",e.orderItemId,"kill",t.orderItemId),t.abort()}))}},{key:"isSkippable",value:function(){return!!Vu.includes(["trueView","vip","sports-vip"],this.deliverName())||function(e){var t=e.getParentByName("vv"),i=t.sdk;if(!i.isVIP)return!1;if("tw"===i.locale&&i.isVIP)return!0;var a=t.videoInfo.videoType||0,n=i.vipCheckResult.userVipType||0,r=mh[a];if(!r)return!0;if(Vu.has(r,"positive"))return function(e,t){return Eh(e,t)>0}(r.positive,n);if(Vu.has(r,"negative"))return!function(e,t){return Eh(e,t)===t}(r.negative,n)}(this)}},{key:"getSkippedType",value:function(){return{2:1,3:2,6:4,7:5}[this.deliverType]}},{key:"resize",value:function(){var e=this;return e.isLiving((function(){"paused"!=e.state&&"playing"!=e.state||e.template.resize()}))}},{key:"isSeekableOriginalRoll",value:function(){return"origin"==this.deliverName()&&Boolean(this.seekable)||15==this.slot.cuepointType}},{key:"sendThirdPartyPingback",value:function(e){Rc(this,Vu.extend({pingbackType:"statistics",subtype:"tps"},e))}},{key:"getSkippedStage",value:function(){return this.remain<=0?2:1}},{key:"getSlotLength",value:function(){return this.slot.ads.length}},{key:"sendPlayDurationPingback",value:function(e){Bc(this,"vpd","pt:0,pc:1,pd:"+e+",pg:"+e)}}]),t}(Hu);function Ph(e){var t=e.slot.cuepointType||-1;return ph[t]||t}function xh(e){return Vu.includes([1,2,3,15],e.slot.cuepointType)}function Ih(e){return Vu.includes([8,10,11],e.slot.cuepointType)}function Eh(e,t){return Array.isArray(e)?"number"!=typeof t?0:Vu.sum(e)&t:0}var Dh=Vu.is,wh=function(e){function t(e,i,a){var r;n()(this,t),r=d()(this,c()(t).call(this,"slot"));var s=h()(r);return s.setParent(a),Vu.extend(s,e),s.show=i,s.state="idle",s.id=Vu.uid(),s.debug=a.vv.sdk.logger.getLogger("slot"),s.hasNotifiedStart=!1,s.hasInited=!0,s.hasRequestedVipDoc=!1,s.skipAdParams={},s.parseAd(),s.hasSkippableAdInSlot=s.hasSkippableAdInSlots(),r}return f()(t,e),s()(t,[{key:"parseAd",value:function(){var e=this;this.ads=this.ads.map((function(t){return new Sh(t,e)}))}},{key:"play",value:function(){if(1===this.cuepointType&&this.initSlotInfo(),Dh.empty(this.ads))0xe8d4a512a0!=this.adZoneId&&this.complete();else{var e=this.ads[0];e&&(this.notifyPlayer("adplayer_ad_start"),this.state="playing",e.play())}}},{key:"abort",value:function(){"ended"!=this.state&&(this.debug("abort"),Vu.each(this.ads,(function(e){e.abort()})),this.end())}},{key:"hasImpressed",value:function(){return Vu.some(this.ads,(function(e){return e.hasImpressed}))}},{key:"tryLoadToVideo",value:function(){return Vu.reduce(this.ads,(function(e,t){return e.then((function(){return t.tryLoadToVideo()}))}),Promise.resolve())}},{key:"complete",value:function(){if(this.debug("slot complete",this.state),this.sendEmptyTrackingBeforeTimeSlice(Infinity),2==this.cuepointType&&this.hasImpressed()){var e=this.request.adBreak;e&&!e.hasMidrollPlayed&&(e.hasMidrollPlayed=!0,this.request.vv.midrollPointsPlayedInView++)}this.end()}},{key:"isViewPoint",value:function(){return Vu.includes([8],this.cuepointType)}},{key:"isWholeCorner",value:function(){return Vu.includes([13],this.cuepointType)}},{key:"index",value:function(){return Vu.indexOf(this.request.slots,this)}},{key:"end",value:function(){(this.hasNotifiedStart&&this.notifyPlayer("adplayer_ad_end"),Vu.includes([1,2,3],this.cuepointType))&&(this.request.vv.lastRollCompleteTime=Date.now());if("preroll"==this.request.type)return this.state="ended",this.debug("preroll slot ended"),1!=this.cuepointType||Dh.empty(this.ads)||this.request.vv.startVideo("preroll"),void this.playNextSlot();"ended"==this.state||this.isViewPoint()||(this.state="ended",this.debug("slot ended"),this.request.end())}},{key:"playNextSlot",value:function(){var e=this.request.slots[this.index()+1];e?Dh.empty(e.ads)?e.end():e.play():15==this.cuepointType?this.request.end("briefRoll"):this.request.end()}},{key:"reset",value:function(){this.state="idle",Vu.each(this.ads,(function(e){e.reset()}))}},{key:"sendEmptyTrackingBeforeTimeSlice",value:function(e){var t=this,i=t.emptyTracking||{};isNaN(e)||Vu.remove(i.timeSlices,(function(a){var n=qc(a.w);if(!isNaN(n)&&n<=e){t.debug("send empty tracking before",e,t.adZoneId);var r=Vu.extend({},a,i.trackingParam);return Wl.send({},r,t,"cupid","impression"),!0}}))}},{key:"notifyPlayer",value:function(e){var t=this.getParentByName("sdk"),i={ctp:this.cuepointType,id:this.id};this.cuepointType>=1&&(this.hasNotifiedStart=!("adplayer_ad_start"!=e),this.debug("slot notifyPlayer:",e,i),t.emit(e,i))}},{key:"initSlotInfo",value:function(){var e=this.request;e.blackscreenDuration=this.countRollDuration(),e.noCreativeUrlAds=[],e.errCreativeUrlAds=[]}},{key:"countRollDuration",value:function(){if(!this)return 0;if(Dh.empty(this.ads))return 0;var e=this.ads;return Vu.reduce(e,(function(e,t){return t.error?e:"skippable"==t.deliverName()?e+t.duration+5:e+t.duration}),0)}},{key:"hasSkippableAdInSlots",value:function(){var e=this.ads;return Vu.some(e,(function(e){return"skippable"==e.deliverName()}))}}]),t}(Hu);function Ah(){return function(){if(!Tc())return!0;var e=Oh();return!e||!1!==e.upd}()?0:1}function qh(e){"preroll"!=e.type||function(){var e=Oh();if(!e)return!1;var t=e.ct||0;return(new Date).getTime()-t<864e5}()||setTimeout(Lh,0)}function Oh(){var e=Sc("QC175");if(!e)return!1;try{e=JSON.parse(e)}catch(t){return console.log("parse qc175 error",t),!1}return e}function Lh(){var e=Tc();if(e){var t="https://userpref.iqiyi.com/apis/userpref/list.action?"+Ku({authcookie:e,props:"upd",agentType:1});yc({url:t,dataType:"jsonp",jsonpCallback:"callback",timeout:5e3,success:function(e,t){var i=e||{};if("success"==t&&"A00000"==i.code){var a={upd:"1"!==((i.data||{}).upd||{}).value,ct:(new Date).getTime()};Pc("QC175",JSON.stringify(a),{path:"/",domain:"iqiyi.com"})}}})}}var Ch=Vu.is,Mh=function(){function e(t){n()(this,e),this.requestCount=0,this.max=2,this.request=t,this.param={},this.debug=t.vv.sdk.logger.getLogger("show"),this.encryptionParam=this.param.encryption={}}return s()(e,[{key:"load",value:function(){return this.setParam().normalizeRequestParam().compressParamKey().encryptShowParam().getUrl().sendRequest()}},{key:"addEncryptionParam",value:function(e){Vu.extend(this.encryptionParam,e)}},{key:"addParam",value:function(e){Vu.extend(this.param,e)}},{key:"setParam",value:function(){var e=this.request,t=e.vv.sdk,i=e.vv;t.updateUser(i),this.addParam(Vu.extend({timestamp:Date.now(),requestId:e.requestId},e.getMultiVals(["adPlayerId","uaaUserId","passportId","requestId"])));var a=$c(window.document.referrer||"")||{},n=function(){var e=window.location.href,t="";try{t=decodeURIComponent(e)}catch(i){}return t=(t=t.split("?")[0].split("#")[0]).replace(/[\u200B-\u200D\uFEFF]/g,"")}(),r=Vu.extend({referrer:a.host,needPolicy:e.needPolicy,url:n.replace(/^https:/,"http:"),ptid:t.ptid||"",vft:e.vft,timePoint:t.timePoint,usePartnerData:Ah(),cuepointList:e.cuepointList,supportIQiyiTracking:!0,supportEmptyTracking:!0,encryptionVersion:""},e.getMultiVals("episodeId albumId videoDuration isVIP isPreload clientVersion sdkVersion searchQuery passportCookie requestIndex vvId pauseRequestTimes prerollOrderItemIds playSource".split(" ")));if("preroll"==e.type&&!i.isPreload&&"iqiyiw"==t.site&&!i.isAutoMapPlayerId&&i.couponCode&&i.couponVer&&n&&1==t.vvCnt&&(r=Vu.extend(r,e.getMultiVals("couponCode couponVer".split(" ")))),"preroll"==e.type){var s=Oc();if(s)1e3*+s.exptime-Date.now()<72e5||(r=Vu.extend(r,{idx:s.idx}))}this.addEncryptionParam(r);var o=i.getContinuingVVs(),d={continuingVideoPlayedCount:o.length,continuingVideoPlayedDuration:Vu.sumBy(o,"videoDuration"),continuingAdPlayedDuration:Vu.sumBy(o.concat(i),"adPlayedDurationInView")};this.addEncryptionParam(d);var u={adPlayedDurationInDay:kh.data.adPlayedDurationInDay},c=i.mw.videoPlayedDurationInDay();return c&&(c=parseInt(c)),u.videoPlayedDurationInDay=c||0,"midroll"==e.type&&(u.midrollPointsPlayedInView=i.midrollPointsPlayedInView,u.lastMidrollRequestTime=i.lastMidrollRequestTime,i.lastRollCompleteTime&&(u.lastRollCompleteInterval=Math.round((Date.now()-i.lastRollCompleteTime)/1e3))),this.addEncryptionParam(u),this}},{key:"normalizeRequestParam",value:function(){var e=this;return Vu.each(["needPolicy","supportIQiyiTracking","supportEmptyTracking","isVIP","isPreload"],(function(t){var i=e.encryptionParam[t];Ch.bool(i)&&(i=i?1:0),e.encryptionParam[t]=i})),e}},{key:"compressParamKey",value:function(){var e=this;return e.debug("request param",e.param),e.compressedParam=Qu(el)(e.param),e.debug("compressed request param",Vu.extend({},e.compressedParam)),e.compressedParam.e.q=e.compressedParam.e.q.map((function(e){return Ku(e,",",":")})).join(";"),e}},{key:"encryptShowParam",value:function(){var e=this.request.getVal("adPlayerId"),t=Ku(this.compressedParam.e,"&","=",{keepRaw:!0});if(e&&t){var i;try{i=bl.encryptBySeed(t,e)}catch(a){console.error("encrypt error",t,e),i=""}this.compressedParam.e=i}return this}},{key:"getUrl",value:function(){var e="/show2",t=this.compressedParam,i=this.previewParam=function(){var e=$c(window.location.href,!0).query,t="w y z".split(" "),i=Vu.only(e,t);if(Vu.keys(i).length==t.length)return i}();return i&&(this.debug("preview mode",i),e="/preview3",t=Vu.extend({},i,t)),this.url="https://t7z.cupid.iqiyi.com"+e+"?"+Ku(t),this.debug("show url",this.url),this}},{key:"sendRequest",value:function(){var e=this,t=Date.now();return new Promise((function(i){yc({url:e.url,dataType:"jsonp",jsonpCallback:"cb",timeout:1e4,checkParserError:!0,success:function(e,a){i({textStatus:a,data:e,duration:{start:t,end:Date.now()}})},error:function(a,n){i({textStatus:n,data:a,duration:{start:t,end:Date.now()}}),e.debug("error status:",a,n)},complete:function(a,n){"timeout"==n&&i({textStatus:n,duration:{start:t,end:Date.now()}}),e.debug("show complete",Date.now()-t,n)}})})).then((function(t){return e.onComplete(t)}))}},{key:"onComplete",value:function(e){this.debug("status:",e.textStatus,e.duration);var t=this,i=t.request.vv.sdk;"preroll"==t.request.type&&(i.showTime=e.duration),t.requestCount++;var a={pingbackType:"show",requestDuration:e.duration.end-e.duration.start};if("success"!=e.textStatus){var n={timeout:302,parsererror:304,error:301};return a.errorCode=n[e.textStatus]||301,t.requestCount<t.max?(a.requestCount=t.requestCount,a.subtype="error",Rc(t.request,a),t.debug("show request retry",t.requestCount),t.sendRequest()):(a.requestCount=-1,a.subtype="error",Rc(t.request,a),t.debug("request retry use up"),{error:e.textStatus,errorCode:n[e.textStatus]||301})}return t.debug("response",e.data),a.requestCount=-1,t.parsedShow=function(e,t,i){var a;try{a=bl.decryptShowResponse(t.url,e)}catch(l){a=e}var n=yl(a),r=t.request,s=Vu.extend({},n);if(t.debug("humanize response",s),n.pingbackParam&&(r.pingbackParam=n.pingbackParam),n.request=r,n.errorCode){i.subtype="error";i.errorCode={302400:305,302500:306,302503:307,302600:308}[n.errorCode],i.errorMessage=n.serverError;var o=1==(n.slots&&n.slots[0]||{}).cuepointType;if(305===i.errorCode||308===i.errorCode&&"preroll"==r.type&&o){if(Rc(r,i),305===i.errorCode)return{error:"paramerror",data:n};if(308===i.errorCode)return{error:"invalidplayer",data:n}}}else{i.subtype="success";var d=r.vv.sdk,u=r.vv;if(n.cupidUserId&&(d.cupidUserId=n.cupidUserId),n.serverTime&&(r.deltaTime=t.deltaTime=n.serverTime-Date.now()),n.pingbackConfig&&(r.pingbackConfig=n.pingbackConfig),n.clientIP){var c=hl.atob(n.clientIP);d.userIP=c}d.isVIP=d.getUser().isVIP,n.videoInfo&&(u.disableSkipAd=n.videoInfo.disableSkipAd,u.videoInfo=n.videoInfo,Vu.extend(u,n.videoInfo)),n.vipCheckConflict&&(d.isVIP=1==n.vipCheckConflict.isVIP),d.vipCheckResult=n.vipCheckResult||{}}return n.slots=n.slots.map((function(e){return new wh(e,n,r)})),r.slots=n.slots,Rc(r,i),n}(e.data,t,a),qh(t.request),t.parsedShow}}]),e}();var Rh=Vu.is,Bh="requestId adBreak cuepointList needPolicy requestIndex from type vft".split(" "),Nh=function(e){function t(e,i){var a;return n()(this,t),a=d()(this,c()(t).call(this,"request")),h()(a).setParent(i),a.state="idle",a.debug=i.sdk.logger.getLogger("request"),a.type=e.type,a.init(e),a}return f()(t,e),s()(t,[{key:"init",value:function(e){Vu.extend(this,Vu.only(e,Bh));var t=e.requestId||function(e){var t=[e.vv.vvId,Date.now()];return Xc(t.join(""))}(this);this.id=this.requestId=t}},{key:"load",value:function(){var e=this;if("ended"!=e.state)return e.memoryLoad=e.memoryLoad||new Promise((function(t,i){e.state="loading",(e.show=new Mh(e)).load().then((function(i){Rh.empty(i.policySlots)||e.vv.schedule.setPolicy(i.policySlots);var a=e.vv.sdk;if(e.isRoll()){var n;a.requestEndTime=a.loadStartTime=Date.now();var r=e.getSlotByCpt(i.slots,15);if("preroll"==e.type?(n=e.getSlotByCpt(i.slots,1),r&&e.vv.schedule.completeBriefRoll(r)):"midroll"==e.type&&(n=i.slots&&i.slots[0]),n&&!Rh.empty(n.ads)){if("preroll"==e.type){var s=[];Vu.each(n.ads,(function(e){s.push(e.orderItemId)})),e.vv.prerollOrderItemIds=s.join(",")}"mraid"==n.ads[0].creative.templateType&&(a.setViewController(),e.debug("mraid and request vc")),n.tryLoadToVideo(a).then((function(){1===n.cuepointType&&e.checkEmptyCreativeUrls(n),e.loadBriefRoll(r,{reason:"load complete",rollType:e.type})}))["catch"]((function(){a.loadEndTime=a.loadEndTime||Date.now(),e.loadBriefRoll(r,{reason:"load fail",rollType:e.type})})),"midroll"==e.type&&(e.vv.lastMidrollRequestTime=n.startTime,e.vv.schedule.bindVideoTimeEvt(n.startTime-5,(function(){a.setViewController((function(){a.rollView.startMidrollTip()}))})))}else e.checkCoupon(),a.loadEndTime=Date.now(),e.loadBriefRoll(r,{reason:"noad",rollType:e.type})}e.isWholeCorner()&&e.vv.schedule.initWholeCorner(i.slots),t(i)}))["catch"]((function(t){e.debug("show error",t),e.end(),i(t)}))})),e.memoryLoad}},{key:"loadBriefRoll",value:function(e,t){var i=this,a=i.vv.sdk;e&&!Rh.empty(e.ads)?e.tryLoadToVideo(a).then((function(){i.vv.startLoadVideo({reason:"load complete",rollType:"briefRoll"}),"preroll"==i.type&&i.vv.startLoadVideo(t)}))["catch"]((function(){i.vv.startLoadVideo({reason:"load fail",rollType:"briefRoll"}),"preroll"==i.type&&i.vv.startLoadVideo(t)})):("preroll"==i.type&&i.vv.startLoadVideo({reason:"noad",rollType:"briefRoll"}),i.vv.startLoadVideo(t))}},{key:"play",value:function(){var e=this;"ended"!=e.state&&e.load().then((function(t){if("ended"!=e.state){if(t.error)return e.showErrorHandler(t),void e.end();if(t)if(e.trySendInventoryDirectly(t.slots),"secondary"==e.type){var i=[];Vu.each(t.slots,(function(t){8==t.cuepointType?i.push(t):(e.debug("slot cpt",t.cuepointType),t.play())})),i.length>0&&e.vv.schedule.initViewPoint(i)}else{var a=t.slots[0];e.state="playing",a?a.play():e.end()}else e.end()}}))["catch"]((function(t){e.debug("error",t)}))}},{key:"showErrorHandler",value:function(e){var t={paramerror:305,invalidplayer:308,parsererror:304,error:301}[e.error]||301;this.pullAdblockBlackScreen(this,{errorCode:t,errorMessage:e.error,requestCount:this.show.requestCount,cupidUserId:e&&e.data&&e.data.cupidUserId})}},{key:"end",value:function(e){var t=this;t.state="ended",t.sendInventory(),t.isRoll()&&"ended"!=t.vv.state&&t.vv.startVideo(e||t.type)}},{key:"isRoll",value:function(){return"preroll"==this.type||"midroll"==this.type||"briefRoll"==this.type}},{key:"isWholeCorner",value:function(){return"whole_corner"==this.type}},{key:"abort",value:function(){var e=this;if(e.show&&e.show.ajax&&e.show.ajax.abort(),e.slots){var t=e.slots;Vu.each(t,(function(e){e.abort()}))}e.end()}},{key:"reset",value:function(){Vu.each(this.slots,(function(e){e.reset()}))}},{key:"trySendInventoryDirectly",value:function(e){(Rh.empty(e)||"secondary"==this.type)&&this.sendInventory()}},{key:"sendInventory",value:function(){var e=this;if(!e.inventorySent)if(e.inventorySent=!0,e.show&&e.show.parsedShow&&e.show.parsedShow.inventory){e.debug("send inventory");var t=Vu.only(e.show.parsedShow.inventory,"originalInventory rawInventory deliveredInventory forbiddenInventory");Rc(e,Vu.extend({pingbackType:"inventory",subtype:"success"},t))}else e.debug("no data to send inventory")}},{key:"pullAdblockBlackScreen",value:function(e,t){var i=this.vv.sdk;if(!i.isPreload&&(!i.isVIP&&("iqiyiw"==i.site||"ppsw"==i.site))){var a=t.errorCode;!a||-1==Vu.values(vh).indexOf(a)||(t&&(t.pingbackType="statistics",t.subtype="adblock",Rc(e,t)),i.emit("adplayer_ad_block",{videoEventId:this.vv.getVal("videoEventId")}),this.debug("notify player adblock"),i.setViewController((function(){return i.viewController.blackscreen.triggerAdblockCBK(e)})))}}},{key:"checkEmptyCreativeUrls",value:function(e){var t=this.show;this.noCreativeUrlAds.length==e.ads.length&&this.pullAdblockBlackScreen(this,{errorCode:vh.CODE_VIDEO_HTTP_ERROR,errorMessage:"creativeUrl is missing",requestCount:t.requestCount})}},{key:"checkErrorCreativeUrls",value:function(e){this.errCreativeUrlAds&&(this.errCreativeUrlAds.push(e),this.errCreativeUrlAds.length==e.slot.ads.length&&this.pullAdblockBlackScreen(e,{errorCode:vh.CODE_VIDEO_HTTP_ERROR,errorMessage:"video-error"}))}},{key:"checkCoupon",value:function(){var e=this.vv,t=e.sdk,i=window.location.pathname,a=window.location.search,n="iqiyiw"===t.site&&Vu.startsWith(i,"/v_")&&!Vu.includes(a,"list=");e.isPreload||e.couponCode&&e.couponVer||!n||1!=t.vvCnt||this.pullAdblockBlackScreen(this,{errorCode:vh.CODE_S_COUPON_NOT_FOUND,errorMessage:"noad"})}},{key:"getSlotByCpt",value:function(e,t){return Vu.find(e,(function(e){return e.cuepointType==t}))}}]),t}(Hu);var Fh=Vu.is,Uh=function(){function e(t){n()(this,e),t=t||{};var i=this;i.startTime=t.startTime,i.cuepointType=t.cuepointType,i.adZoneId=t.adZoneId,i.sequenceId=t.sequenceId,i.adZoneStyle=t.adZoneStyle,i.state=null,i.request=null,i.hasLoaded=t.hasLoaded||!1,i.ad=t.ad||null,i.slot=t.slot||null,i.priority=0,2==i.cuepointType?i.priority=10:8==i.cuepointType&&(i.priority=9)}return s()(e,[{key:"addInfo",value:function(e){e=e||{};this.slot=e.slot||null}},{key:"isMid",value:function(){return!!(Vu.includes([2,10,11,13,15],this.cuepointType)&&this.startTime>0)}},{key:"isOverlay",value:function(){return!!Vu.includes([8,10,11],this.cuepointType)}},{key:"isValid",value:function(){return Fh.number(this.startTime)&&Fh.number(this.cuepointType)}},{key:"isLoaded",value:function(){return!!(this.request||this.ad||8==this.cuepointType||13==this.cuepointType||this.hasLoaded)}},{key:"refresh",value:function(){this.request=null,this.hasPlayed=!1,this.hasLoaded=!1}},{key:"canLoad",value:function(e){return e>=this.startTime-10&&e<=this.startTime}},{key:"abort",value:function(){this.request?this.request.abort():this.ad&&this.ad.abort()}}]),e}(),Vh=Vu.is;function Hh(e){e&&e.sort((function(e,t){var i=e.cuepointType-t.cuepointType;return 0==i&&(i=e.startTime-t.startTime),i}))}function Wh(e){var t=Vu.filter(e,(function(e){return!jh(e)})),i=Vu.map(t,(function(e){return e.priority})),a=Vu.max(i);return e=Vu.filter(e,(function(e){return!(a!=e.priority&&!jh(e)&&13!==e.cuepointType)||(e.state="banned",!1)}))}function jh(e){if(8!==e.cuepointType)return!1;var t=e.slot||{};return Vh.empty(t.ads)}var Gh=Vu.is,zh=function(e){function t(e){var i;n()(this,t),i=d()(this,c()(t).call(this));var a=h()(i);return a.vv=e,a.videoEventId=e.videoEventId,a.mw=a.vv.mw,a.bindMwEvent(),a.log=e.sdk.logger.getLogger("schedule:"+e.videoEventId),a.adBreaks=[],a.allAdBreaks=[],a.midrollPoints={},a.currentAdId=null,a.hasBindSeeked=!1,a.enabled=!0,a.running=!1,a.init(),i}return f()(t,e),s()(t,[{key:"init",value:function(){this.binVideoEvent(),this.fetchAndPlayPreroll(),this.log("schedule inited")}},{key:"bindMwEvent",value:function(){var e="playing pause waiting error willended ended play timeupdate seeked loadstart afterSeeked pausetoplay".split(" "),t=this;t.handleMwEvt=function(e){var i=e.type,a=Vu.includes(["play","playing","timeupdate"],i),n=e.gas||{};if(t.enabled||("error"==i||"loadstart"==i)&&n.id){var r=n.id;if(n.videoEventId!==t.videoEventId)return;if(a){var s=t.vv.sdk;t.loadedVC||(t.loadedVC=!0,s.setViewController())}if(t.emit(i,e),r){var o=t.vv.sdk.adMap[r];if(o)return a&&t.setCurrentAd(r,o,e),t.stopTimer(),void t.emitToAd(o,"video-"+i,e);t.log("error!, fail to find ad",n),t.mw.abort()}else t.startTimer();t.removeCurrentAd()}else t.mw.pause()},e.forEach((function(e){t.mw.on(e,t.handleMwEvt)}))}},{key:"binVideoEvent",value:function(){var e=this;e.timerHandler=function(t){e.currentTime=Math.round(e.mw.currentTime());var i=Vu.get(t,"data.actionType"),a=Vu.get(t,"data");if("seeked"==t.type&&(e.log("seeked",e.currentTime,i),"controls"==i&&(e.onUserSeeked(a),e.disableAutoChooseMidroll("用户 seek"))),"afterSeeked"==t.type&&(e.log("after seeked",e.currentTime,i),"controls"==i&&e.afterUserSeeked(a)),null==e.lastTime){var n=Vu.get(e,"midrollPoints.nextMidroll");n>0&&n<e.currentTime&&e.disableAutoChooseMidroll("开播时间晚于自动中插点")}e.lastTime!=e.currentTime&&e.updateVideoTime(t)},e.playHandler=function(){if(e.running){var t=e.mw.currentTime();e.log("video play",t),e.tryToStopPause();var i=e.midrollPoints;if(i&&i.autoChoose){var a=i.nextMidrollPoint;-1!=a&&a<t&&e.disableAutoChooseMidroll("自动中插点在当前时间前面")}null==e.getCurrentAd()&&e.showAndResume()}},e.pauseHandler=function(t){var i=Vu.get(t,"data.actionType");(e.log("pause",i),"controls"==i)&&(e.mw.currentTime()&&e.running&&(e.vv.pauseTimes++,e.loadPause(),e.pauseOtherAd()))},e.bindAudioEvt()}},{key:"unbindMWEvent",value:function(){var e="playing pause waiting error willended ended play timeupdate seeked afterSeeked loadstart pausetoplay".split(" "),t=this;e.forEach((function(e){t.mw.off(e,t.handleMwEvt)})),t.off()}},{key:"bindAfterSeekedEvt",value:function(){this.hasBindSeeked||(this.hasBindSeeked=!0,this.on("afterSeeked",this.timerHandler))}},{key:"loadPause",value:function(e){var t=this,i=t.getAdBreaksByType(6);(i=Vu.map(i,(function(e){return Vu.extend({},e,{sequenceId:t.vv.pauseTimes,startTime:t.currentTime})})),Gh.empty(i))?t.log("no pause schedule"):(t.log("load pause"),(e=e||{}).requestIndex=e.requestIndex||1,t.vv.pauseRequestTimes++,t.newAdRequest({adBreak:i[0],requestIndex:e.requestIndex,cuepointList:i,needPolicy:!1,from:e.from,type:"pause"},t.vv).play())}},{key:"tryToStopPause",value:function(){Vu.remove(this.vv.requests,(function(e){if("pause"==e.type)return e.abort(),!0}))}},{key:"pauseOtherAd",value:function(){Vu.each(this.vv.requests,(function(e){Vu.each(e.slots,(function(e){Vu.each(e.ads,(function(e){Vu.includes(["playing","paused"],e.state)&&e.pause()}))}))}))}},{key:"showAndResume",value:function(){var e=this;Vu.each(e.vv.requests,(function(e){Vu.each(e.slots,(function(e){Vu.each(e.ads,(function(e){Vu.includes(["playing","paused"],e.state)&&e.resume()}))}))})),Vu.each(e.vv.currentOverlayAds,(function(t){e.log("show and resume current overlay",t.creative.templateType,t.orderItemId);var i=t.$adzone;i&&(i.style.display="",i.style.visibility="")}))}},{key:"emitToAd",value:function(e,t,i){e&&(/timeupdate/.test(t)||(this.log("emit",t,e.id),e.emit(t,i)))}},{key:"setCurrentAd",value:function(e,t){var i=this;t=t||{},i.lastAdId=i.currentAdId,i.currentAdId=e,i.lastAdId!=i.currentAdId&&i.log("current roll changed ",i.lastAdId," => ",i.currentAdId,t.type)}},{key:"getCurrentAd",value:function(){var e=this.vv.sdk;return this.currentAdId?e.adMap[this.currentAdId]:null}},{key:"removeCurrentAd",value:function(){this.setCurrentAd(null,{type:"remove"})}},{key:"fetchAndPlayPreroll",value:function(){var e=this;e.vv.sdk.initEndTime=e.vv.sdk.requestStartTime=Date.now();var t=e.newAdRequest({needPolicy:!0,cuepointList:[{cuepointType:1},{cuepointType:15}],type:"preroll",vft:e.vv.isPreload?"13":""},e.vv);e.vv.isPreload||t.play()}},{key:"requestSecondaryAd",value:function(){var e=this,t=e.vv.sdk;e.log("try load viewpoint and definitionswitching");var i=e.getAdBreaksByType(8),a=e.getPageAdBreaks(),n=i.concat(a.dsAdBreaks);Gh.empty(n)||this.newAdRequest({needPolicy:!1,type:"secondary",cuepointList:n},e.vv).play();var r=e.vv;if("iqiyiw"==t.site&&a.otherPageAdBreaks.length>0){var s=r.getContinuingVVs(),o={continuingVideoPlayedCount:s.length,continuingVideoPlayedDuration:Vu.sumBy(s,"videoDuration"),continuingAdPlayedDuration:Vu.sumBy(s.concat(r),"adPlayedDurationInView")},d=Vu.extend({continuingInfo:o,policy:a.otherPageAdBreaks,adPlayerId:t.adPlayerId},r.initAresParam);!function(e){var t=0;if(window.ares)e();else var i=setInterval((function(){t++,(window.ares||8==t)&&(clearInterval(i),e())}),1e3)}((function(){if(window.ares&&window.ares.initByMars){var i=window.ares;t.hasInitedAres=!0,i.initByMars(d)}else e.log("not find ares and start load ares"),function(e){var t="//static.iqiyi.com/js/common/ares6.min.js?"+Date.now(),i=document.createElement("script"),a=document.getElementsByTagName("script")[0];i.async=!0,i.src=t,i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){i.onload=null,e()};a.parentNode.insertBefore(i,a)}((function(){if(window.ares){e.log("load ares success");var i=window.ares;t.hasInitedAres=!0,i.initByMars(d)}}))}))}}},{key:"requestWholeCorner",value:function(){var e=this,t=e.getAdBreaksByType(13);Gh.empty(t)||(e.log("start to load whole corner"),this.newAdRequest({adBreak:t,requestIndex:e.vv.requestIndex,cuepointList:t,needPolicy:!1,from:e.vv,type:"whole_corner"},e.vv))}},{key:"newAdRequest",value:function(e,t){var i=new Nh(e,t);return this.vv.requests.push(i),i.load(),i}},{key:"initViewPoint",value:function(e){var t=this,i=t.vv.sdk;if(i.isSupportViewpoint){var a=[];if(Vu.each(e,(function(e){Vu.each(e.ads,(function(e){a.push(e)}))})),!Gh.empty(a)){var n=Vu.map(a,(function(e){var i=e.slot;t.vv.viewPointAdZoneId=i.adZoneId;var a=e.creative.creativeObject;a.imgUrl=Dc(a.imgUrl),a.posterUrl=Dc(a.posterUrl);var n=a.posterList||[];return a.posterList=Vu.map(n,(function(e){return Dc(e)})),e.exportAdObject=Vu.extend({startTime:i.startTime,badge:e.badge,adUid:e.id,source:1,orderItemId:e.orderItemId,dspIcon:e.icon},a),e.exportAdObject})),r=Vu.uniqBy(n,(function(e){return e.startTime}));Gh.empty(r)||t.removeConflictSlotsByViewPoints(a),t.log("notify player init_viewpoint"),i.emit("adplayer_ad_info",{type:"init_viewpoint",data:{ads:n,templateType:"viewPoint",adZoneId:t.vv.viewPointAdZoneId,videoEventId:t.vv.videoEventId,viewPoints:r}})}if(!Gh.empty(e)){var s=Vu.map(e,(function(e){return{ad:e.ads?e.ads[0]:null,slot:e,startTime:e.startTime,adZoneId:e.adZoneId,cuepointType:e.cuepointType}}));t.log("init viewpoint",s),t.addBreaks(s)}}else t.log("page not support viewpoint",i.isSupportViewpoint)}},{key:"initWholeCorner",value:function(e){if(Gh.empty(e))this.log("no whole_corner schedule");else{var t=Vu.map(e,(function(e){var t=e.ads?e.ads[0]:null;return{ad:t,slot:e,startTime:t&&t.startTime?t.startTime:0,adZoneId:e.adZoneId,cuepointType:e.cuepointType}}));this.log("init whole corner",t),this.addBreaks(t),this.hasWholeCornerAdBreak=!0}}},{key:"completeBriefRoll",value:function(e){e?(this.log("complete brief roll",e),this.completeAdBreak(e)):this.log("no brief roll slot")}},{key:"setPolicy",value:function(e){var t=this;t.allAdBreaks=function(e){var t=[];return Vu.each(e,(function(e){Vh.empty(e.startTimes)?t.push(new Uh({cuepointType:e.cuepointType,adZoneId:e.adZoneId,adZoneStyle:e.adZoneStyle})):Vu.each(e.startTimes,(function(i,a){t.push(new Uh({startTime:i,cuepointType:e.cuepointType,adZoneId:e.adZoneId,sequenceId:a+1,adZoneStyle:e.adZoneStyle,hasLoaded:15==e.cuepointType}))}))})),t}(e),t.adBreaks=t.allAdBreaks.filter((function(e){return e.isMid()})),Hh(t.adBreaks),t.log("set policy",t.adBreaks)}},{key:"getAdBreaksByType",value:function(e){return Vu.filter(this.allAdBreaks,(function(t){return Vu.isMatch(t,{cuepointType:e})}))}},{key:"getPageAdBreaks",value:function(){var e=[],t=[];return Vu.each(this.allAdBreaks,(function(i){i&&0==i.cuepointType&&0xe8d4a512a0==i.adZoneId&&t.push(i),i&&0==i.cuepointType&&0xe8d4a512a0!=i.adZoneId&&e.push(i)})),{otherPageAdBreaks:e,dsAdBreaks:t}}},{key:"addBreaks",value:function(e){var t=this;e=Vu.map(e,(function(e){return new Uh(e)})),Vu.each(e,(function(e){e.isValid()&&t.adBreaks.push(e)})),Hh(t.adBreaks)}},{key:"completeAdBreak",value:function(e){var t=e.startTime,i=e.cuepointType;Vu.each(this.adBreaks,(function(a){a.startTime===t&&a.cuepointType===i&&a.addInfo({slot:e})}))}},{key:"bindAudioEvt",value:function(){var e=this;e.on("pausetoplay",(function(){e.log("on pausetoplay");var t=e.vv&&e.vv.audioPause;t&&t.template.closeAudioPause()}))}},{key:"startTimer",value:function(){var e=this;e.running||(e.running=!0,e.log("start schedule timer"),e.on("timeupdate",e.timerHandler),e.on("seeked",e.timerHandler),e.on("play",e.playHandler),e.on("pause",e.pauseHandler))}},{key:"stopTimer",value:function(){var e=this;e.running&&(e.log("stop schedule timer"),e.off("timeupdate",e.timerHandler),e.off("seeked",e.timerHandler),e.off("play",e.playHandler),e.off("pause",e.pauseHandler),e.running=!1)}},{key:"updateVideoTime",value:function(){var e=this;0==e.currentTime%10&&e.log("update video time",e.currentTime),e.emit("videotime:"+e.currentTime),e.lastTime=e.currentTime,e.adBreaksTimeHandler()}},{key:"adBreaksTimeHandler",value:function(){var e=this,t=[],i=[];Vu.each(e.adBreaks,(function(a){"banned"!==a.state&&(a.isLoaded()||a.canLoad(e.currentTime)&&(e.log("adBreak canLoad",a),t.push(a),a.hasPlayed=!1),a.isLoaded()&&(e.currentTime==a.startTime||13===a.cuepointType&&e.currentTime>a.startTime)&&(a.hasPlayed||(i.push(a),a.hasPlayed=!0)))}));var a=Wh(t),n=Wh(i);a.length!=t.length&&e.log("adbreaks to load conflict",a,t),n.length!=i.length&&e.log("adbreaks to play conflict",n,i),Vu.each(a,(function(t){e.log("adbreak load and fill",t);var i=t.cuepointType;t.request=e.newAdRequest({needPolicy:!1,cuepointList:[t],adBreak:t,vft:"",type:ph[i]||i},e.vv)})),Vu.each(n,(function(t){var i=t.request,a=t.ad;e.log("adbreak to play",i,t),i?i.play():a?(a.slot.show.request.reset(),a.play()):8!=t.cuepointType&&13!=t.cuepointType&&15!=t.cuepointType||!t.slot||t.slot.complete()}))}},{key:"onUserSeeked",value:function(e){var t=this,i=t.currentTime;t.log("onUserSeeked",e),e.beforeIsAD||Vu.each(t.adBreaks,(function(a){a.startTime>i&&13!=a.cuepointType&&(a.isLoaded()&&a.hasPlayed||15==a.cuepointType&&t.currentTime<t.lastTime&&t.lastTime>a.startTime&&t.currentTime<a.startTime&&!e.isAD)&&(a.abort(),a.refresh())}))}},{key:"setAutoChooseMidRoll",value:function(e){e&&Gh.bool(e.autoChoose)&&(this.log("自动中插点",e),this.midrollPoints=e,e.autoChoose?this.enableAutoChooseMidroll(e.nextMidroll):this.disableAutoChooseMidroll("初始化"))}},{key:"enableAutoChooseMidroll",value:function(e){this.currentTime>e?this.log("当前时间晚于自动中插点"):(this.log("启用自动中插点",e),Vu.each(this.adBreaks,(function(t){2==t.cuepointType&&(t.startTime==e?t.state=null:t.state="banned")})))}},{key:"disableAutoChooseMidroll",value:function(e){var t=this;!1!==t.midrollPoints.autoChoose&&(t.log("停用自动中插点",e,t.midrollPoints),t.midrollPoints={autoChoose:!1},Vu.each(t.adBreaks,(function(e){2==e.cuepointType&&(e.state=null)})))}},{key:"ban",value:function(e){var t=Vu.filter(this.adBreaks,(function(t){return Vu.isMatch(t,e)}));Vu.each(t,(function(e){e.state="banned"})),this.log("ban ad breaks",e,t)}},{key:"removeConflictSlotsByViewPoints",value:function(e){var t=this,i=t.adBreaks;if(i&&e){var a=Vu.map(e,(function(e){return e.slot.startTime}));t.adBreaks=Vu.filter(i,(function(e){var i=Vu.includes([4,9,10,11],e.cuepointType),n=Vu.includes(a,e.startTime);return!(i&&n)||(t.log("remove conflict points",{startTime:e.startTime,cuepointType:e.cuepointType}),!1)}))}}},{key:"afterUserSeeked",value:function(e){e.beforeIsAD&&this.afterUserSeekedInOriginalRoll(e)}},{key:"afterUserSeekedInOriginalRoll",value:function(e){var t=this.currentTime||0,i=this.getCurrentAd()||null;if(i&&i.isSeekableOriginalRoll()){var a=Boolean(e.beforeIsAD)||!1,n=Number(e.beforeSeek)||0,r={beforeIsAD:a,beforeSeek:n,afterIsAD:Boolean(e.isAD)||!1,afterSeek:t,ad:i||null};this.log("after seeked in original midroll",r),this.seekHandler(r);var s=Ku({ofs:Math.round(n)},",",":");Bc(i,"seek",s),i.isSeeked=!0}}},{key:"seekHandler",value:function(e){var t=e.ad;if(t){var i=Math.round(e.afterSeek),a=function(e){var t=e.beforeIsAD,i=e.beforeSeek,a=e.afterIsAD,n=e.afterSeek,r=i<n,s=t&&a&&!r;if(t&&a&&r)return"forwardInAd";if(s)return"backwardInAd"}(e);"forwardInAd"!==a&&"backwardInAd"!==a||(this.log("seek movement in original midroll",a),t.emit("progressReseted",i))}}},{key:"bindVideoTimeEvt",value:function(e,t){this.on("videotime:"+e,t)}}]),t}(xu);var Kh=function(){function e(t){n()(this,e),this.log=t.sdk.logger.getLogger("collisionDetection"),this.vv=t,this.needDetectingList=[],this.wholeCorner={}}return s()(e,[{key:"addAdIntoCollisingList",value:function(e){if(e.id){var t=Yh(this.needDetectingList,e.id);-1==t?this.needDetectingList.push(e):this.needDetectingList[t]=e,this.log("wholecorner after addAd the list",this.needDetectingList)}}},{key:"removeAd",value:function(e){var t=Yh(this.needDetectingList,e);-1!=t&&this.needDetectingList.splice(t,1),this.log("wholecorner after removeAd the list",this.needDetectingList)}},{key:"wholeCornerCollidedWithOriginalList",value:function(){var e=this.wholeCorner;if(this.wholeCornerIsValid()){var t=this.isCollidedWithOriginalList(e);return this.log("wholecorner collision result",t),t}return this.log("wholecorner does not exist"),!1}},{key:"isCollidedWithOriginalList",value:function(e){for(var t=this.needDetectingList,i=!1,a=0;a<t.length;a++)if(this.checkCollision(t[a],e)){i=!0;break}return this.log("wholecorner happen collising? ",i?"yes":"no"),i}},{key:"notifyWholeCornerToShow",value:function(){var e=this.wholeCorner;if(e&&e.id&&!e.showing&&!this.wholeCornerCollidedWithOriginalList()){var t=this.vv.wholeCorner.$adzone;if(!t)return;if(e.timer&&e.timer.running&&!e.timerStatus.display)return;e.timer&&!e.timer.running&&e.timer.start(),this.log("notify whole corner to show"),t.style.display="",t.style.visibility="",this.wholeCorner.showing=!0}}},{key:"notifyWholeCornerToHide",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=this.wholeCorner,i=t&&t.id&&t.showing,a=this.wholeCornerCollidedWithOriginalList(),n=a||e.forceHide;if(i&&n){var r=this.vv.wholeCorner.$adzone;if(!r)return;if(t.timer&&!t.timer.running)return;t.timer&&t.timer.running&&a&&t.timer.stop(),this.log("notify whole corner to hide"),r.style.display="none",r.style.visibility="hidden",this.wholeCorner.showing=!1}}},{key:"setWholeCorner",value:function(e){this.wholeCorner=e}},{key:"getWholeCorner",value:function(){return this.wholeCorner}},{key:"wholeCornerIsValid",value:function(){return!(!this.wholeCorner||!this.wholeCorner.id)}},{key:"checkCollision",value:function(e,t){if(e.willDefinitelyCollide)return!0;var i=e.y,a=e.x,n=parseFloat(e.x)+parseFloat(e.width),r=parseFloat(e.y)+parseFloat(e.height),s=t.y,o=t.x,d=parseFloat(t.x)+parseFloat(t.width),u=parseFloat(t.y)+parseFloat(t.height);return!(r<s||a>d||i>u||n<o)}}]),e}();function Yh(e,t){for(var i=-1,a=0;a<e.length;a++)if(e[a].id==t){i=a;break}return i}var Qh="videoEventId channelId episodeId albumId videoDefinition videoDuration autoload playSource isPreload isSupportViewpoint couponCode couponVer isAutoMapPlayerId vvId".split(" "),Jh=function(e){function t(e,i){var a;n()(this,t),a=d()(this,c()(t).call(this,"vv"));var r=h()(a);return r.setParent(e),r.mw=e.videoMidware,r.state="idle",r.initAresParam=i,r.requests=[],r.prerollOrderItemIds="",r.videoInfo={},r.lastRollCompleteTime=NaN,r.lastMidrollRequestTime=0,r.midrollPointsPlayedInView=0,r.adPlayedDurationInView=0,r.currentOverlayAds=[],r.pauseTimes=0,r.pauseRequestTimes=0,r.isBusy=!0,r.isAutoMapPlayerId=e.rawAdPlayerId!=e.adPlayerId,r.log=e.logger.getLogger("vv:"+e.videoEventId),r.init(i),a}return f()(t,e),s()(t,[{key:"init",value:function(e){var t=this,i=t.sdk;(e=Vu.extend({playSource:0,isPreload:!1,isAutoMapPlayerId:i.rawAdPlayerId!=i.adPlayerId},e)).vvId=function(e){var t=[e.episodeId,e.uaaUserId,Date.now(),Math.random()];return Xc(t.join(""))}(e);var a=Vu.only(e,Qh);t.log("vv init:",a),Vu.extend(t,a),Rc(t,{pingbackType:"visit",subtype:"success",location:Vu.get(window,"location.href"),customInfo:t.sdk.script}),t.isPreload&&t.sdk.currentVV&&(t.continueFromVV=t.sdk.currentVV);var n,r=Oc();r?t.log("ipdx info: ",r):(n=t,yc({url:"https://iqiyi-ipdx.cn.miaozhen.com/x.gif",dataType:"jsonp",jsonpCallback:"callback",timeout:5e3,checkParserError:!0,success:function(e,t){if("success"==t&&e&&e.ip&&e.geocode&&e.exptime){var i=e,a=new Date(1e3*i.exptime-72e5);Pc("idx",JSON.stringify(i),{expires:a}),Bc(n,"ipdx",t)}else Rc(n,{pingbackType:"statistics",subtype:"ipdx",errorCode:1801,customInfo:t})},error:function(e,t){Rc(n,{pingbackType:"statistics",subtype:"ipdx",errorCode:1802,customInfo:t})},complete:function(e,t){"timeout"===t&&Rc(n,{pingbackType:"statistics",subtype:"ipdx",errorCode:1803,customInfo:t})}})),t.schedule=new zh(t),t.adCollisionDetection=new Kh(t)}},{key:"startVideo",value:function(e){var t=this;if(!0!==t.isVideoPlaying&&"ended"!=t.state){var i={rollType:e,videoEventId:t.videoEventId};t.log("roll-ended",i),t.sdk.emit("roll-ended",i),t.onNetworkFree(),t.schedule&&!t.schedule.hasWholeCornerAdBreak&&t.schedule.requestWholeCorner(),t.schedule&&t.schedule.startTimer(),t.isVideoPlaying=!0,t.sdk.setViewController((function(){t.sdk.rollView.removeOptions("video start")}))}}},{key:"stopVideo",value:function(e){var t=this;if(!1!==t.isVideoPlaying){var i={rollType:e,videoEventId:t.videoEventId};t.log("roll-play",i),t.sdk.emit("roll-play",i),t.schedule&&t.schedule.stopTimer(),t.sdk.setViewController((function(){t.sdk.rollView.midrollTip.end()})),t.isVideoPlaying=!1}}},{key:"isCurrentVV",value:function(){return this==this.sdk.currentVV}},{key:"exitFullscreen",value:function(){var e=this.mw;e.isWebFullScreen()&&(this.log("退出网页全屏"),e.webfullscreentoggle()),e.isFullScreen()&&(this.log("退出全屏"),e.fullscreentoggle())}},{key:"disableVideo",value:function(){this.log("disable video"),this.schedule.enabled=!1;var e=this.sdk;e.setViewController((function(){e.rollView&&e.rollView.showMask()})),this.mw.pause()}},{key:"enableVideo",value:function(){this.log("enable video"),this.schedule.enabled=!0,this.mw.play();var e=this.sdk;e.rollView&&e.rollView.hideMask()}},{key:"onNetworkFree",value:function(){this.isBusy&&(this.log("networt free"),this.isBusy=!1,this.schedule.requestSecondaryAd())}},{key:"abort",value:function(){var e=this;if("ended"!=e.state){e.log("abort"),e.state="ended",e.schedule&&(e.schedule.stopTimer(),e.schedule.unbindMWEvent());var t=e.sdk;e.log("notify player clear viewpoint"),t.emit("adplayer_ad_info",{type:"clear_viewpoint",data:{templateType:"viewPoint",adZoneId:e.viewPointAdZoneId,videoEventId:e.videoEventId}}),Vu.each(e.requests,(function(e){e.abort()})),this.stopBlackScreen()}}},{key:"resize",value:function(){Vu.each(this.requests,(function(e){"ended"!=e.state&&Vu.each(e.slots,(function(e){"ended"!=e.state&&Vu.each(e.ads,(function(e){"ended"!=e.state&&e.resize()}))}))}))}},{key:"isSportsVideo",value:function(){return this.videoInfo&&32==this.videoInfo.videoType}},{key:"getContinuingVVs",value:function(){for(var e=[],t=this.continueFromVV;t;)e.push(t),t=t.continueFromVV;return e}},{key:"startLoadVideo",value:function(e){if("ended"!=this.state){e=e||{};var t=this.sdk,i={rollType:e.rollType,reason:e.reason,videoEventId:this.getVal("videoEventId")};"preroll"==e.rollType&&Vu.extend(i,{showStartTime:t.showTime.start,showEndTime:t.showTime.end,showTime:t.showTime.end-t.showTime.start,requestStartTime:t.requestStartTime,requestEndTime:t.requestEndTime,requestTime:t.requestEndTime-t.requestStartTime,initStartTime:t.initStartTime,initEndTime:t.initEndTime,initTime:t.initEndTime-t.initStartTime,loadStartTime:t.loadStartTime,loadEndTime:t.loadEndTime,loadTime:t.loadEndTime-t.loadStartTime}),this.log("roll-load-finish",i),t.emit("roll-load-finish",i)}}},{key:"stopBlackScreen",value:function(){var e=this.sdk;e.setViewController((function(){return e.viewController.blackscreen.stopBlackScreen()}))}}]),t}(Hu);var Xh,Zh=i(309),$h="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" "),e_=0,t_={},i_=function(){};window.console&&(i_=function(e,t){var i=Date.now(),a=i-(Xh||i),n="color:"+function(e){t_[e]||(t_[e]=$h[e_++%$h.length]);return t_[e]}(e.name);Xh=i;var r="%c"+(t.prefix+e.name)+"%c",s=[null,n,"color:inherit"];Vu.each(e.data,(function(e){s.push(e),r+=" %o"})),s.push(n),r+="%c +"+a+"ms",s[0]=r,function(e,t){Function.prototype.apply.call(console[e],console,t)}("log",s)});var a_=i_,n_=Vu.is,r_={level:0,MAX_LOG_LEN:3e3,debugKey:"debug",defaultLevelName:"log",defaultName:"default",_name:"",prefix:"",outputer:a_},s_=function(){function e(t){n()(this,e);var i=this;i.key=t,i.logger=[],i.logs=[],Vu.extend(i,r_),i.init()}return s()(e,[{key:"init",value:function(){var e,t=this;if(t.prefix=t.key+":",t.key)try{e=localStorage[t.key]}catch(i){}t._name=e,t.pattern=function(e){var t=[],i=[];e&&n_.string(e)&&Vu.each(e.split(/[\s,]+/),(function(e){"-"===(e=e.replace(/\*/g,".*?")).charAt(0)?t.push(new RegExp("^"+Vu.slice(e,1)+"$")):i.push(new RegExp("^"+e+"$"))}));return{skips:t,names:i}}(e),t.enabled=t.isNameMatch(e)}},{key:"isNameMatch",value:function(e){var t=this.pattern;if(!e)return!1;function i(t){return t.test(e)}return!Vu.some(t.skips,i)&&!!Vu.some(t.names,i)}},{key:"getLogger",value:function(e){var t=this;e=e||t.defaultName;var i=t.logger[e];return i||(i=t.logger[e]=function(){t.print(e,arguments)}),i}},{key:"print",value:function(e,t){var i=this,a={name:e,key:i.key,data:t};i.logFilter(a,i.lastLog),i.enabled&&i.outputer(a,i)}},{key:"logFilter",value:function(e){e.time=Date.now(),this.saveLog(e)}},{key:"saveLog",value:function(e){this.logs.push(e),this.logs.length>this.MAX_LOG_LEN&&this.logs.shift()}}]),e}();var o_=Zh.version+"-mars",d_=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this,"sdk"))).playerId=e.playerId||"noPlayerId-"+Date.now(),i.script=Vu.get(window,"document.currentScript.src"),i.vvCnt=0,i.vvs=[],i.adPlayedDurationInDay=0,i.version=i.sdkVersion=o_,i.adMap={},i.logger=new s_("mars-"+i.playerId),i.debug=i.logger.getLogger("sdk"),i}return f()(t,e),s()(t,[{key:"init",value:function(e){this.initStartTime=Date.now(),this.debug("sdk init",e,o_),(e=Vu.extend({},e)).episodeId=e.episodeId||e.tvId,e.isVIP=e.isVIP||!1,e.timePoint=e.timePoint||0,e.site=e.site||"iqiyiw",Vu.extend(this,e),this.locale&&(Vu.includes(["tw_t","cn_t"],this.locale)?this.locale="tw":this.locale="cn"),Vu.includes(this.locale,"tw")&&(this.adPlayerId=this.adPlayerId||"qc_105136_100610",this.debug("tw cid",this.adPlayerId));var t,i=this.adPlayerId;this.adPlayerId=function(e){(function(e){return!!Vu.startsWith(e,"qc_")&&e.length=="qc_100001_100000".length})(e)||(e="qc_100001_100226");return e}(i),e.isPreload?this.rawAdPlayerId=this.adPlayerId:this.rawAdPlayerId=this.rawAdPlayerId||i,this.uaaUserId=this.uaaUserId||(t=S.a.get("QC005"),kc.empty(t)&&(t=S.a.get("QC006")),t||"");var a=new Jh(this,e);this.vvCnt++,e.isPreload?this.preloadVV=a:(this.switchView(),this.currentVV=a),this.vvs.push(a),this.bindEvent()}},{key:"switchView",value:function(e){this.debug("switch view",e||"normal");var t="";(this&&this.currentVV&&(t=this.currentVV.videoEventId),Vu.remove(this.vvs,(function(e){return e.abort(),!0})),this.currentVV=null,this.preloadVV=null,this.videoMidware&&this.videoMidware.play(),this.hasInitedAres&&t)&&window.ares.stop({videoEventId:t})}},{key:"playPreload",value:function(){var e=this,t=this;this.debug("play preload");var i=t.currentVV.videoEventId;(Vu.remove(t.vvs,(function(i){return i==t.currentVV&&(e.debug("abort vv"),i.abort(),t.currentVV=null,t.videoMidware.play(),e.debug("remove current vv"),!0)})),t.hasInitedAres)&&window.ares.stop({videoEventId:i});if(this.debug("play preload vv"),t.preloadVV){t.currentVV=t.preloadVV,t.preloadVV=null;var a=t.currentVV.requests[0];a&&a.play()}}},{key:"bindEvent",value:function(){var e=this,t=this;t.on("video-play",(function(){e.debug("player notify video play"),e.setViewController()})),t.binResize(t.videoMidware.video()),t.on("click",(function(i){if(e.debug("click",i),i){var a=i.data.id||i.data.adUid,n=t.adMap[a];n&&("viewpoint"==i.type?(n.emit("click"),Rc(n,{pingbackType:"statistics",subtype:"click",customInfo:"viewPointSidebar"})):"definitionswitching"==i.type&&n.emit("clickAndOpen"))}})),t.on("impression",(function(i){if(e.debug("impression",i),i){var a=i.data.id||i.data.adUid,n=t.adMap[a];if(n)if("viewpoint"==i.type){if(!n.hasSidebarImpressioned)n.hasSidebarImpressioned=!0,Rc(n,{pingbackType:"statistics",subtype:"impression",customInfo:"viewPointSidebar"}),"tips"!=n.creative.creativeObject.impressionArea&&n.emit("impression")}else"definitionswitching"==i.type&&n.emit("impression")}})),t.on("impressionAdZone",(function(e){this.debug("impressionAdZone",e);var i=e.data.adZoneId,a=t.currentVV;a&&i&&Vu.each(a.requests,(function(e){Vu.each(e.slots,(function(e){e.adZoneId==i&&e.sendEmptyTrackingBeforeTimeSlice(Infinity)}))}))}))}},{key:"binResize",value:function(e){var t=this,i=new Cl(100,50),a=e.offsetWidth;function n(){var i=e.offsetWidth;i==a||(t.debug("video resize",a,"==>",i),t.resize(),a=i)}i.on("timer",n),window.addEventListener("resize",(function(){n(),i.reset(),i.start()}))}},{key:"getUser",value:function(){var e=Vu.only(this,"isVIP passportId passportCookie uaaUserId cupidUserId");if(this.videoMidware){var t=this.videoMidware.getUserInfo();Vu.extend(e,t)}return e||{}}},{key:"updateUser",value:function(){var e=this.getUser();return this.debug("update user info",e),Vu.extend(this,e),e}},{key:"loadVC",value:function(){var e,t=this,i=this;if(i.memoryLoadVC)return i.memoryLoadVC;if(window.Mars_V)e=Promise.resolve(window.Mars_V);else{var a="//static.iqiyi.com/js/common/mars_v.js?"+Date.now(),n=document.createElement("script"),r=document.getElementsByTagName("script")[0];n.async=!0,e=new Promise((function(e){t.debug("load view controller"),n.src=a,n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,e())}:n.onload=function(){n.onload=null,e()},r.parentNode.insertBefore(n,r)}))}return i.memoryLoadVC=i.memoryLoadVC||e,i.memoryLoadVC}},{key:"setViewController",value:function(e){var t=this;t.viewController&&e?e():t.loadVC().then((function(){t.viewController||(t.ajax=yc,t.viewController=window.Mars_V.init(t),t.rollView=t.viewController.rollView),e&&e()}))}},{key:"resize",value:function(){this.currentVV&&this.currentVV.resize()}},{key:"destroy",value:function(){var e=this;e.switchView("destroy"),e=null}}]),t}(Hu);var u_={init:function(e){return function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=new d_(e);return window.Mars[t.playerId]=t,t}(e)}};"undefined"!=typeof window&&(window.Mars?u_=window.Mars:window.Mars=u_);var c_=u_,l_="1",h_="10",__="101";$i.a.browser.iPad?(l_="2",h_="20",__="202"):($i.a.os.ios||$i.a.os.android)&&(l_="2",h_="20",__="201");var f_=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._core=e,i._pbisdm=1,i}return f()(t,e),s()(t,[{key:"_send",value:function(e,t){var i=this,a=this._core,n=a.user;n.isVip((function(r){var s=a.getMovieInfo(),o=e.ra||a.getCurrentVD();o=51===o?59:o;var d,u={bstp:6,block:"B",pf:l_,p:h_,p1:__,aid:s.albumId||"",c1:s.cid||"",r:s.tvid||"",u:T.a.getFluid()||"",u2:T.a.getJsuid()||"",pu:n.getUid(),pru:S.a.get("P00PRU")||"",v:bn.a,ra:o,nu:T.a.getIsNewUser()||"",ve:T.a.getEid(),ce:T.a.getWeid(),hu:r?1:-1,ht:s.isVIP?1:0,mod:a.local,plyrtp:0,coop:"",isdm:i._pbisdm,videotp:s.is3D,tmplt:a.getPageTmpltType(),rn:Math.random(),a:"901111_pcwh5_mouse"};try{Object(zi.a)(u,{as:k.a.cmd5x(u.r+""+u.p1+u.u+u.ve+"ChEnYH0804FdadrrEDFf2016tT")})}catch(c){}d=a.isFullScreen?"4":a.isWebFullScreen?"7":"3",Object(zi.a)(u,{wint:d}),a.params.abtest&&(u.abtest=a.params.abtest),u=Object(zi.a)(u,e,t),Ki.a.beacon(u,"//msg.qy.net/b")}))}},{key:"sendSeekPingback",value:function(e,t,i){var a={rseat:"ply_seek",from:e,to:t,t:20};this._core.getMovieInfo().isShowHeatMap&&(a.s2="lvjing"),i?(a.a="901111_pcwh5_keyboard",this._send(a,!0)):this._send(a)}},{key:"sendSwitchVDPingback",value:function(e){this._send({rseat:"ply_cc",tra:51===e?59:e,t:20,ra:this._core.getCurrentVD()})}},{key:"sendUserActionPingback",value:function(e,t){t?this._send({rseat:e,t:20,a:"901111_pcwh5_keyboard"},!0):this._send({rseat:e,t:20})}},{key:"sendBlockPingback",value:function(e){var t={block:e,t:21};this._core.getMovieInfo().isShowHeatMap&&(t.s2="lvjing"),this._send(t,!0)}},{key:"sendIVUserActionPingback",value:function(e){var t=e.rseat,i=e.r,a=e.block,n=e.rpage,r=this._core.getMovieInfo().tvid,s=this._core.getMovieInfo().albumId,o=this._core.iv_state.uniqueId;this._send({rseat:t||"",block:a||"",t:20,r:i||"",aid:s||r,sqpid:r||"",iamvid:o||"",rpage:n||""},!0)}},{key:"sendIVBlockPingback",value:function(e){var t=e.r,i=e.block,a=e.rpage,n=this._core.getMovieInfo().tvid,r={block:i||"",t:21,r:t||"",aid:this._core.getMovieInfo().albumId||n,sqpid:n||"",iamvid:this._core.iv_state.uniqueId||"",rpage:a||""};this._send(r,!0)}},{key:"setpbisdm",value:function(e){this._pbisdm=e}},{key:"sendBarrageShowRulePagePingback",value:function(){this._send({rpage:"full_ply",block:"tucaou",t:20,rseat:"608241_etiquette"},!0)}},{key:"sendBarrageShowLikePingback",value:function(){this._send({rpage:"full_ply",block:"tucaou",t:20,rseat:"608241_like"},!0)}},{key:"sendBarrageEnsureReportPingback",value:function(){this._send({rpage:"full_ply",block:"tucaou",t:20,rseat:"608241_T0_sub"},!0)}},{key:"sendBarrageShowReportPingback",value:function(){this._send({rpage:"full_ply",block:"tucaou",t:20,rseat:"608241_report"},!0)}},{key:"sendShowSystemBarragePingback",value:function(e){this._send({rpage:"full_ply",block:"dmsys",t:21,tm:e.contentId,aid:this._core.getMovieInfo().albumId,rseat:""},!0)}},{key:"sendClickSystemBarragePingback",value:function(e){this._send({rpage:"full_ply",block:"dmsys",t:20,tm:e.contentId,aid:this._core.getMovieInfo().albumId,rseat:"608241_sysclick"},!0)}},{key:"sendClickSystemBarrageButtonPingback",value:function(e){this._send({rpage:"full_ply",block:"dmsys",t:20,tm:e.contentId,aid:this._core.getMovieInfo().albumId,rseat:"608241_syspicclick"},!0)}},{key:"sendShowControlBarPingback",value:function(){var e={block:"80720_playerctrl",t:21};this._core.getMovieInfo().isShowHeatMap&&(e.s2="lvjing"),this._send(e,!0)}},{key:"sendSeekBarHoverPingback",value:function(e){var t={block:"80720_playerctrl_seekbar",t:21};e&&(t.s2="lvjing"),this._send(t,!0)}},{key:"sendShowHeatMapPingback",value:function(){this._send({block:"80720_playerctrl_lvjing",t:21,s2:"lvjing"},!0)}},{key:"showScoreTaskGuidePanel",value:function(){this._send({block:"80720_scorepannel_20m",t:21},!0)}},{key:"closeScoreTaskGuidePanel",value:function(){this._send({rseat:"80720_scorepannel_20mclose",t:20},!0)}},{key:"clickScoreTaskLoginPanel",value:function(){this._send({rseat:"80720_player_login",t:20},!0)}},{key:"showScoreTaskLoginPanel",value:function(){this._send({block:"80720_scorepannel_30mlogin",t:21},!0)}},{key:"showScoreTaskSuccessPanel",value:function(){this._send({rseat:"80720_scorepannel_30msuccess",t:20},!0)}},{key:"hoverVideoListButton",value:function(){this._send({block:"80720_playerctrl_selection",t:21},!0)}},{key:"clickVideoListButton",value:function(){this._send({block:"B",rseat:"80720_playerctrl_selection",t:20},!0)}},{key:"clickVideoListItemTitle",value:function(e){this._send({block:"B",rseat:"80720_playerctrl_selection_"+e,t:20},!0)}},{key:"clickVideoListItemImage",value:function(e){this._send({block:"B",rseat:"80720_playerctrl_selection_"+e,t:20},!0)}},{key:"clickSubtitlesSwitch",value:function(e){this._send({t:20,rseat:"80720_playerctrl_menu_subtitleswitch"+e},!0)}},{key:"clickSubtitlesSetting",value:function(){this._send({t:20,rseat:"80720_playerctrl_menu_subtitle"},!0)}},{key:"clickSubtitlesFontsizeSetting",value:function(e){e?this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_size_"+e},!0):this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_size"},!0)}},{key:"clickSubtitlesAlphaSetting",value:function(e){e?this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_transp_"+e},!0):this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_transp"},!0)}},{key:"clickSubtitlesLanguageSetting",value:function(){this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_lang"},!0)}},{key:"changeSubtitlesLanguage",value:function(){this._send({t:20,rseat:"80720_playerctrl_menu_subtitle_lang_change"},!0)}},{key:"showSubtitlesPanel1",value:function(){this._send({t:21,rseat:"80720_playerctrl_menu_subtitle_panel1"},!0)}},{key:"showSubtitlesPanel2",value:function(){this._send({t:21,rseat:"80720_playerctrl_menu_subtitle_panel2"},!0)}},{key:"showContentMenu",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel"},!0)}},{key:"clickCtxMenuBugBtn",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel_feedback"},!0)}},{key:"clickCtxMenuLinkBtn",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel_linkcopy"},!0)}},{key:"clickCtxMenuShortcutBtn",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel_keyboard"},!0)}},{key:"clickCtxMenuConsoleBtn",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel_debugger"},!0)}},{key:"clickShowInfoPanelBtn",value:function(){this._send({t:20,rseat:"80720_playerctrl_subpannel_state"},!0)}},{key:"sendQBBPingback",value:function(){this._send({block:"qbbbrand_pc",t:21},!0)}},{key:"sendPubBlock",value:function(e){var t={block:"action_bfq",t:21};Object(zi.a)(t,e),this._send(t,!0)}},{key:"sendPubClick",value:function(e){var t={block:"bfq",rseat:"80720_action_bfq",t:20};Object(zi.a)(t,e),this._send(t,!0)}},{key:"sendIVOSClick",value:function(e,t){this._send({t:20,rseat:e,biz:t},!0)}},{key:"sendIVOSShow",value:function(e,t){this._send({t:21,block:e,biz:t},!0)}}]),t}(p.a),p_="1",g_="10",m_="101";$i.a.browser.iPad?(p_="2",g_="20",m_="202"):($i.a.os.ios||$i.a.os.android)&&(p_="2",g_="20",m_="201");var v_,b_=function(e){function t(e){var i;return n()(this,t),(i=d()(this,c()(t).call(this)))._core=e,i._pbisdm=1,i}return f()(t,e),s()(t,[{key:"_send",value:function(e,t){var i=this,a=this._core,n=a.user;n.isVip((function(r){var s,o=a.getMovieInfo(),d={bstp:6,block:"B",pf:p_,p:g_,p1:m_,c1:o.cid||"",r:o.tvid||"",u:T.a.getFluid()||"",u2:T.a.getJsuid()||"",pu:n.getUid(),pru:S.a.get("P00PRU")||"",v:bn.a,ra:e.ra||a.getCurrentVD(),nu:T.a.getIsNewUser()||"",ve:T.a.getEid(),ce:T.a.getWeid(),hu:r?1:-1,ht:o.isVIP?1:0,mod:a.local,plyrtp:0,coop:"",isdm:i._pbisdm,videotp:o.is3D,tmplt:a.getPageTmpltType(),rn:Math.random(),a:"901111_pcwh5_mouse"};try{Object(zi.a)(d,{as:k.a.cmd5x(d.r+""+d.p1+d.u+d.ve+"ChEnYH0804FdadrrEDFf2016tT")})}catch(u){}s=a.isFullScreen?"4":a.isWebFullScreen?"7":"3",Object(zi.a)(d,{wint:s}),d=Object(zi.a)(d,e,t),Ki.a.beacon(d,"//msg.qy.net/b")}))}},{key:"sendUserActionPingback",value:function(e,t){t?this._send({rseat:e,t:20,a:"901111_pcwh5_keyboard"},!0):this._send({rseat:e,t:20})}},{key:"sendQBBPingback",value:function(){this._send({block:"qbbbrand_pc",t:21},!0)}},{key:"sendClickTitlePingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_title",t:20},!0)}},{key:"sendClickVideoPingback",value:function(){this._core.isSimple||this._send({block:"CD",rseat:"908261_select_player_image",t:20},!0)}},{key:"sendClickPlayBtnPingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_play",t:20},!0)}},{key:"sendClickPauseBtnPingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_pause",t:20},!0)}},{key:"sendClickReplayBtnPingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_replay",t:20},!0)}},{key:"sendClickPlayNextBtnPingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_next",t:20},!0)}},{key:"sendClickPlayCancelBtnPingback",value:function(){this._send({block:"CD",rseat:"908261_select_player_cancel",t:20},!0)}},{key:"sendVoiceOnPingback",value:function(){var e={block:"CD",rseat:"908261_select_player_soundon",t:20};this._core.isSimple&&(e.rseat="910191_cainixihuan_soundon",e.block="K"),this._send(e,!0)}},{key:"sendVoiceOffPingback",value:function(){var e={block:"CD",rseat:"908261_select_player_soundoff",t:20};this._core.isSimple&&(e.rseat="910191_cainixihuan_soundoff",e.block="K"),this._send(e,!0)}},{key:"sendVoiceChangePingback",value:function(e){this._send({block:"CD",rseat:"908261_select_player_sound"+e,t:20},!0)}}]),t}(p.a),y_=i(310),k_=i.n(y_),T_=i(311),S_=i.n(T_),P_=i(312),x_=i.n(P_),I_=i(313),E_=i.n(I_),D_=i(314),w_=i.n(D_),A_=i(20),q_=function(e){function t(e,i){return n()(this,t),d()(this,c()(t).call(this,"container",e,i))}return f()(t,e),s()(t,null,[{key:"css",value:function(){return k_.a.toString()}},{key:"html",value:function(){return S_.a.toString()}},{key:"padHtml",value:function(){return x_.a.toString()}},{key:"mobileHtml",value:function(){return E_.a.toString()}},{key:"miniHtml",value:function(e){var t="";return e&&(t='style="object-fit: cover; transform: scale(1.32);"'),w_.a.toString().replace("data-style",t)}}]),t}(A_.a),O_=i(315),L_=i.n(O_),C_=i(316),M_=i.n(C_),R_=i(317),B_=i.n(R_),N_=i(318),F_=i.n(N_),U_=i(319),V_=i.n(U_),H_=i(320),W_=i.n(H_),j_=i(321),G_=i.n(j_),z_=i(322),K_=i.n(z_);var Y_=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,"loading",e,i))).loadingType=a.plugin.querySelector('[data-player-hook="loadingType"]'),a.loading=a.plugin.querySelector('[data-player-hook="videolayerLoading"]'),a._speedTimer=-1,v_=e.i18nLang,a.showBeginLoadingType="",a.isFadeOut=!1,a.init(),a}return f()(t,e),s()(t,[{key:"init",value:function(){var e=this,t=this.view,i=this.engine,a=t.fullscreen,n=t.webfullscreen,r=t.stagesize;$i.a.os.ios||$i.a.os.android||i.autoplay||i.isMini?this.showBeginLoading():this.hideBeginLoading();var s=function(){e.resize()};r&&r.on(s),a&&a.on("change",s),n&&n.on("change",s),this.plugin.querySelector('[data-player-hook="videoLoadingText"]')&&(this.plugin.querySelector('[data-player-hook="videoLoadingText"]').innerHTML=v_.loading_text),i.on(Va.a.NTF_StatusChanged,(function(t){switch(t.state){case Va.a.Status_StartPlay:case Va.a.Status_Playing:case Va.a.Status_AdPlaying:case Va.a.Status_AdStartPlay:case Va.a.Status_End_Play:"image"==e.showBeginLoadingType?(e.isFadeOut=!0,e.fadeOut((function(){e.hideLoading(),e.hideBeginLoading(),e.plugin.style.opacity=1,e.beginloading.querySelector(".loadingImage").removeAttribute("src"),e.isFadeOut=!1})),e.showBeginLoadingType=""):e.isFadeOut||(e.hideLoading(),e.hideBeginLoading());break;case Va.a.Status_AdWaiting:case Va.a.Status_Waiting:($i.a.os.ios||$i.a.os.android)&&i.getCurrenttime()<1&&e.showLoading();break;case Va.a.Status_Loadstart:$i.a.os.ios||$i.a.os.android||e.showLoading();break;case Va.a.Status_Play:($i.a.os.ios||$i.a.os.android)&&i.getCurrenttime()<1&&e.showLoading();break;case Va.a.Status_PlayError:}}),{highPriority:!0}),i.on(Va.a.NTF_VideoChange,(function(){e.showBeginLoading()})),i.on(Va.a.NTF_DefinitionSwitched,(function(){e.hideBeginLoading()})),i.on(Va.a.NTF_NeedUserGesture4Playback,(function(){e.hideBeginLoading()}))}},{key:"showBeginLoading",value:function(){if(!(this.engine.isInteractVideo&&!this.engine.isIVMain)){var e=this.view.isTw?"_tw":"",t=this.view.getPlayIndex(),i=this.view.params,a=this.engine.movieinfo,n=a.tvid?a.imageLoader:i.imageLoader,r=!1,s=!1,o=!1;this.showBeginLoadingType="",this.beginloading&&(this.beginloading.style.display="none"),t>-1?(a=this.view.videoList[t]).isMember?r=!0:a.isQiyiProduced?s=!0:a.isExclusive&&(o=!0):"true"==i.isMember?r=!0:1==i.qiyiProduced?s=!0:1==i.exclusive&&(o=!0),this.beginloading=r?this.plugin.querySelector('[data-player-hook="videoLoadingVip'+e+'"]'):s?this.plugin.querySelector('[data-player-hook="videoLoadingQiyiProduced'+e+'"]'):o?this.plugin.querySelector('[data-player-hook="videoLoadingExclusive'+e+'"]'):this.plugin.querySelector('[data-player-hook="videoLoadingNormal'+e+'"]'),n&&this.engine.getEngineType()===Va.a.QVS_ENGINE&&!this.engine.isMini&&(this.beginloading=this.plugin.querySelector('[data-player-hook="videoLoadingNormal_image"]'),this.beginloading.querySelector(".loadingImage").setAttribute("src",n),this.showBeginLoadingType="image");var d=this.beginloading.querySelector('[data-player-hook="lazygif"]');if(d){var u=d.getAttribute("lazy_src");u&&(d.setAttribute("src",u),d.removeAttribute("lazy_src"))}this.clockDownLoad(),this._begineShow=!0,this.show(),this.beginloading.style.display="block"}}},{key:"hideBeginLoading",value:function(){var e;if(this._begineShow=!1,this.hide(),clearInterval(this._speedTimer),this.beginloading&&(this.beginloading.querySelector('[data-player-hook="loadingDownloadSpeed"]')&&(this.beginloading.querySelector('[data-player-hook="loadingDownloadSpeed"]').innerHTML=""),this.beginloading.style.display="none",e=$i.a.os.ios||$i.a.os.android?this.plugin.querySelector(".iqp-logo-loading"):this.plugin.querySelector(".videoLogo_loading")))for(var t=0;t<e.length;t++)e[t].style.display="none"}},{key:"showLoading",value:function(){!0!==this._begineShow&&(this.beginloading&&(this.beginloading.style.display="none",this.clockDownLoad()),this.resize(),this.show(),this.loading.style.display="block")}},{key:"clockDownLoad",value:function(){var e=this;clearInterval(this._speedTimer),this.updateDownloadSpeed(),this._speedTimer=setInterval((function(){e.updateDownloadSpeed()}),1e3)}},{key:"hideLoading",value:function(){clearInterval(this._speedTimer),this.hide(),this.loading.style.display="none"}},{key:"resize",value:function(){this.view.getWrapperArea().width>920?function(e,t){(function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0})(e,t)||(e.className+=(e.className?" ":"")+t)}(this.plugin,"iqp-player_w920"):function(e,t){for(var i=" "+e.className+" ";i.indexOf(" "+t+" ")>=0;)i=i.replace(" "+t+" "," ");e.className="function"==typeof i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}(this.plugin,"iqp-player_w920")}},{key:"fadeOut",value:function(e){var t=this,i=t.plugin,a=1e3;i.style.display="",i.style.opacity=a/1e3;!function n(){a-=80,i.style.opacity>=0?(i.style.opacity=a/1e3,window.requestAnimationFrame?requestAnimationFrame(n):setTimeout(n,16)):e.call(t)}()}},{key:"updateDownloadSpeed",value:function(){var e=this.view.getDownloadSpeed();e&&this.beginloading.querySelector('[data-player-hook="loadingDownloadSpeed"]')&&(this.beginloading.querySelector('[data-player-hook="loadingDownloadSpeed"]').innerHTML=v_.loading_download_speed+e)}}],[{key:"css",value:function(){return L_.a.toString()}},{key:"html",value:function(){return W_.a.toString()}},{key:"padCss",value:function(){return M_.a.toString()+F_.a.toString()}},{key:"padHtml",value:function(){return G_.a.toString()}},{key:"mobileCss",value:function(){return B_.a.toString()+V_.a.toString()}},{key:"mobileHtml",value:function(){return K_.a.toString()}}]),t}(A_.a),Q_=i(323),J_=i.n(Q_),X_=i(246),Z_=i.n(X_),$_=i(324),ef=i.n($_),tf=i(325),af=i.n(tf);var nf,rf,sf=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,"loading",e,i))).loading=a.plugin.querySelector('[data-player-hook="videolayerLoading"]'),a.init(),a}return f()(t,e),s()(t,[{key:"init",value:function(){var e=this,t=this.view,i=this.engine,a=t.stagesize;this.showBeginLoading();a&&a.on((function(){e.resize()})),i.on(Va.a.NTF_StatusChanged,(function(t){switch(t.state){case Va.a.Status_StartPlay:case Va.a.Status_Playing:case Va.a.Status_AdPlaying:case Va.a.Status_AdStartPlay:case Va.a.Status_End_Play:e.hide(),e.toggleBegin("none");break;case Va.a.Status_Loadstart:e.showLoading()}})),i.on(Va.a.NTF_VideoChange,(function(){e.showBeginLoading()})),i.on(Va.a.NTF_NeedUserGesture4Playback,(function(){e.hide()}))}},{key:"showBeginLoading",value:function(){var e=this.view,t=this.engine.params.imageLoader||"",i=this.engine.movieinfo;i&&i.imageLoader&&(t=i.imageLoader),""!==t?(e.loadHtml(ef.a.toString(),e.pluginContainer),this.beginloading=document.querySelector('[data-player-hook="loadingposter"]'),this.beginloading.style.backgroundImage='url("'.concat(t,'")'),this.toggleBegin("block"),this.loading.style.display="none"):this.showLoading()}},{key:"showLoading",value:function(){this.toggleBegin("none"),this.resize(),this.loading.style.display="block",this.show()}},{key:"toggleBegin",value:function(e){this.beginloading&&(this.beginloading.style.display=e)}},{key:"resize",value:function(){this.view.getWrapperArea().width>920?function(e,t){(function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0})(e,t)||(e.className+=(e.className?" ":"")+t)}(this.plugin,"iqp-player_w920"):function(e,t){for(var i=" "+e.className+" ";i.indexOf(" "+t+" ")>=0;)i=i.replace(" "+t+" "," ");e.className="function"==typeof i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}(this.plugin,"iqp-player_w920")}}],[{key:"css",value:function(){return J_.a.toString()+Z_.a.toString()}},{key:"html",value:function(){return af.a.toString()}}]),t}(A_.a),of=1,df={ID_BEGIN:of,items:{ID_SHOW_CONTROL_BAR:{index:of,status:!0},ID_SHOW_CONTROL_BAR_SEEK_BAR:{index:++of,status:!0},ID_SHOW_CONTROL_BAR_SKIP_TIP:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_VIEW_TIP:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_PREVIEW:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_FF:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_LOOP_PLAY_BTN:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_NEXT_BTN:{index:++of,status:!0},ID_SHOW_CONTROL_BAR_TIME:{index:++of,status:!0},ID_SHOW_CONTROL_BAR_VOLUME:{index:++of,status:!0},ID_SHOW_CONTROL_BAR_FULLSCREEN:{index:++of,status:!0},ID_SHOW_CONTROL_BAR_SETTING:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_CAPTURE:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_CAPTION:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_TRACK:{index:++of,status:!1},ID_SHOW_DOCK:{index:++of,status:!1},ID_SHOW_DOCK_SHARE:{index:++of,status:!1},ID_SHOW_DOCK_LIGHT:{index:++of,status:!1},ID_SHOW_DOCK_DEFINITION:{index:++of,status:!1},ID_SHOW_DOCK_DETAILS:{index:++of,status:!1},ID_SHOW_DOCK_OFFLINE_WATCH:{index:++of,status:!1},ID_SHOW_WIDESCREEN_BTN:{index:++of,status:!1},ID_SHOW_LOGO:{index:++of,status:!1},ID_SHOW_RECOMMEND:{index:++of,status:!1},ID_ENABLE_AD:{index:++of,status:!1},ID_SHOW_TIPS:{index:++of,status:!1},ID_SHOW_MAX_MIN_BTN:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_EXPAND_BTN:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_TVLIST_BTN:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_3D_BTN:{index:++of,status:!1},ID_SKIP_MIDDLE_AD:{index:++of,status:!1},ID_SHOW_TWO_DIMENSION_CODE_BTN:{index:++of,status:!1},ID_SHOW_GREEN_TAIL_BTN:{index:++of,status:!1},ID_SHOW_ADD_TO_TABLE_BTN:{index:++of,status:!1},ID_SHOW_COLLECT_BTN:{index:++of,status:!1},ID_SHOW_CONTROL_BAR_ISHIDE:{index:++of,status:!1},ID_HIDE_VIDEO_LINK:{index:++of,status:!1},ID_HIDE_CONTROL_BAR_WEB_FULLSCREEN:{index:++of,status:!1},ID_HIDE_SCORE_TASK:{index:++of,status:!1},ID_SHOW_CONTENT_MENU:{index:++of,status:!0},ID_SHOW_CONTENT_MENU_SHORTCUT:{index:++of,status:!0},ID_HIDE_HEAT_MAP:{index:++of,status:!1},ID_SHOW_SCREENSHOT:{index:++of,status:!1},ID_HIDE_PLAYBACKRATE:{index:++of,status:!1},ID_HIDE_PIPBTN:{index:++of,status:!1}},ID_END:++of},uf=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"init",value:function(e){var t=this;this.enable(),this._elem=e,this.handler=function(){t.emit("change",t.isFullScreen()?"enter":"exit")},document.addEventListener("fullscreenchange",this.handler),document.addEventListener("mozfullscreenchange",this.handler),document.addEventListener("webkitfullscreenchange",this.handler),document.addEventListener("MSFullscreenChange",this.handler)}},{key:"enable",value:function(){this._enable=!0}},{key:"disable",value:function(){this._enable=!1}},{key:"exit",value:function(){var e=this._elem;if(e)if(this.emit("beforechange",this.isFullScreen()?"enter":"exit"),e.exitFullscreen)e.exitFullscreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(e.mozCancelFullScreen)e.mozCancelFullScreen();else if(e.msExitFullscreen)e.msExitFullscreen();else try{e.webkitExitFullscreen()}catch(t){}}},{key:"enter",value:function(){var e=this._elem;if(this._enable||e)if(this.emit("beforechange",this.isFullScreen()?"enter":"exit"),e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else try{e.webkitEnterFullScreen()}catch(t){}}},{key:"toggle",value:function(){this.isFullScreen()?this.exit():this.enter()}},{key:"isFullScreen",value:function(){return!!(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen)}},{key:"destroy",value:function(){this.disable(),this._elem=null,this._elem.removeEventListener("fullscreenchange",this.handler),document.removeEventListener("mozfullscreenchange",this.handler),this._elem.removeEventListener("webkitfullscreenchange",this.handler),this._elem.removeEventListener("MSFullscreenChange",this.handler),this.handler=null}}]),t}(p.a),cf=function(e){function t(){return n()(this,t),d()(this,c()(t).call(this))}return f()(t,e),s()(t,[{key:"__notice",value:function(){this.emit("change",this.isWebFullScreen()?"enter":"exit")}},{key:"__beforeNotice",value:function(){this.emit("beforechange",this.isWebFullScreen()?"enter":"exit")}},{key:"init",value:function(e){this.enable(),this._wrapper=e}},{key:"enable",value:function(){this._enable=!0}},{key:"disable",value:function(){this._enable=!1}},{key:"initButton",value:function(e){var t=this;this._elem=e,this._enter=this._elem.querySelector('[data-player-hook="webfullenter"]'),this._exit=this._elem.querySelector('[data-player-hook="webfullexit"]'),this.handler=function(){t.toggle()},this._elem.addEventListener("click",this.handler)}},{key:"exit",value:function(){if(this.isWebFullScreen()){this.__beforeNotice(),this._elem&&(this._exit.style.display="none",this._enter.style.display="block");var e=this._wrapper.className;e=e.replace("iqp-web-screen"," ").replace("iqp-full-screen50"," ").replace("iqp-full-screen75"," ").replace(/^\s+|\s+$/g,""),this._wrapper.className=e,document.body.style.overflow=this.__bodyOverflow,this.__notice()}}},{key:"enter",value:function(){this.isWebFullScreen()||(this.__bodyOverflow=document.body.style.overflow,this.__beforeNotice(),this._elem&&(this._exit.style.display="block",this._enter.style.display="none"),this._wrapper.className+=(this._wrapper.className?" ":"")+"iqp-web-screen",document.body.style.overflow="hidden",this.__notice())}},{key:"toggle",value:function(){this.isWebFullScreen()?this.exit():this.enter()}},{key:"isWebFullScreen",value:function(){return!!this._wrapper&&" ".concat(this._wrapper.className," ").indexOf(" ".concat("iqp-web-screen"," "))>=0}},{key:"destroy",value:function(){this.disable(),this._elem=null,this._elem.removeEventListener("click",this.handler),this._enter=null,this._exit=null,this.handler=null}}]),t}(p.a),lf=document.attachEvent,hf=navigator.userAgent.match(/Trident/),_f=(nf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)},function(e){return nf(e)}),ff=(rf=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout,function(e){return rf(e)});function pf(e){var t=e.target||e.srcElement;t.__resizeRAF__&&ff(t.__resizeRAF__),t.__resizeRAF__=_f((function(){var i=t.__resizeTrigger__;i&&i.__resizeListeners__.forEach((function(t){t.call(i,e)}))}))}function gf(e){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",pf)}var mf,vf,bf=function(){function e(t){n()(this,e),this.elem=t}return s()(e,[{key:"on",value:function(e){if(!this.elem.__resizeListeners__)if(this.elem.__resizeListeners__=[],lf)this.elem.__resizeTrigger__=this.elem,this.elem.attachEvent("onresize",pf);else{var t=this.elem.__resizeTrigger__=document.createElement("object");t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1; opacity: 0;"),t.__resizeElement__=this.elem,t.onload=gf,t.type="text/html",hf&&this.elem.appendChild(t),t.data="about:blank",hf||this.elem.appendChild(t)}this.elem.__resizeListeners__.push(e)}},{key:"off",value:function(e){this.elem.__resizeListeners__.splice(this.elem.__resizeListeners__.indexOf(e),1),this.elem.__resizeListeners__.length||(lf?this.elem.detachEvent("onresize",pf):(this.elem.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",pf),this.elem.__resizeTrigger__=!this.elem.removeChild(this.elem.__resizeTrigger__)))}}]),e}(),yf=function(){function e(t){n()(this,e),this.elem=t,this.mutualList={},this.id=1}return s()(e,[{key:"register",value:function(e){var t=e.type,i=e.callback;if(!t||!i||"function"!=typeof i)return null;var a=this.id++;return this.mutualList[t]=this.mutualList[t]||{},this.mutualList[t][a]={enable:!0,callback:i},a}},{key:"unregister",value:function(e){var t=!1;if(!e)return t;for(var i in this.mutualList)if(this.mutualList[i][e]){delete this.mutualList[i][e],t=!0;break}return t}},{key:"enable",value:function(e){if(e)for(var t in this.mutualList)if(this.mutualList[t][e]){this.mutualList[t][e].enable=!0;break}}},{key:"disable",value:function(e){if(e)for(var t in this.mutualList)if(this.mutualList[t][e]){this.mutualList[t][e].enable=!1;break}}},{key:"enableType",value:function(e){if(e){var t=this.mutualList[e];for(var i in t)t[i].enable=!0}}},{key:"disableType",value:function(e){if(e){var t=this.mutualList[e];for(var i in t)t[i].enable=!1}}},{key:"fire",value:function(e){if(e)for(var t in this.mutualList){if(e===t){this._fire(-1,this.mutualList[t]);break}if(this.mutualList[t][e]){this._fire(e,this.mutualList[t]);break}}}},{key:"_fire",value:function(e,t){for(var i in t)i!==e&&t[i].enable&&t[i].callback()}}]),e}(),kf=i(326),Tf=i.n(kf),Sf=i(327),Pf=i.n(Sf),xf=i(9),If=function(e){function t(e,i){var a;return n()(this,t),(a=d()(this,c()(t).call(this,"vippay",e,i))).$vippay=Object(xf.a)(a.plugin),a.$playbtn=a.$vippay.find('[data-player-hook="playbtn"]'),a.$playtxt=a.$vippay.find('[data-player-hook="viptxt"]'),a.$playbtn.on("click",(function(e){a.$vippay.hide(),a.engine.playproxy.playFromVipPay()})),a.engine.on(Va.a.NTF_Show_VIPPay,(function(e){1===e?a.$playtxt.html("尊贵的星钻VIP会员：<br>您已免费解锁本剧所有超前点播内容"):a.$playtxt.html("尊贵的星钻VIP会员：<br>您可以免费观看星钻剧场"),a.$vippay.show(),a.view.pingback.sendBlockPingback("diamondtip")})),a.engine.on(Va.a.NTF_VideoChange,(function(){a.$vippay.hide()})),a}return f()(t,e),s()(t,null,[{key:"css",value:function(){return Tf.a.toString()}},{key:"html",value:function(){return Pf.a.toString()}}]),t}(A_.a),Ef=i(7),Df=i(75),wf=new v.a("Skin.Base"),Af=function(e){function t(e,i){var a;n()(this,t),(a=d()(this,c()(t).call(this))).params=e,a.pack=i,a.engine=i.engine,a.plugins={},a.conflictPanel={},a.setting=null,a.diyskin=e.diyskin||{},a.statusMap={},a.initSwitch(e),a.getUserSet(),a.engine.isMini?a.pingback=new b_(a.engine):a.pingback=new f_(a.engine),a.bottomShow=!1,a.topSwitch=!0,a.bottomSwitch=!0;var r=a.engine,s=r.i18n,o=r.local;return a.i18nLang=i.lang,a.isTradition=s.isTraditionalChinese(o),a.isTw=s.isTWLocale(o),a}return f()(t,e),s()(t,[{key:"initSwitch",value:function(e){for(var t=e.components,i=void 0===t?"feffffe6e":t,a=[],n=0;n<i.length;++n){var r=i.substr(n,1);r="0x"+r;for(var s=Number(r).toString(2),o=s.length,d=0;d<4-o;++d)s="0"+s;a+=s}for(var u=df.items,c=df.ID_BEGIN;c<df.ID_END;++c)if(c<a.length)for(var l in u)u[l].index==c&&(u[l].status="1"==a.charAt(c));this.statusMap=u}},{key:"getUserSet",value:function(){var e=this.statusMap,t={logo:!0,ctl:!0,prog:!0,play:!0,next:!0,time:!0,rate:!0,def:!0,voice:!0,set:!0,list:!0,full:!0,webfull:!0,expandScreen:!1,vinv:!0,hotkeys:!0,score:!0,recommend:!0,ctxmenu:!0,ctxmenu_shortcut:!0,audiotrack:!0,screenshot:!0,aiview:!0,svp:!0,follow:!0,interact:!0,ivos:!0},i=this.engine.i18n.isTWLocale();t.ctl=t.ctl&&e.ID_SHOW_CONTROL_BAR.status,t.prog=t.prog&&e.ID_SHOW_CONTROL_BAR_SEEK_BAR.status,t.time=t.time&&e.ID_SHOW_CONTROL_BAR_TIME.status,t.next=t.next&&e.ID_SHOW_CONTROL_BAR_NEXT_BTN.status,t.def=t.def&&e.ID_SHOW_DOCK_DEFINITION.status,t.voice=t.voice&&e.ID_SHOW_CONTROL_BAR_VOLUME.status,t.set=t.set&&e.ID_SHOW_CONTROL_BAR_SETTING.status,t.rate=t.rate&&(e.ID_SHOW_CONTROL_BAR_SETTING.status||this.params.feedMode)&&!e.ID_HIDE_PLAYBACKRATE.status,t.webfull=t.webfull&&!e.ID_HIDE_CONTROL_BAR_WEB_FULLSCREEN.status,t.full=t.full&&e.ID_SHOW_CONTROL_BAR_FULLSCREEN.status,t.list=t.full&&t.list&&e.ID_SHOW_CONTROL_BAR_TVLIST_BTN.status&&!i,t.score=t.score&&!e.ID_HIDE_SCORE_TASK.status&&!i,t.recommend=t.recommend&&e.ID_SHOW_RECOMMEND.status&&!i,t.ctxmenu=e.ID_SHOW_CONTENT_MENU.status,t.ctxmenu_shortcut=e.ID_SHOW_CONTENT_MENU_SHORTCUT.status,t.vinv=t.vinv&&!e.ID_HIDE_PIPBTN.status,t.audiotrack=t.audiotrack&&this.engine.audioEnabled,t.screenshot=t.screenshot&&e.ID_SHOW_SCREENSHOT.status&&!i,"undefined"!=typeof this.params.isExpandScreen&&(t.expandScreen=this.params.isExpandScreen),"undefined"!=typeof this.params.isSupportedHotKey&&(t.hotkeys=this.params.isSupportedHotKey),"undefined"!=typeof this.params.isSupportedShot&&(t.screenshot=this.params.isSupportedShot),this.params.logo!==undefined&&0==this.params.logo&&(t.logo=!1),t.aiview=t.aiview&&!i,t.svp=t.svp&&!i,t.follow=t.follow&&!i,t.interact=t.interact&&!i,t.ivos=t.full&&t.ivos&&!i&&!this.engine.isSimple,this.setting=t,this.emit("viewsetdone")}},{key:"getCss",value:function(){return this.engine.getEngineType()===Va.a.HTTP_ENGINE?$i.a.browser.iPad||$i.a.os.androidTablet?q_.padCss()+Y_.padCss():q_.mobileCss()+Y_.mobileCss():this.engine.isMini?q_.css()+sf.css():q_.css()+Y_.css()+If.css()}},{key:"init",value:function(){this.playerId=this.params.parentId,this.parent=document.getElementById(this.params.parentId),this.loadCss(this.getCss()),this.engine.getEngineType()===Va.a.HTTP_ENGINE?$i.a.browser.iPad||$i.a.os.androidTablet?this.loadHtml(q_.padHtml(),this.parent):this.loadHtml(q_.mobileHtml(),this.parent):this.engine.isMini?this.loadHtml(q_.miniHtml("banner"==this.params.skinType),this.parent):this.loadHtml(q_.html(),this.parent);var e=this.engine.getEngineType()===Va.a.HTTP_ENGINE;this.video=this.parent.querySelector("video"),this.engine.isSimple||e?this.wrapper=this.videoWrapper=this.parent.querySelector('[data-player-hook="container"]'):(this.wrapper=this.parent.querySelector('[data-player-hook="container"]'),this.videoWrapper=this.parent.querySelector('[data-player-hook="mainlayer"]'),this.ivoslayer=this.parent.querySelector('[data-player-hook="ivoslayer"]')),this.pluginContainer=this.parent.querySelector('[data-player-hook="plgcontainer"]'),this.adContainer=this.parent.querySelector('[data-cupid="container"]'),e?$i.a.browser.iPad||$i.a.os.androidTablet?this.loadHtml(Y_.padHtml(),this.videoWrapper):this.loadHtml(Y_.mobileHtml(),this.videoWrapper):this.engine.isMini?this.loadHtml(sf.html(),this.videoWrapper):this.loadHtml(Y_.html(),this.videoWrapper),e||this.engine.isMini||(this.loadHtml(If.html(),this.videoWrapper),this.addPlugin(new If(this,this.videoWrapper))),this.addPlugin(new q_(this,this.parent)),this.engine.isMini?this.addPlugin(new sf(this,this.videoWrapper)):this.addPlugin(new Y_(this,this.videoWrapper)),this.addVideoEvent(),this.engine.init(this.video),this.videoWrapper.addEventListener("contextmenu",(function(e){e.preventDefault()}))}},{key:"addVideoEvent",value:function(){var e,t=this,i=this.engine.isMini,a=0,n=function(){(t.fullscreen&&t.fullscreen.isFullScreen()||t.webfullscreen&&t.webfullscreen.isWebFullScreen()||t.engine.isWebFullScreen)&&t.videoWrapper.offsetWidth>=1366&&t.videoWrapper.offsetHeight>=580?t.videoWrapper.classList.add(Df.a):t.videoWrapper.classList.remove(Df.a)},r=this;this.clickEvent=function(){if(!r.engine.isAd()&&!r.engine.isPatch()&&!r.engine.isInteracting){var t=r.plugins.ctxmenu;if(t&&(t.isShow||t.isShowPanel))return;1===++a&&(clearTimeout(e),e=setTimeout((function(){var e=r.fullscreen&&r.fullscreen.isFullScreen(),t=r.webfullscreen&&r.webfullscreen.isWebFullScreen();i?(r.pingback.sendClickVideoPingback(),r.callJsDoSomething("miniPlayerVideoClick",{currentTime:r.engine.getCurrenttime(),isMini:!0})):r.playlistShow&&(e||t)?r.emit(Ef.a.NTF_HIDE_VIDEOLIST):r.aiBaikeShow&&(e||t)?r.emit(Ef.a.NTF_AIView_BAIKE_CLOSE):r.engine.hasStatus(Va.a.Status_Playing)?(r.engine.pause(!0),r.pingback.sendUserActionPingback("ply_pause")):r.engine.isIVEnd||(r.engine.play(!0),r.pingback.sendUserActionPingback("ply_play")),a=0}),200))}},this.video.addEventListener("click",this.clickEvent),this.setting.full&&(this.fullscreen=new uf,this.engine.getEngineType()===Va.a.HTTP_ENGINE?this.fullscreen.init(this.video):this.fullscreen.init(this.wrapper),this.dbClickEvent=function(n){t.engine.isAd()||i||t.engine.isInteracting||(n.preventDefault(),a=0,clearTimeout(e),t.engine.ivosRuning||t.fullToggle())},this.video.addEventListener("dblclick",this.dbClickEvent),this.engine.on(Va.a.NTF_Recharge,(function(){t.fullscreen.exit()})),this.fullscreen.on("change",n.bind(this))),this.setting.webfull&&(this.webfullscreen=new cf,this.webfullscreen.init(this.videoWrapper),this.setting.autowebfull&&this.webfullscreen.enter(),this.engine.on(Va.a.NTF_Recharge,(function(){t.webfullscreen.exit()})),this.webfullscreen.on("change",n.bind(this))),this.stagesize=new bf(this.pluginContainer),this.stagesize.on(n.bind(this)),this.ivoslayer&&(this.ivossize=new bf(this.ivoslayer)),this.mutualpanel=new yf(this)}},{key:"checkSubView",value:function(e,t){var i=this;this.subView?this.subView[e](t):this.once("subViewInit",(function(){i.subView[e](t)}))}},{key:"addView",value:function(e){this.subView=new e(this,this.engine),this.subView.init(),this.emit("subViewInit")}},{key:"loadCss",value:function(e,t){if(t||!this.params.cssRendered){var i=document.createElement("style");i.setAttribute("data-player-hook","playercss"),i.innerHTML=e,document.querySelector("head").appendChild(i)}}},{key:"loadHtml",value:function(e,t){var i=document.createElement("iqpdiv");i.innerHTML=e,t.appendChild(i.children[0])}},{key:"addPlugin",value:function(e){this.plugins[e.name]=e}},{key:"forEach",value:function(e){for(var t in this.plugins)this.plugins[t][e]()}},{key:"enable",value:function(){this.forEach("enable")}},{key:"disable",value:function(){this.forEach("disable")}},{key:"destroy",value:function(){for(var e in this.clickEvent&&this.video.removeEventListener("click",this.clickEvent),this.dbClickEvent&&this.video.removeEventListener("dblclick",this.dbClickEvent),this.plugins)try{this.plugins[e].destroy()}catch(t){}this.plugins={},document.getElementById(this.playerId)&&(document.getElementById(this.playerId).innerHTML="")}},{key:"callJsDoSomething",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=this.engine.getMovieInfo();wf.log("call js setJsDoSomething: "+e),t.origin=this.params.origin||"h5",t.handleType=e,t.tvid=i.tvid,this.engine.isInteractVideo&&(t.isInteractVideo=this.engine.isInteractVideo,t.uniqueId=this.engine.iv_state.uniqueId),this.emit("setJsDoSomething",t)}},{key:"addVideoList",value:function(e){this.checkSubView("addVideoList",e)}},{key:"removeVideoList",value:function(e){this.checkSubView("removeVideoList",e)}},{key:"setFollowData",value:function(e){this.checkSubView("setFollowData",e)}},{key:"hasNextVideo",value:function(){return!!this.subView&&this.subView.hasNextVideo()}},{key:"switchNextVideo",value:function(e){this.checkSubView("switchNextVideo",e)}},{key:"checkAutoPlay",value:function(){this.checkSubView("checkAutoPlay")}},{key:"switchPreVideo",value:function(){this.checkSubView("switchPreVideo")}},{key:"switchVideo",value:function(e){this.engine.switchVideo(e)}},{key:"getPlayIndex",value:function(){return this.subView?this.subView.getPlayIndex():-1}},{key:"skipPrelude",value:function(e){this.checkSubView("skipPrelude",e)}},{key:"setSmallWindowMode",value:function(e){this.checkSubView("setSmallWindowMode",e)}},{key:"setQiyiUserLogin",value:function(e){this.checkSubView("setQiyiUserLogin",e)}},{key:"setRightBarStatus",value:function(e){this.checkSubView("setRightBarStatus",e)}},{key:"getRealArea",value:function(){for(var e={width:16,height:9},t=this.engine.movieinfo.vidl,i=0;i<t.length;i++)if(t[i].vd===this.engine.getCurrentVD()){e=t[i].realArea;break}return e||(e=this.getWrapperArea()),e}},{key:"getWrapperArea",value:function(){var e=getComputedStyle(this.videoWrapper),t=e.width;if(t=parseInt("100%"===t?0:t),isNaN(t)){var i=this.videoWrapper.offsetWidth;i<=0||null==i||(t=i)}return{width:t,height:parseInt(e.height)}}},{key:"getDownloadSpeed",value:function(){var e=this.engine.getDownloadSpeed();return e&&(e=e===Infinity?0:e>1e9?(e/1e9).toFixed(2)+"Gb/s":e>1e6?(e/1e6).toFixed(2)+"Mb/s":e>1e3?(e/1e3).toFixed(2)+"Kb/s":e>0?e.toFixed(2)+"b/s":0),e}},{key:"fullToggle",value:function(){var e=this.fullscreen;if(this.setting.expandScreen){var t=!!this.engine.isFullScreen,i=!!this.engine.isWebFullScreen;t?this.callJsDoSomething("exitExpandScreen",{from:"full"}):(i&&this.callJsDoSomething("exitExpandScreen",{from:"webfull"}),this.callJsDoSomething("enterExpandScreen",{from:"full"})),this.emit(Ef.a.NTF_FullScreen_BeforeChange,t?"enter":"exit")}else e&&e.toggle()}},{key:"videoList",get:function(){return this.subView?this.subView.videoList:[]}}]),t}(p.a),qf={PlayerType_Html5VOD:"h5_VOD",PlayerType_FlashVOD:"flash_VOD",PlayerType_Null:"null",QYPLAYER_STATUS_LOAD_MOVIE:"loadmovie",QYPLAYER_STATUS_DATA_READY:"dataready",QYPLAYER_STATUS_AD_START_PLAY:"adstartplay",QYPLAYER_STATUS_AD_PLAYING:"adplaying",QYPLAYER_STATUS_AD_PAUSED:"adpaused",QYPLAYER_STATUS_AD_RESUMED:"adresumed",QYPLAYER_STATUS_READY:"ready",QYPLAYER_STATUS_START_PLAY:"startplay",QYPLAYER_STATUS_SEEKING:"seeking",QYPLAYER_STATUS_WAITING:"waiting",QYPLAYER_STATUS_PAUSED:"paused",QYPLAYER_STATUS_PLAYING:"playing",QYPLAYER_STATUS_STOPED:"stoped",QYPLAYER_STATUS_ERROR:"error",QYPLAYER_STATUS_END_PLAY:"endplay",QYPLAYER_LOAD_COMPLETE:"loadcomplete",QYPLAYER_LOAD_SUCCESS:"playerLoadSuccess",QYPLAYER_STATE_CHANGE:"playerStateChange",QYPLAYER_VIDEO_CHANGE:"videoChanged",QYPLAYER_VID_CHANGE:"vidChanged",QYPLAYER_NEXT_VIDEO:"playnextvideo",QYPLAYER_SET_LIGHT:"setLight",QYPLAYER_MOVETO_QITAN:"moveToQitan",QYPLAYER_SHOW_LOGIN_PANEL:"showLoginPanel",QYPLAYER_EXPAND:"expand",QYPLAYER_AUTHENTICATION_RESULE:"authenticationResult",QYPLAYER_RECHARGE:"recharge",QYPLAYER_SUBSCRIBE:"subscribe",QYPLAYER_REFRESH_PAGE:"refreshPage",QYPLAYER_DOWNLOAD:"download",QYPLAYER_REQUEST_VIDEOLIST:"requestVideoList",QYPLAYER_REQUEST_VIDEOLIST_BY_PAGE:"requestVideoListByPage",QYPLAYER_REQUEST_CHANGE_VIDEO:"requestChangeVideo",QYPLAYER_SWITCH_FULL_SCREEN:"switchFullScreen",QYPLAYER_ADD_TO_TABLE:"addToTable",QYPLAYER_FOCUS_TIPS:"focusTips",QYPLAYER_FOCUS_UPLOADER:"focusUploader",QYPLAYER_FIND_GOODS:"findGoods",QYPLAYER_PGC_FOLLOW:"pgcFollow",QYPLAYER_SHOW_DOWNLOAD_APPPOP:"showDownLoadAppPop",QYPLAYER_CHECK_CLIENT_INSTALL:"checkClientInstall",QYPLAYER_REQUEST_SEND_PINGBACK:"requestJSSendPB",QYPLAYER_DOSOMETHING:"setJsDoSomething",QYPLAYER_FOLLOW_UPNEXT_LOAD:"followUpNextLoad",QYPLAYER_USER_CLICK_SCORE:"userClickScore",QYPLAYER_BARRAGE_REPLAY:"barrageReply",QYPLAYER_BARRAGE_RECEIVE_DATA:"barrageReceiveData",QYPLAYER_SET_BARRAGE_INTERACT_INFO:"setBarrageInteractInfo",QYPLAYER_NOTIFY_BARRAGE_DATA:"notifyBarrageData",QYPLAYER_SET_BARRAGE_CONFIG_INFO:"setHasBarrageConfigInfo",QYPLAYER_SET_BARRAGE_CHANNEL_CONFIG_INFO:"setHasBarrageChannelConfigInfo",QYPLAYER_BARRAGE_STATE_CHANGE:"barrageStateChange",QYPLAYER_BARRAGE_ALLOWED:"barrageAllowed",QYPLAYER_REQUEST_REWARD:"requestReward",QYPLAYER_COMMENT_ALLOWED:"commentAllowed",QYPLAYER_GET_PLAYER_LOG:"getQiyiPlayerLog",QYPLAYER_WEBFULLSCREEN_BEFORE_CHANGE:"beforeWebFullScreenChange",QYPLAYER_WEBFULLSCREEN_AFTER_CHANGE:"afterWebFullScreenChange",QYPLAYER_FULLSCREEN_BEFORE_CHANGE:"beforeFullScreenChange",QYPLAYER_FULLSCREEN_AFTER_CHANGE:"afterFullScreenChange",QYPLAYER_NOTIFY_GIFT_INFO:"notifyGiftInfo",QYPLAYER_NOTIFY_WRITE_FLASH_LOG:"writeFlashLog",QYPLAYER_SWITCH_PLAYER:"switchPlayer",QYPLAYER_NOTIFY_AD_START:"ADStart",QYPLAYER_NOTIFY_AD_END:"ADEnd",QYPLAYER_NOTIFY_AD_NOTIFY_INFO:"adnotifyinfo",QYPLAYER_NOTIFY_AD_BLOCK:"adblock",QYPLAYER_NOTIFY_TIMEUPDATE:"timeUpdate",QYPLAYER_NOTIFY_SCORECHANGE:"scoreTaskChange",QYPLAYER_NOTIFY_FEEDBACK_SHOW:"feedbackShow",QYPLAYER_NOTIFY_FEEDBACK_HIDE:"feedbackHide",QYPLAYER_NOTIFY_USER_SEEK:"userSeek",QYPLAYER_BuyPlay:"buyPlay",QYPLAYER_NOTIFY_TO_DIVERSION:"todiversion",QYPLAYER_NOTIFY_AI_STAR_INFO:"aistarinfo",QYPLAYER_NOTIFY_AI_STAR_CLOSE:"aistarclose",QYPLAYER_NOTIFY_SHOW_VIDEOLIST:"showvideolist",QYPLAYER_NOTIFY_FOLLOW_CLICK:"followbtnclick",QYPLAYER_NOTIFY_INTERACTION_START:"interactionstart",QYPLAYER_NOTIFY_INTERACTION_END:"interactionend",QYPLAYER_H5_VIDEO_LOADSTART:"h5videoloadstart",QYPLAYER_H5_VIDEO_LOADEDMETADATA:"h5videoloadedmetadata",QYPLAYER_H5_DURATION_CHANGED:"h5durationchanged",QYPLAYER_H5_VOLUME_CHANGED:"h5volumechanged"},Of={error_code_title1:"呃，播放失败啦~",error_code_desc1:"试试更稳定、流畅的爱奇艺客户端",error_code_desc2:"检测发现您可能在使用恶意插件，请检查并卸载后重试",error_code_desc6:"很抱歉，你访问的视频丢了",error_code_desc7:"该视频当前还未通过审核",error_code_title9:"很抱歉，该视频已被删除，感谢您使用爱奇艺",error_code_title10:"很抱歉，由于版权问题该视频已下线。感谢您使用爱奇艺",error_code_desc10:"你可以试试汇集全网视频的  爱奇艺客户端",error_code_desc11:"很抱歉，因为版权限制，本节目暂无法观看",error_code_title12:"很抱歉，由于平台限制原因，该视频无法在网页端播放。",error_code_desc12:"你可以试试看1080P全免费的爱奇艺客户端",error_code_title13:"由于版权限制，您所在的地区无法观看该视频",error_code_title14:"本片受版权方约束，暂不支持当前版本的浏览器，<br/>请使用最新版移动客户端进行观看",error_code_desc14:"",error_code_desc21:"您没有权限观看此视频",error_code_desc22:"您的账号仅限2台设备同时播放，请停止其他设备播放等待5分钟或修改密码",error_code_switch_flash:"播放出错了，请点击切换到原版Flash播放器",error_code_desc_http:"播放出错了，请稍后刷新重试",error_code_title301:"很抱歉，当前视频播放失败，请刷新后再次尝试。<br/>可点击帮助反馈，上报播放问题，我们会尽快帮您解决~",error_code_desc_ad:"呃...广告无法正常播放了，开通VIP功能跳过广告，或关闭屏蔽广告功能",controls_tip_history:'您上次观看至<i class="iqp-txt-selected">#time#</i> 处, 爱奇艺为您自动续播。',controls_tip_skipheader:"已经为您跳过片头",controls_tip_skiptailer:"即将为您跳过片尾",controls_tip_zstip:"尊贵的星钻VIP会员,您已使用观影券观看本片",controls_tip_cdtip:"尊贵的星钻VIP会员,您已免费解锁本剧超前点播",controls_tip_yytip:"尊贵的星钻VIP会员，您可免费观看本剧",controls_tip_recharge_type1:'免费试看<i class="iqp-txt-selected">6</i>分钟，观看完整版请 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">开通VIP会员</a>',controls_tip_recharge_type4:'免费试看<i class="iqp-txt-selected">6</i>分钟，观看完整版请 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">开通网球会员</a>',controls_tip_recharge_type2:'试看<i class="iqp-txt-selected">#previewTime#</i>分钟，因版权限制，观看完整版请 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">购买本片</a>',controls_tip_recharge_type3:'试看<i class="iqp-txt-selected">#previewTime#</i>分钟，因版权限制，观看完整版请  <a href="javascript:;" class="iqp-txt-selected" data-event="useTicket">用券观看</a>',controls_tip_recharge_defaultype:'免费观看前<i class="iqp-txt-selected">#previewTime#</i>分钟，完整观看请 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">立即购买</a>',controls_tip_skipheadertailer:"跳过片头片尾",controls_yes:"是",controls_no:"否",controls_tip_precache:"正在缓冲",controls_tip_switching:"正在切换到",controls_tip_switchedsucc:"已成功切换到",controls_tip_switchwaiting:"画质，请稍候",controls_tip_switchedfail:"画质切换失败，请检查网络并再次尝试",controls_tip_switchedpic:"画质",controls_tip_switchhdr:'为您推荐最佳观影画质 <b>#definition#</b>，  <a href="javascript:;" class="iqp-txt-selected" data-event="switchHDR">立即开启</a>',controls_tip_playspeedguide:"在这里可以调节播放倍速",controls_tip_speed_changed:'播放速度：<i class="iqp-txt-selected">XX</i>',controls_split_tip:' (长按方向键 "→" )',controls_tip_setting_normal:"正常",controls_subtitles_tip_switching:"正在切换到",controls_subtitles_tip_switchedsucc:"已成功切换到",controls_subtitles_tip_switchwaiting:"字幕，请稍候",controls_subtitles_tip_switchedfail:"字幕切换失败，请检查网络并再次尝试",controls_subtitles_tip_switchedpic:"字幕",controls_playlistbtn:"选集",controls_clickplay_hover:"点击播放",controls_clickpause_hover:"点击暂停",controls_replay_hover:"重新播放",controls_forward_hover:"下一集",controls_webfullscreen_hover:"网页全屏",controls_exitwebfullscreen_hover:"退出网页全屏",controls_fullscreen_hover:"全屏",controls_exitfullscreen_hover:"退出全屏",controls_download:"立即下载",controls_download_mobile:"立即体验",controls_clientdownload_mobile:"使用爱奇艺客户端，视频播放更流畅~",controls_cycleplay:"循环播放",controls_select_player:"播放器选择",controls_setting_recommend:"推荐使用  [ HTML5 ]",controls_setting_playratedesc:"倍速",controls_nextbtn:"下一条视频 ",definition_name_limit:"极速",definition_name_standard:"流畅",definition_name_high:"高清",definition_name_superhigh:"超清",definition_name_720p:"720P",definition_name_1080p:"1080P",definition_name_hdr:"爱奇艺HDR",definition_name_4k:"4k",definition_name_1080P50:"1080P50",definition_name_ad:"广告",definition_name_auto:"智能(#definition#)",error_errorcode_text:"错误代码",error_switchplayer:"切换播放器",error_tryrefresh:"立即刷新",error_download:"使用客户端观看",error_help:"帮助反馈",error_private_video:"该视频为私密视频，密码输入正确后才可播放哦",error_private_selfsee:"该视频为私密视频，仅发布者可见哦~",error_private_pwderror:"密码输入不正确，请输入正确密码",error_confirm:"确认",error_input_pwd:"请输入密码",loading_text:"正在全力加载，请稍候…",score_task_guide:"再看10分钟即可领取积分噢~",score_task_login:"观看任务完成，领积分兑超值好礼",score_task_success:"恭喜完成观看视频任务！<br>送你#score#积分奖励",score_task_btn_info1:"查看详情",score_task_btn_info2:"我的积分",score_task_btn_close1:"不再提示",score_task_btn_close2:"不再提示",score_task_btn_login:"立即领取",score_task_btn_login1:"立即登录",ban_btn:"修改密码",ban_tip_001:"账号最多同时在2台设备播放，终止其余设备播放或修改密码恢复",ban_tip_002:"检测到账号被多人共享，会员权益已暂停，请修改密码",ban_tip_004:"检测到您的帐号被严重分享，已永久封禁",error_maintitle:"Flash插件异常",error_fltitle:"下载官方Flash插件",error_h5title:"正在切换HTML5播放模式",error_fltip:"已安装仍无法观看",subtitles_switch:"字幕",subtitles_setting:"字幕设置",subtitles_back:"返回",subtitles_fontsize:"字号",subtitles_alpha:"透明度",subtitles_language:"语言",picture_in_picture:"画中画",contentMenu_bug:"问题反馈",contentMenu_link:"复制链接",contentMenu_shortcut:"快捷键说明",contentMenu_console:"播放状态查询",contentMenu_shortcut_text:"播放快捷键",contentMenu_shortcut_text1_1:"空格",contentMenu_shortcut_text1_2:"：播放 / 暂停",contentMenu_shortcut_text2_2:"：音量提高5%",contentMenu_shortcut_text2_4:"：音量降低5%",contentMenu_shortcut_text3_1:"：快退5秒",contentMenu_shortcut_text4_1:"：单次快进5秒",contentMenu_shortcut_text4_2:"长按倍速播放",contentMenu_shortcut_text5_2:"：播放上一集",contentMenu_shortcut_text5_4:"：播放下一集",contentMenu_shortcut_text7_2:"：进入全屏 / 退出全屏",contentMenu_shortcut_text8_2:"：开启静音 / 取消静音",contentMenu_shortcut_text9_2:"：重播",contentMenu_shortcut_text10_2:"：退出全屏",infoPanelUnknown:"未知",infoPanelNetText:"网络类型：",infoPanelSpeedText:"加载速度：",infoPanelWaitingText:"缓冲时长：",infoPanelLostText:"丢帧率：",infoPanelProtocolText:"视频协议：",infoPanelCdnText:"CDN：",infoPanelSolutionText:"分辨率：",infoPanelVideoSizeText:"视图尺寸：",infoPanelVoiceText:"音量大小：",infoPanelEngineText:"播放引擎：",infoPanelVideoTypeText:"资源类型：",infoPanelDRMText:"DRM类型：",infoPanelDebugText:"调试日志：",infoPanelDebugBtn:"点击下载",big_hotkey_playbackratet_text:"进行中",loading_download_speed:"加载速度:",top_tip_like:"点赞",top_tip_cancel_like:"取消点赞",top_tip_collect:"收藏",top_tip_cancel_collect:"取消收藏",top_tip_size:"画面尺寸",def_vip:"VIP",def_free:"限免",def_sport:"体育会员",def_login:"登录",audiotrack_tip_switching:"正在切换到",audiotrack_tip_switchedsucc:"已成功切换到",audiotrack_tip_switchwaiting:"请稍候...",audiotrack_tip_video:"视频",audiotrack_tip_switchedfail:"切换失败,请检查网络并再次尝试",toast_tip_mutestartplay:"由于浏览器限制，请手动开启声音",mini_autoplay_loading:"即将播放",aiview_request:"识别中...",aiview_neterror:"服务器未知错误, 请稍后重试",aiview_zero:"哎呀, 什么都没识别到"},Lf={error_code_title1:"喔喔，播放失敗啦~",error_code_desc1:"試試更穩定、流暢的愛奇藝客戶端",error_code_desc2:"檢測發現您可能在使用惡意插件，請檢查並解安裝後重試",error_code_desc6:"很抱歉，你訪問的視頻丟了",error_code_desc7:"該視頻目前還未通過審核",error_code_title9:"很抱歉，該視頻已被刪除，感謝您使用愛奇藝",error_code_title10:"很抱歉，由於版權問題該視頻已下線。感謝您使用愛奇藝",error_code_desc10:"你可以試試匯集全網視頻的  愛奇藝客戶端",error_code_desc11:"很抱歉，因爲版權限制，本節目暫無法觀看",error_code_title12:"很抱歉，由於平台限制原因，該視頻無法在網頁端播放。",error_code_desc12:"你可以試試看1080P全免費的愛奇藝客戶端",error_code_title13:"由於版權限制，您所在的地區無法觀看該視頻",error_code_title14:"本片受版權方約束，暫不支持當前版本的瀏覽器，<br/>請使用最新版移動客戶端進行觀看",error_code_desc14:"",error_code_desc21:"您沒有權限觀看此視頻",error_code_desc22:"您的帳號僅限2臺設備同時播放，請停止其他設備播放等待5分鍾或修改密碼",error_code_switch_flash:"播放出錯了，請點擊切換到原版Flash播放器",error_code_desc_http:"播放出錯了，請稍後刷新重試",error_code_title301:"很抱歉，當前視頻播放失敗，請刷新後再次嘗試。<br/>可點擊幫助反饋，上報播放問題，我們會盡快幫您解決~",error_code_desc_ad:"喔喔...廣告無法正常播放了，開通VIP功能跳過廣告，或關閉屏蔽廣告功能",controls_tip_history:'您上次觀看至<i class="iqp-txt-selected">#time#</i> 處, 愛奇藝為您自動續播。',controls_tip_skipheader:"已經為您跳過片頭",controls_tip_skiptailer:"即將為您跳過片尾",controls_tip_zstip:"尊貴的星鑽VIP會員,您已使用觀影券觀看本片",controls_tip_cdtip:"尊貴的星鑽VIP會員,您已免費解鎖本劇超前點映",controls_tip_yytip:"尊貴的星鑽VIP會員,您可以免費觀看本劇",controls_tip_recharge_type1:'免費試看<i class="iqp-txt-selected">6</i>分鐘，觀看完整版請 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">開通VIP會員</a>',controls_tip_recharge_type4:'免費試看<i class="iqp-txt-selected">6</i>分鐘，觀看完整版請立即購買，點擊 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">開通網球會員</a>',controls_tip_recharge_type2:'試看<i class="iqp-txt-selected">#previewTime#</i>分鐘，因版權限制，觀看完整版請 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">購買本片</a>',controls_tip_recharge_type3:'試看<i class="iqp-txt-selected">#previewTime#</i>分鐘，因版權限制，觀看完整版請  <a href="javascript:;" class="iqp-txt-selected" data-event="useTicket">用券觀看</a>',controls_tip_recharge_defaultype:'免費觀看前<i class="iqp-txt-selected">#previewTime#</i>分鐘，完整觀看請 <a href="javascript:;" class="iqp-txt-selected" data-event="recharge">立即購買</a>',controls_tip_skipheadertailer:"跳過片頭片尾",controls_yes:"是",controls_no:"否",controls_tip_precache:"正在緩衝",controls_tip_switching:"正在切換到",controls_tip_switchedsucc:"已成功切換到",controls_tip_switchwaiting:"畫質，請稍候",controls_tip_switchedfail:"畫質切換失敗，請檢查網絡並再次嘗試",controls_tip_switchedpic:"畫質",controls_tip_switchhdr:'爲您推薦最佳觀影畫質 <b>#definition#</b>，  <a href="javascript:;" class="iqp-txt-selected" data-event="switchHDR">立即開啓</a>',controls_tip_playspeedguide:"在這裏可以調節播放倍速",controls_tip_speed_changed:'播放速度：<i class="iqp-txt-selected">XX</i>',controls_split_tip:' (長按方向鍵 "→" )',controls_tip_setting_normal:"正常",controls_subtitles_tip_switching:"正在切換到",controls_subtitles_tip_switchedsucc:"已成功切換到",controls_subtitles_tip_switchwaiting:"字幕，請稍候",controls_subtitles_tip_switchedfail:"字幕切換失敗，請檢查網絡並再次嘗試",controls_subtitles_tip_switchedpic:"字幕",controls_playlistbtn:"選集",controls_clickplay_hover:"點擊播放",controls_clickpause_hover:"點擊暫停",controls_replay_hover:"重新播放",controls_forward_hover:"下一集",controls_webfullscreen_hover:"網頁全屏",controls_exitwebfullscreen_hover:"退出網頁全屏",controls_fullscreen_hover:"全屏",controls_exitfullscreen_hover:"退出全屏",controls_download:"立即下載",controls_download_mobile:"立即體驗",controls_clientdownload_mobile:"使用愛奇藝客戶端，視頻播放更流暢~",controls_cycleplay:"循環播放",controls_select_player:"播放器選擇",controls_setting_recommend:"推薦使用  [ HTML5 ]",controls_setting_playratedesc:"倍速",controls_nextbtn:"下壹條視頻 ",definition_name_limit:"極速",definition_name_standard:"流暢",definition_name_high:"高清",definition_name_superhigh:"超清",definition_name_720p:"720P",definition_name_1080p:"1080P",definition_name_4k:"4k",definition_name_1080P50:"1080P50",definition_name_ad:"廣告",definition_name_auto:"智能(#definition#)",error_errorcode_text:"錯誤代碼",error_switchplayer:"切換播放器",error_tryrefresh:"立即刷新",error_download:"使用客戶端觀看",error_help:"幫助反饋",error_private_video:"該視頻為私密視頻，密碼輸入正確後才可播放哦",error_private_selfsee:"該視頻為私密視頻，僅發布者可見哦~",error_private_pwderror:"密碼輸入不正確，請輸入正確密碼",error_confirm:"確認",error_input_pwd:"請輸入密碼",loading_text:"正在全力加載，請稍候…",score_task_guide:"再看10分鐘即可領取積分噢~",score_task_login:"觀看任務完成，送積分兌超值好禮",score_task_success:"恭喜完成觀看視頻任務！<br>送你#score#積分獎勵",score_task_btn_info1:"查看詳情",score_task_btn_info2:"我的積分",score_task_btn_close1:"不再提示",score_task_btn_close2:"不再提示",score_task_btn_login:"立即領取",ban_btn:"修改密碼",ban_tip_001:"賬號最多同時在2臺設備播放，終止其餘設備播放或修改密碼恢復",ban_tip_002:"檢測到賬號被多人共享，會員權益已暫停，請修改密碼",ban_tip_004:"檢測到您的帳號被嚴重分享，已永久封禁",error_maintitle:"Flash插件異常",error_fltitle:"下載官方Flash插件",error_h5title:"正在切換HTML5播放模式",error_fltip:"已安裝仍無法觀看",subtitles_switch:"字幕",subtitles_setting:"字幕設置",subtitles_back:"返回",subtitles_fontsize:"字號",subtitles_alpha:"透明度",subtitles_language:"語言",picture_in_picture:"畫中畫",contentMenu_bug:"問題反饋",contentMenu_link:"復制鏈接",contentMenu_shortcut:"快捷鍵說明",contentMenu_console:"播放狀態查詢",contentMenu_shortcut_text:"播放快捷鍵",contentMenu_shortcut_text1_1:"空格",contentMenu_shortcut_text1_2:"：播放 / 暫停",contentMenu_shortcut_text2_2:"：音量提高5%",contentMenu_shortcut_text2_4:"：音量降低5%",contentMenu_shortcut_text3_1:"：快退5秒",contentMenu_shortcut_text4_1:"：單次快進5秒",contentMenu_shortcut_text4_2:"長按倍速播放",contentMenu_shortcut_text5_2:"：播放上壹集",contentMenu_shortcut_text5_4:"：播放下壹集",contentMenu_shortcut_text7_2:"：進入全屏 / 退出全屏",contentMenu_shortcut_text8_2:"：開啟靜音 / 取消靜音",contentMenu_shortcut_text9_2:"：重播",contentMenu_shortcut_text10_2:"：退出全屏",infoPanelUnknown:"未知",infoPanelNetText:"網絡類型：",infoPanelSpeedText:"加載速度：",infoPanelWaitingText:"緩衝時長：",infoPanelLostText:"丟幀率：",infoPanelProtocolText:"視頻協議：",infoPanelCdnText:"CDN：",infoPanelSolutionText:"分辨率：",infoPanelVideoSizeText:"視圖尺寸：",infoPanelVoiceText:"音量大小：",infoPanelEngineText:"播放引擎：",infoPanelVideoTypeText:"資源類型：",infoPanelDRMText:"DRM類型：",infoPanelDebugText:"調試日誌：",infoPanelDebugBtn:"點擊下載",big_hotkey_playbackratet_text:"進行中",loading_download_speed:"加載速度:",top_tip_like:"點贊",top_tip_cancel_like:"取消點贊",top_tip_collect:"收藏",top_tip_cancel_collect:"取消收藏",top_tip_size:"畫面尺寸",def_vip:"會員",def_free:"限免",def_login:"登錄",audiotrack_tip_switching:"正在切換到",audiotrack_tip_switchedsucc:"已成功切換到",audiotrack_tip_switchwaiting:"請稍候...",audiotrack_tip_video:"視頻",audiotrack_tip_switchedfail:"切換失敗，請檢查網絡並再次嘗試",toast_tip_mutestartplay:"由於瀏覽器限制，請手動開啟聲音",mini_autoplay_loading:"即將播放",aiview_request:"識別中...",aiview_neterror:"訪問用戶過多, 請稍後重試",aiview_zero:"哎呀什麼都沒識別到"},Cf=new v.a("Wonder.Data.PC"),Mf=function(e){function t(e,i){var a;return n()(this,t),a=d()(this,c()(t).call(this)),e.playerType="wonder",a.adapter=i,a.ad=c_.init({playerId:e.parentId}),e.tvid=un(e.tvid),a.engine=new Pu(e,h()(a)),a.lang=Of,a.engine.i18n.isTraditionalChinese()&&(a.lang=Lf),a.view=new Af(e,h()(a)),a.view.setting?a.view.init():a.view.once("viewsetdone",(function(){a.view.init()})),T.a.init(),a.initEvent(),a}return f()(t,e),s()(t,[{key:"initEvent",value:function(){var e=this,t=function(t,i){e.adapter.fire({type:t,data:i})},i=function(t,i){(i=i||{}).state=t.toLocaleLowerCase(),Cf.info("call js, fire event,params: type = playerStateChange(状态改变), state = "+i.state),e.adapter.fire({type:qf.QYPLAYER_STATE_CHANGE,data:i})},a=!1;this.engine.on(Va.a.NTF_StatusChanged,(function(a){switch(a.state){case Va.a.Status_AdStartPlay:i(qf.QYPLAYER_STATUS_AD_START_PLAY,a),e.adapter.loadSkin({isMini:e.engine.isMini});break;case Va.a.Status_AdPlaying:i(qf.QYPLAYER_STATUS_AD_PLAYING,a);break;case Va.a.Status_AdPaused:i(qf.QYPLAYER_STATUS_AD_PAUSED,a);break;case Va.a.Status_Loadstart:Cf.info("call js, fire event,params: type = h5videoloadstart(视频开始加载)"),t(qf.QYPLAYER_H5_VIDEO_LOADSTART);break;case Va.a.Status_LoadedMetaData:Cf.info("call js, fire event,params: type = h5videoloadedmetadata(视频metadata数据已加载)"),t(qf.QYPLAYER_H5_VIDEO_LOADEDMETADATA);break;case Va.a.Status_StartPlay:i(qf.QYPLAYER_STATUS_START_PLAY,a),e.adapter.loadSkin({isMini:e.engine.isMini});break;case Va.a.Status_Waiting:i(qf.QYPLAYER_STATUS_WAITING,a);break;case Va.a.Status_Paused:i(qf.QYPLAYER_STATUS_PAUSED,a);break;case Va.a.Status_Playing:i(qf.QYPLAYER_STATUS_PLAYING,a);break;case Va.a.Status_Stoped:i(qf.QYPLAYER_STATUS_STOPED,a);break;case Va.a.Status_End_Play:i(qf.QYPLAYER_STATUS_END_PLAY,a);break;case Va.a.Status_PlayError:i(qf.QYPLAYER_STATUS_ERROR,a),e.adapter.loadSkin({isMini:e.engine.isMini})}})),this.engine.on(Va.a.NTF_VRSReady,(function(e){Cf.info("call js, fire event,params: type = dataready(数据信息已经准备好)"),t(qf.QYPLAYER_STATUS_DATA_READY,e.data)})),this.engine.on(Va.a.NTF_CanPlayThrough,(function(){})),this.engine.on(Va.a.NTF_VolumeChanged,(function(e){a&&(Cf.info("call js, fire event,params: type = h5volumechanged(音量修改)"),t(qf.QYPLAYER_H5_VOLUME_CHANGED,e)),a=!0})),this.engine.on(Va.a.NTF_DurationChanged,(function(e){Cf.info("call js, fire event,params: type = h5durationchanged(影片时长有修改)"),t(qf.QYPLAYER_H5_DURATION_CHANGED,e)})),this.engine.on(Va.a.NTF_VideoChanged,(function(i){Cf.info("call js, fire event,params: type = videoChanged(视频切换完成), interaction=".concat(e.engine.isInteractVideo)),e.engine.isInteractVideo&&(i.isInteractVideo=e.engine.isInteractVideo,i.uniqueId=e.engine.iv_state.uniqueId,i.isIVSubSwitch=e.engine.isIVSubSwitch),t(qf.QYPLAYER_VIDEO_CHANGE,i)})),this.engine.on(Va.a.NTF_VideoChange,(function(i){Cf.info("call js, fire event,params: type = vidChanged(视频切换)"),i.playerVersion=bn.a,e.engine.isInteractVideo&&(i.isInteractVideo=e.engine.isInteractVideo,i.uniqueId=e.engine.iv_state.uniqueId),t(qf.QYPLAYER_VID_CHANGE,i)})),this.engine.on(Va.a.NTF_FollowUpNextLoad,(function(e){Cf.info("call js, fire event,params: type = followUpNextLoad(继续加载后续结构)"),t(qf.QYPLAYER_FOLLOW_UPNEXT_LOAD,e)})),this.engine.on(Va.a.NTF_AD_Start,(function(e){Cf.info("call js, fire event,params: type = ADStart(广告开播)"),t(qf.QYPLAYER_NOTIFY_AD_START,e)})),this.engine.on(Va.a.NTF_AD_End,(function(e){Cf.info("call js, fire event,params: type = ADEnd(广告播放完成)"),t(qf.QYPLAYER_NOTIFY_AD_END,e)})),this.engine.on(Va.a.Status_AresNoticeInfo,(function(e){Cf.info("call js, fire event,params: type = AD notify info(广告通知的信息-只是转发)"+e.type),t(e.type,e.data)})),this.engine.on(Va.a.NTF_TimeUpdate,(function(e){t(qf.QYPLAYER_NOTIFY_TIMEUPDATE,e)})),this.engine.on(Va.a.NTF_Seeking,(function(e){t(qf.QYPLAYER_STATUS_SEEKING,e)})),this.engine.on(Va.a.NTF_NeedUserGesture4Playback,(function(){Cf.info("需要授权开播,加载皮肤"),e.engine.needUserGesture4Playback=!0,e.adapter.loadSkin({isMini:e.engine.isMini}),t(qf.QYPLAYER_NOTIFY_NeedUserGesture4Playback,event)})),this.engine.on(Va.a.NTF_Error,(function(a){i(qf.QYPLAYER_STATUS_ERROR,a.data),e.adapter.loadSkin({isMini:e.engine.isMini}),"A00011"===a.code&&(Cf.info("call js, fire event,params: type = recharge(请求JS充值)"),t(qf.QYPLAYER_RECHARGE,{code:"Q00310",from:""}))})),this.engine.on(Va.a.NTF_Recharge,(function(e){Cf.info("call js, fire event,params: type = recharge(请求JS充值)"),t(qf.QYPLAYER_RECHARGE,e)})),this.engine.on(Va.a.NTF_BuyPlay,(function(e){Cf.info("call js, fire event,params: type = buyPlay(会员购买超前点播特权)"),t(qf.QYPLAYER_BuyPlay,e)})),this.engine.on(Va.a.NTF_AD_BLOCK,(function(e){Cf.info("call js, fire event,params: type = adblock"),t(qf.QYPLAYER_NOTIFY_AD_BLOCK,e)})),this.view.on(qf.QYPLAYER_FIND_GOODS,(function(e){Cf.info("call js, fire event,params: type = findGoods(定位到商品)"),t(qf.QYPLAYER_FIND_GOODS,e)})),this.view.on(qf.QYPLAYER_DOSOMETHING,(function(e){Cf.info("call js, fire event,params: type = setJsDoSomething(请求JS做某些操作), data = "+JSON.stringify(e)),t(qf.QYPLAYER_DOSOMETHING,e)})),this.view.on(Ef.a.NTF_SHOW_LOGIN_PANEL,(function(e){Cf.info("call js, fire event,params: type = showLoginPanel(弹出登录框),data = "+JSON.stringify(e)),t(qf.QYPLAYER_SHOW_LOGIN_PANEL,e)})),this.view.on(Ef.a.NTF_WebFullScreen_BeforeChange,(function(e){t(qf.QYPLAYER_WEBFULLSCREEN_BEFORE_CHANGE,"enter"===e)})),this.view.on(Ef.a.NTF_WebFullScreen_AfterChange,(function(e){var i="enter"===e;Cf.info("call js, fire event,params: type = afterWebFullScreenChange(页面全屏改变), data = "+i),t(qf.QYPLAYER_WEBFULLSCREEN_AFTER_CHANGE,i)})),this.view.on(Ef.a.NTF_FullScreen_BeforeChange,(function(e){t(qf.QYPLAYER_FULLSCREEN_BEFORE_CHANGE,"enter"===e)})),this.view.on(Ef.a.NTF_FullScreen_AfterChange,(function(e){var i="enter"===e;Cf.info("call js, fire event,params: type = afterWebFullScreenChange(全屏改变), data = "+i),t(qf.QYPLAYER_FULLSCREEN_AFTER_CHANGE,i)})),this.view.on(Ef.a.NTF_ScoreTask_ScoreChange,(function(){t(qf.QYPLAYER_NOTIFY_SCORECHANGE)})),this.view.on(Ef.a.NTF_FeedBack_Show,(function(){t(qf.QYPLAYER_NOTIFY_FEEDBACK_SHOW)})),this.view.on(Ef.a.NTF_FeedBack_Hide,(function(){t(qf.QYPLAYER_NOTIFY_FEEDBACK_HIDE)})),this.view.on(Ef.a.NTF_USER_SEEK,(function(){Cf.info("call js, fire event,params: type = userSeek"),t(qf.QYPLAYER_NOTIFY_USER_SEEK)})),this.view.on(Ef.a.NTF_AIView_ItemClick,(function(e){Cf.info("call js, fire event,params: type = aistarinfo"),t(qf.QYPLAYER_NOTIFY_AI_STAR_INFO,e)})),this.view.on(Ef.a.NTF_AIView_CLOSE,(function(e){Cf.info("call js, fire event,params: type = aistarclose"),t(qf.QYPLAYER_NOTIFY_AI_STAR_CLOSE,e)})),this.view.on(Ef.a.NTF_AIView_BAIKE_CLOSE,(function(e){Cf.info("call js, fire event,params: type = aistarclose"),t(qf.QYPLAYER_NOTIFY_AI_STAR_CLOSE,e)})),this.view.on(Ef.a.NTF_SHOW_VIDEOLIST,(function(e){Cf.info("call js, fire event,params: type = showvideolist"),t(qf.QYPLAYER_NOTIFY_SHOW_VIDEOLIST,e)})),this.view.on(Ef.a.NTF_IV_INTERACTIONSTART,(function(e){Cf.info("call js, fire event,params: type = interactionstart"),t(qf.QYPLAYER_NOTIFY_INTERACTION_START,e)})),this.view.on(Ef.a.NTF_IV_INTERACTIONEND,(function(e){Cf.info("call js, fire event,params: type = interactionend"),t(qf.QYPLAYER_NOTIFY_INTERACTION_END,e)}))}},{key:"addView",value:function(e){this.view.addView(e)}},{key:"load",value:function(e){Cf.info("js call func,params: type = load(加载视频), data = "+e),this.engine.load(e)}},{key:"destroy",value:function(){this.engine.destroy(),this.view.destroy()}},{key:"play",value:function(e){Cf.info("js call func,params: type = play(播放)");var t=!1;e&&e.withUserGesture&&(t=!0),this.engine.play(t)}},{key:"resume",value:function(){Cf.info("js call func,params: type = resume"),this.engine.play()}},{key:"replay",value:function(){Cf.info("js call func,params: type = replay"),this.engine.replay()}},{key:"pause",value:function(){Cf.info("js call func,params: type = pause , patch = ".concat(this.engine.isPatch(),", switching=").concat(this.engine.playproxy._videoSwitching)),this.engine.isPatch()||(this.engine.playproxy._videoSwitching?this.engine.pause(!0,!0):this.engine.pause())}},{key:"seek",value:function(e){Cf.info("js call func,params: type = seek, time = "+e),this.engine.seek(e)}},{key:"seekN",value:function(e){if("number"==typeof e&&isFinite(e)){Cf.info("js call func,params: type = seekN, time = "+e);var t=this.engine.getCurrenttime();this.engine.seek(t+e)}}},{key:"setPlayPingbackInfo",value:function(e){Cf.info("js call func,params: type = setPlayPingbackInfo, param = "+JSON.stringify(e)),this.engine.setPlayPingbackInfo(e)}},{key:"stop",value:function(){Cf.info("js call func,params: type = stop(停止播放)"),this.engine.stop()}},{key:"getMuted",value:function(){return this.engine.getMuted()}},{key:"isPaused",value:function(){return this.engine.isPaused()}},{key:"setMuted",value:function(e){this.engine.setMuted(e)}},{key:"getPlayInfo",value:function(e){var t=this.engine,i=this.view;t.getPlayInfo((function(a){var n={};n.tvid=a.tvid,n.vid=a.vid,n.cid=a.cid,n.albumId=a.albumId,n.categoryId=a.cid,n.currentTime=t.getCurrenttime(),n.totalDuration=1e3*t.getDuration(),n.bufferTime=t.getBufferTime(),n.currentDefination=a.rate,n.currentTrack="",n.currentStatus=t.getCurrStatus(),n.isTryWatch=t.isTryWatch()?"1":"0",n.isPause=t.isPaused()?"1":"0";var r=i.getRealArea();n.width=parseInt(r.width),n.height=parseInt(r.height),n.vipTypes=t.getVipTypes(),n.playerVersion=a.playerVersion,e&&"function"==typeof e&&e(n)}))}},{key:"getVideoInfo",value:function(e){this.engine.getVideoInfo(e)}},{key:"setQiyiUserLogin",value:function(e){Cf.info("js call func,params: type = setQiyiUserLogin(修改登录状态), param = "+v.a.stringify(e)),this.view.setQiyiUserLogin(e)}},{key:"switchVideo",value:function(e){Cf.info("js call func,params: type = switchVideo(影片切换), param = "+v.a.stringify(e)),this.engine.switchVideo(e)}},{key:"switchNextVideo",value:function(){Cf.info("js call func,params: type = switchNextVideo(下一集)"),this.view.switchNextVideo()}},{key:"switchPreVideo",value:function(){Cf.info("js call func,params: type = switchPreVideo(上一集)"),this.view.switchPreVideo()}},{key:"addVideoList",value:function(e){Cf.info("js call func,params: type = addVideoList(添加联播列表)"),this.view.addVideoList(e)}},{key:"removeVideoList",value:function(e){Cf.info("js call func,params: type = removeVideoList(从联播列表删除), data = "+e),this.view.removeVideoList(e)}},{key:"setSmallWindowMode",value:function(e){this.view.setSmallWindowMode(e)}},{key:"jsNotifyAdManager",value:function(e){this.engine.jsNotifyAdManager(e)}},{key:"getQiyiPlayerLog",value:function(e){try{this["package"].getQiyiPlayerLog(e)}catch(t){}}},{key:"clearBanWord",value:function(){this.view.emit(Ef.a.NTF_Barrage_ClearBanWord)}},{key:"addBanWord",value:function(e){this.view.emit(Ef.a.NTF_Barrage_AddBanWord,e)}},{key:"removeBanWord",value:function(e){this.view.emit(Ef.a.NTF_Barrage_RemoveBanWord,e)}},{key:"notyfyADInfo",value:function(e){this.engine.notyfyADInfo(e)}},{key:"setRightBarStatus",value:function(e){e&&e.type&&(Cf.info("js call func,params: type = setRightBarStatus, param = "+v.a.stringify(e)),this.view.setRightBarStatus(e))}},{key:"setExpandScreenStatus",value:function(e){e&&this.view.emit(Ef.a.NTF_EXPANDSCREEN_STATUS_CHANGED,e)}},{key:"getQiyiPlayerInfo",value:function(e){this.getPlayInfo(e)}},{key:"setPlayerWebFullScreen",value:function(e){this.view.emit(Ef.a.NTF_WebFullScreen_SetSwitch,e)}},{key:"setPlayerFullScreen",value:function(e){this.view.emit(Ef.a.NTF_FullScreen_SetSwitch,e)}},{key:"setDelayPlayInfo",value:function(e){this.engine.setDelayPlayInfo(e)}},{key:"clearDelayPlayInfo",value:function(e){this.engine.clearDelayPlayInfo(e)}},{key:"addPlayListView",value:function(e){e.request=!0,this.view.emit(Ef.a.NTF_ADDVideoList,e)}},{key:"getSwitchVideoType",value:function(){this.view._switchVideoType}},{key:"exitPicInPic",value:function(){this.view.emit(Ef.a.Type_ExitPic)}},{key:"showToast",value:function(e){this.view.emit(Ef.a.NTF_SHOW_TOAST,{txt:e})}},{key:"refresh",value:function(e){this.engine.refresh(e)}},{key:"backToStoryLine",value:function(e){var t=this.engine.IVRecorder;t&&t.backToStoryLine(e)}},{key:"backToIVMain",value:function(e){this.view.emit(Ef.a.NTF_BACKTO_IVMAIN,e)}},{key:"setFollowData",value:function(e){Cf.info("js call, setFollowData, data = ".concat(JSON.stringify(e))),this.view.setFollowData(e)}},{key:"changeFollowState",value:function(e){Cf.info("js call, changeFollowState, data = ".concat(JSON.stringify(e))),this.view.emit(Ef.a.NTF_FOLLOW_CHANGE_STATE,e)}},{key:"changeAIBaikeState",value:function(e){Cf.info("js call, changeAIBaikeState, data = ".concat(JSON.stringify(e))),this.view.emit(Ef.a.NTF_AIView_BAIKE_STATECHANGE,e)}},{key:"setBarrageState",value:function(e){Cf.info("js call, setBarrageState, data = ".concat(JSON.stringify(e))),e.index!==undefined&&e.focus!==undefined&&(this.view.barrageFocux==undefined&&(this.view.barrageFocux=[]),this.view.barrageFocux[parseInt(e.index)]=e.focus)}}]),t}(p.a);t["default"]=Mf;mf=window.QiyiPlayerLoader||{},vf=!!mf.packLoader.usedGrayUrl["wonder.data.pc"],"wonder.data.pc"===mf.packageName&&(!vf&&mf.isSyncing||!mf.isSyncing)&&mf.setPackage(Mf)}]);